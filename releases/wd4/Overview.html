<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.27">
  <meta charset="utf-8">
  <meta name="generator" content="ReSpec 24.33.2">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1, shrink-to-fit=no">
  <style>
  /* --- EXAMPLES --- */
  span.example-title {
    text-transform: none;
  }
  aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  div.illegal-example { color: red }
  div.illegal-example p { color: black }
  aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
  }

  aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
  }
  aside.example div.example span.example-title {
    color: #999;
  }
  </style>
  <style>
  /* --- ISSUES/NOTES --- */
  .issue-label {
    text-transform: initial;
  }

  .warning > p:first-child { margin-top: 0 }
  .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
  }
  span.warning { padding: .1em .5em .15em; }

  .issue.closed span.issue-number {
    text-decoration: line-through;
  }

  .warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
  }

  .warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
  }

  li.task-list-item {
    list-style: none;
  }

  input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
  }

  .issue a.respec-gh-label {
  padding: 5px;
  margin: 0 2px 0 2px;
  font-size: 10px;
  text-transform: none;
  text-decoration: none;
  font-weight: bold;
  border-radius: 4px;
  position: relative;
  bottom: 2px;
  border: none;
  }

  .issue a.respec-label-dark {
  color: #fff;
  background-color: #000;
  }

  .issue a.respec-label-light {
  color: #000;
  background-color: #fff;
  }
  </style>
  <style>
  /* --- WEB IDL --- */

  pre.idl {
  padding: 1em;
  position: relative;
  }

  @media print {
  pre.idl {
    white-space: pre-wrap;
  }
  }

  pre.idl::before {
  content: "WebIDL";
  display: block;
  width: 150px;
  background: #90b8de;
  color: #fff;
  font-family: sans-serif;
  font-weight: bold;
  margin: -1em 0 1em -1em;
  height: 28px;
  line-height: 28px;  
  }

  .idlID {
  font-weight: bold;
  color: #005a9c;
  }

  .idlType {
  color: #005a9c;
  }

  .idlName {
  color: #ff4500;
  }

  .idlName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }

  a.idlEnumItem {
  color: #000;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  .idlSuperclass {
  font-style: italic;
  color: #005a9c;
  }


  /*.idlParam*/

  .idlParamName,
  .idlDefaultValue {
  font-style: italic;
  }

  .extAttr {
  color: #666;
  }


  /*.idlSectionComment*/

  .idlSectionComment {
  color: gray;
  }

  .idlIncludes a {
  font-weight: bold;
  }

  .respec-button-copy-paste:focus {
  text-decoration: none;
  border-color: #51a7e8;
  outline: none;
  box-shadow: 0 0 5px rgba(81, 167, 232, 0.5);
  }

  .respec-button-copy-paste:focus:hover,
  .respec-button-copy-paste.selected:focus {
  border-color: #51a7e8;
  }

  .respec-button-copy-paste:hover,
  .respec-button-copy-paste:active,
  .respec-button-copy-paste.zeroclipboard-is-hover,
  .respec-button-copy-paste.zeroclipboard-is-active {
  text-decoration: none;
  background-color: #ddd;
  background-image: linear-gradient(#eee, #ddd);
  border-color: #ccc;
  }

  .respec-button-copy-paste:active,
  .respec-button-copy-paste.selected,
  .respec-button-copy-paste.zeroclipboard-is-active {
  background-color: #dcdcdc;
  background-image: none;
  border-color: #b5b5b5;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15)
  }

  .respec-button-copy-paste.selected:hover {
  background-color: #cfcfcf;
  }

  .respec-button-copy-paste:disabled,
  .respec-button-copy-paste:disabled:hover,
  .respec-button-copy-paste.disabled,
  .respec-button-copy-paste.disabled:hover {
  color: rgba(102, 102, 102, 0.5);
  cursor: default;
  background-color: rgba(229, 229, 229, 0.5);
  background-image: none;
  border-color: rgba(197, 197, 197, 0.5);
  box-shadow: none;
  }

  @media print {
  .respec-button-copy-paste {
    visibility: hidden;
  }
  }
  </style>
  <title>Web of Things (WoT) Scripting API</title>
  <style id="respec-mainstyle">
  /*****************************************************************
  * ReSpec 3 CSS
  * Robin Berjon - http://berjon.com/
  *****************************************************************/

  @keyframes pop {
  0% {
    transform: scale(1, 1);
  }
  25% {
    transform: scale(1.25, 1.25);
    opacity: 0.75;
  }
  100% {
    transform: scale(1, 1);
  }
  }

  /* Override code highlighter background */
  .hljs {
  background: transparent !important;
  }

  /* --- INLINES --- */
  h1 abbr,
  h2 abbr,
  h3 abbr,
  h4 abbr,
  h5 abbr,
  h6 abbr,
  a abbr {
  border: none;
  }

  dfn {
  font-weight: bold;
  }

  a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
  }

  a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  a.bibref {
  text-decoration: none;
  }

  .respec-offending-element:target {
  animation: pop 0.25s ease-in-out 0s 1;
  }

  .respec-offending-element,
  a[href].respec-offending-element {
  text-decoration: red wavy underline;
  }
  @supports not (text-decoration: red wavy underline) {
  .respec-offending-element:not(pre) {
    display: inline-block;
  }
  .respec-offending-element {
    /* Red squiggly line */
    background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=)
      bottom repeat-x;
  }
  }

  #references :target {
  background: #eaf3ff;
  animation: pop 0.4s ease-in-out 0s 1;
  }

  cite .bibref {
  font-style: normal;
  }

  code {
  color: #c83500;
  }

  th code {
  color: inherit;
  }

  a[href].orcid {
    padding-left: 4px;
    padding-right: 4px;
  }

  a[href].orcid > svg {
    margin-bottom: -2px;
  }

  /* --- TOC --- */

  .toc a,
  .tof a {
  text-decoration: none;
  }

  a .secno,
  a .figno {
  color: #000;
  }

  ul.tof,
  ol.tof {
  list-style: none outside none;
  }

  .caption {
  margin-top: 0.5em;
  font-style: italic;
  }

  /* --- TABLE --- */

  table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
  }

  .simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
  }

  .simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
  }

  .simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  }

  .simple tr:nth-child(even) {
  background: #f0f6ff;
  }

  /* --- DL --- */

  .section dd > p:first-child {
  margin-top: 0;
  }

  .section dd > p:last-child {
  margin-bottom: 0;
  }

  .section dd {
  margin-bottom: 1em;
  }

  .section dl.attrs dd,
  .section dl.eldef dd {
  margin-bottom: 0;
  }

  #issue-summary > ul,
  .respec-dfn-list {
  column-count: 2;
  }

  #issue-summary li,
  .respec-dfn-list li {
  list-style: none;
  }

  details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
  }

  details.respec-tests-details > * {
  padding-right: 2em;
  }

  details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: 0.3em;
  background-color: white;
  padding-bottom: 0.5em;
  }

  details.respec-tests-details[open] > summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
  }

  details.respec-tests-details > ul {
  width: 100%;
  margin-top: -0.3em;
  }

  details.respec-tests-details > li {
  padding-left: 1em;
  }

  a[href].self-link:hover {
  opacity: 1;
  text-decoration: none;
  background-color: transparent;
  }

  h2,
  h3,
  h4,
  h5,
  h6 {
  position: relative;
  }

  aside.example .marker > a.self-link {
  color: inherit;
  }

  h2 > a.self-link,
  h3 > a.self-link,
  h4 > a.self-link,
  h5 > a.self-link,
  h6 > a.self-link {
  border: none;
  color: inherit;
  font-size: 83%;
  height: 2em;
  left: -1.6em;
  opacity: 0.5;
  position: absolute;
  text-align: center;
  text-decoration: none;
  top: 0;
  transition: opacity 0.2s;
  width: 2em;
  }

  h2 > a.self-link::before,
  h3 > a.self-link::before,
  h4 > a.self-link::before,
  h5 > a.self-link::before,
  h6 > a.self-link::before {
  content: "§";
  display: block;
  }

  @media (max-width: 767px) {
  dd {
    margin-left: 0;
  }

  /* Don't position self-link in headings off-screen */
  h2 > a.self-link,
  h3 > a.self-link,
  h4 > a.self-link,
  h5 > a.self-link,
  h6 > a.self-link {
    left: auto;
    top: auto;
  }
  }

  @media print {
  .removeOnSave {
    display: none;
  }
  }
  </style>
  <style type="text/css">
  @-webkit-keyframes vex-fadein {
  0% {
    opacity: 0; }
  100% {
    opacity: 1; } }

  @keyframes vex-fadein {
  0% {
    opacity: 0; }
  100% {
    opacity: 1; } }

  @-webkit-keyframes vex-fadeout {
  0% {
    opacity: 1; }
  100% {
    opacity: 0; } }

  @keyframes vex-fadeout {
  0% {
    opacity: 1; }
  100% {
    opacity: 0; } }

  @-webkit-keyframes vex-rotation {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg); }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg); } }

  @keyframes vex-rotation {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg); }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg); } }

  .vex, .vex *, .vex *:before, .vex *:after {
  -moz-box-sizing: border-box;
  box-sizing: border-box; }

  .vex {
  position: fixed;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  z-index: 1111;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0; }

  .vex-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll; }

  .vex-overlay {
  -webkit-animation: vex-fadein .5s;
  animation: vex-fadein .5s;
  position: fixed;
  z-index: 1111;
  background: rgba(0, 0, 0, 0.4);
  top: 0;
  right: 0;
  bottom: 0;
  left: 0; }

  .vex-overlay.vex-closing {
  -webkit-animation: vex-fadeout .5s forwards;
  animation: vex-fadeout .5s forwards; }

  .vex-content {
  -webkit-animation: vex-fadein .5s;
  animation: vex-fadein .5s;
  background: #fff; }

  .vex.vex-closing .vex-content {
  -webkit-animation: vex-fadeout .5s forwards;
  animation: vex-fadeout .5s forwards; }

  .vex-close:before {
  font-family: Arial, sans-serif;
  content: "\D7"; }

  .vex-dialog-form {
  margin: 0; }

  .vex-dialog-button {
  text-rendering: optimizeLegibility;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent; }

  .vex-loading-spinner {
  -webkit-animation: vex-rotation .7s linear infinite;
  animation: vex-rotation .7s linear infinite;
  box-shadow: 0 0 1em rgba(0, 0, 0, 0.1);
  position: fixed;
  z-index: 1112;
  margin: auto;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  height: 2em;
  width: 2em;
  background: #fff; }

  body.vex-open {
  overflow: hidden; }
  </style>
  <style type="text/css">
  @-webkit-keyframes vex-pulse {
  0% {
    box-shadow: inset 0 0 0 300px transparent; }
  70% {
    box-shadow: inset 0 0 0 300px rgba(255, 255, 255, 0.25); }
  100% {
    box-shadow: inset 0 0 0 300px transparent; } }

  @keyframes vex-pulse {
  0% {
    box-shadow: inset 0 0 0 300px transparent; }
  70% {
    box-shadow: inset 0 0 0 300px rgba(255, 255, 255, 0.25); }
  100% {
    box-shadow: inset 0 0 0 300px transparent; } }

  .vex.vex-theme-wireframe {
  padding-top: 160px;
  padding-bottom: 160px; }
  .vex.vex-theme-wireframe .vex-overlay {
    background: rgba(255, 255, 255, 0.4); }
  .vex.vex-theme-wireframe .vex-content {
    font-family: "Helvetica Neue", sans-serif;
    background: #fff;
    color: #000;
    border: 2px solid #000;
    padding: 2em;
    position: relative;
    margin: 0 auto;
    max-width: 100%;
    width: 400px;
    font-size: 1.1em;
    line-height: 1.5em; }
    .vex.vex-theme-wireframe .vex-content h1, .vex.vex-theme-wireframe .vex-content h2, .vex.vex-theme-wireframe .vex-content h3, .vex.vex-theme-wireframe .vex-content h4, .vex.vex-theme-wireframe .vex-content h5, .vex.vex-theme-wireframe .vex-content h6, .vex.vex-theme-wireframe .vex-content p, .vex.vex-theme-wireframe .vex-content ul, .vex.vex-theme-wireframe .vex-content li {
      color: inherit; }
  .vex.vex-theme-wireframe .vex-close {
    position: absolute;
    top: 0;
    right: 0;
    cursor: pointer; }
    .vex.vex-theme-wireframe .vex-close:before {
      position: absolute;
      content: "\D7";
      font-size: 40px;
      font-weight: normal;
      line-height: 80px;
      height: 80px;
      width: 80px;
      text-align: center;
      top: 3px;
      right: 3px;
      color: #000; }
    .vex.vex-theme-wireframe .vex-close:hover:before, .vex.vex-theme-wireframe .vex-close:active:before {
      color: #000; }
  .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-message {
    margin-bottom: .5em; }
  .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input {
    margin-bottom: 1em; }
    .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input select, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input textarea, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="date"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="datetime"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="datetime-local"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="email"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="month"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="number"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="password"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="search"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="tel"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="text"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="time"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="url"], .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="week"] {
      background: #fff;
      width: 100%;
      padding: .25em .67em;
      font-family: inherit;
      font-weight: inherit;
      font-size: inherit;
      min-height: 2.5em;
      margin: 0 0 .25em;
      border: 2px solid #000; }
      .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input select:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input textarea:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="date"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="datetime"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="datetime-local"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="email"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="month"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="number"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="password"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="search"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="tel"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="text"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="time"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="url"]:focus, .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-input input[type="week"]:focus {
        border-style: dashed;
        outline: none; }
  .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-buttons {
    *zoom: 1; }
    .vex.vex-theme-wireframe .vex-dialog-form .vex-dialog-buttons:after {
      content: "";
      display: table;
      clear: both; }
  .vex.vex-theme-wireframe .vex-dialog-button {
    border-radius: 0;
    border: 0;
    float: right;
    margin: 0 0 0 .5em;
    font-family: inherit;
    text-transform: uppercase;
    letter-spacing: .1em;
    font-size: .8em;
    line-height: 1em;
    padding: .75em 2em; }
    .vex.vex-theme-wireframe .vex-dialog-button.vex-last {
      margin-left: 0; }
    .vex.vex-theme-wireframe .vex-dialog-button:focus {
      -webkit-animation: vex-pulse 1.1s infinite;
      animation: vex-pulse 1.1s infinite;
      outline: none; }
      @media (max-width: 568px) {
        .vex.vex-theme-wireframe .vex-dialog-button:focus {
          -webkit-animation: none;
          animation: none; } }
    .vex.vex-theme-wireframe .vex-dialog-button.vex-dialog-button-primary {
      background: #000;
      color: #fff;
      border: 2px solid transparent; }
    .vex.vex-theme-wireframe .vex-dialog-button.vex-dialog-button-secondary {
      background: #fff;
      color: #000;
      border: 2px solid #000; }

  .vex-loading-spinner.vex-theme-wireframe {
  height: 2.5em;
  width: 2.5em; }
  </style>
  <style type="text/css">
  .vex-dialog-message {
  font-weight: bold;
  text-align: center;
  }

  .vex-dialog-input p {
  margin-bottom: 1em;
  }
  </style>
  <link rel="canonical" href=
  "https://www.w3.org/TR/wot-scripting-api/">
  <style>
  /*

  github.com style (c) Vasily Polovnyov <vast@whiteants.net>

  */

  .hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
  }

  .hljs-comment,
  .hljs-quote {
  color: #998;
  font-style: italic;
  }

  .hljs-keyword,
  .hljs-selector-tag,
  .hljs-subst {
  color: #333;
  font-weight: bold;
  }

  .hljs-number,
  .hljs-literal,
  .hljs-variable,
  .hljs-template-variable,
  .hljs-tag .hljs-attr {
  color: #008080;
  }

  .hljs-string,
  .hljs-doctag {
  color: #d14;
  }

  .hljs-title,
  .hljs-section,
  .hljs-selector-id {
  color: #900;
  font-weight: bold;
  }

  .hljs-subst {
  font-weight: normal;
  }

  .hljs-type,
  .hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
  }

  .hljs-tag,
  .hljs-name,
  .hljs-attribute {
  color: #000080;
  font-weight: normal;
  }

  .hljs-regexp,
  .hljs-link {
  color: #009926;
  }

  .hljs-symbol,
  .hljs-bullet {
  color: #990073;
  }

  .hljs-built_in,
  .hljs-builtin-name {
  color: #0086b3;
  }

  .hljs-meta {
  color: #999;
  font-weight: bold;
  }

  .hljs-deletion {
  background: #fdd;
  }

  .hljs-addition {
  background: #dfd;
  }

  .hljs-emphasis {
  font-style: italic;
  }

  .hljs-strong {
  font-weight: bold;
  }
  </style>
  <style>
  var {
  position: relative;
  cursor: pointer;
  }

  var[data-type]::before,
  var[data-type]::after {
  position: absolute;
  left: 50%;
  top: -6px;
  opacity: 0;
  transition: opacity 0.4s;
  pointer-events: none;
  }

  /* the triangle or arrow or caret or whatever */
  var[data-type]::before {
  content: "";
  transform: translateX(-50%);
  border-width: 4px 6px 0 6px;
  border-style: solid;
  border-color: transparent;
  border-top-color: #000;
  }

  /* actual text */
  var[data-type]::after {
  content: attr(data-type);
  transform: translateX(-50%) translateY(-100%);
  background: #000;
  text-align: center;
  /* additional styling */
  font-family: "Dank Mono", "Fira Code", monospace;
  font-style: normal;
  padding: 6px;
  border-radius: 3px;
  color: #daca88;
  text-indent: 0;
  font-weight: normal;
  }

  var[data-type]:hover::after,
  var[data-type]:hover::before {
  opacity: 1;
  }
  </style>
  <script id="initialUserConfig" type="application/json">
  {
  "specStatus": "WD",
  "shortName": "wot-scripting-api",
  "copyrightStart": 2017,
  "noLegacyStyle": true,
  "publishDate": "2019-10-28",
  "previousPublishDate": "2018-11-29",
  "previousMaturity": "",
  "edDraftURI": "https://w3c.github.io/wot-scripting-api/",
  "crEnd": "",
  "inlineCSS": true,
  "noIDLIn": true,
  "format": "markdown",
  "editors": [
    {
      "name": "Zoltan Kis",
      "w3cid": "57789",
      "company": "Intel",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Daniel Peintner",
      "w3cid": "39497",
      "company": "Siemens AG",
      "companyURL": "https://www.siemens.com/"
    },
    {
      "name": "Johannes Hund",
      "w3cid": "74472",
      "note": "Former Editor, when at Siemens AG"
    },
    {
      "name": "Kazuaki Nimura",
      "w3cid": "59208",
      "note": "Former Editor, at Fujitsu Ltd."
    }
  ],
  "wg": "Web of Things Working Group",
  "wgURI": "https://www.w3.org/WoT/WG/",
  "wgPublicList": "public-wot-wg",
  "issueBase": "https://www.github.com/w3c/wot-scripting-api/issues/",
  "githubAPI": "https://api.github.com/repos/w3c/wot-scripting-api",
  "otherLinks": [
    {
      "key": "Repository",
      "data": [
        {
          "value": "On GitHub",
          "href": "https://github.com/w3c/wot-scripting-api"
        },
        {
          "value": "File a bug",
          "href": "https://github.com/w3c/wot-scripting-api/issues"
        }
      ]
    },
    {
      "key": "Contributors",
      "data": [
        {
          "value": "Contributors on GitHub",
          "href": "https://github.com/w3c/wot-scripting-api/graphs/contributors"
        }
      ]
    }
  ],
  "localBiblio": {
    "WOT-ARCHITECTURE": {
      "href": "https://www.w3.org/TR/2019/CR-wot-architecture-20190516/",
      "title": "Web of Things Architecture",
      "publisher": "W3C",
      "date": "16 May 2019",
      "id": "wot-architecture"
    },
    "WOT-TD": {
      "href": "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/",
      "title": "WoT Thing Description ",
      "publisher": "W3C",
      "date": "16 May 2019",
      "id": "wot-td"
    },
    "WOT-PROTOCOL-BINDINGS": {
      "href": "https://w3c.github.io/wot-binding-templates/",
      "title": "Web of Things Protocol Binding Templates",
      "publisher": "W3C",
      "date": "20 August 2017",
      "id": "wot-protocol-bindings"
    },
    "WOT-PRACTICES": {
      "href": "http://w3c.github.io/wot/current-practices/wot-practices.html",
      "title": "Web of Things Current Practices",
      "publisher": "W3C",
      "date": "6 February 2017"
    },
    "WOT-SECURITY-GUIDELINES": {
      "href": "https://w3c.github.io/wot-security/",
      "title": "Web of Things Security and Privacy Guidelines",
      "publisher": "W3C",
      "date": "28 August 2017",
      "id": "wot-security-guidelines"
    },
    "WOT-SECURITY-BEST-PRACTICES": {
      "href": "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md",
      "title": "Web of Things Security and Privacy Best Practices",
      "publisher": "W3C",
      "date": "WIP",
      "id": "wot-security-best-practices"
    },
    "WOT-SECURITY-TESTING": {
      "href": "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md",
      "title": "Web of Things Security Testing and Validation",
      "publisher": "W3C",
      "date": "WIP",
      "id": "wot-security-testing"
    },
    "TYPESCRIPT": {
      "href": "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md",
      "title": "TypeScript Language Specification",
      "publisher": "Microsoft",
      "date": "1 October 2012",
      "id": "typescript"
    },
    "WEBAPPSEC": {
      "href": "https://w3c.github.io/webappsec/specs/powerfulfeatures",
      "title": "Secure Contexts",
      "publisher": "W3C",
      "date": "17 July 2015",
      "id": "webappsec"
    }
  },
  "publishISODate": "2019-10-28T00:00:00.000Z",
  "generatedSubtitle": "WOrking Draft 28 October 2019"
  }
  </script>
  <meta name="description" content=
  "The main Web of Things (WoT) concepts are described in the WoT Architecture document. The Web of Things is made of entities (Things) that can describe their capabilities in a machine-interpretable Thing Description (TD) and expose these capabilities through the WoT Interface, that is, network interactions modeled as Properties (for reading and writing values), Actions (to execute remote procedures with or without return values) and Events (for signaling notifications).">
  <link rel="stylesheet" href=
  "https://www.w3.org/StyleSheets/TR/2016/W3C-WD">
</head>
<body class="h-entry" data-cite="WebIDL">
  <div class="head">
    <a class="logo" href="https://www.w3.org/"><img alt="W3C"
    width="72" height="48" src=
    "https://www.w3.org/StyleSheets/TR/2016/logos/W3C"></a>
    <h1 id="title" class="title p-name">Web of Things (WoT)
    Scripting API</h1>
    <h2>W3C Working Draft <time class="dt-published" datetime=
    "2019-10-28">28 October 2019</time></h2>
    <dl>
      <dt>This version:</dt>
      <dd>
        <a class="u-url" href=
        "https://www.w3.org/TR/2019/WD-wot-scripting-api-20191028/">
          https://www.w3.org/TR/2019/WD-wot-scripting-api-20191028/</a>
      </dd>
      <dt>Latest published version:</dt>
      <dd>
        <a href=
        "https://www.w3.org/TR/wot-scripting-api/">https://www.w3.org/TR/wot-scripting-api/</a>
      </dd>
      <dt>Latest editor's draft:</dt>
      <dd>
        <a href=
        "https://w3c.github.io/wot-scripting-api/">https://w3c.github.io/wot-scripting-api/</a>
      </dd>
      <dt>Previous version:</dt>
      <dd>
        <a class="u-url" href=
        "https://www.w3.org/TR/2018/WD-wot-scripting-api-20181129/">
          https://www.w3.org/TR/2018/WD-wot-scripting-api-20181129/</a>
      </dd>
      <dt>Editors:</dt>
      <dd class="p-author h-card vcard" data-editor-id="57789">
        <span class="p-name fn">Zoltan Kis</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.intel.com/">Intel</a>)
      </dd>
      <dd class="p-author h-card vcard" data-editor-id="39497">
        <span class="p-name fn">Daniel Peintner</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.siemens.com/">Siemens AG</a>)
      </dd>
      <dd class="p-author h-card vcard" data-editor-id="74472"><span class=
      "p-name fn">Johannes Hund</span> (Former Editor, when at
      Siemens AG)</dd>
      <dd class="p-author h-card vcard" data-editor-id="59208"><span class=
      "p-name fn">Kazuaki Nimura</span> (Former Editor, at Fujitsu
      Ltd.)</dd>
      <dt>Repository:</dt>
      <dd>
        <a href="https://github.com/w3c/wot-scripting-api">On
        GitHub</a>
      </dd>
      <dd>
        <a href=
        "https://github.com/w3c/wot-scripting-api/issues">File a
        bug</a>
      </dd>
      <dt>Contributors:</dt>
      <dd>
        <a href=
        "https://github.com/w3c/wot-scripting-api/graphs/contributors">
        Contributors on GitHub</a>
      </dd>
    </dl>
    <p class="copyright"><a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    © 2017-2019 <a href="https://www.w3.org/"><abbr title=
    "World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
    (<a href="https://www.csail.mit.edu/"><abbr title=
    "Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title=
    "European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
    <a href="https://www.keio.ac.jp/">Keio</a>, <a href=
    "https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
    liability</a>, <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
    trademark</a> and <a rel="license" href=
    "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">
    permissive document license</a> rules apply.</p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory">
    <h2>Abstract</h2>
    <p>The main <a href="#dfn-web-of-things" class="internalDFN"
    data-link-type="dfn">Web of Things</a> (WoT) concepts are
    described in the <a href=
    "https://www.w3.org/TR/2019/CR-wot-architecture-20190516/">WoT Architecture</a>
    document. The Web of Things is made of entities (<a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a>s) that can describe their capabilities in a
    machine-interpretable <a href="#dfn-thing-descriptions" class=
    "internalDFN" data-link-type="dfn">Thing Description</a> (TD)
    and expose these capabilities through the <a href=
    "#dfn-wot-interface" class="internalDFN" data-link-type=
    "dfn">WoT Interface</a>, that is, network interactions modeled
    as <a href="#dfn-properties" class="internalDFN"
    data-link-type="dfn">Properties</a> (for reading and writing
    values), <a href="#dfn-actions" class="internalDFN"
    data-link-type="dfn">Action</a>s (to execute remote procedures
    with or without return values) and <a href="#dfn-events" class=
    "internalDFN" data-link-type="dfn">Event</a>s (for signaling
    notifications).</p>
    <p>Scripting is an optional "convenience" building block in WoT
    and it is typically used in gateways that are able to run a
    <a href="#dfn-wot-runtime" class="internalDFN" data-link-type=
    "dfn">WoT Runtime</a> and <a href=
    "https://github.com/w3c/wot-scripting-api/tree/master/applications/script-manager">
    script management</a>, providing a convenient way to extend WoT
    support to new types of endpoints and implement WoT
    applications such as <a href=
    "https://github.com/w3c/wot-scripting-api/tree/master/applications/thing-directory">
    Thing Directory</a>.</p>
    <p>This specification describes a programming interface
    representing the <a href="#dfn-wot-interface" class=
    "internalDFN" data-link-type="dfn">WoT Interface</a> that
    allows scripts to discover, operate <a href="#dfn-things"
    class="internalDFN" data-link-type="dfn">Thing</a>s and to
    expose locally defined <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn">Things</a> characterized by
    <a href="#dfn-wot-interactions" class="internalDFN"
    data-link-type="dfn">WoT Interactions</a> specified by a
    script.</p>
    <p>The specification deliberately follows the <a href=
    "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/">WoT Thing
    Description specification</a> closely. It is possible to
    implement simpler APIs on top of this API, or implementing
    directly the WoT network facing interface (i.e. the <a href=
    "#dfn-wot-interface" class="internalDFN" data-link-type=
    "dfn">WoT Interface</a>).</p>
    <div class="note" id="issue-container-generatedID">
      <div role="heading" class="ednote-title marker" id="h-ednote"
      aria-level="3">
        <span>Editor's note</span>
      </div>
      <p class="">This specification is implemented at least by the
      <a href="http://www.thingweb.io/">Thingweb</a> project also
      known as <a href=
      "https://github.com/eclipse/thingweb.node-wot">node-wot</a>,
      which is considered the reference open source implementation
      at the moment. Check its <a href=
      "https://github.com/eclipse/thingweb.node-wot">source
      code</a>, including <a href=
      "https://github.com/eclipse/thingweb.node-wot">examples</a>.
      Other, closed source implementations have been made by WG
      member companies and tested against <a href=
      "https://github.com/eclipse/thingweb.node-wot">node-wot</a>
      in plug-fests.</p>
    </div>
  </section>
  <section id="sotd" class="introductory">
    <h2>Status of This Document</h2>
    <p><em>This section describes the status of this document at
    the time of its publication. Other documents may supersede this
    document. A list of current <abbr title=
    "World Wide Web Consortium">W3C</abbr> publications and the
    latest revision of this technical report can be found in the
    <a href="https://www.w3.org/TR/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> technical reports
    index</a> at https://www.w3.org/TR/.</em></p>
    <p>Implementers need to be aware that this specification is
    considered unstable. Vendors interested in implementing this
    specification before it eventually reaches the Candidate
    Recommendation phase should subscribe to the <a href=
    "https://github.com/w3c/wot-scripting-api">repository</a> and
    take part in the discussions.</p>
    <div class="note" id="issue-container-generatedID-0">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-0" aria-level="3">
        <span>Editor's note</span><span class="issue-label">: The
        W3C WoT WG is asking for feedback</span>
      </div>
      <p class="">Please contribute to this draft using the
      <a href="https://github.com/w3c/wot-scripting-api/issues">GitHub
      Issue</a> feature of the <a href=
      "https://github.com/w3c/wot-scripting-api/">WoT Scripting
      API</a> repository. For feedback on security and privacy
      considerations, please use the <a href=
      "https://github.com/w3c/wot-security/issues">WoT Security and
      Privacy</a> Issues.</p>
    </div>
    <p>This document was published by the <a href=
    "https://www.w3.org/WoT/WG/">Web of Things Working Group</a> as
    a Working Draft. This document is intended to become a W3C
    Recommendation.</p>
    <p>Comments regarding this document are welcome. Please send
    them to <a href=
    "mailto:public-wot-wg@w3.org">public-wot-wg@w3.org</a>
    (<a href="https://lists.w3.org/Archives/Public/public-wot-wg/">archives</a>).</p>
    <p>Publication as a Working Draft does not imply endorsement
    by the <abbr title="World Wide Web Consortium">W3C</abbr>
    Membership. This is a draft document and may be updated,
    replaced or obsoleted by other documents at any time. It is
    inappropriate to cite this document as other than work in
    progress.</p>
    <p>This document was produced by a group operating under the
    <a href=
    "https://www.w3.org/Consortium/Patent-Policy/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
    <a rel="disclosure" href=
    "https://www.w3.org/2004/01/pp-impl/95969/status">public list
    of any patent
    disclosures</a> made in connection with the deliverables of the
    group; that page also includes instructions for disclosing a
    patent. An individual who has actual knowledge of a patent
    which the individual believes contains <a href=
    "https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with
    <a href=
    "https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section
    6 of the <abbr title="World Wide Web Consortium">W3C</abbr>
    Patent Policy</a>.</p>
    <p>This document is governed by the <a id=
    "w3c_process_revision" href=
    "https://www.w3.org/2019/Process-20190301/">1 March 2019
    <abbr title="World Wide Web Consortium">W3C</abbr> Process
    Document</a>.</p>
  </section>
  <nav id="toc">
    <h2 class="introductory" id="table-of-contents">Table of
    Contents</h2>
    <ol class="toc">
      <li class="tocline">
        <a class="tocxref" href="#introduction"><bdi class=
        "secno">1.</bdi> Introduction</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#use-cases"><bdi class=
        "secno">2.</bdi> Use Cases</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#consuming-a-thing"><bdi class="secno">2.1</bdi>
            Consuming a Thing</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#exposing-a-thing"><bdi class=
            "secno">2.2</bdi> Exposing a Thing</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#discovery"><bdi class=
            "secno">2.3</bdi> Discovery</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#conformance"><bdi class=
        "secno">3.</bdi> Conformance</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-thingdescription-type"><bdi class="secno">4.</bdi>
        The <span data-dfn-type="typedef" data-export="" data-idl=
        "typedef" data-title=
        "ThingDescription"><code>ThingDescription</code></span>
        type</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#fetching-a-thing-description"><bdi class=
            "secno">4.1</bdi> Fetching a Thing Description</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#expanding-a-thing-description"><bdi class=
            "secno">4.2</bdi> Expanding a Thing Description</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#validating-a-thing-description"><bdi class=
            "secno">4.3</bdi> Validating a Thing Description</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#the-wot-api-object"><bdi class=
        "secno">5.</bdi> The <span data-dfn-type="dfn">WoT API
        object</span></a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#the-wot-interface"><bdi class="secno">5.1</bdi> The
            <span data-dfn-type="interface" data-export=""
            data-idl="interface" data-title=
            "WOT"><code>WOT</code></span> interface</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-consume-method"><bdi class="secno">5.2</bdi> The
            <span data-dfn-type="method" data-export="" data-idl=
            "operation" data-title="consume()" data-dfn-for="WOT"
            data-type="Promise" data-lt=
            "WOT.consume()|WOT.consume|consume()|consume"><code>consume()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-produce-method"><bdi class="secno">5.3</bdi> The
            <span data-dfn-type="method" data-export="" data-idl=
            "operation" data-title="produce()" data-dfn-for="WOT"
            data-type="Promise" data-lt=
            "WOT.produce()|WOT.produce|produce()|produce"><code>produce()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-discover-method"><bdi class="secno">5.4</bdi> The
            <span data-dfn-type="method" data-export="" data-idl=
            "operation" data-title="discover()" data-dfn-for="WOT"
            data-type="ThingDiscovery" data-lt=
            "WOT.discover()|WOT.discover|discover()|discover"><code>
            discover()</code></span> method</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-consumedthing-interface"><bdi class="secno">6.</bdi>
        The <span data-dfn-type="interface" data-export=""
        data-idl="interface" data-title=
        "ConsumedThing"><code>ConsumedThing</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#constructing-consumedthing"><bdi class=
            "secno">6.1</bdi> Constructing
            <code>ConsumedThing</code></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-getthingdescription-method"><bdi class=
            "secno">6.2</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "getThingDescription()" data-dfn-for="ConsumedThing"
            data-type="ThingDescription" data-lt=
            "ConsumedThing.getThingDescription()|ConsumedThing.getThingDescription|getThingDescription()|getThingDescription">
            <code>getThingDescription()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-interactionoptions-dictionary"><bdi class=
            "secno">6.3</bdi> The <span data-dfn-type="dictionary"
            data-export="" data-idl="dictionary" data-title=
            "InteractionOptions"><code>InteractionOptions</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-propertymap-type"><bdi class="secno">6.4</bdi>
            The <span data-dfn-type="typedef" data-export=""
            data-idl="typedef" data-title=
            "PropertyMap"><code>PropertyMap</code></span> type</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-readproperty-method"><bdi class="secno">6.5</bdi>
            The <span data-dfn-type="method" data-export=""
            data-idl="operation" data-title="readProperty()"
            data-dfn-for="ConsumedThing" data-type="Promise"
            data-lt=
            "ConsumedThing.readProperty()|ConsumedThing.readProperty|readProperty()|readProperty">
            <code>readProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-readmultipleproperties-method"><bdi class=
            "secno">6.6</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "readMultipleProperties()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.readMultipleProperties()|ConsumedThing.readMultipleProperties|readMultipleProperties()|readMultipleProperties">
            <code>readMultipleProperties()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-readallproperties-method"><bdi class=
            "secno">6.7</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "readAllProperties()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.readAllProperties()|ConsumedThing.readAllProperties|readAllProperties()|readAllProperties">
            <code>readAllProperties()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-writeproperty-method"><bdi class=
            "secno">6.8</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "writeProperty()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.writeProperty()|ConsumedThing.writeProperty|writeProperty()|writeProperty">
            <code>writeProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-writemultipleproperties-method"><bdi class=
            "secno">6.9</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "writeMultipleProperties()" data-dfn-for=
            "ConsumedThing" data-type="Promise" data-lt=
            "ConsumedThing.writeMultipleProperties()|ConsumedThing.writeMultipleProperties|writeMultipleProperties()|writeMultipleProperties">
            <code>writeMultipleProperties()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-wotlistener-callback"><bdi class=
            "secno">6.10</bdi> The <span data-dfn-type="callback"
            data-export="" data-idl="callback" data-title=
            "WotListener"><code>WotListener</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-observeproperty-method"><bdi class=
            "secno">6.11</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "observeProperty()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.observeProperty()|ConsumedThing.observeProperty|observeProperty()|observeProperty">
            <code>observeProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-unobserveproperty-method"><bdi class=
            "secno">6.12</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "unobserveProperty()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.unobserveProperty()|ConsumedThing.unobserveProperty|unobserveProperty()|unobserveProperty">
            <code>unobserveProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-invokeaction-method"><bdi class=
            "secno">6.13</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "invokeAction()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.invokeAction()|ConsumedThing.invokeAction|invokeAction()|invokeAction">
            <code>invokeAction()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-subscribeevent-method"><bdi class=
            "secno">6.14</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "subscribeEvent()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.subscribeEvent()|ConsumedThing.subscribeEvent|subscribeEvent()|subscribeEvent">
            <code>subscribeEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-unsubscribeevent-method"><bdi class=
            "secno">6.15</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "unsubscribeEvent()" data-dfn-for="ConsumedThing"
            data-type="Promise" data-lt=
            "ConsumedThing.unsubscribeEvent()|ConsumedThing.unsubscribeEvent|unsubscribeEvent()|unsubscribeEvent">
            <code>unsubscribeEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#consumedthing-examples"><bdi class="secno">6.16</bdi>
            ConsumedThing Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-exposedthing-interface"><bdi class="secno">7.</bdi>
        The <span data-dfn-type="interface" data-export=""
        data-idl="interface" data-title=
        "ExposedThing"><code>ExposedThing</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#constructing-exposedthing"><bdi class=
            "secno">7.1</bdi> Constructing
            <code>ExposedThing</code></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#methods-inherited-from-consumedthing"><bdi class=
            "secno">7.2</bdi> Methods inherited from <span class=
            "formerLink" data-link-type=
            "idl"><code>ConsumedThing</code></span></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-propertyreadhandler-callback"><bdi class=
            "secno">7.3</bdi> The <span data-dfn-type="callback"
            data-export="" data-idl="callback" data-title=
            "PropertyReadHandler"><code>PropertyReadHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setpropertyreadhandler-method"><bdi class=
            "secno">7.4</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "setPropertyReadHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "ExposedThing.setPropertyReadHandler()|ExposedThing.setPropertyReadHandler|setPropertyReadHandler()|setPropertyReadHandler">
            <code>setPropertyReadHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-property-read-requests"><bdi class=
            "secno">7.5</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Property</span> read requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-property-observe-requests"><bdi class=
            "secno">7.6</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Property</span> observe
            requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-propertywritehandler-callback"><bdi class=
            "secno">7.7</bdi> The <span data-dfn-type="callback"
            data-export="" data-idl="callback" data-title=
            "PropertyWriteHandler"><code>PropertyWriteHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setpropertywritehandler-method"><bdi class=
            "secno">7.8</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "setPropertyWriteHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "ExposedThing.setPropertyWriteHandler()|ExposedThing.setPropertyWriteHandler|setPropertyWriteHandler()|setPropertyWriteHandler">
            <code>setPropertyWriteHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-property-write-requests"><bdi class=
            "secno">7.9</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Property</span> write requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-actionhandler-callback"><bdi class=
            "secno">7.10</bdi> The <span data-dfn-type="callback"
            data-export="" data-idl="callback" data-title=
            "ActionHandler"><code>ActionHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-setactionhandler-method"><bdi class=
            "secno">7.11</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "setActionHandler()" data-dfn-for="ExposedThing"
            data-type="ExposedThing" data-lt=
            "ExposedThing.setActionHandler()|ExposedThing.setActionHandler|setActionHandler()|setActionHandler">
            <code>setActionHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#handling-action-requests"><bdi class=
            "secno">7.12</bdi> Handling <span class="formerLink"
            data-link-type="dfn">Action</span> requests</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-emitevent-method"><bdi class="secno">7.13</bdi>
            The <span data-dfn-type="method" data-export=""
            data-idl="operation" data-title="emitEvent()"
            data-dfn-for="ExposedThing" data-type="void" data-lt=
            "ExposedThing.emitEvent()|ExposedThing.emitEvent|emitEvent()|emitEvent">
            <code>emitEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-expose-method"><bdi class="secno">7.14</bdi> The
            <span data-dfn-type="method" data-export="" data-idl=
            "operation" data-title="expose()" data-dfn-for=
            "ExposedThing" data-type="Promise" data-lt=
            "ExposedThing.expose()|ExposedThing.expose|expose()|expose">
            <code>expose()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-destroy-method"><bdi class="secno">7.15</bdi> The
            <span data-dfn-type="method" data-export="" data-idl=
            "operation" data-title="destroy()" data-dfn-for=
            "ExposedThing" data-type="Promise" data-lt=
            "ExposedThing.destroy()|ExposedThing.destroy|destroy()|destroy">
            <code>destroy()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#exposedthing-examples"><bdi class="secno">7.16</bdi>
            ExposedThing Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#the-thingdiscovery-interface"><bdi class="secno">8.</bdi>
        The <span data-dfn-type="interface" data-export=""
        data-idl="interface" data-title=
        "ThingDiscovery"><code>ThingDiscovery</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#constructing-thingdiscovery"><bdi class=
            "secno">8.1</bdi> Constructing
            <code>ThingDiscovery</code></a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-discoverymethod-enumeration"><bdi class=
            "secno">8.2</bdi> The <span data-dfn-type="typedef"
            data-export="" data-idl="typedef" data-title=
            "DiscoveryMethod"><code>DiscoveryMethod</code></span>
            enumeration</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#the-thingfilter-dictionary"><bdi class=
            "secno">8.3</bdi> The <span data-dfn-type="dictionary"
            data-export="" data-idl="dictionary" data-title=
            "ThingFilter"><code>ThingFilter</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#the-start-method"><bdi class=
            "secno">8.4</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title=
            "start()" data-dfn-for="ThingDiscovery" data-type=
            "void" data-lt=
            "ThingDiscovery.start()|ThingDiscovery.start|start()|start">
            <code>start()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#the-next-method"><bdi class=
            "secno">8.5</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title="next()"
            data-dfn-for="ThingDiscovery" data-type="Promise"
            data-lt=
            "ThingDiscovery.next()|ThingDiscovery.next|next()|next">
            <code>next()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#the-stop-method"><bdi class=
            "secno">8.6</bdi> The <span data-dfn-type="method"
            data-export="" data-idl="operation" data-title="stop()"
            data-dfn-for="ThingDiscovery" data-type="void" data-lt=
            "ThingDiscovery.stop()|ThingDiscovery.stop|stop()|stop">
            <code>stop()</code></span> method</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#discovery-examples"><bdi class="secno">8.7</bdi>
            Discovery Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#security-and-privacy"><bdi class=
        "secno">9.</bdi> Security and Privacy</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#sec-security-consideration-runtime"><bdi class=
            "secno">9.1</bdi> Scripting Runtime Security and
            Privacy Risks</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-input"><bdi class=
                "secno">9.1.1</bdi> Corrupted Input Security and
                Privacy Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-device-direct-access"><bdi class="secno">
                9.1.2</bdi> Physical Device Direct Access Security
                and Privacy Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-update-provisioning"><bdi class="secno">
                9.1.3</bdi> Provisioning and Update Security
                Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-credentials-storage"><bdi class="secno">
                9.1.4</bdi> Security Credentials Storage Security
                and Privacy Risk</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#sec-security-consideration-script"><bdi class=
            "secno">9.2</bdi> Script Security and Privacy Risks</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-script-input"><bdi class="secno">
                9.2.1</bdi> Corrupted Script Input Security and
                Privacy Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-script-processing"><bdi class="secno">
                9.2.2</bdi> Denial Of Service Security Risk</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#sec-security-consideration-script-stale-td"><bdi class="secno">
                9.2.3</bdi> Stale TD Security Risk</a>
              </li>
            </ol>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#terminology-and-conventions"><bdi class="secno">10.</bdi>
        Terminology and conventions</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#api-design-rationale"><bdi class=
        "secno">A.</bdi> API design rationale</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#approaches-to-wot-application-development"><bdi class="secno">
            A.1</bdi> Approaches to WoT application development</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#no-scripting-api"><bdi class="secno">A.1.1</bdi>
                No Scripting API</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#simple-scripting-api"><bdi class=
                "secno">A.1.2</bdi> Simple Scripting API</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#this-api-aligned-with-wot-td"><bdi class=
                "secno">A.1.3</bdi> This API, aligned with
                [<cite><span class="formerLink" title=
                "WoT Thing Description " data-link-type=
                "biblio">WOT-TD</span></cite>]</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#fetching-and-validating-a-td"><bdi class=
            "secno">A.2</bdi> Fetching and validating a TD</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#factory-vs-constructors"><bdi class="secno">A.3</bdi>
            Factory vs constructors</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#observers"><bdi class=
            "secno">A.4</bdi> Observers</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#using-events"><bdi class=
            "secno">A.5</bdi> Using Events</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#polymorphic-functions"><bdi class="secno">A.6</bdi>
            Polymorphic functions</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#Changes"><bdi class=
        "secno">B.</bdi> Changes</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#open-issues"><bdi class=
        "secno">C.</bdi> Open issues</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#idl-index"><bdi class=
        "secno">D.</bdi> Full Web IDL</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#acknowledgements"><bdi class=
        "secno">E.</bdi> Acknowledgements</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#references"><bdi class=
        "secno">F.</bdi> References</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#normative-references"><bdi class="secno">F.1</bdi>
            Normative references</a>
          </li>
        </ol>
      </li>
    </ol>
  </nav>
  <section id="introduction">
    <h2 id="x1-introduction"><bdi class="secno">1.</bdi>
    Introduction<a class="self-link" aria-label="§" href=
    "#introduction"></a></h2>
    <p>WoT provides layered interoperability based on how <a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a>s are used: "consumed" and "exposed", as
    <a href="https://www.w3.org/TR/2019/CR-wot-architecture-20190516/#terminology">defined</a>
    in [<cite><a class="bibref" href="#bib-wot-architecture" title=
    "Web of Things Architecture" data-link-type=
    "biblio">WOT-ARCHITECTURE</a></cite>].</p>
    <p>By <a href="#dfn-consume" class="internalDFN"
    data-link-type="dfn">consuming a TD</a>, a client <a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a> creates a local runtime resource model that
    allows accessing the <a href="#dfn-properties" class=
    "internalDFN" data-link-type="dfn">Properties</a>, <a href=
    "#dfn-actions" class="internalDFN" data-link-type=
    "dfn">Actions</a> and <a href="#dfn-events" class="internalDFN"
    data-link-type="dfn">Events</a> exposed by the server <a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a> on a remote device.</p>
    <div>
      <p>Exposing a <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn">Thing</a> requires:</p>
      <ul>
        <li>defining a <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn">Thing Description</a>
        (TD),
        </li>
        <li>then instantiating a software stack that implements the
        <a href="#dfn-wot-interface" class="internalDFN"
        data-link-type="dfn">WoT Interface</a> specified by the
        <a href="#dfn-td" class="internalDFN" data-link-type="dfn">
          TD</a> in order to serve requests for accessing the
          exposed <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Properties</a>, <a href=
          "#dfn-actions" class="internalDFN" data-link-type=
          "dfn">Actions</a> and <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn">Events</a>,
        </li>
        <li>then eventually publishing the <a href=
        "#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn">Thing Description</a> (for instance to
        a <a href="#dfn-thing-directory" class="internalDFN"
        data-link-type="dfn">Thing Directory</a> directory for
        easier discovery).
        </li>
      </ul>This specification describes how to expose and consume
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a>s by a script. Also, it defines a generic API
      for <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> discovery.
    </div>
    <div class="note" role="note" id=
    "issue-container-generatedID-1">
      <div role="heading" class="note-title marker" id="h-note"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">Typically scripts are meant to be used on bridges
      or gateways that expose and control simpler devices as WoT
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a>s and have means to handle (e.g. install,
      uninstall, update etc.) and run scripts.</p>
    </div>
    <div class="note" role="note" id=
    "issue-container-generatedID-2">
      <div role="heading" class="note-title marker" id="h-note-0"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">This specification does not make assumptions on
      how the <a href="#dfn-wot-runtime" class="internalDFN"
      data-link-type="dfn">WoT Runtime</a> handles and runs
      scripts, including single or multiple tenancy, script
      deployment and lifecycle management. The API already supports
      the generic mechanisms that make it possible to implement
      script management, for instance by exposing a manager
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> whose <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Actions</a> (action
      handlers) implement script lifecycle management
      operations.</p>
    </div>
  </section>
  <section class="informative" id="use-cases">
    <h2 id="x2-use-cases"><bdi class="secno">2.</bdi> Use
    Cases<a class="self-link" aria-label="§" href=
    "#use-cases"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The following scripting use cases are supported in this
    specification:</p>
    <section id="consuming-a-thing">
      <h3 id="x2-1-consuming-a-thing"><bdi class="secno">2.1</bdi>
      Consuming a Thing<a class="self-link" aria-label="§" href=
      "#consuming-a-thing"></a></h3>
      <ul>
        <li>
          <a href="#dfn-consume" class="internalDFN"
          data-link-type="dfn">Consume a TD</a>, i.e. create a
          programmatic object from a <a href=
          "#dfn-thing-descriptions" class="internalDFN"
          data-link-type="dfn">Thing Description</a> that exposes
          <a href="#dfn-wot-interactions" class="internalDFN"
          data-link-type="dfn">WoT Interactions</a>:
          <ul>
            <li>Read the value of a <a href="#dfn-properties"
              class="internalDFN" data-link-type="dfn">Property</a>
              or a set of properties.
            </li>
            <li>Set the value of a <a href="#dfn-properties"
              class="internalDFN" data-link-type="dfn">Property</a>
              or a set of properties.
            </li>
            <li>Observe value changes of a <a href=
            "#dfn-properties" class="internalDFN" data-link-type=
            "dfn">Property</a>.
            </li>
            <li>Invoke an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn">Action</a>.
            </li>
            <li>Observe WoT <a href="#dfn-events" class=
            "internalDFN" data-link-type="dfn">Events</a> emitted
            by the <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn">Thing</a>.
            </li>
            <li>Introspect the <a href="#dfn-thing-descriptions"
            class="internalDFN" data-link-type="dfn">Thing
            Description</a>, including the list of linked resources
            based on the <a href="#dfn-thing-descriptions" class=
            "internalDFN" data-link-type="dfn">Thing
            Description</a>.
            </li>
          </ul>
        </li>
      </ul>
    </section>
    <section id="exposing-a-thing">
      <h3 id="x2-2-exposing-a-thing"><bdi class="secno">2.2</bdi>
      Exposing a Thing<a class="self-link" aria-label="§" href=
      "#exposing-a-thing"></a></h3>
      <ul>
        <li>Exposing the <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn">Thing</a> includes generating the
          protocol bindings in order to access lower level
          functionality.
        </li>
        <li>Create a local <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> to be exposed,
        based on a <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn">Thing Description</a>
        provided in string serialized format, or out of an existing
        <a href="#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a> object.
        </li>
        <li>Add a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> definition to the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Remove a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a> definition from the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Add an <a href="#dfn-actions" class="internalDFN"
        data-link-type="dfn">Action</a> definition to the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Remove an <a href="#dfn-actions" class="internalDFN"
        data-link-type="dfn">Action</a> definition from the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Add a WoT <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn">Event</a> definition to the <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>.
        </li>
        <li>Remove a WoT <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn">Event</a> definition from the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Emit a WoT <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn">Event</a>, i.e. notify all subscribed
        listeners.
        </li>
        <li>Register service handlers for external requests:
          <ul>
            <li>to retrieve a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn">Property</a> value;
            </li>
            <li>to update a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn">Property</a> value;
            </li>
            <li>to invoke an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn">Action</a>: take the
            parameters from the request, execute the defined
            action, and return the result;
            </li>
          </ul>
        </li>
      </ul>
    </section>
    <section id="discovery">
      <h3 id="x2-3-discovery"><bdi class="secno">2.3</bdi>
      Discovery<a class="self-link" aria-label="§" href=
      "#discovery"></a></h3>
      <ul>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s in a network by sending a
        broadcast request.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s running in the local
        <a href="#dfn-wot-runtime" class="internalDFN"
        data-link-type="dfn">WoT Runtime</a>.
        </li>
        <li>Discover nearby <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a>s, for instance
        connected by NFC or Bluetooth.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s by sending a discovery
        request to a given registry.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s filtered by filters defined
        on <a href="#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn">Thing Description</a>s
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s filtered by semantic
        queries.
        </li>
        <li>Stop or suppress an ongoing discovery process.</li>
        <li>Optionally specify a timeout to the discovery process
        after which it is stopped/suppressed.</li>
      </ul>
    </section>
  </section>
  <section id="conformance">
    <h2 id="x3-conformance"><bdi class="secno">3.</bdi>
    Conformance<a class="self-link" aria-label="§" href=
    "#conformance"></a></h2>
    <p>As well as sections marked as non-normative, all authoring
    guidelines, diagrams, examples, and notes in this specification
    are non-normative. Everything else in this specification is
    normative.</p>
    <p>The key words <em class="rfc2119">MAY</em>, <em class=
    "rfc2119">MUST</em>, and <em class="rfc2119">SHOULD</em> in
    this document are to be interpreted as described in <a href=
    "https://tools.ietf.org/html/bcp14">BCP 14</a> [<cite><a class=
    "bibref" href="#bib-rfc2119" title=
    "Key words for use in RFCs to Indicate Requirement Levels"
    data-link-type="biblio">RFC2119</a></cite>] [<cite><a class=
    "bibref" href="#bib-rfc8174" title=
    "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"
    data-link-type="biblio">RFC8174</a></cite>] when, and only
    when, they appear in all capitals, as shown here.</p>
    <p>This specification describes the conformance criteria for
    the following classes of <dfn data-dfn-type="dfn" id=
    "dfn-user-agent">user agent</dfn> (<dfn data-dfn-type="dfn" id=
    "dfn-ua">UA</dfn>).</p>
    <p>Due to requirements of small embedded implementations,
    splitting WoT client and server interfaces was needed. Then,
    discovery is a distributed application, but typical scenarios
    have been covered by a generic discovery API in this
    specification. This resulted in using 3 conformance classes for
    a <a href="#dfn-ua" class="internalDFN" data-link-type=
    "dfn">UA</a> that implements this API, one for client, one for
    server, and one for discovery. An application that uses this
    API can introspect for the presence of the
    <code>consume()</code>, <code>produce()</code> and
    <code>discover()</code> methods on the <a href=
    "#dfn-wot-api-object" class="internalDFN" data-link-type=
    "dfn">WoT API object</a> in order to determine which
    conformance class the <a href="#dfn-ua" class="internalDFN"
    data-link-type="dfn">UA</a> implements.</p>
    <dl>
      <dt>
        <dfn data-dfn-type="dfn" id="dfn-wot-consumer">WoT
        Consumer</dfn> <a href="#dfn-ua" class="internalDFN"
        data-link-type="dfn">UA</a>
      </dt>
      <dd>
        <p>Implementations of this conformance class <em class=
        "rfc2119" title="MUST">MUST</em> implement the
        <code><a href="#dom-consumedthing" class="internalDFN"
        data-link-type="idl"><code>ConsumedThing</code></a></code>
        interface and the <code>consume()</code> method on the
        <a href="#dfn-wot-api-object" class="internalDFN"
        data-link-type="dfn">WoT API object</a>.</p>
      </dd>
      <dt>
        <dfn data-dfn-type="dfn" id="dfn-wot-producer">WoT
        Producer</dfn> <a href="#dfn-ua" class="internalDFN"
        data-link-type="dfn">UA</a>
      </dt>
      <dd>
        <p>Implementations of this conformance class <em class=
        "rfc2119" title="MUST">MUST</em> implement <code><a href=
        "#dom-exposedthing" class="internalDFN" data-link-type=
        "idl"><code>ExposedThing</code></a></code> interface and
        the <code>produce()</code> method on the <a href=
        "#dfn-wot-api-object" class="internalDFN" data-link-type=
        "dfn">WoT API object</a>.</p>
      </dd>
      <dt>
        <dfn data-dfn-type="dfn" id="dfn-wot-discovery">WoT
        Discovery</dfn> <a href="#dfn-ua" class="internalDFN"
        data-link-type="dfn">UA</a>
      </dt>
      <dd>
        <p>Implementations of this conformance class <em class=
        "rfc2119" title="MUST">MUST</em> implement the
        <code><a href="#dom-thingdiscovery" class="internalDFN"
        data-link-type="idl"><code>ThingDiscovery</code></a></code>
        interface and the <code>discover()</code> method on the
        <a href="#dfn-wot-api-object" class="internalDFN"
        data-link-type="dfn">WoT API object</a>.</p>
      </dd>
    </dl>
    <p>These conformance classes <em class="rfc2119" title=
    "MAY">MAY</em> be implemented in a single <a href="#dfn-ua"
    class="internalDFN" data-link-type="dfn">UA</a>.</p>
    <p>This specification can be used for implementing the WoT
    Scripting API in multiple programming languages. The interface
    definitions are specified in [<cite><a class="bibref" href=
    "#bib-webidl" title="Web IDL" data-link-type=
    "biblio">WEBIDL</a></cite>].</p>
    <p>The <a href="#dfn-ua" class="internalDFN" data-link-type=
    "dfn">UA</a> may be implemented in the browser, or in a
    separate runtime environment, such as <a href=
    "https://nodejs.org/en/">Node.js</a> or in small embedded
    runtimes.</p>
    <p>Implementations that use ECMAScript executed in a browser to
    implement the APIs defined in this document <em class="rfc2119"
    title="MUST">MUST</em> implement them in a manner consistent
    with the ECMAScript Bindings defined in the Web IDL
    specification [<cite><a class="bibref" href="#bib-webidl"
    title="Web IDL" data-link-type="biblio">WEBIDL</a></cite>].</p>
    <p>Implementations that use TypeScript or ECMAScript in a
    runtime to implement the APIs defined in this document
    <em class="rfc2119" title="MUST">MUST</em> implement them in a
    manner consistent with the TypeScript Bindings defined in the
    TypeScript specification [<cite><a class="bibref" href=
    "#bib-typescript" title="TypeScript Language Specification"
    data-link-type="biblio">TYPESCRIPT</a></cite>].</p>
  </section>
  <section id="the-thingdescription-type">
    <h2 id="x4-the-thingdescription-type"><bdi class=
    "secno">4.</bdi> The <dfn data-dfn-type="typedef" data-export=
    "" id="dom-thingdescription" data-idl="typedef" data-title=
    "ThingDescription"><code>ThingDescription</code></dfn>
    type<a class="self-link" aria-label="§" href=
    "#the-thingdescription-type"></a></h2>
    <pre class="idl def"><span data-idl="" class="idlTypedef" id=
    "idl-def-thingdescription" data-title=
    "ThingDescription">typedef<span class=
    "idlType"> <a data-xref-type="interface" data-cite-path=""
    data-type="interface" href=
    "https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-for="" data-link-type="typedef" href=
"#dom-thingdescription"><code>ThingDescription</code></a>;</span></pre>
    <p>Represents a <a href="#dfn-thing-descriptions" class=
    "internalDFN" data-link-type="dfn">Thing Description</a>
    (<a href="#dfn-td" class="internalDFN" data-link-type=
    "dfn">TD</a>) as defined in [<cite><a class="bibref" href=
    "#bib-wot-td" title="WoT Thing Description " data-link-type=
    "biblio">WOT-TD</a></cite>]. It is expected to be a <a href=
    "https://infra.spec.whatwg.org/#parse-json-from-bytes">parsed
    JSON object</a> that is validated using <a href=
    "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#json-schema-for-validation">
    JSON schema validation</a>.</p>
    <section id="fetching-a-thing-description">
      <h3 id="x4-1-fetching-a-thing-description"><bdi class=
      "secno">4.1</bdi> Fetching a Thing Description<a class=
      "self-link" aria-label="§" href=
      "#fetching-a-thing-description"></a></h3>
      <p>Fetching a <a href="#dfn-td" class="internalDFN"
      data-link-type="dfn">TD</a> given a URL should be done with
      an external method, such as the <a href=
      "https://fetch.spec.whatwg.org/#fetch-api">Fetch API</a> or a
      HTTP client library, which offer already standardized options
      on specifying fetch details.</p>
      <div class="example" id=
      "example-1-fetching-a-thing-description">
        <div class="marker">
          <a class="self-link" href=
          "#example-1-fetching-a-thing-description">Example
          <bdi>1</bdi></a><span class="example-title">: Fetching a
          Thing Description</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">let</span> res = <span class=
"hljs-keyword">await</span> fetch(<span class=
"hljs-string">'https://tds.mythings.biz/sensor11'</span>);
  <span class=
"hljs-comment">// ... additional checks possible on res.headers</span>
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> res.json();
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class="hljs-keyword">catch</span> (err) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Fetching TD failed"</span>, err.message);
}</code></pre>
      </div>
    </section>
    <section id="expanding-a-thing-description">
      <h3 id="x4-2-expanding-a-thing-description"><bdi class=
      "secno">4.2</bdi> Expanding a Thing Description<a class=
      "self-link" aria-label="§" href=
      "#expanding-a-thing-description"></a></h3>
      <p>Note that [<cite><a class="bibref" href="#bib-wot-td"
      title="WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>] allows using a shortened <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a> by the means of <a href=
      "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#sec-default-values">
      defaults</a> and requiring clients to expand them with
      default values specified in [<cite><a class="bibref" href=
      "#bib-wot-td" title="WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>] for the properties that are not
      explicitly defined in a given <a href="#dfn-td" class=
      "internalDFN" data-link-type="dfn">TD</a>.</p>
      <div>
        <p>To <dfn data-dfn-type="dfn" id="dfn-expand-a-td">expand
        a TD</dfn> given <var>td</var>, run the following
        steps:</p>
        <ol>
          <li>For each item in the <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#sec-default-values">
            TD default values</a> table from [<cite><a class=
            "bibref" href="#bib-wot-td" title=
            "WoT Thing Description " data-link-type=
            "biblio">WOT-TD</a></cite>], if the term is not defined
            in <a href="#dfn-td" class="internalDFN"
            data-link-type="dfn">td</a>, add the term definition
            with the default value specified in [<cite><a class=
            "bibref" href="#bib-wot-td" title=
            "WoT Thing Description " data-link-type=
            "biblio">WOT-TD</a></cite>].
          </li>
        </ol>
      </div>
    </section>
    <section id="validating-a-thing-description">
      <h3 id="x4-3-validating-a-thing-description"><bdi class=
      "secno">4.3</bdi> Validating a Thing Description<a class=
      "self-link" aria-label="§" href=
      "#validating-a-thing-description"></a></h3>
      <p>The [<cite><a class="bibref" href="#bib-wot-td" title=
      "WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>] specification defines how a
      <a href="#dfn-td" class="internalDFN" data-link-type=
      "dfn">TD</a> should be validated. Therefore, this API expects
      the <a href="#dom-thingdescription" class="internalDFN"
      data-link-type="idl"><code>ThingDescription</code></a>
      objects be validated before used as parameters. This
      specification defines a basic <a href="#dfn-td" class=
      "internalDFN" data-link-type="dfn">TD</a> validation as
      follows.</p>
      <div>
        <p>To <dfn data-dfn-type="dfn" id=
        "dfn-validate-a-td">validate a TD</dfn> given
        <var>td</var>, run the following steps:</p>
        <ol>
          <li>If <var>td</var> is not an object, throw
          <code>"TypeError"</code> and terminate these steps.</li>
          <li>If any of the mandatory properties defined in
          [<cite><a class="bibref" href="#bib-wot-td" title=
          "WoT Thing Description " data-link-type=
          "biblio">WOT-TD</a></cite>] for <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#thing">Thing</a>
          that don't have <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#sec-default-values">
            default definitions</a> are missing from <var>td</var>,
            throw <code>"TypeError"</code> and terminate these
            steps.
          </li>
          <li>If <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#json-schema-for-validation">
            JSON schema validation</a> fails on <var>td</var>,
            throw <code>"TypeError"</code> and terminate these
            steps.
          </li>
        </ol>
      </div>
    </section>
  </section>
  <section data-dfn-for="WOT" id="the-wot-api-object">
    <h2 id="x5-the-wot-api-object"><bdi class="secno">5.</bdi> The
    <dfn data-dfn-type="dfn" id="dfn-wot-api-object">WoT API
    object</dfn><a class="self-link" aria-label="§" href=
    "#the-wot-api-object"></a></h2>
    <p>Defines the API entry point exposed as a singleton and
    contains the API methods.</p>
    <section id="the-wot-interface">
      <h3 id="x5-1-the-wot-interface"><bdi class="secno">5.1</bdi>
      The <dfn data-dfn-type="interface" data-export="" id=
      "dom-wot" data-idl="interface" data-title=
      "WOT"><code>WOT</code></dfn> interface<a class="self-link"
      aria-label="§" href="#the-wot-interface"></a></h3>
      <pre class="idl def"><span data-idl="" class="idlInterface"
      id="idl-def-wot" data-title="WOT">[<span class=
      "extAttr"><a data-xref-type="extended-attribute"
      data-cite-path="" data-type="extended-attribute" href=
      "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-wot"><code>WOT</code></a> {<span class="idlSectionComment">
  // methods defined in UA conformance classes
</span>};</span></pre>
      <div class="note" role="note" id=
      "issue-container-generatedID-3">
        <div role="heading" class="note-title marker" id="h-note-1"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Browser implementations should use a namespace
        object such as <code>navigator.wot</code>. Standalone
        runtimes may expose the API object through mechanisms like
        <a href="https://nodejs.org/api/modules.html">require()</a>
        or <a href=
        "http://www.ecma-international.org/ecma-262/6.0/#sec-imports">
        import</a>.</p>
      </div>
    </section>
    <section id="the-consume-method">
      <h3 id="x5-2-the-consume-method"><bdi class="secno">5.2</bdi>
      The <dfn data-dfn-type="method" data-export="" id=
      "dom-wot-consume" data-idl="operation" data-title="consume()"
      data-dfn-for="WOT" data-type="Promise" data-lt=
      "WOT.consume()|WOT.consume|consume()|consume"><code>consume()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-consume-method"></a></h3>
      <pre class="idl def"><span data-idl="" class="idlInterface"
      id="idl-def-wot-partial-1" data-title=
      "WOT">partial interface <a class="internalDFN idlID"
      data-link-for="" data-link-type="interface" href=
      "#dom-wot"><code>WOT</code></a> {<span data-idl="" class=
      "idlMethod" id="idl-def-wot-consume-td" data-title="consume"
      data-dfn-for="WOT"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-consumedthing" class="internalDFN" data-link-type=
"idl"><code>ConsumedThing</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="WOT" data-link-type="method"
href="#dom-wot-consume"><code>consume</code></a>(<span class=
"idlType"><a data-xref-type="_IDL_" href="#dom-thingdescription"
class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span>);</span>
};</span></pre>
      <div>
        <p>Belongs to the <a href="#dfn-wot-consumer" class=
        "internalDFN" data-link-type="dfn">WoT Consumer</a>
        conformance class. Expects an <var>td</var> argument and
        returns a <a data-link-type="dfn" href=
        "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
        that resolves with a <a href="#dom-consumedthing" class=
        "internalDFN" data-link-type=
        "idl"><code>ConsumedThing</code></a> object that represents
        a client interface to operate with the <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>. The method <em class="rfc2119" title=
        "MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Run the <a href="#dfn-validate-a-td" class=
          "internalDFN" data-link-type="dfn">validate a TD</a>
          steps on <var>td</var>. If that throws, reject
          <var>promise</var> with the error and terminate these
          steps.
          </li>
          <li>Let <var>thing</var> be a new <a href=
          "#dom-consumedthing" class="internalDFN"
            data-link-type="idl"><code>ConsumedThing</code></a>
            object constructed from <var>td</var>.
          </li>
          <li>Set up the <a href="#dfn-wot-interactions" class=
          "internalDFN" data-link-type="dfn">WoT Interactions</a>
          based on introspecting <a href="#dfn-td" class=
          "internalDFN" data-link-type="dfn">td</a> as explained in
          [<cite><a class="bibref" href="#bib-wot-td" title=
          "WoT Thing Description " data-link-type=
          "biblio">WOT-TD</a></cite>] and [<cite><a class="bibref"
            href="#bib-wot-protocol-bindings" title=
            "Web of Things Protocol Binding Templates"
            data-link-type=
            "biblio">WOT-PROTOCOL-BINDINGS</a></cite>]. Make a
            request to the underlying platform to initialize the
            <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn">Protocol Bindings</a>. The details
            are private to the implementations and out of scope of
            this specification.
          </li>
          <li>Resolve <var>promise</var> with
          <var>thing</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-produce-method">
      <h3 id="x5-3-the-produce-method"><bdi class="secno">5.3</bdi>
      The <dfn data-dfn-type="method" data-export="" id=
      "dom-wot-produce" data-idl="operation" data-title="produce()"
      data-dfn-for="WOT" data-type="Promise" data-lt=
      "WOT.produce()|WOT.produce|produce()|produce"><code>produce()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-produce-method"></a></h3>
      <pre class="idl def"><span data-idl="" class="idlInterface"
      id="idl-def-wot-partial-2" data-title=
      "WOT">partial interface <a class="internalDFN idlID"
      data-link-for="" data-link-type="interface" href=
      "#dom-wot"><code>WOT</code></a> {<span data-idl="" class=
      "idlMethod" id="idl-def-wot-produce-td" data-title="produce"
      data-dfn-for="WOT"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="WOT" data-link-type="method"
href="#dom-wot-produce"><code>produce</code></a>(<span class=
"idlType"><a data-xref-type="_IDL_" href="#dom-thingdescription"
class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span>);</span>
};</span></pre>
      <div>
        <p>Belongs to the <a href="#dfn-wot-producer" class=
        "internalDFN" data-link-type="dfn">WoT Producer</a>
        conformance class. Expects a <code>td</code> argument and
        returns a <a data-link-type="dfn" href=
        "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
        that resolves with an <a href="#dom-exposedthing" class=
        "internalDFN" data-link-type=
        "idl"><code>ExposedThing</code></a> object that extends
        <a href="#dom-consumedthing" class="internalDFN"
        data-link-type="idl"><code>ConsumedThing</code></a> with a
        server interface, i.e. the ability to define request
        handlers. The method <em class="rfc2119" title=
        "MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">promise</a>
          with <code>SecurityError</code> and terminate these
          steps.
          </li>
          <li>Let <var>thing</var> be a new <a href=
          "#dom-exposedthing" class="internalDFN" data-link-type=
          "idl"><code>ExposedThing</code></a> object constructed
          with <var>td</var>.
          </li>
          <li>Resolve <var>promise</var> with
          <var>thing</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-discover-method">
      <h3 id="x5-4-the-discover-method"><bdi class=
      "secno">5.4</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-wot-discover" data-idl="operation"
      data-title="discover()" data-dfn-for="WOT" data-type=
      "ThingDiscovery" data-lt=
      "WOT.discover()|WOT.discover|discover()|discover"><code>discover()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-discover-method"></a></h3>
      <pre class="idl def"><span data-idl="" class="idlInterface"
      id="idl-def-wot-partial-3" data-title=
      "WOT">partial interface <a class="internalDFN idlID"
      data-link-for="" data-link-type="interface" href=
      "#dom-wot"><code>WOT</code></a> {<span data-idl="" class=
      "idlMethod" id="idl-def-wot-discover-filter" data-title=
      "discover" data-dfn-for="WOT"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-thingdiscovery" class=
"internalDFN" data-link-type=
"idl"><code>ThingDiscovery</code></a></span> <a class=
"internalDFN idlName" data-link-for="WOT" data-link-type="method"
href=
"#dom-wot-discover"><code>discover</code></a>(optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-thingfilter" class=
"internalDFN" data-link-type=
"idl"><code>ThingFilter</code></a></span> <span class=
"idlParamName">filter</span> = null);</span>
};</span></pre>
      <div>
        <p>Belongs to the <a href="#dfn-wot-discovery" class=
        "internalDFN" data-link-type="dfn">WoT Discovery</a>
        conformance class. Starts the discovery process that will
        provide <a href="#dom-thingdescription" class="internalDFN"
        data-link-type="idl"><code>ThingDescription</code></a>
        objects for <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn">Thing Description</a>s
        that match an optional <var>filter</var> argument. The
        method <em class="rfc2119" title="MUST">MUST</em> run the
        following steps:</p>
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, throw
          <code>SecurityError</code> and terminate these
          steps.</li>
          <li>Construct a <a href="#dom-thingdiscovery" class=
          "internalDFN" data-link-type=
          "idl"><code>ThingDiscovery</code></a> object
          <var>discovery</var> with <var>filter</var>.
          </li>
          <li>Invoke the <a href=
          "#the-start-method">discovery.start()</a> method.
          </li>
          <li>Return <var>discovery</var>.</li>
        </ol>
      </div>
      <p>Refer to the <a href="#dom-thingdiscovery" class=
      "internalDFN" data-link-type=
      "idl"><code>ThingDiscovery</code></a> section for how
      discovery should be implemented.</p>
    </section>
  </section>
  <section data-dfn-for="ConsumedThing" id=
  "the-consumedthing-interface">
    <h2 id="x6-the-consumedthing-interface"><bdi class=
    "secno">6.</bdi> The <dfn data-dfn-type="interface"
    data-export="" id="dom-consumedthing" data-idl="interface"
    data-title="ConsumedThing"><code>ConsumedThing</code></dfn>
    interface<a class="self-link" aria-label="§" href=
    "#the-consumedthing-interface"></a></h2>
    <p>Represents a client API to operate a <a href="#dfn-things"
    class="internalDFN" data-link-type="dfn">Thing</a>. Belongs to
    the <a href="#dfn-wot-consumer" class="internalDFN"
    data-link-type="dfn">WoT Consumer</a> conformance class.</p>
    <pre class="idl def"><span data-idl="" class="idlInterface" id=
    "idl-def-consumedthing" data-title="ConsumedThing">[<span class=
    "extAttr"><a data-xref-type="extended-attribute" data-cite-path=
    "" data-type="extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-consumedthing"><code>ConsumedThing</code></a> {<span data-idl=""
class="idlConstructor" id="idl-def-consumedthing-constructor-td"
data-title="constructor" data-dfn-for="ConsumedThing">
  <dfn data-export="" data-dfn-type="constructor" id=
"dom-consumedthing-constructor" data-idl="constructor" data-title=
"constructor" data-dfn-for="ConsumedThing" data-lt=
"ConsumedThing.constructor()|ConsumedThing.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a data-xref-type="_IDL_"
href="#dom-thingdescription" class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span>);</span><span data-idl="" class=
"idlMethod" id=
"idl-def-consumedthing-readproperty-propertyname-options"
data-title="readProperty" data-dfn-for="ConsumedThing"><span class=
"idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-readproperty"><code>readProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">propertyName</span>,
                            optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-readallproperties-options" data-title=
"readAllProperties" data-dfn-for="ConsumedThing"><span class=
"idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-propertymap" class="internalDFN" data-link-type=
"idl"><code>PropertyMap</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="ConsumedThing" data-link-type=
"method" href=
"#dom-consumedthing-readallproperties"><code>readAllProperties</code></a>(optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-readmultipleproperties-propertynames-options"
data-title="readMultipleProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-propertymap" class="internalDFN" data-link-type=
"idl"><code>PropertyMap</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="ConsumedThing" data-link-type=
"method" href=
"#dom-consumedthing-readmultipleproperties"><code>readMultipleProperties</code></a>(<span class="idlType">
                            <a data-xref-type="dfn" data-cite-path=
"" data-type="dfn" href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a>&gt;</span> <span class="idlParamName">propertyNames</span>,
                            optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-writeproperty-propertyname-value-options"
data-title="writeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-writeproperty"><code>writeProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">propertyName</span>,<span class="idlType">
                              <a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">value</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-writemultipleproperties-valuemap-options"
data-title="writeMultipleProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-writemultipleproperties"><code>writeMultipleProperties</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
href="#dom-propertymap" class="internalDFN" data-link-type=
"idl"><code>PropertyMap</code></a></span> <span class=
"idlParamName">valueMap</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-invokeaction-actionname-params-options"
data-title="invokeAction" data-dfn-for="ConsumedThing"><span class=
"idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-invokeaction"><code>invokeAction</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">actionName</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">params</span> = null,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-observeproperty-name-listener-options"
data-title="observeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-observeproperty"><code>observeProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a data-xref-type="_IDL_" href=
"#dom-wotlistener" class="internalDFN" data-link-type=
"idl"><code>WotListener</code></a></span> <span class=
"idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id="idl-def-consumedthing-unobserveproperty-name"
data-title="unobserveProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-unobserveproperty"><code>unobserveProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>);</span><span data-idl=""
class="idlMethod" id=
"idl-def-consumedthing-subscribeevent-name-listener-options"
data-title="subscribeEvent" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-subscribeevent"><code>subscribeEvent</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a data-xref-type="_IDL_" href=
"#dom-wotlistener" class="internalDFN" data-link-type=
"idl"><code>WotListener</code></a></span> <span class=
"idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" id="idl-def-consumedthing-unsubscribeevent-name"
data-title="unsubscribeEvent" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-unsubscribeevent"><code>unsubscribeEvent</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>);</span><span data-idl=""
class="idlMethod" id="idl-def-consumedthing-getthingdescription"
data-title="getThingDescription" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-thingdescription" class=
"internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <a class=
"internalDFN idlName" data-link-for="ConsumedThing" data-link-type=
"method" href=
"#dom-consumedthing-getthingdescription"><code>getThingDescription</code></a>();</span>
};</span><span data-idl="" class="idlDictionary" id=
"idl-def-interactionoptions" data-title="InteractionOptions">
dictionary <a class="internalDFN idlID" data-link-for=""
data-link-type="dictionary" href=
"#dom-interactionoptions"><code>InteractionOptions</code></a> {<span data-idl=""
class="idlMember" id="idl-def-interactionoptions-urivariables"
data-title="uriVariables" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <dfn data-export=""
data-dfn-type="dict-member" id=
"dom-interactionoptions-urivariables" data-idl="field" data-title=
"uriVariables" data-dfn-for="InteractionOptions" data-type="object"
class="idlName"><code>uriVariables</code></dfn>;</span>
};</span><span data-idl="" class="idlTypedef" id=
"idl-def-propertymap" data-title="PropertyMap">
typedef<span class="idlType"> <a data-xref-type="interface"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-for="" data-link-type="typedef" href=
"#dom-propertymap"><code>PropertyMap</code></a>;</span><span data-idl=""
class="idlCallback" id="idl-def-wotlistener" data-title=
"WotListener">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-wotlistener"><code>WotListener</code></a> =<span class=
"idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a></span>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">data</span>);</span></pre>
    <section id="constructing-consumedthing">
      <h3 id="x6-1-constructing-consumedthing"><bdi class=
      "secno">6.1</bdi> Constructing
      <code>ConsumedThing</code><a class="self-link" aria-label="§"
      href="#constructing-consumedthing"></a></h3>
      <p>After <a href="#fetching-a-thing-description">fetching</a>
      a <a href="#dfn-thing-descriptions" class="internalDFN"
      data-link-type="dfn">Thing Description</a> as a JSON object,
      one can create a <a href="#dom-consumedthing" class=
      "internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a> object.</p>
      <div>
        <p>To create <a href="#dom-consumedthing" class=
        "internalDFN" data-link-type=
        "idl"><code>ConsumedThing</code></a> with the <a href=
        "#dom-thingdescription" class="internalDFN" data-link-type=
        "idl"><code>ThingDescription</code></a> <var>td</var>, run
        the following steps:</p>
        <ol>
          <li>Run the <a href="#dfn-expand-a-td" class=
          "internalDFN" data-link-type="dfn">expand a TD</a> steps
          on <var>td</var>. If that fails, re-throw the error and
          terminate these steps.
          </li>
          <li>Let <var>thing</var> be a new <a href=
          "#dom-consumedthing" class="internalDFN"
            data-link-type="idl"><code>ConsumedThing</code></a>
            object.
          </li>
          <li>Let |<var>td</var>| be an internal slot of
          <var>thing</var> and let <var>td</var> be its value.</li>
          <li>Return <var>thing</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-getthingdescription-method">
      <h3 id="x6-2-the-getthingdescription-method"><bdi class=
      "secno">6.2</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-getthingdescription"
      data-idl="operation" data-title="getThingDescription()"
      data-dfn-for="ConsumedThing" data-type="ThingDescription"
      data-lt=
      "ConsumedThing.getThingDescription()|ConsumedThing.getThingDescription|getThingDescription()|getThingDescription">
      <code>getThingDescription()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-getthingdescription-method"></a></h3>
      <p>Returns the internal slot |<var>td</var>| of the <a href=
      "#dom-consumedthing" class="internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a> object that represents
      the <a href="#dfn-thing-descriptions" class="internalDFN"
      data-link-type="dfn">Thing Description</a> of the <a href=
      "#dom-consumedthing" class="internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a>. Applications may
      consult the <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn">Thing</a> metadata stored in
      |<var>td</var>| in order to introspect its capabilities
      before interacting with it.</p>
    </section>
    <section id="the-interactionoptions-dictionary">
      <h3 id="x6-3-the-interactionoptions-dictionary"><bdi class=
      "secno">6.3</bdi> The <dfn data-dfn-type="dictionary"
      data-export="" id="dom-interactionoptions" data-idl=
      "dictionary" data-title=
      "InteractionOptions"><code>InteractionOptions</code></dfn>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-interactionoptions-dictionary"></a></h3>
      <p>Holds the interaction options that need to be exposed for
      application scripts according to the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>. In this version of the
      specification only URI template variables are used,
      represented as <a href=
      "https://infra.spec.whatwg.org/#parse-json-from-bytes">parsed
      JSON objects</a> defined in [<cite><a class="bibref" href=
      "#bib-wot-td" title="WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>].</p>
      <div class="note" id="issue-container-generatedID-4">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-1" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">The support for URI variables comes from the
        need exposed by [<cite><a class="bibref" href="#bib-wot-td"
        title="WoT Thing Description " data-link-type=
        "biblio">WOT-TD</a></cite>] to be able to describe existing
        <a href="#dfn-td" class="internalDFN" data-link-type=
        "dfn">TD</a>s that use them, but it should be possible to
        write a <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn">Thing Description</a>
        that would use <a href="#dfn-actions" class="internalDFN"
        data-link-type="dfn">Action</a>s for representing the
        interactions that need URI variables and represent the URI
        variables as parameters to the <a href="#dfn-actions"
        class="internalDFN" data-link-type="dfn">Action</a> and in
        that case that could be encapsulated by the implementations
        and the <var>options</var> parameter could be dismissed
        from the methods exposed by this API.</p>
      </div>
    </section>
    <section id="the-propertymap-type">
      <h3 id="x6-4-the-propertymap-type"><bdi class=
      "secno">6.4</bdi> The <dfn data-dfn-type="typedef"
      data-export="" id="dom-propertymap" data-idl="typedef"
      data-title="PropertyMap"><code>PropertyMap</code></dfn>
      type<a class="self-link" aria-label="§" href=
      "#the-propertymap-type"></a></h3>
      <p>Represents a map of <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> names as
      strings to a value that the <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> can take. It
      is used as a property bag for interactions that involve
      multiple <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Properties</a> at once.</p>
      <div class="note" id="issue-container-generatedID-5">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-2" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">It could be defined in Web IDL (as well as
        <a href="#dom-thingdescription" class="internalDFN"
        data-link-type="idl"><code>ThingDescription</code></a>) as
        a <a href=
        "https://heycam.github.io/webidl/#idl-maplike">maplike</a>
        interface from <i>string</i> to <i>any</i>.</p>
      </div>
    </section>
    <section id="the-readproperty-method">
      <h3 id="x6-5-the-readproperty-method"><bdi class=
      "secno">6.5</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-readproperty" data-idl=
      "operation" data-title="readProperty()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.readProperty()|ConsumedThing.readProperty|readProperty()|readProperty">
      <code>readProperty()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-readproperty-method"></a></h3>
      <div>
        <p>Reads a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> value. Takes a string
        argument <var>propertyName</var> and and an optional
        <a href="#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns a <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Property</a> value represented as <code>any</code>
        type. The method <em class="rfc2119" title="MUST">MUST</em>
        run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to retrieve
          the value of the <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn">Property</a> given by
          <var>propertyName</var> with optional URI templates given
          in <var>options.uriVariables</var>.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Let <var>value</var> be the result of the
          request.</li>
          <li>Run the <dfn data-dfn-type="dfn" id=
          "dfn-validate-property-value">validate Property
          value</dfn> sub-steps on <var>value</var>:
            <ol>
              <li>Based on the <a href=
              "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#dataschema">
                DataSchema definition</a>, <var>value</var>
                <em class="rfc2119" title="MUST">MUST</em> be a
                JSON value and comply to the data schema defined
                for the <a href="#dfn-properties" class=
                "internalDFN" data-link-type="dfn">Property</a>
                that is found in
                <code>this.getThingDescription().properties[</code><var>propertyName</var><code>]</code>.
              </li>
              <li>If this fails, throw <code>SyntaxError</code>,
              otherwise return <var>value</var>.</li>
            </ol>
          </li>
          <li>If these above steps failed, reject
          <var>promise</var> with <code>SyntaxError</code> and
          terminate these steps.</li>
          <li>Otherwise resolve <var>promise</var> with
          <var>value</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-readmultipleproperties-method">
      <h3 id="x6-6-the-readmultipleproperties-method"><bdi class=
      "secno">6.6</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-readmultipleproperties"
      data-idl="operation" data-title="readMultipleProperties()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.readMultipleProperties()|ConsumedThing.readMultipleProperties|readMultipleProperties()|readMultipleProperties">
      <code>readMultipleProperties()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-readmultipleproperties-method"></a></h3>
      <div>
        <p>Reads multiple <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Property</a> values with
        one or multiple requests. Takes the
        <var>propertyNames</var> argument as a sequence of strings
        and an optional <a href="#dom-interactionoptions" class=
        "internalDFN" data-link-type=
        "idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns an object with keys
        from <var>propertyNames</var> and values returned by this
        algorithm. The method <em class="rfc2119" title=
        "MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Let <var>result</var> be an object and for each
          string <var>name</var> in <var>propertyNames</var> add a
          property with key <var>name</var> and the value
          <code>null</code>.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to retrieve
          the <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a> values given by
          <var>propertyNames</var> with optional URI templates
          given in <var>options.uriVariables</var>.
          </li>
          <li>If this cannot be done with a single request with the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> of the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn">Thing</a>, then reject
            <var>promise</var> with <code>NotSupportedError</code>
            and terminate these steps.
          </li>
          <li>Process the reply and update all properties in
          <var>result</var> with the values obtained in the
          reply.</li>
          <li>If the above step fails at any point, reject
          <var>promise</var> with <code>SyntaxError</code> and
          terminate these steps.</li>
          <li>Resolve <var>promise</var> with
          <var>result</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-readallproperties-method">
      <h3 id="x6-7-the-readallproperties-method"><bdi class=
      "secno">6.7</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-readallproperties"
      data-idl="operation" data-title="readAllProperties()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.readAllProperties()|ConsumedThing.readAllProperties|readAllProperties()|readAllProperties">
      <code>readAllProperties()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-readallproperties-method"></a></h3>
      <div>
        <p>Reads all properties of the <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> with one or
        multiple requests. Takes an optional <a href=
        "#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns an object with keys
        from <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> names and values returned
        by this algorithm. The method <em class="rfc2119" title=
        "MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Let <var>result</var> be an object and for each
          string <var>name</var> in <var>propertyNames</var> add a
          property with key <var>name</var> and the value
          <code>null</code>.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to retrieve
          the value of the all the <a href="#dfn-properties"
            class="internalDFN" data-link-type="dfn">Property</a>
            definitions from the <a href="#dfn-td" class=
            "internalDFN" data-link-type="dfn">TD</a> with optional
            URI templates given in <var>options.uriVariables</var>.
          </li>
          <li>If this cannot be done with a single request with the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> of the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn">Thing</a>, then reject
            <var>promise</var> with <code>NotSupportedError</code>
            and terminate these steps.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Process the reply and update all properties in
          <var>result</var> with the values obtained in the
          reply.</li>
          <li>Resolve <var>promise</var> with
          <var>result</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-writeproperty-method">
      <h3 id="x6-8-the-writeproperty-method"><bdi class=
      "secno">6.8</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-writeproperty" data-idl=
      "operation" data-title="writeProperty()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.writeProperty()|ConsumedThing.writeProperty|writeProperty()|writeProperty">
      <code>writeProperty()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-writeproperty-method"></a></h3>
      <div>
        <p>Writes a single <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Property</a>. Takes a
        string argument <var>propertyName</var>, a value argument
        <var>value</var> and an optional <a href=
        "#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns success or failure.
        The method <em class="rfc2119" title="MUST">MUST</em> run
        the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Run the <a href="#dfn-validate-property-value"
            class="internalDFN" data-link-type="dfn">validate
            Property value</a> steps on <var>value</var>. If that
            fails, reject <a data-link-type="dfn" href=
            "https://tc39.github.io/ecma262/#sec-promise-objects">promise</a>
            with <code>SyntaxError</code> and terminate these
            steps.
          </li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to write
          <var>value</var> to the <a href="#dfn-properties"
            class="internalDFN" data-link-type="dfn">Property</a>
            given by <var>propertyName</var> with optional URI
            templates given in <var>options.uriVariables</var>.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-writemultipleproperties-method">
      <h3 id="x6-9-the-writemultipleproperties-method"><bdi class=
      "secno">6.9</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-writemultipleproperties"
      data-idl="operation" data-title="writeMultipleProperties()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.writeMultipleProperties()|ConsumedThing.writeMultipleProperties|writeMultipleProperties()|writeMultipleProperties">
      <code>writeMultipleProperties()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-writemultipleproperties-method"></a></h3>
      <div>
        <p>Writes a multiple <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Property</a> values with
        one request. Takes a <var>properties</var> argument as an
        object with keys being <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Property</a> names and
        values as <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> values and an optional
        <a href="#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns success or failure.
        The method <em class="rfc2119" title="MUST">MUST</em> run
        the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>For each key <var>name</var> on
          <var>properties</var>, take its value as <var>value</var>
          and run the <a href="#dfn-validate-property-value"
            class="internalDFN" data-link-type="dfn">validate
            Property value</a> steps on <var>value</var>. If that
            fails in for any <var>name</var>, reject
            <a data-link-type="dfn" href=
            "https://tc39.github.io/ecma262/#sec-promise-objects">promise</a>
            with <code>SyntaxError</code> and terminate these
            steps.
          </li>
          <li>Make a single request to the underlying platform (via
          the <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn">Protocol Bindings</a>) to write
            the each <a href="#dfn-properties" class="internalDFN"
            data-link-type="dfn">Property</a> provided in
            <var>properties</var> with optional URI templates given
            in <var>options.uriVariables</var>.
          </li>
          <li>If this cannot be done with a single request with the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> of the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn">Thing</a>, then reject
            <var>promise</var> with <code>NotSupportedError</code>
            and terminate these steps.
          </li>
          <li>If the request fails, return the error received from
          the <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn">Protocol Bindings</a> and
            terminate these steps.
          </li>
          <li>Otherwise resolve <var>promise</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-wotlistener-callback">
      <h3 id="x6-10-the-wotlistener-callback"><bdi class=
      "secno">6.10</bdi> The <dfn data-dfn-type="callback"
      data-export="" id="dom-wotlistener" data-idl="callback"
      data-title="WotListener"><code>WotListener</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-wotlistener-callback"></a></h3>
      <p>User provided callback that takes <code>any</code>
      argument and is used for observing <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a> changes
      and handling <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn">Event</a> notifications. Since
      subscribing to these are WoT interactions, they are not
      modelled with software events.</p>
    </section>
    <section id="the-observeproperty-method">
      <h3 id="x6-11-the-observeproperty-method"><bdi class=
      "secno">6.11</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-observeproperty"
      data-idl="operation" data-title="observeProperty()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.observeProperty()|ConsumedThing.observeProperty|observeProperty()|observeProperty">
      <code>observeProperty()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-observeproperty-method"></a></h3>
      <div>
        <p>Makes a request for <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Property</a> value
        change notifications. Takes a string argument
        <var>propertyName</var>, a <a href="#dom-wotlistener"
        class="internalDFN" data-link-type=
        "idl"><code>WotListener</code></a> callback function
        <var>listener</var> and an optional <a href=
        "#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns success or failure.
        The method <em class="rfc2119" title="MUST">MUST</em> run
        the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>If <var>listener</var> is not a function, reject
          <var>promise</var> with <code>"TypeError"</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to observe
          <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a> identified by
          <var>propertyName</var> with optional URI templates given
          in <var>options.uriVariables</var>.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var>.</li>
          <li>Whenever the underlying platform receives a
          notification for this subscription with new <a href=
          "#dfn-properties" class="internalDFN" data-link-type=
          "dfn">Property</a> value <var>value</var>, run the
          following sub-steps:
            <ul>
              <li>If running the <a href=
              "#dfn-validate-property-value" class="internalDFN"
              data-link-type="dfn">validate Property value</a>
              steps on <var>value</var> fails, terminate these
              steps.
              </li>
              <li>Invoke <var>listener</var> with <var>value</var>
              as parameter.</li>
            </ul>
          </li>
        </ol>
      </div>
    </section>
    <section id="the-unobserveproperty-method">
      <h3 id="x6-12-the-unobserveproperty-method"><bdi class=
      "secno">6.12</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-unobserveproperty"
      data-idl="operation" data-title="unobserveProperty()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.unobserveProperty()|ConsumedThing.unobserveProperty|unobserveProperty()|unobserveProperty">
      <code>unobserveProperty()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-unobserveproperty-method"></a></h3>
      <div>
        <p>Makes a request for unsubscribing from <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Property</a> value change notifications. Takes a
        string argument <var>propertyName</var> and returns success
        or failure. The method <em class="rfc2119" title=
        "MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to stop
          observing the <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn">Property</a>
          identified by <var>propertyName</var>.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-invokeaction-method">
      <h3 id="x6-13-the-invokeaction-method"><bdi class=
      "secno">6.13</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-invokeaction" data-idl=
      "operation" data-title="invokeAction()" data-dfn-for=
      "ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.invokeAction()|ConsumedThing.invokeAction|invokeAction()|invokeAction">
      <code>invokeAction()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-invokeaction-method"></a></h3>
      <div>
        <p>Makes a request for invoking an <a href="#dfn-actions"
        class="internalDFN" data-link-type="dfn">Action</a> and
        return the result. Takes a string argument
        <var>actionName</var>, an optional argument
        <var>params</var> of type <code>any</code> and an optional
        <a href="#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns the result of the
        <a href="#dfn-actions" class="internalDFN" data-link-type=
        "dfn">Action</a> or an error. The method <em class=
        "rfc2119" title="MUST">MUST</em> run the following
        steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to invoke the
          <a href="#dfn-actions" class="internalDFN"
            data-link-type="dfn">Action</a> identified by
            <var>actionName</var> with parameters provided in
            <var>params</var> with optional URI templates given in
            <var>options.uriVariables</var>.
          </li>
          <li>If the request fails locally or returns an error over
          the network, reject <var>promise</var> with the error
          received from the <a href="#dfn-protocol-bindings"
            class="internalDFN" data-link-type="dfn">Protocol
            Bindings</a> and terminate these steps.
          </li>
          <li>Otherwise let <var>value</var> be the result returned
          in the reply and run the <a href=
          "#dfn-validate-property-value" class="internalDFN"
          data-link-type="dfn">validate Property value</a> steps on
          it. If that fails, reject <var>promise</var> with <code>
            SyntaxError</code> and terminate these steps.
          </li>
          <li>Reject <var>promise</var> with <var>value</var>.</li>
        </ol>
      </div>
    </section>
    <section id="the-subscribeevent-method">
      <h3 id="x6-14-the-subscribeevent-method"><bdi class=
      "secno">6.14</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-subscribeevent"
      data-idl="operation" data-title="subscribeEvent()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.subscribeEvent()|ConsumedThing.subscribeEvent|subscribeEvent()|subscribeEvent">
      <code>subscribeEvent()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-subscribeevent-method"></a></h3>
      <div>
        <p>Makes a request for subscribing to <a href="#dfn-events"
        class="internalDFN" data-link-type="dfn">Event</a>
        notifications. Takes a string argument
        <var>eventName</var>, a <a href="#dom-wotlistener" class=
        "internalDFN" data-link-type=
        "idl"><code>WotListener</code></a> callback function
        <var>listener</var> and an optional <a href=
        "#dom-interactionoptions" class="internalDFN"
        data-link-type="idl"><code>InteractionOptions</code></a>
        <var>options</var> argument. It returns success or failure.
        The method <em class="rfc2119" title="MUST">MUST</em> run
        the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>If <var>listener</var> is not a function, reject
          <var>promise</var> with <code>"TypeError"</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to subscribe
          to an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn">Event</a> identified by
          <var>eventName</var>with optional URI templates given in
          <var>options.uriVariables</var>.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var>.</li>
          <li>Whenever the underlying platform receives a
          notification for this <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn">Event</a>
          subscription, implementations <em class="rfc2119"
            title="SHOULD">SHOULD</em> invoke <var>listener</var>,
            giving the data provided with the <a href="#dfn-events"
            class="internalDFN" data-link-type="dfn">Event</a> as
            parameter.
          </li>
        </ol>
      </div>
    </section>
    <section id="the-unsubscribeevent-method">
      <h3 id="x6-15-the-unsubscribeevent-method"><bdi class=
      "secno">6.15</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-consumedthing-unsubscribeevent"
      data-idl="operation" data-title="unsubscribeEvent()"
      data-dfn-for="ConsumedThing" data-type="Promise" data-lt=
      "ConsumedThing.unsubscribeEvent()|ConsumedThing.unsubscribeEvent|unsubscribeEvent()|unsubscribeEvent">
      <code>unsubscribeEvent()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-unsubscribeevent-method"></a></h3>
      <div>
        <p>Makes a request for unsubscribing from <a href=
        "#dfn-events" class="internalDFN" data-link-type=
        "dfn">Event</a> notifications. Takes a string argument
        <var>eventName</var> and returns success or failure. The
        method <em class="rfc2119" title="MUST">MUST</em> run the
        following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform (via the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>) to
          unsubscribe from the <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn">Event</a> identified
          by <var>eventName</var>.
          </li>
          <li>If the request fails, reject <var>promise</var> with
          the error received from the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var>.</li>
        </ol>
      </div>
    </section>
    <section id="consumedthing-examples">
      <h3 id="x6-16-consumedthing-examples"><bdi class=
      "secno">6.16</bdi> ConsumedThing Examples<a class="self-link"
      aria-label="§" href="#consumedthing-examples"></a></h3>
      <p>The next example illustrates how to fetch a <a href=
      "#dfn-td" class="internalDFN" data-link-type="dfn">TD</a> by
      URL, create a <a href="#dom-consumedthing" class=
      "internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a>, read metadata (title),
      read property value, subscribe to property change, subscribe
      to a WoT event, unsubscribe.</p>
      <div class="example" id="example-2-thing-client-api-example">
        <div class="marker">
          <a class="self-link" href=
          "#example-2-thing-client-api-example">Example
          <bdi>2</bdi></a><span class="example-title">: Thing
          Client API example</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">let</span> res = <span class=
"hljs-keyword">await</span> fetch(<span class=
"hljs-string">"https://tds.mythings.org/sensor11"</span>);
  <span class="hljs-keyword">let</span> td = res.json();
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing "</span> + thing.getThingDescription().title + <span class="hljs-string">" consumed."</span>);
} <span class="hljs-keyword">catch</span>(e) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"TD fetch error: "</span> + e.message); },
};
<span class="hljs-keyword">try</span> {
  <span class=
"hljs-comment">// subscribe to property change for “temperature”</span>
  <span class=
"hljs-keyword">await</span> thing.observeProperty(<span class=
"hljs-string">"temperature"</span>, value =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature changed to: "</span> + value);
  });
  <span class=
"hljs-comment">// subscribe to the “ready” event defined in the TD</span>
  <span class=
"hljs-keyword">await</span> thing.subscribeEvent(<span class=
"hljs-string">"ready"</span>, eventData =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Ready; index: "</span> + eventData);
    <span class=
"hljs-comment">// run the “startMeasurement” action defined by TD</span>
    <span class=
"hljs-keyword">await</span> thing.invokeAction(<span class=
"hljs-string">"startMeasurement"</span>, { <span class=
"hljs-attr">units</span>: <span class=
"hljs-string">"Celsius"</span> });
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Measurement started."</span>);
  });
} <span class="hljs-keyword">catch</span>(e) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error starting measurement."</span>);
}
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
  <span class=
"hljs-built_in">console</span>.log(“Temperature: “ + <span class=
"hljs-keyword">await</span> thing.readProperty(“temperature”));
  <span class=
"hljs-keyword">await</span> thing.unsubscribe(“ready”);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Unsubscribed from the ‘ready’ event."</span>);
},
<span class="hljs-number">10000</span>);</code></pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="ExposedThing" id=
  "the-exposedthing-interface">
    <h2 id="x7-the-exposedthing-interface"><bdi class=
    "secno">7.</bdi> The <dfn data-dfn-type="interface"
    data-export="" id="dom-exposedthing" data-idl="interface"
    data-title="ExposedThing"><code>ExposedThing</code></dfn>
    interface<a class="self-link" aria-label="§" href=
    "#the-exposedthing-interface"></a></h2>
    <p>The <a href="#dom-exposedthing" class="internalDFN"
    data-link-type="idl"><code>ExposedThing</code></a> interface is
    the server API to operate the <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn">Thing</a> that allows
    defining request handlers, <a href="#dfn-properties" class=
    "internalDFN" data-link-type="dfn">Property</a>, <a href=
    "#dfn-actions" class="internalDFN" data-link-type=
    "dfn">Action</a>, and <a href="#dfn-events" class="internalDFN"
    data-link-type="dfn">Event</a> interactions.</p>
    <pre class="idl def"><span data-idl="" class="idlInterface" id=
    "idl-def-exposedthing" data-title="ExposedThing">[<span class=
    "extAttr"><a data-xref-type="extended-attribute" data-cite-path=
    "" data-type="extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-exposedthing"><code>ExposedThing</code></a>: <span class=
"idlSuperclass"><a data-xref-type="_IDL_" href="#dom-consumedthing"
class="internalDFN" data-link-type=
"idl"><code>ConsumedThing</code></a></span> {<span data-idl=""
class="idlMethod" id=
"idl-def-exposedthing-setpropertyreadhandler-name-readhandler"
data-title="setPropertyReadHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a></span> <a class=
"internalDFN idlName" data-link-for="ExposedThing" data-link-type=
"method" href=
"#dom-exposedthing-setpropertyreadhandler"><code>setPropertyReadHandler</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a data-xref-type="_IDL_" href="#dom-propertyreadhandler"
class="internalDFN" data-link-type=
"idl"><code>PropertyReadHandler</code></a></span> <span class=
"idlParamName">readHandler</span>);</span><span data-idl="" class=
"idlMethod" id=
"idl-def-exposedthing-setpropertywritehandler-name-writehandler"
data-title="setPropertyWriteHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a></span> <a class=
"internalDFN idlName" data-link-for="ExposedThing" data-link-type=
"method" href=
"#dom-exposedthing-setpropertywritehandler"><code>setPropertyWriteHandler</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a data-xref-type="_IDL_" href=
"#dom-propertywritehandler" class="internalDFN" data-link-type=
"idl"><code>PropertyWriteHandler</code></a></span> <span class=
"idlParamName">writeHandler</span>);</span><span data-idl="" class=
"idlMethod" id="idl-def-exposedthing-setactionhandler-name-action"
data-title="setActionHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a></span> <a class=
"internalDFN idlName" data-link-for="ExposedThing" data-link-type=
"method" href=
"#dom-exposedthing-setactionhandler"><code>setActionHandler</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-actionhandler" class="internalDFN" data-link-type=
"idl"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span>);</span><span data-idl="" class=
"idlMethod" id="idl-def-exposedthing-emitevent-name-data"
data-title="emitEvent" data-dfn-for="ExposedThing"><span class=
"idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName"
data-link-for="ExposedThing" data-link-type="method" href=
"#dom-exposedthing-emitevent"><code>emitEvent</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType"> <a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">data</span>);</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-expose" data-title=
"expose" data-dfn-for="ExposedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ExposedThing" data-link-type="method" href=
"#dom-exposedthing-expose"><code>expose</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-exposedthing-destroy" data-title=
"destroy" data-dfn-for="ExposedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ExposedThing" data-link-type="method" href=
"#dom-exposedthing-destroy"><code>destroy</code></a>();</span>
};</span><span data-idl="" class="idlCallback" id=
"idl-def-propertyreadhandler" data-title="PropertyReadHandler">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-propertyreadhandler"><code>PropertyReadHandler</code></a> =<span class="idlType"> <a data-xref-type="interface"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span>(
        optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" id="idl-def-propertywritehandler" data-title=
"PropertyWriteHandler">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-propertywritehandler"><code>PropertyWriteHandler</code></a> =<span class="idlType"> <a data-xref-type="interface"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">value</span>,
        optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" id="idl-def-actionhandler" data-title=
"ActionHandler">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-actionhandler"><code>ActionHandler</code></a> =<span class=
"idlType"> <a data-xref-type="interface" data-cite-path=""
data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">params</span>,
        optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span></pre>
    <section id="constructing-exposedthing">
      <h3 id="x7-1-constructing-exposedthing"><bdi class=
      "secno">7.1</bdi> Constructing
      <code>ExposedThing</code><a class="self-link" aria-label="§"
      href="#constructing-exposedthing"></a></h3>
      <p>The <code>ExposedThing</code> interface extends <a href=
      "#dom-consumedthing" class="internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a>. It is constructed from
      a full or partial <a href="#dom-thingdescription" class=
      "internalDFN" data-link-type=
      "idl"><code>ThingDescription</code></a> object.</p>
      <div class="note" role="note" id=
      "issue-container-generatedID-6">
        <div role="heading" class="note-title marker" id="h-note-2"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Note that an existing <a href=
        "#dom-thingdescription" class="internalDFN" data-link-type=
        "idl"><code>ThingDescription</code></a> object can be
        optionally modified (for instance by adding or removing
        elements on its <var>properties</var>, <var>actions</var>
        and <var>events</var> internal properties) and the
        resulting object can used for constructing an <a href=
        "#dom-exposedthing" class="internalDFN" data-link-type=
        "idl"><code>ExposedThing</code></a> object. This is the
        current way of adding and removing <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Property</a>, <a href="#dfn-actions" class=
        "internalDFN" data-link-type="dfn">Action</a> and <a href=
        "#dfn-events" class="internalDFN" data-link-type=
        "dfn">Event</a> definitions, as illustrated in the <a href=
        "#exposedthing-examples">examples</a>.</p>
      </div>
      <div class="note" role="note" id=
      "issue-container-generatedID-7">
        <div role="heading" class="note-title marker" id="h-note-3"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">Before invoking <a href=
        "#dom-exposedthing-expose">expose()</a>, the <a href=
        "#dom-exposedthing" class="internalDFN" data-link-type=
        "idl"><code>ExposedThing</code></a> object does not serve
        any requests. This allows first constructing <a href=
        "#dom-exposedthing" class="internalDFN" data-link-type=
        "idl"><code>ExposedThing</code></a> and then initialize its
        <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Properties</a> and service handlers
        before starting serving requests.</p>
      </div>
      <div>
        <p>To construct an <a href="#dom-exposedthing" class=
        "internalDFN" data-link-type=
        "idl"><code>ExposedThing</code></a> with the <a href=
        "#dom-thingdescription" class="internalDFN" data-link-type=
        "idl"><code>ThingDescription</code></a> <var>td</var>, run
        the following steps:</p>
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, throw
          <code>SecurityError</code> and terminate these
          steps.</li>
          <li>Run the <a href="#dfn-expand-a-td" class=
          "internalDFN" data-link-type="dfn">expand a TD</a> steps
          on <var>td</var>. If that fails, re-throw the error and
          terminate these steps.
          </li>
          <li>Let <var>thing</var> be a new <a href=
          "#dom-exposedthing" class="internalDFN" data-link-type=
          "idl"><code>ExposedThing</code></a> object.
          </li>
          <li>Let |<var>td</var>| be an internal slot of
          <var>thing</var> and let <var>td</var> be its value.</li>
          <li>Return <var>thing</var>.</li>
        </ol>
      </div>
    </section>
    <section id="methods-inherited-from-consumedthing">
      <h3 id="x7-2-methods-inherited-from-consumedthing">
      <bdi class="secno">7.2</bdi> Methods inherited from <a href=
      "#dom-consumedthing" class="internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a><a class="self-link"
      aria-label="§" href=
      "#methods-inherited-from-consumedthing"></a></h3>
      <p>The <code>readProperty()</code>,
      <code>readMultipleProperties()</code>,
      <code>readAllProperties()</code>,
      <code>writeProperty()</code>,
      <code>writeMultipleProperties()</code>,
      <code>writeAllProperties()</code> methods have the same
      algorithmic steps as described in <a href=
      "#the-consumedthing-interface"><code>ConsumedThing</code></a>,
      with the difference that making a request to the underlying
      platform <em class="rfc2119" title="MAY">MAY</em> be
      implemented with local methods or libraries and don't
      necessarily need to involve network operations.</p>
      <p>The implementation of <a href="#dom-consumedthing" class=
      "internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a> interface in an <a href=
      "#dom-exposedthing" class="internalDFN" data-link-type=
      "idl"><code>ExposedThing</code></a> provide the
      <i>default</i> methods to interact with the <a href=
      "#dom-exposedthing" class="internalDFN" data-link-type=
      "idl"><code>ExposedThing</code></a>.</p>
      <p>After constructing an <a href="#dom-exposedthing" class=
      "internalDFN" data-link-type=
      "idl"><code>ExposedThing</code></a>, a script can initialize
      its <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Properties</a> and can set up the
      optional read, write and action request handlers (the default
      ones are provided by the implementation). The script provided
      handlers <em class="rfc2119" title="MAY">MAY</em> use the
      default handlers, thereby extending the default behavior, but
      they can also bypass them, overriding the default behavior.
      Finally, the script would call <a href=
      "#the-expose-method"><code>expose()</code></a> on the
      <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="idl"><code>ExposedThing</code></a> in order
      to start serving external requests.</p>
    </section>
    <section data-dfn-for="PropertyReadHandler" id=
    "the-propertyreadhandler-callback">
      <h3 id="x7-3-the-propertyreadhandler-callback"><bdi class=
      "secno">7.3</bdi> The <dfn data-dfn-type="callback"
      data-export="" id="dom-propertyreadhandler" data-idl=
      "callback" data-title=
      "PropertyReadHandler"><code>PropertyReadHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-propertyreadhandler-callback"></a></h3>
      <p>A function that is called when an external request for
      reading a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> is received and defines
      what to do with such requests. It returns a
      <a data-link-type="dfn" href=
      "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
      and resolves it when the value of the <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> matching the <code>name</code> argument is
      obtained, or rejects with an error if the property is not
      found or the value cannot be retrieved.</p>
    </section>
    <section id="the-setpropertyreadhandler-method">
      <h3 id="x7-4-the-setpropertyreadhandler-method"><bdi class=
      "secno">7.4</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-exposedthing-setpropertyreadhandler"
      data-idl="operation" data-title="setPropertyReadHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "ExposedThing.setPropertyReadHandler()|ExposedThing.setPropertyReadHandler|setPropertyReadHandler()|setPropertyReadHandler">
      <code>setPropertyReadHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setpropertyreadhandler-method"></a></h3>
      <p>Takes <code>name</code> as string argument and
      <code>readHandler</code> as argument of type <a href=
      "#dom-propertyreadhandler" class="internalDFN"
      data-link-type="idl"><code>PropertyReadHandler</code></a>.
      Sets the service handler for reading the specified <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> matched by <code>name</code>. Throws on
      error. Returns a reference to <var>this</var> object for
      supporting chaining.</p>
      <p>The <code>readHandler</code> callback function should
      implement reading a <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> and
      <em class="rfc2119" title="SHOULD">SHOULD</em> be called by
      implementations when a request for reading a <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> is received from the underlying
      platform.</p>
      <p>There <em class="rfc2119" title="MUST">MUST</em> be at
      most one handler for any given <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a>, so
      newly added handlers <em class="rfc2119" title=
      "MUST">MUST</em> replace the previous handlers. If no handler
      is initialized for any given <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a>,
      implementations <em class="rfc2119" title=
      "SHOULD">SHOULD</em> implement a default property read
      handler based on the <a href="#dfn-thing-descriptions" class=
      "internalDFN" data-link-type="dfn">Thing Description</a>.</p>
    </section>
    <section id="handling-property-read-requests">
      <h3 id="x7-5-handling-property-read-requests"><bdi class=
      "secno">7.5</bdi> Handling <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> read
      requests<a class="self-link" aria-label="§" href=
      "#handling-property-read-requests"></a></h3>
      <div>
        <p>When a network request for reading <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Property</a> <var>propertyName</var> is received by
        the implementation, run the following steps:</p>
        <ol>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a> with
          <var>propertyName</var> does not exist, return
          <code>ReferenceError</code> in the reply and terminate
          these steps.
          </li>
          <li>If there is a user provided read handler registered
          with <code>setPropertyReadHandler()</code>, invoke that
          wih <var>propertyName</var>, return the value with the
          reply and terminate these steps.</li>
          <li>Otherwise, if there is a default read handler
          provided by the implementation, invoke it with
          <var>propertyName</var>, return the value with the reply
          and terminate these steps.</li>
          <li>if there is no default handler defined by the
          implementation, return <a data-link-type="dfn" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> with the reply and
            terminate these steps.
          </li>
        </ol>
      </div>
    </section>
    <section id="handling-property-observe-requests">
      <h3 id="x7-6-handling-property-observe-requests"><bdi class=
      "secno">7.6</bdi> Handling <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> observe
      requests<a class="self-link" aria-label="§" href=
      "#handling-property-observe-requests"></a></h3>
      <div>
        <p>When a network request for observing a <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Property</a> <var>propertyName</var> is received by
        the implementation, run the following steps:</p>
        <ol>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a> with
          <var>propertyName</var> does not exist, return an error
          in the reply (as defined in the <a href=
          "#dfn-thing-descriptions" class="internalDFN"
          data-link-type="dfn">Thing Description</a>) and terminate
          these steps.
          </li>
          <li>Save the request sender information to the <a href=
          "#dfn-properties" class="internalDFN" data-link-type=
          "dfn">Property</a>'s <a href=
          "#dfn-internal-observer-list" class="internalDFN"
          data-link-type="dfn">internal observer list</a> in order
          to be able to notify about <a href="#dfn-properties"
          class="internalDFN" data-link-type="dfn">Property</a>
          value changes.
          </li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="PropertyWriteHandler" id=
    "the-propertywritehandler-callback">
      <h3 id="x7-7-the-propertywritehandler-callback"><bdi class=
      "secno">7.7</bdi> The <dfn data-dfn-type="callback"
      data-export="" id="dom-propertywritehandler" data-idl=
      "callback" data-title=
      "PropertyWriteHandler"><code>PropertyWriteHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-propertywritehandler-callback"></a></h3>
      <p>A function that is called when an external request for
      writing a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> is received and defines
      what to do with such requests. It expects the requested new
      <code>value</code> as argument and returns a
      <a data-link-type="dfn" href=
      "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
      which is resolved when the value of the <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> that matches the <code>name</code>
      argument has been updated with <code>value</code>, or rejects
      with an error if the property is not found or the value
      cannot be updated.</p>
      <div class="note" id="issue-container-generatedID-8">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-3" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">Note that the code in this callback function
        can read the property before updating it in order to find
        out the old value, if needed. Therefore the old value is
        not provided to this function.</p>
      </div>
    </section>
    <section id="the-setpropertywritehandler-method">
      <h3 id="x7-8-the-setpropertywritehandler-method"><bdi class=
      "secno">7.8</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-exposedthing-setpropertywritehandler"
      data-idl="operation" data-title="setPropertyWriteHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "ExposedThing.setPropertyWriteHandler()|ExposedThing.setPropertyWriteHandler|setPropertyWriteHandler()|setPropertyWriteHandler">
      <code>setPropertyWriteHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setpropertywritehandler-method"></a></h3>
      <p>Takes <code>name</code> as string argument and
      <code>writeHandler</code> as argument of type <a href=
      "#dom-propertywritehandler" class="internalDFN"
      data-link-type="idl"><code>PropertyWriteHandler</code></a>.
      Sets the service handler for writing the specified <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> matched by <code>name</code>. Throws on
      error. Returns a reference to <var>this</var> object for
      supporting chaining.</p>
      <p>There <em class="rfc2119" title="MUST">MUST</em> be at
      most one write handler for any given <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a>, so newly added handlers <em class=
      "rfc2119" title="MUST">MUST</em> replace the previous
      handlers. If no write handler is initialized for any given
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a>, implementations <em class="rfc2119"
      title="SHOULD">SHOULD</em> implement default property update
      and notifying observers on change, based on the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>.</p>
    </section>
    <section id="handling-property-write-requests">
      <h3 id="x7-9-handling-property-write-requests"><bdi class=
      "secno">7.9</bdi> Handling <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> write
      requests<a class="self-link" aria-label="§" href=
      "#handling-property-write-requests"></a></h3>
      <div>
        <p>When a network request for writing a <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Property</a> <var>propertyName</var> with a new value
        <var>value</var> is received, implementations <em class=
        "rfc2119" title="SHOULD">SHOULD</em> run the following
        <dfn data-dfn-type="dfn" id=
        "dfn-update-property-steps">update property steps</dfn>,
        given <var>propertyName</var>, <var>value</var> and
        <var>mode</var> set to <code>"single"</code>:</p>
        <ol>
          <li>If a <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a> with
          <var>propertyName</var> does not exist, return
          <code>ReferenceError</code> in the reply and terminate
          these steps.
          </li>
          <li>If there is a user provided write handler registered
          with <code>setPropertyWriteHandler()</code>, or if there
          is a default write handler,
            <ol>
              <li>Invoke the handler with <var>propertyName</var>.
              If it fails, return the error in the reply and
              terminate these steps.</li>
              <li>Otherwise, if <var>mode</var> is
              <code>"single"</code>, reply to the request with the
              new value, following to the <a href=
              "#dfn-protocol-bindings" class="internalDFN"
              data-link-type="dfn">Protocol Bindings</a>.
              </li>
              <li>For each item stored in the <a href=
              "#dfn-internal-observer-list" class="internalDFN"
              data-link-type="dfn">internal observer list</a> of
              the <a href="#dfn-properties" class="internalDFN"
              data-link-type="dfn">Property</a> with
              <var>propertyName</var>, send an observe reply with
              the new value attached.
              </li>
            </ol>
          </li>
          <li>If there is no handler to handle the request, return
          <a data-link-type="dfn" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> in the reply and terminate
            these steps.
          </li>
        </ol>
      </div>
      <div>
        <p>When a network request for writing multiple <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Properties</a> given in an object
        <var>propertyNames</var> is received, run the following
        steps:</p>
        <ol>
          <li>For each property with key <var>name</var> and value
          <var>value</var> defined in <var>propertyNames</var>, run
          the <a href="#dfn-update-property-steps" class=
          "internalDFN" data-link-type="dfn">update property
          steps</a> with <var>name</var>, <var>value</var> and
          <var>mode</var> set to <code>"multiple"</code>.
          </li>
          <li>Reply to the request (by sending a single or multiple
          replies) according to the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> defined for
          the <a href="#dfn-properties" class="internalDFN"
          data-link-type="dfn">Property</a>.
          </li>
        </ol>
      </div>
    </section>
    <section data-dfn-for="ActionHandler" id=
    "the-actionhandler-callback">
      <h3 id="x7-10-the-actionhandler-callback"><bdi class=
      "secno">7.10</bdi> The <dfn data-dfn-type="callback"
      data-export="" id="dom-actionhandler" data-idl="callback"
      data-title="ActionHandler"><code>ActionHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-actionhandler-callback"></a></h3>
      <p>A function that is called when an external request for
      invoking an <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn">Action</a> is received and defines what
      to do with such requests. It is invoked with a
      <code>params</code> dictionary argument. It returns a
      <a data-link-type="dfn" href=
      "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
      that rejects with an error or resolves if the action is
      successful.</p>
    </section>
    <section id="the-setactionhandler-method">
      <h3 id="x7-11-the-setactionhandler-method"><bdi class=
      "secno">7.11</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-exposedthing-setactionhandler"
      data-idl="operation" data-title="setActionHandler()"
      data-dfn-for="ExposedThing" data-type="ExposedThing" data-lt=
      "ExposedThing.setActionHandler()|ExposedThing.setActionHandler|setActionHandler()|setActionHandler">
      <code>setActionHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setactionhandler-method"></a></h3>
      <p>Takes <code>name</code> as string argument and
      <code>action</code> as argument of type <a href=
      "#dom-actionhandler" class="internalDFN" data-link-type=
      "idl"><code>ActionHandler</code></a>. Sets the handler
      function for the specified <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> matched by
      <code>name</code>. Throws on error. Returns a reference to
      <var>this</var> object for supporting chaining.</p>
      <p>The <code>action</code> callback function will implement
      an <a href="#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> and <em class="rfc2119" title=
      "SHOULD">SHOULD</em> be called by implementations when a
      request for invoking the <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> is received
      from the underlying platform.</p>
      <p>There <em class="rfc2119" title="MUST">MUST</em> be at
      most one handler for any given <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a>, so newly added
      handlers <em class="rfc2119" title="MUST">MUST</em> replace
      the previous handlers.</p>
    </section>
    <section id="handling-action-requests">
      <h3 id="x7-12-handling-action-requests"><bdi class=
      "secno">7.12</bdi> Handling <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a>
      requests<a class="self-link" aria-label="§" href=
      "#handling-action-requests"></a></h3>
      <div>
        <p>When a network request for invoking the <a href=
        "#dfn-actions" class="internalDFN" data-link-type=
        "dfn">Action</a> identified by <var>name</var> is received,
        the runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
        execute the following steps:</p>
        <ol>
          <li>If an <a href="#dfn-actions" class="internalDFN"
          data-link-type="dfn">Action</a> identified by
          <var>name</var> does not exist, return
          <code>ReferenceError</code> in the reply and terminate
          these steps.
          </li>
          <li>If there is a user provided action handler registered
          with <code>setActionHandler()</code>, invoke that wih
          <var>name</var>, return the resulting value with the
          reply and terminate these steps.</li>
          <li>Otherwise return <a data-link-type="dfn" href=
          "https://heycam.github.io/webidl/#notsupportederror"><code>
            NotSupportedError</code></a> with the reply and
            terminate these steps.
          </li>
        </ol>
      </div>
    </section>
    <section id="the-emitevent-method">
      <h3 id="x7-13-the-emitevent-method"><bdi class=
      "secno">7.13</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-exposedthing-emitevent" data-idl=
      "operation" data-title="emitEvent()" data-dfn-for=
      "ExposedThing" data-type="void" data-lt=
      "ExposedThing.emitEvent()|ExposedThing.emitEvent|emitEvent()|emitEvent">
      <code>emitEvent()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-emitevent-method"></a></h3>
      <div>
        <p>Takes <var>name</var> as string argument denoting an
        <a href="#dfn-events" class="internalDFN" data-link-type=
        "dfn">Event</a> name, and a <var>data</var> argument of
        <code>any</code> type. The method <em class="rfc2119"
        title="MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, throw
          <code>SecurityError</code> and terminate these
          steps.</li>
          <li>If an <a href="#dfn-events" class="internalDFN"
          data-link-type="dfn">Event</a> with the name
          <var>name</var> is not found in
          <var>this.getThingDescription().events</var>, throw
          <code>NotFoundError</code> and terminate these steps.
          </li>
          <li>Make a request to the underlying platform to send an
          <a href="#dfn-events" class="internalDFN"
            data-link-type="dfn">Event</a> with <var>data</var>
            attached as property, using the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn">Protocol Bindings</a>, then
            terminate these steps.
          </li>
        </ol>
      </div>
    </section>
    <section id="the-expose-method">
      <h3 id="x7-14-the-expose-method"><bdi class=
      "secno">7.14</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-exposedthing-expose" data-idl=
      "operation" data-title="expose()" data-dfn-for="ExposedThing"
      data-type="Promise" data-lt=
      "ExposedThing.expose()|ExposedThing.expose|expose()|expose"><code>
      expose()</code></dfn> method<a class="self-link" aria-label=
      "§" href="#the-expose-method"></a></h3>
      <div>
        <p>Start serving external requests for the <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>, so that <a href="#dfn-wot-interactions"
        class="internalDFN" data-link-type="dfn">WoT
        Interactions</a> using <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Properties</a>, <a href=
        "#dfn-actions" class="internalDFN" data-link-type=
        "dfn">Action</a>s and <a href="#dfn-events" class=
        "internalDFN" data-link-type="dfn">Event</a>s will be
        possible. The method <em class="rfc2119" title=
        "MUST">MUST</em> run the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Run the <a href="#dfn-expand-a-td" class=
          "internalDFN" data-link-type="dfn">expand a TD</a> steps
          on the internal slot |<var>td</var>|.
          </li>
          <li>Run the <a href="#dfn-validate-a-td" class=
          "internalDFN" data-link-type="dfn">validate a TD</a> on
          |<var>td</var>|. If that fails, reject <var>promise</var>
          with <code>"TypeError"</code> and terminate these steps.
          </li>
          <li>For each <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn">Property</a>
          definition in <var>this.instance.properties</var>
          initialize an |<dfn data-dfn-type="dfn" id=
          "dfn-internal-observer-list">internal observer
          list</dfn>| internal slot in order to store observe
          request data needed to notify the observers on value
          changes.
          </li>
          <li>Set up the <a href="#dfn-wot-interactions" class=
          "internalDFN" data-link-type="dfn">WoT Interactions</a>
          based on introspecting <a href="#dfn-td" class=
          "internalDFN" data-link-type="dfn">td</a> as explained in
          [<cite><a class="bibref" href="#bib-wot-td" title=
          "WoT Thing Description " data-link-type=
          "biblio">WOT-TD</a></cite>] and [<cite><a class="bibref"
            href="#bib-wot-protocol-bindings" title=
            "Web of Things Protocol Binding Templates"
            data-link-type=
            "biblio">WOT-PROTOCOL-BINDINGS</a></cite>]. Make a
            request to the underlying platform to initialize the
            <a href="#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn">Protocol Bindings</a> and then
            start serving external requests for <a href=
            "#dfn-wot-interactions" class="internalDFN"
            data-link-type="dfn">WoT Interactions</a> (read, write
            and observe <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn">Properties</a>,
            invoke <a href="#dfn-actions" class="internalDFN"
            data-link-type="dfn">Action</a>s and manage <a href=
            "#dfn-events" class="internalDFN" data-link-type=
            "dfn">Event</a> subscriptions), based on the <a href=
            "#dfn-protocol-bindings" class="internalDFN"
            data-link-type="dfn">Protocol Bindings</a>. The details
            are private to the implementations and out of scope of
            this specification.
          </li>
          <li>If there was an error during the request, reject
          <var>promise</var> with an <code>Error</code> object
          <var>error</var> with <code>error.message</code> set to
          the error code seen by the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var> and terminate
          these steps.</li>
        </ol>
      </div>
    </section>
    <section id="the-destroy-method">
      <h3 id="x7-15-the-destroy-method"><bdi class=
      "secno">7.15</bdi> The <dfn data-dfn-type="method"
      data-export="" id="dom-exposedthing-destroy" data-idl=
      "operation" data-title="destroy()" data-dfn-for=
      "ExposedThing" data-type="Promise" data-lt=
      "ExposedThing.destroy()|ExposedThing.destroy|destroy()|destroy">
      <code>destroy()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-destroy-method"></a></h3>
      <div>
        <p>Stop serving external requests for the <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a> and destroy the object. Note that eventual
        unregistering should be done before invoking this method.
        The method <em class="rfc2119" title="MUST">MUST</em> run
        the following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, reject
          <var>promise</var> with <code>SecurityError</code> and
          terminate these steps.</li>
          <li>Make a request to the underlying platform to stop
          serving external requests for <a href=
          "#dfn-wot-interactions" class="internalDFN"
          data-link-type="dfn">WoT Interactions</a>, based on the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>.
          </li>
          <li>If there was an error during the request, reject
          <var>promise</var> with an <code>Error</code> object
          <var>error</var> with <code>error.message</code> set to
          the error code seen by the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
          </li>
          <li>Otherwise resolve <var>promise</var> and terminate
          these steps.</li>
        </ol>
      </div>
    </section>
    <section id="exposedthing-examples">
      <h3 id="x7-16-exposedthing-examples"><bdi class=
      "secno">7.16</bdi> ExposedThing Examples<a class="self-link"
      aria-label="§" href="#exposedthing-examples"></a></h3>
      <p>The next example illustrates how to create an
      <code><a href="#dom-exposedthing" class="internalDFN"
      data-link-type="idl"><code>ExposedThing</code></a></code>
      based on a partial <a href="#dfn-td" class="internalDFN"
      data-link-type="dfn">TD</a> object constructed
      beforehands.</p>
      <div class="example" id=
      "example-3-create-exposedthing-with-a-simple-property">
        <div class="marker">
          <a class="self-link" href=
          "#example-3-create-exposedthing-with-a-simple-property">Example
          <bdi>3</bdi></a><span class="example-title">: Create
          ExposedThing with a simple Property</span>
        </div>
        <pre class="highlight" aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class=
"hljs-keyword">let</span> temperaturePropertyDefinition = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
    <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">-50</span>,
    <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">10000</span>
  };
  <span class="hljs-keyword">let</span> tdFragment = {
    <span class="hljs-attr">properties</span>: {
      <span class=
"hljs-attr">temperature</span>: temperaturePropertyDefinition
    },
    <span class="hljs-attr">actions</span>: {
      <span class="hljs-attr">reset</span>: {
        <span class="hljs-attr">description</span>: <span class=
"hljs-string">"Reset the temperature sensor"</span>,
        <span class="hljs-attr">input</span>: {
          <span class=
"hljs-attr">temperature</span>: temperatureValueDefinition
        },
        <span class="hljs-attr">output</span>: <span class=
"hljs-literal">null</span>,
        <span class="hljs-attr">forms</span>: []
      },
    },
    <span class="hljs-attr">events</span>: {
      <span class=
"hljs-attr">onchange</span>: temperatureValueDefinition
    }
  };
  <span class="hljs-keyword">let</span> thing1 = <span class=
"hljs-keyword">await</span> WOT.produce(tdFragment);
  <span class="hljs-comment">// initialize Properties</span>
  <span class=
"hljs-keyword">await</span> thing1.writeProperty(<span class=
"hljs-string">"temperature"</span>, <span class=
"hljs-number">0</span>);
  <span class="hljs-comment">// add service handlers</span>
  thing1.setPropertyReadHandler(<span class=
"hljs-string">"temperature"</span>, () =&gt; {
     <span class=
"hljs-keyword">return</span> readLocalTemperatureSensor();  <span class="hljs-comment">// Promise</span>
  });
  <span class="hljs-comment">// start serving requests</span>
  <span class="hljs-keyword">await</span> thing1.expose();
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</code></pre>
      </div>
      <p>The next example illustrates how to add or modify a
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> definition on an existing <code><a href=
      "#dom-exposedthing" class="internalDFN" data-link-type=
      "idl"><code>ExposedThing</code></a></code>: take its
      <var>td</var> property, add or modify it, then create another
      <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="idl"><code>ExposedThing</code></a> with
      that.</p>
      <div class="example" id="example-4-add-an-object-property">
        <div class="marker">
          <a class="self-link" href=
          "#example-4-add-an-object-property">Example
          <bdi>4</bdi></a><span class="example-title">: Add an
          object Property</span>
        </div>
        <pre class="highlight" aria-busy="false"><code class=
        "hljs javascript"><span class="hljs-keyword">try</span> {
  <span class=
"hljs-comment">// create a deep copy of thing1's TD</span>
  <span class="hljs-keyword">let</span> instance = <span class=
"hljs-built_in">JSON</span>.parse(<span class=
"hljs-built_in">JSON</span>.stringify(thing1.td));
  <span class="hljs-keyword">const</span> statusValueDefinition = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"object"</span>,
    <span class="hljs-attr">properties</span>: {
      <span class="hljs-attr">brightness</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
        <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">0.0</span>,
        <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">100.0</span>,
        <span class="hljs-attr">required</span>: <span class=
"hljs-literal">true</span>
      },
      <span class="hljs-attr">rgb</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"array"</span>,
        <span class="hljs-string">"minItems"</span>: <span class=
"hljs-number">3</span>,
        <span class="hljs-string">"maxItems"</span>: <span class=
"hljs-number">3</span>,
        <span class="hljs-attr">items</span> : {
            <span class="hljs-string">"type"</span> : <span class=
"hljs-string">"number"</span>,
            <span class=
"hljs-string">"minimum"</span>: <span class="hljs-number">0</span>,
            <span class=
"hljs-string">"maximum"</span>: <span class="hljs-number">255</span>
        }
      }
  };
  instance[<span class="hljs-string">"name"</span>] = <span class=
"hljs-string">"mySensor"</span>;
  instance.properties[<span class=
"hljs-string">"brightness"</span>] = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
    <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">0.0</span>,
    <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">100.0</span>,
    <span class="hljs-attr">required</span>: <span class=
"hljs-literal">true</span>,
  };
  instance.properties[<span class=
"hljs-string">"status"</span>] = statusValueDefinition;
  instance.actions[<span class=
"hljs-string">"getStatus"</span>] = {
    <span class="hljs-attr">description</span>: <span class=
"hljs-string">"Get status object"</span>,
    <span class="hljs-attr">input</span>: <span class=
"hljs-literal">null</span>,
    <span class="hljs-attr">output</span>: {
      <span class=
"hljs-attr">status</span> : statusValueDefinition;
    },
    <span class="hljs-attr">forms</span>: [...]
  };
  instance.events[<span class=
"hljs-string">"onstatuschange"</span>] = statusValueDefinition;
  instance.forms = [...];  <span class=
"hljs-comment">// update</span>
  <span class="hljs-keyword">var</span> thing2 = <span class=
"hljs-keyword">new</span> ExposedThing(instance);
  <span class="hljs-comment">// <span class=
"hljs-doctag">TODO:</span> add service handlers</span>
  <span class="hljs-keyword">await</span> thing2.expose();
  });
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</code></pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="ThingDiscovery" id=
  "the-thingdiscovery-interface">
    <h2 id="x8-the-thingdiscovery-interface"><bdi class=
    "secno">8.</bdi> The <dfn data-dfn-type="interface"
    data-export="" id="dom-thingdiscovery" data-idl="interface"
    data-title="ThingDiscovery"><code>ThingDiscovery</code></dfn>
    interface<a class="self-link" aria-label="§" href=
    "#the-thingdiscovery-interface"></a></h2>
    <p>Discovery is a distributed application that requires
    provisioning and support from participating network nodes
    (clients, servers, directory services). This API models the
    client side of typical discovery schemes supported by various
    IoT deployments.</p>
    <p>The <a href="#dom-thingdiscovery" class="internalDFN"
    data-link-type="idl"><code>ThingDiscovery</code></a> object is
    constructed given a filter and provides the properties and
    methods controlling the discovery process.</p>
    <pre class="idl def"><span data-idl="" class="idlInterface" id=
    "idl-def-thingdiscovery" data-title=
    "ThingDiscovery">[<span class="extAttr"><a data-xref-type=
    "extended-attribute" data-cite-path="" data-type=
    "extended-attribute" href=
    "https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-thingdiscovery"><code>ThingDiscovery</code></a> {<span data-idl=""
class="idlConstructor" id=
"idl-def-thingdiscovery-constructor-filter" data-title=
"constructor" data-dfn-for="ThingDiscovery">
  <dfn data-export="" data-dfn-type="constructor" id=
"dom-thingdiscovery-constructor" data-idl="constructor" data-title=
"constructor" data-dfn-for="ThingDiscovery" data-lt=
"ThingDiscovery.constructor()|ThingDiscovery.constructor|constructor()|constructor"><code>constructor</code></dfn>(optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-thingfilter" class="internalDFN" data-link-type=
"idl"><code>ThingFilter</code></a></span> <span class=
"idlParamName">filter</span> = null);</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-filter" data-title=
"filter" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" href="#dom-thingfilter" class="internalDFN" data-link-type=
"idl"><code>ThingFilter</code></a>?</span> <a class=
"internalDFN idlName" data-link-for="ThingDiscovery"
data-link-type="attribute" href=
"#dom-thingdiscovery-filter"><code>filter</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-active" data-title=
"active" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="attribute" href=
"#dom-thingdiscovery-active"><code>active</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-done" data-title=
"done" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="attribute" href=
"#dom-thingdiscovery-done"><code>done</code></a>;</span><span data-idl=""
class="idlAttribute" id="idl-def-thingdiscovery-error" data-title=
"error" data-dfn-for="ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" data-link-type="dfn" href=
"https://tc39.github.io/ecma262/#sec-error-objects">Error</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="attribute" href=
"#dom-thingdiscovery-error"><code>error</code></a>;</span><span data-idl=""
class="idlMethod" id="idl-def-thingdiscovery-start" data-title=
"start" data-dfn-for="ThingDiscovery"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="method" href=
"#dom-thingdiscovery-start"><code>start</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-thingdiscovery-next" data-title=
"next" data-dfn-for="ThingDiscovery"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-thingdescription" class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="ThingDiscovery"
data-link-type="method" href=
"#dom-thingdiscovery-next"><code>next</code></a>();</span><span data-idl=""
class="idlMethod" id="idl-def-thingdiscovery-stop" data-title=
"stop" data-dfn-for="ThingDiscovery"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="method" href=
"#dom-thingdiscovery-stop"><code>stop</code></a>();</span>
};</span></pre>
    <div class="note" id="issue-container-generatedID-9">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-4" aria-level="3">
        <span>Editor's note</span>
      </div>
      <p class="">The <a href="#dom-thingdiscovery" class=
      "internalDFN" data-link-type=
      "idl"><code>ThingDiscovery</code></a> interface has a
      <code>next()</code> method and a <code>done</code> property,
      but it is not an <a href="">Iterable</a>. Look into <a href=
      "https://github.com/w3c/wot-scripting-api/issues/177">Issue
      177</a> for rationale.</p>
    </div>
    <p>The <dfn data-dfn-type="dfn" id=
    "dfn-discovery-results">discovery results</dfn> internal slot
    is an internal queue for temporarily storing the found <a href=
    "#dom-thingdescription" class="internalDFN" data-link-type=
    "idl"><code>ThingDescription</code></a> objects until they are
    consumed by the application using the <a href=
    "#the-next-method">next()</a> method. Implementations <em class=
    "rfc2119" title="MAY">MAY</em> optimize the size of this queue
    based on e.g. the available resources and the frequency of
    invoking the <a href="#the-next-method">next()</a> method.</p>
    <p>The <dfn data-dfn-type="attribute" data-export="" id=
    "dom-thingdiscovery-filter" data-idl="attribute" data-title=
    "filter" data-dfn-for="ThingDiscovery" data-type="ThingFilter"
    data-lt=
    "ThingDiscovery.filter|filter"><code>filter</code></dfn>
    property represents the discovery filter of type <a href=
    "#dom-thingfilter" class="internalDFN" data-link-type=
    "idl"><code>ThingFilter</code></a> specified for the
    discovery.</p>
    <p>The <dfn data-dfn-type="attribute" data-export="" id=
    "dom-thingdiscovery-active" data-idl="attribute" data-title=
    "active" data-dfn-for="ThingDiscovery" data-type="boolean"
    data-lt=
    "ThingDiscovery.active|active"><code>active</code></dfn>
    property is <code>true</code> when the discovery is actively
    ongoing on protocol level (i.e. new <a href="#dfn-td" class=
    "internalDFN" data-link-type="dfn">TD</a>s may still arrive)
    and <code>false</code> otherwise.</p>
    <p>The <dfn data-dfn-type="attribute" data-export="" id=
    "dom-thingdiscovery-done" data-idl="attribute" data-title=
    "done" data-dfn-for="ThingDiscovery" data-type="boolean"
    data-lt="ThingDiscovery.done|done"><code>done</code></dfn>
    property is <code>true</code> if the discovery has been
    completed with no more results to report and <a href=
    "#dfn-discovery-results" class="internalDFN" data-link-type=
    "dfn">discovery results</a> is also empty.</p>
    <p>The <dfn data-dfn-type="attribute" data-export="" id=
    "dom-thingdiscovery-error" data-idl="attribute" data-title=
    "error" data-dfn-for="ThingDiscovery" data-type="Error"
    data-lt="ThingDiscovery.error|error"><code>error</code></dfn>
    property represents the last error that occured during the
    discovery process. Typically used for critical errors that stop
    discovery.</p>
    <section id="constructing-thingdiscovery">
      <h3 id="x8-1-constructing-thingdiscovery"><bdi class=
      "secno">8.1</bdi> Constructing
      <code>ThingDiscovery</code><a class="self-link" aria-label=
      "§" href="#constructing-thingdiscovery"></a></h3>
      <div>
        <p>To create <a href="#dom-thingdiscovery" class=
        "internalDFN" data-link-type=
        "idl"><code>ThingDiscovery</code></a> with the <a href=
        "#dom-thingfilter" class="internalDFN" data-link-type=
        "idl"><code>ThingFilter</code></a> <var>filter</var>, run
        the following steps:</p>
        <ol>
          <li>If <var>filter</var> is not an object or
          <code>null</code>, throw <code>"TypeError"</code> and
          terminate these steps.</li>
          <li>Let <var>discovery</var> be a new <a href=
          "#dom-thingdiscovery" class="internalDFN"
            data-link-type="idl"><code>ThingDiscovery</code></a>
            object.
          </li>
          <li>Set the <a href=
          "#dom-thingdiscovery-filter">filter</a> property to <var>
            filter</var>.
          </li>
          <li>Set <a href="#dom-thingdiscovery-active">active</a>
          and <a href="#dom-thingdiscovery-done">done</a> to <code>
            false</code>. Set <a href=
            "#dom-thingdiscovery-error">error</a> to
            <code>null</code>.
          </li>
          <li>Return <var>discovery</var>.</li>
        </ol>
      </div>
      <p>The <a href="#the-start-method">start()</a> method sets
      <a href="#dom-thingdiscovery-active">active</a> to
      <code>true</code>. The <a href="#the-stop-method">stop()</a>
      method sets <a href="#dom-thingdiscovery-active">active</a>
      to <var>false</var>, but <a href=
      "#dom-thingdiscovery-done">done</a> may be still
      <code>false</code> if there are <a href=
      "#dom-thingdescription" class="internalDFN" data-link-type=
      "idl"><code>ThingDescription</code></a> objects in the
      <a href="#dfn-discovery-results" class="internalDFN"
      data-link-type="dfn">discovery results</a> not yet consumed
      with <a href="#the-next-method">next()</a>.</p>
      <p>During successive calls of <a href=
      "#the-next-method">next()</a>, <a href=
      "#dom-thingdiscovery-active">active</a> may be
      <code>true</code> or <code>false</code>, but <a href=
      "#dom-thingdiscovery-done">done</a> is set to
      <code>false</code> by <a href="#the-next-method">next()</a>
      only when both <a href=
      "#dom-thingdiscovery-active">active</a> is <code>false</code>
      and <a href="#dfn-discovery-results" class="internalDFN"
      data-link-type="dfn">discovery results</a> is empty.</p>
    </section>
    <section data-dfn-for="DiscoveryMethod" id=
    "the-discoverymethod-enumeration">
      <h3 id="x8-2-the-discoverymethod-enumeration"><bdi class=
      "secno">8.2</bdi> The <dfn data-dfn-type="typedef"
      data-export="" id="dom-discoverymethod" data-idl="typedef"
      data-title=
      "DiscoveryMethod"><code>DiscoveryMethod</code></dfn>
      enumeration<a class="self-link" aria-label="§" href=
      "#the-discoverymethod-enumeration"></a></h3>
      <pre class="idl def"><span data-idl="" class="idlTypedef" id=
      "idl-def-discoverymethod" data-title=
      "DiscoveryMethod">typedef<span class=
      "idlType"> <a data-xref-type="_IDL_" data-link-type="dfn"
      href=
      "https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <a class="internalDFN idlID"
data-link-for="" data-link-type="typedef" href=
"#dom-discoverymethod"><code>DiscoveryMethod</code></a>;</span></pre>
      <p>Represents the discovery type to be used:</p>
      <ul>
        <li><dfn data-dfn-type="dfn" id="dfn-any">"any"</dfn> does
        not provide any restriction</li>
        <li>
          <dfn data-dfn-type="dfn" id="dfn-local">"local"</dfn> for
          discovering <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn">Thing</a>s defined in the same
          device or connected to the device by wired or wireless
          means.
        </li>
        <li>
          <dfn data-dfn-type="dfn" id=
          "dfn-directory">"directory"</dfn> for discovery based on
          a service provided by a <a href="#dfn-thing-directory"
          class="internalDFN" data-link-type="dfn">Thing
          Directory</a>.
        </li>
        <li>
          <dfn data-dfn-type="dfn" id=
          "dfn-multicast">"multicast"</dfn> for discovering
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>s in the device's network by using a
          supported multicast protocol.
        </li>
      </ul>
    </section>
    <section data-dfn-for="ThingFilter" id=
    "the-thingfilter-dictionary">
      <h3 id="x8-3-the-thingfilter-dictionary"><bdi class=
      "secno">8.3</bdi> The <dfn data-dfn-type="dictionary"
      data-export="" id="dom-thingfilter" data-idl="dictionary"
      data-title="ThingFilter"><code>ThingFilter</code></dfn>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-thingfilter-dictionary"></a></h3>
      <p>Represents an object containing the constraints for
      discovering <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn">Thing</a>s as key-value pairs.</p>
      <pre class="idl def"><span data-idl="" class="idlDictionary"
      id="idl-def-thingfilter" data-title=
      "ThingFilter">dictionary <a class="internalDFN idlID"
      data-link-for="" data-link-type="dictionary" href=
      "#dom-thingfilter"><code>ThingFilter</code></a> {<span data-idl=
      "" class="idlMember" id="idl-def-thingfilter-method"
      data-title="method" data-dfn-for="ThingFilter"><span class=
      "idlType">
  (<a data-xref-type="_IDL_" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"idl"><code>DiscoveryMethod</code></a> or <a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a>)</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-method"><code>method</code></a> = "any";</span><span data-idl=""
class="idlMember" id="idl-def-thingfilter-url" data-title="url"
data-dfn-for="ThingFilter"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-url"><code>url</code></a>;</span><span data-idl=
"" class="idlMember" id="idl-def-thingfilter-query" data-title=
"query" data-dfn-for="ThingFilter"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-query"><code>query</code></a>;</span><span data-idl=""
class="idlMember" id="idl-def-thingfilter-fragment" data-title=
"fragment" data-dfn-for="ThingFilter"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-fragment"><code>fragment</code></a>;</span>
};</span></pre>
      <p>The <dfn data-dfn-type="dict-member" data-export="" id=
      "dom-thingfilter-method" data-idl="field" data-title="method"
      data-dfn-for="ThingFilter" data-type=
      "DiscoveryMethod|DOMString"><code>method</code></dfn>
      property represents the discovery type that should be used in
      the discovery process. The possible values are defined by the
      <code><a href="#dom-discoverymethod" class="internalDFN"
      data-link-type="idl"><code>DiscoveryMethod</code></a></code>
      enumeration that <em class="rfc2119" title="MAY">MAY</em> be
      extended by string values defined by solutions (with no
      guarantee of interoperability).</p>
      <p>The <dfn data-dfn-type="dict-member" data-export="" id=
      "dom-thingfilter-url" data-idl="field" data-title="url"
      data-dfn-for="ThingFilter" data-type=
      "USVString"><code>url</code></dfn> property represents
      additional information for the discovery method, such as the
      URL of the target entity serving the discovery request, for
      instance the URL of a <a href="#dfn-thing-directory" class=
      "internalDFN" data-link-type="dfn">Thing Directory</a> (if
      <code>method</code> is <code>"directory"</code>) or that of a
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> (otherwise).</p>
      <p>The <dfn data-dfn-type="dict-member" data-export="" id=
      "dom-thingfilter-query" data-idl="field" data-title="query"
      data-dfn-for="ThingFilter" data-type=
      "USVString"><code>query</code></dfn> property represents a
      query string accepted by the implementation, for instance a
      SPARQL or JSON query. Support may be implemented locally in
      the <a href="#dfn-wot-runtime" class="internalDFN"
      data-link-type="dfn">WoT Runtime</a> or remotely as a service
      in a <a href="#dfn-thing-directory" class="internalDFN"
      data-link-type="dfn">Thing Directory</a>.</p>
      <p>The <dfn data-dfn-type="dict-member" data-export="" id=
      "dom-thingfilter-fragment" data-idl="field" data-title=
      "fragment" data-dfn-for="ThingFilter" data-type=
      "object"><code>fragment</code></dfn> property represents a
      template object used for matching property by property
      against discovered <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn">Thing</a>s.</p>
    </section>
    <section id="the-start-method">
      <h3 id="x8-4-the-start-method"><bdi class="secno">8.4</bdi>
      The <dfn data-dfn-type="method" data-export="" id=
      "dom-thingdiscovery-start" data-idl="operation" data-title=
      "start()" data-dfn-for="ThingDiscovery" data-type="void"
      data-lt=
      "ThingDiscovery.start()|ThingDiscovery.start|start()|start"><code>
      start()</code></dfn> method<a class="self-link" aria-label=
      "§" href="#the-start-method"></a></h3>
      <div>
        <p>Starts the discovery process. The method <em class=
        "rfc2119" title="MUST">MUST</em> run the following
        steps:</p>
        <ol>
          <li>If invoking this method is not allowed for the
          current scripting context for security reasons, set
          <var>this.error</var> to <code>SecurityError</code> and
          terminate these steps.</li>
          <li>If discovery is not supported by the implementation,
          set <var>this.error</var> to
          <code>NotSupportedError</code> and terminate these
          steps.</li>
          <li>If <var>this.filter</var> is defined,
            <ul>
              <li>Let <var>filter</var> denote
              <var>this.filter</var>.</li>
              <li>If <var>filter.query</var> is defined, pass it as
              an opaque string to the underlying implementation to
              be matched against discovered items. The underlying
              implementation is responsible to parse it e.g. as a
              SPARQL or JSON query and match it against the
                <a href="#dfn-thing-descriptions" class=
                "internalDFN" data-link-type="dfn">Thing
                Description</a>s found during the discovery
                process. If queries are not supported, set
                <var>this.error</var> to
                <code>NotSupportedError</code> and terminate these
                steps.
              </li>
            </ul>
          </li>
          <li>Create the <a href="#dfn-discovery-results" class=
          "internalDFN" data-link-type="dfn">discovery results</a>
          internal slot for storing discovered <a href=
          "#dom-thingdescription" class="internalDFN"
          data-link-type="idl"><code>ThingDescription</code></a>
          objects.
          </li>
          <li>Request the underlying platform to start the
          discovery process, with the following parameters:
            <ul>
              <li>If <var>filter.method</var> is not defined or the
              value is <code>"any"</code>, use the widest discovery
              method supported by the underlying platform.</li>
              <li>Otherwise if <var>filter.method</var> is
              <code>"local"</code>, use the local <a href=
              "#dfn-thing-directory" class="internalDFN"
              data-link-type="dfn">Thing Directory</a> for
              discovery. Usually that defines <a href="#dfn-things"
                class="internalDFN" data-link-type="dfn">Thing</a>s
                deployed in the same device, or connected to the
                device in slave mode (e.g. sensors connected via
                Bluetooth or a serial connection).
              </li>
              <li>Otherwise if <var>filter.method</var> is
              <code>"directory"</code>, use the remote <a href=
              "#dfn-thing-directory" class="internalDFN"
              data-link-type="dfn">Thing Directory</a> specified in
              <var>filter.url</var>.
              </li>
              <li>Otherwise if <var>filter.method</var> is
              <code>"multicast"</code>, use all the multicast
              discovery protocols supported by the underlying
              platform.</li>
            </ul>
          </li>
          <li>When the underlying platform has started the
          discovery process, set the <code>active</code> property
          to <code>true</code>.</li>
          <li>Whenever a new <a href="#dfn-thing-descriptions"
          class="internalDFN" data-link-type="dfn">Thing
          Description</a> <var>td</var> is discovered by the
          underlying platform, run the following sub-steps:
            <ol>
              <li>
                <a href=
                "https://fetch.spec.whatwg.org/#fetch-api">Fetch</a>
                <var>td</var> as a JSON object <var>json</var>. If
                that fails, set <var>this.error</var> to
                <code>SyntaxError</code>, discard <var>td</var> and
                continue the discovery process.
              </li>
              <li>If <var>filter.query</var> is defined, check if
              <var>json</var> is a match for the query. The
              matching algorithm is encapsulated by
              implementations. If that returns <code>false</code>,
              discard <var>td</var> and continue the discovery
              process.</li>
              <li>If <var>filter.fragment</var> is defined, for
              each property defined in it, check if that property
              exists in <var>json.properties</var> and has the same
              value. If this is <code>false</code> in any checks,
              discard <var>td</var> and continue the discovery
              process.</li>
              <li>Otherwise add <var>td</var> to the <a href=
              "#dfn-discovery-results" class="internalDFN"
              data-link-type="dfn">discovery results</a>.
              </li>
              <li>At this point implementations <em class="rfc2119"
              title="MAY">MAY</em> control the flow of the
              discovery process (depending on memory constraints,
              for instance temporarily stop discovery if the queue
              is getting too large, or resume discovery when the
              queue is emptied sufficiently).</li>
            </ol>
          </li>
          <li>Whenever an error occurs during the discovery
          process,
            <ol>
              <li>Set <var>this.error</var> to a new
              <code>Error</code> object <var>error</var>. Set
              <var>error.name</var> to
              <code>'DiscoveryError'</code>.</li>
              <li>If there was an error code or message provided by
              the <a href="#dfn-protocol-bindings" class=
              "internalDFN" data-link-type="dfn">Protocol
              Bindings</a>, set <var>error.message</var> to that
              value as string.
              </li>
              <li>If the error is irrecoverable and discovery has
              been stopped by the underlying platform, set
              <code>this.active</code> to <code>false</code>.</li>
            </ol>
          </li>
          <li>When the underlying platform reports the discovery
          process has completed, set <var>this.active</var> to
          <code>false</code>.</li>
        </ol>
      </div>
    </section>
    <section id="the-next-method">
      <h3 id="x8-5-the-next-method"><bdi class="secno">8.5</bdi>
      The <dfn data-dfn-type="method" data-export="" id=
      "dom-thingdiscovery-next" data-idl="operation" data-title=
      "next()" data-dfn-for="ThingDiscovery" data-type="Promise"
      data-lt=
      "ThingDiscovery.next()|ThingDiscovery.next|next()|next"><code>
      next()</code></dfn> method<a class="self-link" aria-label="§"
      href="#the-next-method"></a></h3>
      <div>
        <p>Provides the next discovered <a href=
        "#dom-thingdescription" class="internalDFN" data-link-type=
        "idl"><code>ThingDescription</code></a> object. The method
        <em class="rfc2119" title="MUST">MUST</em> run the
        following steps:</p>
        <ol>
          <li>Return a <a data-link-type="dfn" href=
          "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a>
          <var>promise</var> and execute the next steps
          <a data-link-type="dfn" href=
          "https://html.spec.whatwg.org/multipage/#in-parallel">in
          parallel</a>.
          </li>
          <li>If <var>this.active</var> is <code>true</code>, wait
          until the <a href="#dfn-discovery-results" class=
          "internalDFN" data-link-type="dfn">discovery results</a>
          internal slot is not empty.
          </li>
          <li>If <a href="#dfn-discovery-results" class=
          "internalDFN" data-link-type="dfn">discovery results</a>
          is empty and <var>this.active</var> is
          <code>false</code>, set <var>this.done</var> to
          <code>true</code> and reject <var>promise</var>.
          </li>
          <li>Remove the first <a href="#dom-thingdescription"
          class="internalDFN" data-link-type=
          "idl"><code>ThingDescription</code></a> object
          <var>td</var> from <a href="#dfn-discovery-results"
            class="internalDFN" data-link-type="dfn">discovery
            results</a>.
          </li>
          <li>Resolve <var>promise</var> with <var>td</var> and
          terminate these steps.</li>
        </ol>
      </div>
    </section>
    <section id="the-stop-method">
      <h3 id="x8-6-the-stop-method"><bdi class="secno">8.6</bdi>
      The <dfn data-dfn-type="method" data-export="" id=
      "dom-thingdiscovery-stop" data-idl="operation" data-title=
      "stop()" data-dfn-for="ThingDiscovery" data-type="void"
      data-lt=
      "ThingDiscovery.stop()|ThingDiscovery.stop|stop()|stop"><code>
      stop()</code></dfn> method<a class="self-link" aria-label="§"
      href="#the-stop-method"></a></h3>
      <div>
        <p>Stops or suppresses the discovery process. It might not
        be supported by all discovery methods and endpoints,
        however, any further discovery results or errors will be
        discarded and the discovery is marked inactive. The method
        <em class="rfc2119" title="MUST">MUST</em> run the
        following steps:</p>
        <ol>
          <li>Request the underlying platform to stop the discovery
          process. If this returns an error, or if it is not
          possible, for instance when discovery is based on open
          ended multicast requests, the implementation <em class=
          "rfc2119" title="SHOULD">SHOULD</em> discard subsequent
          discovered items.</li>
          <li>Set <code>this.active</code> to
          <code>false</code>.</li>
        </ol>
      </div>
    </section>
    <section id="discovery-examples">
      <h3 id="x8-7-discovery-examples"><bdi class="secno">8.7</bdi>
      Discovery Examples<a class="self-link" aria-label="§" href=
      "#discovery-examples"></a></h3>
      <p>The following example finds <a href=
      "#dom-thingdescription" class="internalDFN" data-link-type=
      "idl"><code>ThingDescription</code></a> objects of <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a>s that are exposed by local hardware,
      regardless how many instances of <a href="#dfn-wot-runtime"
      class="internalDFN" data-link-type="dfn">WoT Runtime</a> it
      is running. Note that the discovery can end (become inactive)
      before the internal <a href="#dfn-discovery-results" class=
      "internalDFN" data-link-type="dfn">discovery results</a>
      queue is emptied, so we need to continue reading <a href=
      "#dom-thingdescription" class="internalDFN" data-link-type=
      "idl"><code>ThingDescription</code></a> objects until done.
      This is typical with local and directory type
      discoveries.</p>
      <div class="example" id=
      "example-5-discover-things-exposed-by-local-hardware">
        <div class="marker">
          <a class="self-link" href=
          "#example-5-discover-things-exposed-by-local-hardware">Example
          <bdi>5</bdi></a><span class="example-title">: Discover
          Things exposed by local hardware</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class=
        "hljs-keyword">let</span> discovery = <span class=
        "hljs-keyword">new</span> ThingDiscovery({ <span class=
        "hljs-attr">method</span>: <span class=
        "hljs-string">"local"</span> });
<span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> discovery.next();
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found Thing Description for "</span> + td.title);
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class=
"hljs-keyword">while</span> (!discovery.done);</code></pre>
      </div>
      <p>The next example finds <a href="#dom-thingdescription"
      class="internalDFN" data-link-type=
      "idl"><code>ThingDescription</code></a> objects of <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a>s listed in a <a href="#dfn-thing-directory"
      class="internalDFN" data-link-type="dfn">Thing Directory</a>
      service. We set a timeout for safety.</p>
      <div class="example" id=
      "example-6-discover-things-via-directory">
        <div class="marker">
          <a class="self-link" href=
          "#example-6-discover-things-via-directory">Example
          <bdi>6</bdi></a><span class="example-title">: Discover
          Things via directory</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class=
        "hljs-keyword">let</span> discoveryFilter = {
  <span class="hljs-attr">method</span>: <span class=
"hljs-string">"directory"</span>,
  <span class="hljs-attr">url</span>: <span class=
"hljs-string">"http://directory.wotservice.org"</span>
};
<span class="hljs-keyword">let</span> discovery = <span class=
"hljs-keyword">new</span> ThingDiscovery(discoveryFilter);
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    discovery.stop();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery stopped after timeout."</span>);
  },
  <span class="hljs-number">3000</span>);
<span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> discovery.next();
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found Thing Description for "</span> + td.title);
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class="hljs-keyword">while</span> (!discovery.done);
<span class="hljs-keyword">if</span> (discovery.error) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery stopped because of an error: "</span> + error.message);
}</code></pre>
      </div>
      <p>The next example is for an open-ended multicast discovery,
      which likely won't complete soon (depending on the underlying
      protocol), so stopping it with a timeout is a good idea. It
      will likely deliver results one by one.</p>
      <div class="example" id=
      "example-7-discover-things-in-a-network">
        <div class="marker">
          <a class="self-link" href=
          "#example-7-discover-things-in-a-network">Example
          <bdi>7</bdi></a><span class="example-title">: Discover
          Things in a network</span>
        </div>
        <pre aria-busy="false"><code class=
        "hljs javascript"><span class=
        "hljs-keyword">let</span> discovery = <span class=
        "hljs-keyword">new</span> ThingDiscovery({ <span class=
        "hljs-attr">method</span>: <span class=
        "hljs-string">"multicast"</span> });
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    discovery.stop();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Stopped open-ended discovery"</span>);
  },
  <span class="hljs-number">10000</span>);
<span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> discovery.next();
  <span class="hljs-keyword">let</span> thing = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing name: "</span> + thing.getThingDescription().title);
} <span class=
"hljs-keyword">while</span> (!discovery.done);</code></pre>
      </div>
    </section>
  </section>
  <section id="security-and-privacy">
    <h2 id="security"><bdi class="secno">9.</bdi> Security and
    Privacy<a class="self-link" aria-label="§" href=
    "#security-and-privacy"></a></h2>
    <p>A detailed discussion of security and privacy considerations
    for the Web of Things, including a threat model that can be
    adapted to various circumstances, is presented in the
    informative document [<cite><a class="bibref" href=
    "#bib-wot-security-guidelines" title=
    "Web of Things Security and Privacy Guidelines" data-link-type=
    "biblio">WOT-SECURITY-GUIDELINES</a></cite>]. This section
    discusses only security and privacy risks and possible
    mitigations directly relevant to the scripts and WoT Scripting
    API.</p>
    <p>A suggested set of best practices to improve security for
    WoT devices and services has been documented in
    [<cite><a class="bibref" href=
    "#bib-wot-security-best-practices" title=
    "Web of Things Security and Privacy Best Practices"
    data-link-type=
    "biblio">WOT-SECURITY-BEST-PRACTICES</a></cite>]. That document
    may be updated as security measures evolve. Following these
    practices does not guarantee security, but it might help avoid
    common known vulnerabilities.</p>
    <div>
      <p>The WoT security risks and possible mitigations are
      concerning the following groups:</p>
      <ul>
        <li>Implementors of WoT Runtimes that do not implement a
        Scripting Runtime. The [<cite><a class="bibref" href=
        "#bib-wot-architecture" title="Web of Things Architecture"
        data-link-type="biblio">WOT-ARCHITECTURE</a></cite>]
        document provides generic security guidelines for this
        group.</li>
        <li>Implementors of the WoT Scripting API in a WoT
        Scripting Runtime. This is the main scope and is covered in
        the <a href="#sec-security-consideration-runtime">Scripting
        Runtime Security and Privacy Risks</a> sub-section that
        contains normative text regarding security.
        </li>
        <li>WoT script developers, covered in the <a href=
        "#sec-security-consideration-script">Script Security and
        Privacy Risks</a> sub-section that contains informative
        recommendations concerning security.
        </li>
      </ul>
    </div>
    <section id="sec-security-consideration-runtime">
      <h3 id="x9-1-scripting-runtime-security-and-privacy-risks">
      <bdi class="secno">9.1</bdi> Scripting Runtime Security and
      Privacy Risks<a class="self-link" aria-label="§" href=
      "#sec-security-consideration-runtime"></a></h3>
      <p>This section is normative and contains specific risks
      relevant for the WoT Scripting Runtime.</p>
      <section id="sec-security-consideration-input">
        <h4 id="x9-1-1-corrupted-input-security-and-privacy-risk">
        <bdi class="secno">9.1.1</bdi> Corrupted Input Security and
        Privacy Risk<a class="self-link" aria-label="§" href=
        "#sec-security-consideration-input"></a></h4>
        <p>A typical way to compromise any process is to send it a
        corrupted input via one of the exposed interfaces. This can
        be done to a script instance using WoT interface it
        exposes.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>
            Implementors of this API <em class="rfc2119" title=
            "SHOULD">SHOULD</em> perform validation on all script
            inputs. In addition to input validation, <a href=
            "https://en.wikipedia.org/wiki/Fuzzing">fuzzing</a>
            should be used to verify that the input processing is
            done correctly. There are many tools and techniques in
            existence to do such validation. More details can be
            found in [<cite><a class="bibref" href=
            "#bib-wot-security-testing" title=
            "Web of Things Security Testing and Validation"
            data-link-type=
            "biblio">WOT-SECURITY-TESTING</a></cite>].
          </dd>
        </dl>
      </section>
      <section id=
      "sec-security-consideration-device-direct-access">
        <h4 id=
        "x9-1-2-physical-device-direct-access-security-and-privacy-risk">
        <bdi class="secno">9.1.2</bdi> Physical Device Direct
        Access Security and Privacy Risk<a class="self-link"
        aria-label="§" href=
        "#sec-security-consideration-device-direct-access"></a></h4>
        <p>In case a script is compromised or misbehaving, the
        underlying physical device (and potentially surrounded
        environment) can be damaged if a script can use directly
        exposed native device interfaces. If such interfaces lack
        safety checks on their inputs, they might bring the
        underlying physical device (or environment) to an unsafe
        state (i.e. device overheats and explodes).</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>The WoT Scripting Runtime <em class="rfc2119" title=
          "SHOULD">SHOULD</em> avoid directly exposing the native
          device interfaces to the script developers. Instead, a
          WoT Scripting Runtime should provide a hardware
          abstraction layer for accessing the native device
          interfaces. Such hardware abstraction layer should refuse
          to execute commands that might put the device (or
          environment) to an unsafe state. Additionally, in order
          to reduce the damage to a physical WoT device in cases a
          script gets compromised, it is important to minimize the
          number of interfaces that are exposed or accessible to a
          particular script based on its functionality.</dd>
        </dl>
      </section>
      <section id="sec-security-consideration-update-provisioning">
        <h4 id="x9-1-3-provisioning-and-update-security-risk">
        <bdi class="secno">9.1.3</bdi> Provisioning and Update
        Security Risk<a class="self-link" aria-label="§" href=
        "#sec-security-consideration-update-provisioning"></a></h4>
        <p>If the WoT Scripting Runtime supports post-manufacturing
        provisioning or updates of scripts, WoT Scripting Runtime
        or any related data (including security credentials), it
        can be a major attack vector. An attacker can try to modify
        any above described element during the update or
        provisioning process or simply provision attacker's code
        and data directly.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>Post-manufacturing provisioning or update of scripts,
          WoT Scripting Runtime or any related data should be done
          in a secure fashion. A set of recommendations for secure
          update and post-manufacturing provisioning can be found
          in [<cite><a class="bibref" href=
          "#bib-wot-security-guidelines" title=
          "Web of Things Security and Privacy Guidelines"
          data-link-type=
          "biblio">WOT-SECURITY-GUIDELINES</a></cite>].</dd>
        </dl>
      </section>
      <section id="sec-security-consideration-credentials-storage">
        <h4 id=
        "x9-1-4-security-credentials-storage-security-and-privacy-risk">
        <bdi class="secno">9.1.4</bdi> Security Credentials Storage
        Security and Privacy Risk<a class="self-link" aria-label=
        "§" href=
        "#sec-security-consideration-credentials-storage"></a></h4>
        <p>Typically the WoT Scripting Runtime needs to store the
        security credentials that are provisioned to a WoT device
        to operate in WoT network. If an attacker can compromise
        the confidentiality or integrity of these credentials, then
        it can obtain access to the WoT assets, impersonate WoT
        things or devices or create Denial-Of-Service (DoS)
        attacks.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>The WoT Scripting Runtime should securely store the
          provisioned security credentials, guaranteeing their
          integrity and confidentiality. In case there are more
          than one tenant on a single WoT-enabled device, a WoT
          Scripting Runtime should guarantee isolation of each
          tenant provisioned security credentials. Additionally, in
          order to minimize a risk that provisioned security
          credentials get compromised, the WoT Scripting Runtime
          should not expose any API for scripts to query the
          provisioned security credentials.</dd>
        </dl>
      </section>
    </section>
    <section id="sec-security-consideration-script" class=
    "informative">
      <h3 id="x9-2-script-security-and-privacy-risks"><bdi class=
      "secno">9.2</bdi> Script Security and Privacy Risks<a class=
      "self-link" aria-label="§" href=
      "#sec-security-consideration-script"></a></h3>
      <p><em>This section is non-normative.</em></p>
      <p>This section describes specific risks relevant for script
      developers.</p>
      <section id="sec-security-consideration-script-input">
        <h4 id=
        "x9-2-1-corrupted-script-input-security-and-privacy-risk">
        <bdi class="secno">9.2.1</bdi> Corrupted Script Input
        Security and Privacy Risk<a class="self-link" aria-label=
        "§" href=
        "#sec-security-consideration-script-input"></a></h4>
        <p>A script instance may receive data formats defined by
        the TD, or data formats defined by the applications. While
        the WoT Scripting Runtime <em class="rfc2119" title=
        "SHOULD">SHOULD</em> perform validation on all input fields
        defined by the TD, scripts may be still exploited by input
        data.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>
            Script developers should perform validation on all
            application defined script inputs. In addition to input
            validation, <a href=
            "https://en.wikipedia.org/wiki/Fuzzing">fuzzing</a>
            could be used to verify that the input processing is
            done correctly. There are many tools and techniques in
            existence to do such validation. More details can be
            found in [<cite><a class="bibref" href=
            "#bib-wot-security-testing" title=
            "Web of Things Security Testing and Validation"
            data-link-type=
            "biblio">WOT-SECURITY-TESTING</a></cite>].
          </dd>
        </dl>
      </section>
      <section id="sec-security-consideration-script-processing">
        <h4 id="x9-2-2-denial-of-service-security-risk"><bdi class=
        "secno">9.2.2</bdi> Denial Of Service Security
        Risk<a class="self-link" aria-label="§" href=
        "#sec-security-consideration-script-processing"></a></h4>
        <p>If a script performs a heavy functional processing on
        received requests before the request is authenticated, it
        presents a great risk for Denial-Of-Service (DOS)
        attacks.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>Scripts should avoid heavy functional processing
          without prior successful authentication of requestor. The
          set of recommended authentication mechanisms can be found
          in [<cite><a class="bibref" href=
          "#bib-wot-security-best-practices" title=
          "Web of Things Security and Privacy Best Practices"
          data-link-type=
          "biblio">WOT-SECURITY-BEST-PRACTICES</a></cite>].</dd>
        </dl>
      </section>
      <section id="sec-security-consideration-script-stale-td">
        <h4 id="x9-2-3-stale-td-security-risk"><bdi class=
        "secno">9.2.3</bdi> Stale TD Security Risk<a class=
        "self-link" aria-label="§" href=
        "#sec-security-consideration-script-stale-td"></a></h4>
        <p>During the lifetime of a WoT network, a content of a TD
        can change. This includes its identifier, which might not
        be an immutable one and might be updated periodically.</p>
        <dl>
          <dt>Mitigation:</dt>
          <dd>Scripts should use this API to subscribe for
          notifications on TD changes and do not rely on TD values
          to remain persistent.</dd>
        </dl>
        <div class="note" id="issue-container-generatedID-10">
          <div role="heading" class="ednote-title marker" id=
          "h-ednote-5" aria-level="5">
            <span>Editor's note</span>
          </div>
          <p class="">While stale TDs can present a potential
          problem for WoT network operation, it might not be a
          security risk.</p>
        </div>
      </section>
    </section>
  </section>
  <section id="terminology-and-conventions">
    <h2 id="x10-terminology-and-conventions"><bdi class=
    "secno">10.</bdi> Terminology and conventions<a class=
    "self-link" aria-label="§" href=
    "#terminology-and-conventions"></a></h2>
    <p>The generic WoT terminology is defined in [<cite><a class=
    "bibref" href="#bib-wot-architecture" title=
    "Web of Things Architecture" data-link-type=
    "biblio">WOT-ARCHITECTURE</a></cite>]: <dfn data-lt=
    "Things|Thing" data-dfn-type="dfn" data-plurals="things" id=
    "dfn-things">Thing</dfn>, <dfn data-lt=
    "Thing Descriptions|Thing Description" data-dfn-type="dfn" id=
    "dfn-thing-descriptions">Thing Description</dfn> (in short
    <dfn data-dfn-type="dfn" id="dfn-td">TD</dfn>),
    <dfn data-dfn-type="dfn" id="dfn-web-of-things">Web of
    Things</dfn> (in short <b><i>WoT</i></b>), <dfn data-dfn-type=
    "dfn" id="dfn-wot-interface">WoT Interface</dfn> (same as
    <dfn data-dfn-type="dfn" id="dfn-wot-network-interface">WoT
    network interface</dfn>), <dfn data-dfn-type="dfn" id=
    "dfn-protocol-bindings">Protocol Bindings</dfn>,
    <dfn data-dfn-type="dfn" id="dfn-wot-runtime">WoT
    Runtime</dfn>, <dfn data-lt=
    "consume|consume a TD|consuming a TD|Consuming a Thing Description"
    data-dfn-type="dfn" id="dfn-consume">Consuming a Thing
    Description</dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-thing-directory">Thing Directory</dfn>,
    <dfn data-dfn-type="dfn" id="dfn-wot-interactions">WoT
    Interactions</dfn>, <dfn data-lt="Properties|Property"
    data-dfn-type="dfn" data-plurals="properties" id=
    "dfn-properties">Property</dfn>, <dfn data-lt="Actions|Action"
    data-dfn-type="dfn" data-plurals="actions" id=
    "dfn-actions">Action</dfn>, <dfn data-lt=
    "Events|WoT-Event|Event" data-dfn-type="dfn" data-plurals=
    "events" id="dfn-events">Event</dfn> etc.</p>
    <p><dfn data-dfn-type="dfn" id="dfn-json-ld">JSON-LD</dfn> is
    defined in [<cite><a class="bibref" href="#bib-json-ld" title=
    "JSON-LD 1.0" data-link-type="biblio">JSON-LD</a></cite>] as a
    JSON document that is augmented with support for Linked
    Data.</p>
    <p>The terms <dfn data-dfn-type="dfn" id="dfn-url"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-url">URL</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-url-scheme" data-no-export=
    ""><a href=
    "https://url.spec.whatwg.org/#concept-url-scheme">URL
    scheme</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-url-host"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-url-host">URL
    host</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-url-path"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-url-path">URL
    path</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-url-record"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-url">URL
    record</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-parse-a-url"
    data-no-export=""><a href=
    "https://url.spec.whatwg.org/#parse-a-url">parse a
    URL</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-absolute-url-string" data-no-export=""><a href=
    "https://url.spec.whatwg.org/#absolute-url-string">absolute-URL
    string</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-path-absolute-url-string" data-no-export=""><a href=
    "https://url.spec.whatwg.org/#path-absolute-url-string">path-absolute-URL
    string</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-basic-url-parser" data-no-export=""><a href=
    "https://url.spec.whatwg.org/#concept-basic-url-parser">basic
    URL parser</a></dfn> are defined in [<cite><a class="bibref"
    href="#bib-url" title="URL Standard" data-link-type=
    "biblio">URL</a></cite>].</p>
    <p>The terms <dfn data-dfn-type="dfn" id="dfn-mime-type"
    data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#mime-type">MIME
    type</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-parsing-a-mime-type" data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#parsing-a-mime-type">Parsing
    a MIME type</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-serializing-a-mime-type" data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#serializing-a-mime-type">Serializing
    a MIME type</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-valid-mime-type-string" data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#valid-mime-type">valid MIME
    type string</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-json-mime-type" data-no-export=""><a href=
    "https://mimesniff.spec.whatwg.org/#json-mime-type">JSON MIME
    type</a></dfn> are defined in [<cite><a class="bibref" href=
    "#bib-mimesniff" title="MIME Sniffing Standard" data-link-type=
    "biblio">MIMESNIFF</a></cite>].</p>
    <p>The terms <dfn data-dfn-type="dfn" id="dfn-utf-8-encoding"
    data-no-export=""><a href=
    "https://encoding.spec.whatwg.org/#utf-8">UTF-8
    encoding</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-utf-8-decode" data-no-export=""><a href=
    "https://encoding.spec.whatwg.org/#utf-8-decode">UTF-8
    decode</a></dfn>, <dfn data-dfn-type="dfn" id="dfn-encode"
    data-no-export=""><a href=
    "https://encoding.spec.whatwg.org/#encode">encode</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-decode" data-no-export=
    ""><a href=
    "https://encoding.spec.whatwg.org/#decode">decode</a></dfn> are
    defined in [<cite><a class="bibref" href="#bib-encoding" title=
    "Encoding Standard" data-link-type=
    "biblio">ENCODING</a></cite>].</p>
    <p><dfn data-dfn-type="dfn" id="dfn-string" data-no-export=
    ""><a href=
    "https://infra.spec.whatwg.org/#string">string</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-parse-json-from-bytes"
    data-no-export=""><a href=
    "https://infra.spec.whatwg.org/#parse-json-from-bytes">parse
    JSON from bytes</a></dfn> and <dfn data-dfn-type="dfn" id=
    "dfn-serialize-json-to-bytes" data-no-export=""><a href=
    "https://infra.spec.whatwg.org/#serialize-json-to-bytes">serialize
    JSON to bytes</a></dfn>, are defined in [<cite><a class=
    "bibref" href="#bib-infra" title="Infra Standard"
    data-link-type="biblio">INFRA</a></cite>].</p>
    <p>The terms <dfn data-dfn-type="dfn" id="dfn-throw"
    data-no-export=""><a href=
    "https://heycam.github.io/webidl/#dfn-throw"><code>throw</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-creating" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#dfn-create-exception"><code>creating</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-domstring" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-dictionary" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#idl-dictionary"><code>Dictionary</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-arraybuffer" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-buffersource" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#common-BufferSource"><code>BufferSource</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-any-0" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#idl-any"><code>any</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-not-present" data-no-export=
    ""><a href="https://heycam.github.io/webidl/#dfn-present">not
    present</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-domexception" data-no-export=""><a href=
    "https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-aborterror" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-syntaxerror" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#syntaxerror"><code>SyntaxError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-notsupportederror"
    data-no-export=""><a href=
    "https://heycam.github.io/webidl/#notsupportederror"><code>NotSupportedError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-networkerror" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#networkerror"><code>NetworkError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-typeerror" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>
    TypeError</code></a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-notreadableerror" data-no-export=""><a href=
    "https://heycam.github.io/webidl/#notreadableerror"><code>NotReadableError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-timeouterror" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#timeouterror"><code>TimeoutError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-nomodificationallowederror"
    data-no-export=""><a href=
    "https://heycam.github.io/webidl/#nomodificationallowederror"><code>
    NoModificationAllowedError</code></a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-securityerror" data-no-export=
    ""><a href=
    "https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a></dfn>,
    are defined in [<cite><a class="bibref" href="#bib-webidl"
    title="Web IDL" data-link-type="biblio">WEBIDL</a></cite>].</p>
    <p><dfn data-dfn-type="dfn" id="dfn-promise" data-no-export=
    ""><a href=
    "https://tc39.github.io/ecma262/#sec-promise-objects"></a><a data-link-type="dfn"
    href=
    "https://tc39.github.io/ecma262/#sec-promise-objects">Promise</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-error" data-no-export=
    ""><a href=
    "https://tc39.github.io/ecma262/#sec-error-objects">Error</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-json" data-no-export=
    ""><a href=
    "https://tc39.github.io/ecma262/#sec-json-object">JSON</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-json-stringify"
    data-no-export=""><a href=
    "https://tc39.github.io/ecma262/#sec-json.stringify">JSON.stringify</a></dfn>,
    <dfn data-dfn-type="dfn" id="dfn-json-parse" data-no-export=
    ""><a href=
    "https://tc39.github.io/ecma262/#sec-json.parse">JSON.parse</a></dfn>
    and <dfn data-dfn-type="dfn" id="dfn-internal-slots"
    data-no-export=""><a href=
    "https://tc39.github.io/ecma262/#sec-object-internal-methods-and-internal-slots">
    internal slots</a></dfn> are defined in [<cite><a class=
    "bibref" href="#bib-ecmascript" title=
    "ECMAScript Language Specification" data-link-type=
    "biblio">ECMASCRIPT</a></cite>].</p>
    <p>The terms <dfn data-dfn-type="dfn" id="dfn-browsing-context"
    data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#browsing-context">browsing
    context</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-top-level-browsing-context" data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#top-level-browsing-context">
    top-level browsing context</a></dfn>, <dfn data-dfn-type="dfn"
    id="dfn-global-object" data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#global-object">global
    object</a></dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-current-settings-object" data-no-export=""><a href=
    "https://html.spec.whatwg.org/multipage/#current-settings-object">
    current settings object</a></dfn>, executing algorithms
    <dfn data-dfn-type="dfn" id="dfn-in-parallel" data-no-export=
    ""><a href=
    "https://html.spec.whatwg.org/multipage/#in-parallel">in
    parallel</a></dfn> are defined in [<cite><a class="bibref"
    href="#bib-html5" title="HTML5" data-link-type=
    "biblio">HTML5</a></cite>] and are used in the context of
    browser implementations.</p>
    <p>The term <a href=
    "https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">
    <dfn data-dfn-type="dfn" id="dfn-secure-context">secure
    context</dfn></a> is defined in [<cite><a class="bibref" href=
    "#bib-webappsec" title="Secure Contexts" data-link-type=
    "biblio">WEBAPPSEC</a></cite>].</p>
    <p><dfn data-dfn-type="dfn" id="dfn-iana-media-type">IANA media
    type</dfn>s (formerly known as MIME types) are defined in
    <a href="http://tools.ietf.org/html/rfc2046">RFC2046</a>.</p>
    <p>The terms <dfn data-dfn-type="dfn" id=
    "dfn-hyperlink-reference">hyperlink reference</dfn> and
    <dfn data-dfn-type="dfn" id="dfn-relation-type">relation
    type</dfn> are defined in [<cite><a class="bibref" href=
    "#bib-html5" title="HTML5" data-link-type=
    "biblio">HTML5</a></cite>] and <a href=
    "https://tools.ietf.org/html/rfc8288">RFC8288</a>.</p>
  </section>
  <section class="appendix" id="api-design-rationale">
    <h2 id="a-api-design-rationale"><bdi class="secno">A.</bdi> API
    design rationale<a class="self-link" aria-label="§" href=
    "#api-design-rationale"></a></h2>
    <p>API rationale usually belongs to a separate document, but in
    the WoT case the complexity of the context justifies including
    basic rationale here.</p>
    <section id="approaches-to-wot-application-development">
      <h3 id="a-1-approaches-to-wot-application-development">
      <bdi class="secno">A.1</bdi> Approaches to WoT application
      development<a class="self-link" aria-label="§" href=
      "#approaches-to-wot-application-development"></a></h3>
      <p>The WoT Interest Group and Working Group have explored
      different approaches to application development for WoT that
      have been all implemented and tested.</p>
      <section id="no-scripting-api">
        <h4 id="a-1-1-no-scripting-api"><bdi class=
        "secno">A.1.1</bdi> No Scripting API<a class="self-link"
        aria-label="§" href="#no-scripting-api"></a></h4>
        <p>It is possible to develop WoT applications that only use
        the <a href="#dfn-wot-network-interface" class=
        "internalDFN" data-link-type="dfn">WoT network
        interface</a>, typically exposed by a WoT gateway that
        presents a REST-ful API towards clients and implements IoT
        protocol plugins that communicate with supported IoT
        deployments. One such implementation is the <a href=
        "https://iot.mozilla.org/">Mozilla WebThings</a>
        platform.</p>
      </section>
      <section id="simple-scripting-api">
        <h4 id="a-1-2-simple-scripting-api"><bdi class=
        "secno">A.1.2</bdi> Simple Scripting API<a class=
        "self-link" aria-label="§" href=
        "#simple-scripting-api"></a></h4>
        <p>WoT <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s show good synergy with
        software objects, so a <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> can be
        represented as a software object, with <a href=
        "#dfn-properties" class="internalDFN" data-link-type=
        "dfn">Properties</a> represented as object properties,
        <a href="#dfn-actions" class="internalDFN" data-link-type=
        "dfn">Action</a>s as methods, and <a href="#dfn-events"
        class="internalDFN" data-link-type="dfn">Event</a>s as
        events. In addition, metadata is stored in special
        properties. Consuming and exposing is done with factory
        methods that produce a software object that directly
        represents a remote <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> and its
        interactions. One such implementation is the <a href=
        "https://github.com/draggett/arena-webhub">Arena Web
        Hub</a> project.</p>
        <p>In the next example, a <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> that
        represents interactions with a lock would look like the
        following: the <var>status</var> property and the
        <code>open()</code> method are directly exposed on the
        object.</p>
        <div class="example" id=
        "example-8-open-a-lock-with-a-simple-api">
          <div class="marker">
            <a class="self-link" href=
            "#example-8-open-a-lock-with-a-simple-api">Example
            <bdi>8</bdi></a><span class="example-title">: Open a
            lock with a simple API</span>
          </div>
          <pre aria-busy="false"><code class=
          "hljs javascript"><span class=
          "hljs-keyword">let</span> lock = <span class=
          "hljs-keyword">await</span> WoT.consume(‘https:<span class=
          "hljs-comment">//td.my.com/lock-00123’);</span>
<span class="hljs-built_in">console</span>.log(lock.status);
lock.open(<span class=
"hljs-string">'withThisKey'</span>);</code></pre>
        </div>
      </section>
      <section id="this-api-aligned-with-wot-td">
        <h4 id="a-1-3-this-api-aligned-with-wot-td"><bdi class=
        "secno">A.1.3</bdi> This API, aligned with [<cite><a class=
        "bibref" href="#bib-wot-td" title="WoT Thing Description "
        data-link-type="biblio">WOT-TD</a></cite>]<a class=
        "self-link" aria-label="§" href=
        "#this-api-aligned-with-wot-td"></a></h4>
        <p>Since the direct mapping of <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a>s to software
        objects have had some challenges, this specification takes
        another approach that exposes software objects to represent
        the <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a> metadata as data property
        and the WoT interactions as methods. One implementation is
        <a href=
        "https://github.com/eclipse/thingweb.node-wot">node-wot</a>
        in the the <a href="http://www.thingweb.io/">Eclipse
        ThingWeb</a> project, which is the current reference
        implementation of the API specified in this document.</p>
        <p>The same example now would look like the following: the
        <var>status</var> property and the <code>open()</code>
        method are represented indirectly.</p>
        <div class="example" id="example-9-open-a-lock">
          <div class="marker">
            <a class="self-link" href=
            "#example-9-open-a-lock">Example
            <bdi>9</bdi></a><span class="example-title">: Open a
            lock</span>
          </div>
          <pre aria-busy="false"><code class=
          "hljs javascript"><span class=
          "hljs-keyword">let</span> res = <span class=
          "hljs-keyword">await</span> fetch(‘https:<span class=
          "hljs-comment">//td.my.com/lock-00123’);</span>
<span class="hljs-keyword">let</span> td = <span class=
"hljs-keyword">await</span> res.json();
<span class="hljs-keyword">let</span> lock = <span class=
"hljs-keyword">new</span> ConsumedThing(td);
<span class=
"hljs-built_in">console</span>.log(lock.readProperty(‘status’));
lock.invokeAction(‘open’, <span class=
"hljs-string">'withThisKey'</span>);</code></pre>
        </div>
      </section>
      <p>In conclusion, the WoT WG decided to explore the third
      option that closely follows the [<cite><a class="bibref"
      href="#bib-wot-td" title="WoT Thing Description "
      data-link-type="biblio">WOT-TD</a></cite>] specification.
      Based on this, a simple API can also be implemented. Since
      Scripting is an optional module in WoT, this leaves room for
      applications that only use the WoT network interface.
      Therefore all three approaches above are supported by
      [<cite><a class="bibref" href="#bib-wot-td" title=
      "WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>].</p>
      <p>Moreover, the WoT network interface can be implemented in
      many languages and runtimes. Consider this API an example for
      what needs to be taken into consideration when designing a
      Scripting API for WoT.</p>
    </section>
    <section id="fetching-and-validating-a-td">
      <h3 id="a-2-fetching-and-validating-a-td"><bdi class=
      "secno">A.2</bdi> Fetching and validating a TD<a class=
      "self-link" aria-label="§" href=
      "#fetching-and-validating-a-td"></a></h3>
      <p>The <code>fetch(url)</code> method has been part of this
      API in earlier versions. However, now fetching a <a href=
      "#dfn-td" class="internalDFN" data-link-type="dfn">TD</a>
      given a URL should be done with an external method, such as
      the <a href="https://fetch.spec.whatwg.org/#fetch-api">Fetch
      API</a> or a HTTP client library, which offer already
      standardized options on specifying fetch details. The reason
      is that while simple fetch operations (covering most use
      cases) could be done in this API, when various fetch options
      were needed, there was no point in duplicating existing work
      to re-expose those options in this API.</p>
      <p>Since fetching a <a href="#dfn-td" class="internalDFN"
      data-link-type="dfn">TD</a> has been scoped out, and <a href=
      "#dfn-td" class="internalDFN" data-link-type="dfn">TD</a>
      validation is defined externally in [<cite><a class="bibref"
      href="#bib-wot-td" title="WoT Thing Description "
      data-link-type="biblio">WOT-TD</a></cite>], that is scoped
      out, too. This specification expects a <a href="#dfn-td"
      class="internalDFN" data-link-type="dfn">TD</a> as <a href=
      "https://infra.spec.whatwg.org/#parse-json-from-bytes">parsed
      JSON object</a> that has been validated according to the
      [<cite><a class="bibref" href="#bib-wot-td" title=
      "WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>] specification.</p>
    </section>
    <section id="factory-vs-constructors">
      <h3 id="a-3-factory-vs-constructors"><bdi class=
      "secno">A.3</bdi> Factory vs constructors<a class="self-link"
      aria-label="§" href="#factory-vs-constructors"></a></h3>
      <p>The factory methods for consuming and exposing <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a>s are asynchronous and fully validate the
      input <a href="#dfn-td" class="internalDFN" data-link-type=
      "dfn">TD</a>. In addition, one can also construct <a href=
      "#dom-consumedthing" class="internalDFN" data-link-type=
      "idl"><code>ConsumedThing</code></a> and <a href=
      "#dom-exposedthing" class="internalDFN" data-link-type=
      "idl"><code>ExposedThing</code></a> by providing a parsed and
      validated <a href="#dfn-td" class="internalDFN"
      data-link-type="dfn">TD</a>. Platform initialization is then
      done when needed during the WoT interactions. So applications
      that prefer validating a <a href="#dfn-td" class=
      "internalDFN" data-link-type="dfn">TD</a> themselves, may use
      the constructors, whereas applications that leave validation
      to implementations and prefer interactions initialized up
      front <em class="rfc2119" title="SHOULD">SHOULD</em> use the
      factory methods on the <a href="#dfn-wot-api-object" class=
      "internalDFN" data-link-type="dfn">WoT API object</a>.</p>
    </section>
    <section id="observers">
      <h3 id="a-4-observers"><bdi class="secno">A.4</bdi>
      Observers<a class="self-link" aria-label="§" href=
      "#observers"></a></h3>
      <p>Earlier drafts used the <a href=
      "https://github.com/tc39/proposal-observable">Observer</a>
      construct, but since it has not become standard, a new design
      was needed that was light enough for embedded
      implementations. Therefore observing <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> changes and handling WoT <a href=
      "#dfn-events" class="internalDFN" data-link-type=
      "dfn">Event</a>s is done with callback registrations.</p>
    </section>
    <section id="using-events">
      <h3 id="a-5-using-events"><bdi class="secno">A.5</bdi> Using
      Events<a class="self-link" aria-label="§" href=
      "#using-events"></a></h3>
      <div>
        <p>This API ended up not using software events at all, for
        the following reasons:</p>
        <ul>
          <li>Subscription to WoT <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn">Event</a>s may be
          different from handling software events (subscription
          might need parameters, might involve security tokens
          etc).
          </li>
          <li>Most implementations are for Node.js and browser
          implementations will likely be libraries (because
          possible dependency management issues in native
          implementations), using Events has been challenging.</li>
          <li>Observing <a href="#dfn-properties" class=
          "internalDFN" data-link-type="dfn">Property</a> changes
          and handling WoT <a href="#dfn-events" class=
          "internalDFN" data-link-type="dfn">Event</a>s is done
          with the solution above.
          </li>
        </ul>
      </div>
    </section>
    <section id="polymorphic-functions">
      <h3 id="a-6-polymorphic-functions"><bdi class=
      "secno">A.6</bdi> Polymorphic functions<a class="self-link"
      aria-label="§" href="#polymorphic-functions"></a></h3>
      <p>The reason to use function names like
      <code>readProperty()</code>,
      <code>readMultipleProperties()</code> etc. instead of a
      generic polymorphic <code>read()</code> function is that the
      current names map exactly to the <code>"op"</code> vocabulary
      from the <a href=
      "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/#form">Form</a>
      definition in [<cite><a class="bibref" href="#bib-wot-td"
      title="WoT Thing Description " data-link-type=
      "biblio">WOT-TD</a></cite>].</p>
    </section>
  </section>
  <section class="appendix" id="Changes">
    <h2 id="b-changes"><bdi class="secno">B.</bdi> Changes<a class=
    "self-link" aria-label="§" href="#Changes"></a></h2>
    <div>
      <p>The following is a list of major changes to the document.
      Major versions of this specification are the following:</p>
      <ul>
        <li>First Public Working Draft <a href=
        "https://www.w3.org/TR/2017/WD-wot-scripting-api-20170914/">
          September 2017</a>.
        </li>
        <li>Working Draft <a href=
        "https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/">
          April 2018</a>.
        </li>
        <li>Working Draft <a href=
        "https://www.w3.org/TR/2018/WD-wot-scripting-api-20181129/">
          November 2018</a>.
        </li>
        <li>This version, introducing the following major changes:
          <ul>
            <li>Remove <code>fetch()</code> for fetching a
              <a href="#dfn-td" class="internalDFN" data-link-type=
              "dfn">TD</a> (delegated to external API).
            </li>
            <li>Remove <code>Observer</code> and use <a href=
            "https://w3ctag.github.io/design-principles/"><abbr title="World Wide Web Consortium">
              W3C</abbr> TAG recommended design patterns</a>.
            </li>
            <li>Align the discovery API to other similar APIs (such
            as <a href=
            "https://www.w3.org/TR/generic-sensor/#the-sensor-interface">
              <abbr title="World Wide Web Consortium">W3C</abbr>
              Generic Sensor API</a>).
            </li>
            <li>Remove the large data definition API for
            constructing <a href="#dfn-td" class="internalDFN"
            data-link-type="dfn">TD</a>s and leverage using
              <a href="#dom-thingdescription" class="internalDFN"
              data-link-type=
              "idl"><code>ThingDescription</code></a> instead.
            </li>
            <li>Add missing algorithms and rework most existing
            ones.</li>
            <li>Allow constructors for <a href="#dom-consumedthing"
              class="internalDFN" data-link-type=
              "idl"><code>ConsumedThing</code></a> and <a href=
              "#dom-exposedthing" class="internalDFN"
              data-link-type="idl"><code>ExposedThing</code></a>.
            </li>
            <li>Add API rationale as an appendix to this
            document.</li>
          </ul>
        </li>
      </ul>
    </div>
    <p>For a complete list of changes, see the <a href=
    "https://github.com/w3c/wot-scripting-api/commits/master">github
    change log</a>. You can also view the <a href=
    "https://github.com/w3c/wot-scripting-api/issues?page=1&amp;state=closed">
    recently closed issues</a>.</p>
  </section>
  <section id="open-issues">
    <h2 class="appendix" id="openissues"><bdi class=
    "secno">C.</bdi> Open issues<a class="self-link" aria-label="§"
    href="#open-issues"></a></h2>
    <div>
      <p>The following problems are being discussed and need most
      attention:</p>
      <ul>
        <li>Script management and runtime related issues
        (https://github.com/w3c/wot-scripting-api/issues/)</li>
        <li>An explicit API for adding and removing <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn">
          Property</a>, <a href="#dfn-actions" class="internalDFN"
          data-link-type="dfn">Action</a> and <a href="#dfn-events"
          class="internalDFN" data-link-type="dfn">Event</a>
          definitions on <a href="#dom-exposedthing" class=
          "internalDFN" data-link-type=
          "idl"><code>ExposedThing</code></a> (it was present in
          earlier versions, but removed for complexity and a
          simpler way to do it.
        </li>
      </ul>
    </div>
  </section>
  <section class="appendix" id="idl-index">
    <h2 id="d-full-web-idl"><bdi class="secno">D.</bdi> Full Web
    IDL<a class="self-link" aria-label="§" href=
    "#idl-index"></a></h2>
    <pre class="idl def" id="actual-idl-index"><span data-idl=""
    class="idlTypedef" data-title=
    "ThingDescription">typedef<span class=
    "idlType"> <a data-xref-type="interface" data-cite-path=""
    data-type="interface" href=
    "https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-for="" data-link-type="typedef" href=
"#dom-thingdescription"><code>ThingDescription</code></a>;</span>

<span data-idl="" class="idlInterface" data-title=
"WOT">[<span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-wot"><code>WOT</code></a> {<span class="idlSectionComment">
  // methods defined in UA conformance classes
</span>};</span>

<span data-idl="" class="idlInterface" data-title=
"WOT">partial interface <a class="internalDFN idlID" data-link-for=
"" data-link-type="interface" href=
"#dom-wot"><code>WOT</code></a> {<span data-idl="" class=
"idlMethod" data-title="consume" data-dfn-for="WOT"><span class=
"idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-consumedthing" class="internalDFN" data-link-type=
"idl"><code>ConsumedThing</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="WOT" data-link-type="method"
href="#dom-wot-consume"><code>consume</code></a>(<span class=
"idlType"><a data-xref-type="_IDL_" href="#dom-thingdescription"
class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span>);</span>
};</span>

<span data-idl="" class="idlInterface" data-title=
"WOT">partial interface <a class="internalDFN idlID" data-link-for=
"" data-link-type="interface" href=
"#dom-wot"><code>WOT</code></a> {<span data-idl="" class=
"idlMethod" data-title="produce" data-dfn-for="WOT"><span class=
"idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-exposedthing" class="internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="WOT" data-link-type="method"
href="#dom-wot-produce"><code>produce</code></a>(<span class=
"idlType"><a data-xref-type="_IDL_" href="#dom-thingdescription"
class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span>);</span>
};</span>

<span data-idl="" class="idlInterface" data-title=
"WOT">partial interface <a class="internalDFN idlID" data-link-for=
"" data-link-type="interface" href=
"#dom-wot"><code>WOT</code></a> {<span data-idl="" class=
"idlMethod" data-title="discover" data-dfn-for="WOT"><span class=
"idlType">
  <a data-xref-type="_IDL_" href="#dom-thingdiscovery" class=
"internalDFN" data-link-type=
"idl"><code>ThingDiscovery</code></a></span> <a class=
"internalDFN idlName" data-link-for="WOT" data-link-type="method"
href=
"#dom-wot-discover"><code>discover</code></a>(optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-thingfilter" class=
"internalDFN" data-link-type=
"idl"><code>ThingFilter</code></a></span> <span class=
"idlParamName">filter</span> = null);</span>
};</span>

<span data-idl="" class="idlInterface" data-title=
"ConsumedThing">[<span class="extAttr"><a data-xref-type=
"extended-attribute" data-cite-path="" data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-consumedthing"><code>ConsumedThing</code></a> {<span data-idl=""
class="idlConstructor" data-title="constructor" data-dfn-for=
"ConsumedThing">
  <dfn data-export="" data-dfn-type="constructor" data-idl=
"constructor" data-title="constructor" data-dfn-for="ConsumedThing"
data-lt=
"ConsumedThing.constructor()|ConsumedThing.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a data-xref-type="_IDL_"
href="#dom-thingdescription" class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span>);</span><span data-idl="" class=
"idlMethod" data-title="readProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-readproperty"><code>readProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">propertyName</span>,
                            optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="readAllProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-propertymap" class="internalDFN" data-link-type=
"idl"><code>PropertyMap</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="ConsumedThing" data-link-type=
"method" href=
"#dom-consumedthing-readallproperties"><code>readAllProperties</code></a>(optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="readMultipleProperties" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-propertymap" class="internalDFN" data-link-type=
"idl"><code>PropertyMap</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="ConsumedThing" data-link-type=
"method" href=
"#dom-consumedthing-readmultipleproperties"><code>readMultipleProperties</code></a>(<span class="idlType">
                            <a data-xref-type="dfn" data-cite-path=
"" data-type="dfn" href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a>&gt;</span> <span class="idlParamName">propertyNames</span>,
                            optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="writeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-writeproperty"><code>writeProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">propertyName</span>,<span class="idlType">
                              <a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">value</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="writeMultipleProperties"
data-dfn-for="ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-writemultipleproperties"><code>writeMultipleProperties</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
href="#dom-propertymap" class="internalDFN" data-link-type=
"idl"><code>PropertyMap</code></a></span> <span class=
"idlParamName">valueMap</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="invokeAction" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-invokeaction"><code>invokeAction</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">actionName</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">params</span> = null,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="observeProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-observeproperty"><code>observeProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a data-xref-type="_IDL_" href=
"#dom-wotlistener" class="internalDFN" data-link-type=
"idl"><code>WotListener</code></a></span> <span class=
"idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="unobserveProperty" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-unobserveproperty"><code>unobserveProperty</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>);</span><span data-idl=""
class="idlMethod" data-title="subscribeEvent" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-subscribeevent"><code>subscribeEvent</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
                              <a data-xref-type="_IDL_" href=
"#dom-wotlistener" class="internalDFN" data-link-type=
"idl"><code>WotListener</code></a></span> <span class=
"idlParamName">listener</span>,
                              optional<span class=
"idlType"> <a data-xref-type="_IDL_" href="#dom-interactionoptions"
class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlMethod" data-title="unsubscribeEvent" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ConsumedThing" data-link-type="method" href=
"#dom-consumedthing-unsubscribeevent"><code>unsubscribeEvent</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>);</span><span data-idl=""
class="idlMethod" data-title="getThingDescription" data-dfn-for=
"ConsumedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-thingdescription" class=
"internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a></span> <a class=
"internalDFN idlName" data-link-for="ConsumedThing" data-link-type=
"method" href=
"#dom-consumedthing-getthingdescription"><code>getThingDescription</code></a>();</span>
};</span><span data-idl="" class="idlDictionary" data-title=
"InteractionOptions">
dictionary <a class="internalDFN idlID" data-link-for=""
data-link-type="dictionary" href=
"#dom-interactionoptions"><code>InteractionOptions</code></a> {<span data-idl=""
class="idlMember" data-title="uriVariables" data-dfn-for=
"InteractionOptions"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <dfn data-export=""
data-dfn-type="dict-member" data-idl="field" data-title=
"uriVariables" data-dfn-for="InteractionOptions" data-type="object"
class="idlName"><code>uriVariables</code></dfn>;</span>
};</span><span data-idl="" class="idlTypedef" data-title=
"PropertyMap">
typedef<span class="idlType"> <a data-xref-type="interface"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <a class="internalDFN idlID"
data-link-for="" data-link-type="typedef" href=
"#dom-propertymap"><code>PropertyMap</code></a>;</span><span data-idl=""
class="idlCallback" data-title="WotListener">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-wotlistener"><code>WotListener</code></a> =<span class=
"idlType"> <a data-xref-type="_IDL_" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a></span>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">data</span>);</span>

<span data-idl="" class="idlInterface" data-title=
"ExposedThing">[<span class="extAttr"><a data-xref-type=
"extended-attribute" data-cite-path="" data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-exposedthing"><code>ExposedThing</code></a>: <span class=
"idlSuperclass"><a data-xref-type="_IDL_" href="#dom-consumedthing"
class="internalDFN" data-link-type=
"idl"><code>ConsumedThing</code></a></span> {<span data-idl=""
class="idlMethod" data-title="setPropertyReadHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a></span> <a class=
"internalDFN idlName" data-link-for="ExposedThing" data-link-type=
"method" href=
"#dom-exposedthing-setpropertyreadhandler"><code>setPropertyReadHandler</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a data-xref-type="_IDL_" href="#dom-propertyreadhandler"
class="internalDFN" data-link-type=
"idl"><code>PropertyReadHandler</code></a></span> <span class=
"idlParamName">readHandler</span>);</span><span data-idl="" class=
"idlMethod" data-title="setPropertyWriteHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a></span> <a class=
"internalDFN idlName" data-link-for="ExposedThing" data-link-type=
"method" href=
"#dom-exposedthing-setpropertywritehandler"><code>setPropertyWriteHandler</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType">
          <a data-xref-type="_IDL_" href=
"#dom-propertywritehandler" class="internalDFN" data-link-type=
"idl"><code>PropertyWriteHandler</code></a></span> <span class=
"idlParamName">writeHandler</span>);</span><span data-idl="" class=
"idlMethod" data-title="setActionHandler" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"idl"><code>ExposedThing</code></a></span> <a class=
"internalDFN idlName" data-link-for="ExposedThing" data-link-type=
"method" href=
"#dom-exposedthing-setactionhandler"><code>setActionHandler</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-actionhandler" class="internalDFN" data-link-type=
"idl"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span>);</span><span data-idl="" class=
"idlMethod" data-title="emitEvent" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName"
data-link-for="ExposedThing" data-link-type="method" href=
"#dom-exposedthing-emitevent"><code>emitEvent</code></a>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <span class="idlParamName">name</span>,<span class="idlType"> <a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">data</span>);</span><span data-idl=""
class="idlMethod" data-title="expose" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ExposedThing" data-link-type="method" href=
"#dom-exposedthing-expose"><code>expose</code></a>();</span><span data-idl=""
class="idlMethod" data-title="destroy" data-dfn-for=
"ExposedThing"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a class="internalDFN idlName"
data-link-for="ExposedThing" data-link-type="method" href=
"#dom-exposedthing-destroy"><code>destroy</code></a>();</span>
};</span><span data-idl="" class="idlCallback" data-title=
"PropertyReadHandler">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-propertyreadhandler"><code>PropertyReadHandler</code></a> =<span class="idlType"> <a data-xref-type="interface"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span>(
        optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" data-title="PropertyWriteHandler">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-propertywritehandler"><code>PropertyWriteHandler</code></a> =<span class="idlType"> <a data-xref-type="interface"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">value</span>,
        optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span><span data-idl=""
class="idlCallback" data-title="ActionHandler">
callback <a class="internalDFN idlID" data-link-for=""
data-link-type="callback" href=
"#dom-actionhandler"><code>ActionHandler</code></a> =<span class=
"idlType"> <a data-xref-type="interface" data-cite-path=""
data-type="interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a>&gt;</span>(<span class="idlType"><a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-any"><code>any</code></a></span> <span class="idlParamName">params</span>,
        optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-interactionoptions" class="internalDFN" data-link-type=
"idl"><code>InteractionOptions</code></a></span> <span class=
"idlParamName">options</span> = null);</span>

<span data-idl="" class="idlInterface" data-title=
"ThingDiscovery">[<span class="extAttr"><a data-xref-type=
"extended-attribute" data-cite-path="" data-type=
"extended-attribute" href=
"https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-xref-type="extended-attribute"
data-cite-path="" data-type="extended-attribute" href=
"https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface"
data-cite-path="window-object.html" data-type="interface" href=
"https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>,<a data-xref-type="interface"
data-lt="WorkerGlobalScope" data-cite-path="workers.html"
data-type="interface" href=
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">Worker</a>)</span>]
interface <a class="internalDFN idlID" data-link-for=""
data-link-type="interface" href=
"#dom-thingdiscovery"><code>ThingDiscovery</code></a> {<span data-idl=""
class="idlConstructor" data-title="constructor" data-dfn-for=
"ThingDiscovery">
  <dfn data-export="" data-dfn-type="constructor" data-idl=
"constructor" data-title="constructor" data-dfn-for=
"ThingDiscovery" data-lt=
"ThingDiscovery.constructor()|ThingDiscovery.constructor|constructor()|constructor"><code>constructor</code></dfn>(optional<span class="idlType"> <a data-xref-type="_IDL_"
href="#dom-thingfilter" class="internalDFN" data-link-type=
"idl"><code>ThingFilter</code></a></span> <span class=
"idlParamName">filter</span> = null);</span><span data-idl=""
class="idlAttribute" data-title="filter" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" href="#dom-thingfilter" class="internalDFN" data-link-type=
"idl"><code>ThingFilter</code></a>?</span> <a class=
"internalDFN idlName" data-link-for="ThingDiscovery"
data-link-type="attribute" href=
"#dom-thingdiscovery-filter"><code>filter</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="active" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="attribute" href=
"#dom-thingdiscovery-active"><code>active</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="done" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" data-cite-path="" data-type="interface" href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="attribute" href=
"#dom-thingdiscovery-done"><code>done</code></a>;</span><span data-idl=""
class="idlAttribute" data-title="error" data-dfn-for=
"ThingDiscovery">
  readonly attribute<span class="idlType"> <a data-xref-type=
"_IDL_" data-link-type="dfn" href=
"https://tc39.github.io/ecma262/#sec-error-objects">Error</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="attribute" href=
"#dom-thingdiscovery-error"><code>error</code></a>;</span><span data-idl=""
class="idlMethod" data-title="start" data-dfn-for=
"ThingDiscovery"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="method" href=
"#dom-thingdiscovery-start"><code>start</code></a>();</span><span data-idl=""
class="idlMethod" data-title="next" data-dfn-for=
"ThingDiscovery"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_"
href="#dom-thingdescription" class="internalDFN" data-link-type=
"idl"><code>ThingDescription</code></a>&gt;</span> <a class=
"internalDFN idlName" data-link-for="ThingDiscovery"
data-link-type="method" href=
"#dom-thingdiscovery-next"><code>next</code></a>();</span><span data-idl=""
class="idlMethod" data-title="stop" data-dfn-for=
"ThingDiscovery"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-void">void</a></span> <a class="internalDFN idlName"
data-link-for="ThingDiscovery" data-link-type="method" href=
"#dom-thingdiscovery-stop"><code>stop</code></a>();</span>
};</span>

<span data-idl="" class="idlTypedef" data-title=
"DiscoveryMethod">typedef<span class="idlType"> <a data-xref-type=
"_IDL_" data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a></span> <a class="internalDFN idlID"
data-link-for="" data-link-type="typedef" href=
"#dom-discoverymethod"><code>DiscoveryMethod</code></a>;</span>

<span data-idl="" class="idlDictionary" data-title=
"ThingFilter">dictionary <a class="internalDFN idlID"
data-link-for="" data-link-type="dictionary" href=
"#dom-thingfilter"><code>ThingFilter</code></a> {<span data-idl=""
class="idlMember" data-title="method" data-dfn-for=
"ThingFilter"><span class="idlType">
  (<a data-xref-type="_IDL_" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"idl"><code>DiscoveryMethod</code></a> or <a data-xref-type="_IDL_"
data-link-type="dfn" href=
"https://heycam.github.io/webidl/#idl-DOMString"><code>DOMString</code></a>)</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-method"><code>method</code></a> = "any";</span><span data-idl=""
class="idlMember" data-title="url" data-dfn-for=
"ThingFilter"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-url"><code>url</code></a>;</span><span data-idl=
"" class="idlMember" data-title="query" data-dfn-for=
"ThingFilter"><span class="idlType">
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface"
href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-query"><code>query</code></a>;</span><span data-idl=""
class="idlMember" data-title="fragment" data-dfn-for=
"ThingFilter"><span class="idlType">
  <a data-xref-type="interface" data-cite-path="" data-type=
"interface" href=
"https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a class="internalDFN idlName"
data-link-for="ThingFilter" data-link-type="dict-member" href=
"#dom-thingfilter-fragment"><code>fragment</code></a>;</span>
};</span></pre>
  </section>
  <section class="appendix" id="acknowledgements">
    <h2 id="e-acknowledgements"><bdi class="secno">E.</bdi>
    Acknowledgements<a class="self-link" aria-label="§" href=
    "#acknowledgements"></a></h2>
    <p>Special thanks to former editor Johannes Hund (until August
    2017, when at Siemens AG) and Kazuaki Nimura (until December
    2018) for developing this specification. Also, the editors
    would like to thank Dave Raggett, Matthias Kovatsch, Michael
    Koster, Elena Reshetova, Michael McCool as well as the other
    WoT WG members for their comments, contributions and
    guidance.</p>
  </section>
  <section id="references" class="appendix">
    <h2 id="f-references"><bdi class="secno">F.</bdi>
    References<a class="self-link" aria-label="§" href=
    "#references"></a></h2>
    <section id="normative-references">
      <h3 id="f-1-normative-references"><bdi class=
      "secno">F.1</bdi> Normative references<a class="self-link"
      aria-label="§" href="#normative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-ecmascript">[ECMASCRIPT]</dt>
        <dd>
          <a href=
          "https://tc39.github.io/ecma262/"><cite>ECMAScript
          Language Specification</cite></a>. Ecma International.
          URL: <a href=
          "https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
        </dd>
        <dt id="bib-encoding">[ENCODING]</dt>
        <dd>
          <a href=
          "https://encoding.spec.whatwg.org/"><cite>Encoding
          Standard</cite></a>. Anne van Kesteren. WHATWG. Living
          Standard. URL: <a href=
          "https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-html">[HTML]</dt>
        <dd>
          <a href=
          "https://html.spec.whatwg.org/multipage/"><cite>HTML
          Standard</cite></a>. Anne van Kesteren; Domenic Denicola;
          Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG.
          Living Standard. URL: <a href=
          "https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        </dd>
        <dt id="bib-html5">[HTML5]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>.
          Ian Hickson; Robin Berjon; Steve Faulkner; Travis
          Leithead; Erika Doyle Navara; Theresa O'Connor; Silvia
          Pfeiffer. W3C. 27 March 2018. W3C Recommendation. URL:
          <a href=
          "https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
        </dd>
        <dt id="bib-infra">[INFRA]</dt>
        <dd>
          <a href="https://infra.spec.whatwg.org/"><cite>Infra
          Standard</cite></a>. Anne van Kesteren; Domenic Denicola.
          WHATWG. Living Standard. URL: <a href=
          "https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-json-ld">[JSON-LD]</dt>
        <dd>
          <a href="https://www.w3.org/TR/json-ld/"><cite>JSON-LD
          1.0</cite></a>. Manu Sporny; Gregg Kellogg; Markus
          Lanthaler. W3C. 16 January 2014. W3C Recommendation. URL:
          <a href=
          "https://www.w3.org/TR/json-ld/">https://www.w3.org/TR/json-ld/</a>
        </dd>
        <dt id="bib-mimesniff">[MIMESNIFF]</dt>
        <dd>
          <a href="https://mimesniff.spec.whatwg.org/"><cite>MIME
          Sniffing Standard</cite></a>. Gordon P. Hemsley. WHATWG.
          Living Standard. URL: <a href=
          "https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-rfc2119">[RFC2119]</dt>
        <dd>
          <a href="https://tools.ietf.org/html/rfc2119"><cite>Key
          words for use in RFCs to Indicate Requirement
          Levels</cite></a>. S. Bradner. IETF. March 1997. Best
          Current Practice. URL: <a href=
          "https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
        </dd>
        <dt id="bib-rfc8174">[RFC8174]</dt>
        <dd>
          <a href=
          "https://tools.ietf.org/html/rfc8174"><cite>Ambiguity of
          Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>.
          B. Leiba. IETF. May 2017. Best Current Practice. URL:
          <a href=
          "https://tools.ietf.org/html/rfc8174">https://tools.ietf.org/html/rfc8174</a>
        </dd>
        <dt id="bib-typescript">[TYPESCRIPT]</dt>
        <dd>
          <a href=
          "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
          <cite>TypeScript Language Specification</cite></a>.
          Microsoft. 1 October 2012. URL: <a href=
          "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
          https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md</a>
        </dd>
        <dt id="bib-url">[URL]</dt>
        <dd>
          <a href="https://url.spec.whatwg.org/"><cite>URL
          Standard</cite></a>. Anne van Kesteren. WHATWG. Living
          Standard. URL: <a href=
          "https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-webappsec">[WEBAPPSEC]</dt>
        <dd>
          <a href=
          "https://w3c.github.io/webappsec/specs/powerfulfeatures"><cite>
          Secure Contexts</cite></a>. W3C. 17 July 2015. URL:
          <a href=
          "https://w3c.github.io/webappsec/specs/powerfulfeatures">https://w3c.github.io/webappsec/specs/powerfulfeatures</a>
        </dd>
        <dt id="bib-webidl">[WEBIDL]</dt>
        <dd>
          <a href="https://heycam.github.io/webidl/"><cite>Web
          IDL</cite></a>. Boris Zbarsky. W3C. 15 December 2016. W3C
          Editor's Draft. URL: <a href=
          "https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
        </dd>
        <dt id="bib-wot-architecture">[WOT-ARCHITECTURE]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/2019/CR-wot-architecture-20190516/"><cite>Web of
          Things Architecture</cite></a>. W3C. 16 May 2019. URL:
          <a href=
          "https://www.w3.org/TR/2019/CR-wot-architecture-20190516/">https://www.w3.org/TR/2019/CR-wot-architecture-20190516/</a>
        </dd>
        <dt id="bib-wot-protocol-bindings">
        [WOT-PROTOCOL-BINDINGS]</dt>
        <dd>
          <a href=
          "https://w3c.github.io/wot-binding-templates/"><cite>Web
          of Things Protocol Binding Templates</cite></a>. W3C. 20
          August 2017. URL: <a href=
          "https://w3c.github.io/wot-binding-templates/">https://w3c.github.io/wot-binding-templates/</a>
        </dd>
        <dt id="bib-wot-security-best-practices">
        [WOT-SECURITY-BEST-PRACTICES]</dt>
        <dd>
          <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md">
          <cite>Web of Things Security and Privacy Best
          Practices</cite></a>. W3C. WIP. URL: <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md">
          https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md</a>
        </dd>
        <dt id="bib-wot-security-guidelines">
        [WOT-SECURITY-GUIDELINES]</dt>
        <dd>
          <a href="https://w3c.github.io/wot-security/"><cite>Web
          of Things Security and Privacy Guidelines</cite></a>.
          W3C. 28 August 2017. URL: <a href=
          "https://w3c.github.io/wot-security/">https://w3c.github.io/wot-security/</a>
        </dd>
        <dt id="bib-wot-security-testing">
        [WOT-SECURITY-TESTING]</dt>
        <dd>
          <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md">
          <cite>Web of Things Security Testing and
          Validation</cite></a>. W3C. WIP. URL: <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md">
          https://github.com/w3c/wot-security/blob/master/wot-security-testing.md</a>
        </dd>
        <dt id="bib-wot-td">[WOT-TD]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/"><cite>WoT
          Thing Description</cite></a> . W3C. 16 May 2019. URL:
          <a href=
          "https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/">https://www.w3.org/TR/2019/CR-wot-thing-description-20190516/</a>
        </dd>
      </dl>
    </section>
  </section>
  <p role="navigation" id="back-to-top"><a href=
  "#toc"><abbr title="Back to Top">↑</abbr></a></p>
  <script src=
  "https://www.w3.org/scripts/TR/2016/fixup.js"></script>
</body>
</html>
