<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.2.0" />
<meta charset="utf-8" />
<meta name="generator" content="ReSpec 23.4.0" />
<meta name="viewport" content=
"width=device-width, initial-scale=1, shrink-to-fit=no" />
<style>
<![CDATA[
  /* --- EXAMPLES --- */
  span.example-title {
    text-transform: none;
  }
  aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  div.illegal-example { color: red }
  div.illegal-example p { color: black }
  aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
  }

  aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
  }
  aside.example div.example span.example-title {
    color: #999;
  }
]]>
</style>

<style>
<![CDATA[
  /* --- ISSUES/NOTES --- */
  div.issue-title, div.note-title , div.ednote-title, div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
  }
  div.issue-title { color: #e05252; }
  div.note-title, div.ednote-title { color: #2b2; }
  div.warning-title { color: #f22; }
  div.issue-title span, div.note-title span, div.ednote-title span, div.warning-title span {
    text-transform: uppercase;
  }
  div.note, div.issue, div.ednote, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
  }
  .note > p:first-child, .ednote > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
  .issue, .note, .ednote, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
  }
  div.issue, div.note , div.ednote,  div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  span.note, span.ednote, span.issue, span.warning { padding: .1em .5em .15em; }

  .issue {
    border-color: #e05252;
    background: #fbe9e9;
  }
  .issue.closed span.issue-number {
    text-decoration: line-through;
  }

  .note, .ednote {
    border-color: #52e052;
    background: #e9fbe9;
  }

  .warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
  }

  .warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
  }

  li.task-list-item {
    list-style: none;
  }

  input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
  }

  .issue a.respec-gh-label {
  padding: 5px;
  margin: 0 2px 0 2px;
  font-size: 10px;
  text-transform: none;
  text-decoration: none;
  font-weight: bold;
  border-radius: 4px;
  position: relative;
  bottom: 2px;
  }

  .issue a.respec-label-dark {
  color: #fff;
  background-color: #000;
  }

  .issue a.respec-label-light {
  color: #000;
  background-color: #fff;
  }
]]>
</style>

<style>
<![CDATA[
  /* --- WEB IDL --- */

  pre.idl {
  padding: 1em;
  }

  @media print {
  pre.idl {
    white-space: pre-wrap;
  }
  }

  pre.idl::before {
  content: "WebIDL";
  display: block;
  width: 150px;
  background: #90b8de;
  color: #fff;
  font-family: sans-serif;
  font-weight: bold;
  margin: -1em 0 1em -1em;
  height: 28px;
  line-height: 28px;  
  }

  .idlType {
  color: #ff4500;
  font-weight: bold;
  text-decoration: none;
  }


  /*.idlModule*/


  /*.idlModuleID*/


  /*.idlInterface*/

  .idlInterfaceID,
  .idlDictionaryID,
  .idlCallbackID,
  .idlEnumID {
  font-weight: bold;
  color: #005a9c;
  }

  a.idlEnumItem {
  color: #000;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  .idlSuperclass {
  font-style: italic;
  color: #005a9c;
  }


  /*.idlAttribute*/

  .idlAttrType,
  .idlFieldType,
  .idlMemberType {
  color: #005a9c;
  }

  .idlAttrName,
  .idlFieldName,
  .idlMemberName {
  color: #ff4500;
  }

  .idlAttrName a,
  .idlFieldName a,
  .idlMemberName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlMethod*/

  .idlMethType,
  .idlCallbackType {
  color: #005a9c;
  }

  .idlMethName {
  color: #ff4500;
  }

  .idlMethName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlCtor*/

  .idlCtorName {
  color: #ff4500;
  }

  .idlCtorName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlParam*/

  .idlParamType {
  color: #005a9c;
  }

  .idlParamName,
  .idlDefaultValue {
  font-style: italic;
  }

  .extAttr {
  color: #666;
  }


  /*.idlSectionComment*/

  .idlSectionComment {
  color: gray;
  }


  /*.idlIterable*/

  .idlIterableKeyType,
  .idlIterableValueType {
  color: #005a9c;
  }


  /*.idlMaplike*/

  .idlMaplikeKeyType,
  .idlMaplikeValueType {
  color: #005a9c;
  }


  /*.idlConst*/

  .idlConstType {
  color: #005a9c;
  }

  .idlConstName {
  color: #ff4500;
  }

  .idlConstName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlException*/

  .idlExceptionID {
  font-weight: bold;
  color: #c00;
  }

  .idlTypedefID,
  .idlTypedefType {
  color: #005a9c;
  }

  .idlRaises,
  .idlRaises a.idlType,
  .idlRaises a.idlType code,
  .excName a,
  .excName a code {
  color: #c00;
  font-weight: normal;
  }

  .excName a {
  font-family: monospace;
  }

  .idlRaises a.idlType,
  .excName a.idlType {
  border-bottom: 1px dotted #c00;
  }

  .excGetSetTrue,
  .excGetSetFalse,
  .prmNullTrue,
  .prmNullFalse,
  .prmOptTrue,
  .prmOptFalse {
  width: 45px;
  text-align: center;
  }

  .excGetSetTrue,
  .prmNullTrue,
  .prmOptTrue {
  color: #0c0;
  }

  .excGetSetFalse,
  .prmNullFalse,
  .prmOptFalse {
  color: #c00;
  }

  .idlImplements a, .idlIncludes a {
  font-weight: bold;
  }

  dl.attributes,
  dl.methods,
  dl.constants,
  dl.constructors,
  dl.fields,
  dl.dictionary-members {
  margin-left: 2em;
  }

  .attributes dt,
  .methods dt,
  .constants dt,
  .constructors dt,
  .fields dt,
  .dictionary-members dt {
  font-weight: normal;
  }

  .attributes dt code,
  .methods dt code,
  .constants dt code,
  .constructors dt code,
  .fields dt code,
  .dictionary-members dt code {
  font-weight: bold;
  color: #000;
  font-family: monospace;
  }

  .attributes dt code,
  .fields dt code,
  .dictionary-members dt code {
  background: #ffffd2;
  }

  .attributes dt .idlAttrType code,
  .fields dt .idlFieldType code,
  .dictionary-members dt .idlMemberType code {
  color: #005a9c;
  background: transparent;
  font-family: inherit;
  font-weight: normal;
  font-style: italic;
  }

  .methods dt code {
  background: #d9e6f8;
  }

  .constants dt code {
  background: #ddffd2;
  }

  .constructors dt code {
  background: #cfc;
  }

  .attributes dd,
  .methods dd,
  .constants dd,
  .constructors dd,
  .fields dd,
  .dictionary-members dd {
  margin-bottom: 1em;
  }

  table.parameters,
  table.exceptions {
  border-spacing: 0;
  border-collapse: collapse;
  margin: 0.5em 0;
  width: 100%;
  }

  table.parameters {
  border-bottom: 1px solid #90b8de;
  }

  table.exceptions {
  border-bottom: 1px solid #deb890;
  }

  .parameters th,
  .exceptions th {
  color: inherit;
  padding: 3px 5px;
  text-align: left;
  font-weight: normal;
  }

  .parameters th {
  color: #fff;
  background: #005a9c;
  }

  .exceptions th {
  background: #deb890;
  }

  .parameters td,
  .exceptions td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  vertical-align: top;
  }

  .parameters tr:first-child td,
  .exceptions tr:first-child td {
  border-top: none;
  }

  .parameters td.prmName,
  .exceptions td.excName,
  .exceptions td.excCodeName {
  width: 100px;
  }

  .parameters td.prmType {
  width: 120px;
  }

  table.exceptions table {
  border-spacing: 0;
  border-collapse: collapse;
  width: 100%;
  }

  .respec-button-copy-paste:focus {
  text-decoration: none;
  border-color: #51a7e8;
  outline: none;
  box-shadow: 0 0 5px rgba(81, 167, 232, 0.5);
  }

  .respec-button-copy-paste:focus:hover,
  .respec-button-copy-paste.selected:focus {
  border-color: #51a7e8;
  }

  .respec-button-copy-paste:hover,
  .respec-button-copy-paste:active,
  .respec-button-copy-paste.zeroclipboard-is-hover,
  .respec-button-copy-paste.zeroclipboard-is-active {
  text-decoration: none;
  background-color: #ddd;
  background-image: linear-gradient(#eee, #ddd);
  border-color: #ccc;
  }

  .respec-button-copy-paste:active,
  .respec-button-copy-paste.selected,
  .respec-button-copy-paste.zeroclipboard-is-active {
  background-color: #dcdcdc;
  background-image: none;
  border-color: #b5b5b5;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15)
  }

  .respec-button-copy-paste.selected:hover {
  background-color: #cfcfcf;
  }

  .respec-button-copy-paste:disabled,
  .respec-button-copy-paste:disabled:hover,
  .respec-button-copy-paste.disabled,
  .respec-button-copy-paste.disabled:hover {
  color: rgba(102, 102, 102, 0.5);
  cursor: default;
  background-color: rgba(229, 229, 229, 0.5);
  background-image: none;
  border-color: rgba(197, 197, 197, 0.5);
  box-shadow: none;
  }
]]>
</style>
<title>Web of Things (WoT) Scripting API</title>

<style id="respec-mainstyle">
<![CDATA[
  /*****************************************************************
  * ReSpec 3 CSS
  * Robin Berjon - http://berjon.com/
  *****************************************************************/

  /* Override code highlighter background */
  .hljs {
  background: transparent !important;
  }

  /* --- INLINES --- */
  h1 abbr,
  h2 abbr,
  h3 abbr,
  h4 abbr,
  h5 abbr,
  h6 abbr,
  a abbr {
  border: none;
  }

  dfn {
  font-weight: bold;
  }

  a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
  }

  a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  a.bibref {
  text-decoration: none;
  }

  #references :target {
  background: #eaf3ff;
  }

  cite .bibref {
  font-style: normal;
  }

  code {
  color: #c83500;
  }

  th code {
  color: inherit;
  }

  /* --- TOC --- */

  .toc a,
  .tof a {
  text-decoration: none;
  }

  a .secno,
  a .figno {
  color: #000;
  }

  ul.tof,
  ol.tof {
  list-style: none outside none;
  }

  .caption {
  margin-top: 0.5em;
  font-style: italic;
  }

  /* --- TABLE --- */

  table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
  }

  .simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
  }

  .simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
  }

  .simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  }

  .simple tr:nth-child(even) {
  background: #f0f6ff;
  }

  /* --- DL --- */

  .section dd>p:first-child {
  margin-top: 0;
  }

  .section dd>p:last-child {
  margin-bottom: 0;
  }

  .section dd {
  margin-bottom: 1em;
  }

  .section dl.attrs dd,
  .section dl.eldef dd {
  margin-bottom: 0;
  }

  #issue-summary>ul,
  .respec-dfn-list {
  column-count: 2;
  }

  #issue-summary li,
  .respec-dfn-list li {
  list-style: none;
  }

  details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
  }

  details.respec-tests-details>* {
  padding-right: 2em;
  }

  details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: 0.3em;
  background-color: white;
  padding-bottom: 0.5em;
  }

  details.respec-tests-details[open]>summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
  }

  details.respec-tests-details>ul {
  width: 100%;
  margin-top: -0.3em;
  }

  details.respec-tests-details>li {
  padding-left: 1em;
  }

  a[href].self-link:hover {
  opacity: 1;
  text-decoration: none;
  background-color: transparent;
  }

  h2,
  h3,
  h4,
  h5,
  h6 {
  position: relative;
  }

  aside.example .marker > a.self-link {
  color: inherit;
  }

  h2>a.self-link,
  h3>a.self-link,
  h4>a.self-link,
  h5>a.self-link,
  h6>a.self-link {
  border: none;
  color: inherit;
  font-size: 83%;
  height: 2em;
  left: -1.6em;
  opacity: .5;
  position: absolute;
  text-align: center;
  text-decoration: none;
  top: 0;
  transition: opacity .2s;
  width: 2em;
  }

  h2>a.self-link::before,
  h3>a.self-link::before,
  h4>a.self-link::before,
  h5>a.self-link::before,
  h6>a.self-link::before {
  content: "§";
  display: block;
  }

  @media (max-width: 767px) {
  dd {
    margin-left: 0;
  }

  /* Don't position self-link in headings off-screen */
  h2>a.self-link,
  h3>a.self-link,
  h4>a.self-link,
  h5>a.self-link,
  h6>a.self-link {
    left: auto;
    top: auto;
  }
  }

  @media print {
  .removeOnSave {
    display: none;
  }
  }
]]>
</style>

<style>
<![CDATA[
  /*

  github.com style (c) Vasily Polovnyov <vast@whiteants.net>

  */

  .hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
  }

  .hljs-comment,
  .hljs-quote {
  color: #998;
  font-style: italic;
  }

  .hljs-keyword,
  .hljs-selector-tag,
  .hljs-subst {
  color: #333;
  font-weight: bold;
  }

  .hljs-number,
  .hljs-literal,
  .hljs-variable,
  .hljs-template-variable,
  .hljs-tag .hljs-attr {
  color: #008080;
  }

  .hljs-string,
  .hljs-doctag {
  color: #d14;
  }

  .hljs-title,
  .hljs-section,
  .hljs-selector-id {
  color: #900;
  font-weight: bold;
  }

  .hljs-subst {
  font-weight: normal;
  }

  .hljs-type,
  .hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
  }

  .hljs-tag,
  .hljs-name,
  .hljs-attribute {
  color: #000080;
  font-weight: normal;
  }

  .hljs-regexp,
  .hljs-link {
  color: #009926;
  }

  .hljs-symbol,
  .hljs-bullet {
  color: #990073;
  }

  .hljs-built_in,
  .hljs-builtin-name {
  color: #0086b3;
  }

  .hljs-meta {
  color: #999;
  font-weight: bold;
  }

  .hljs-deletion {
  background: #fdd;
  }

  .hljs-addition {
  background: #dfd;
  }

  .hljs-emphasis {
  font-style: italic;
  }

  .hljs-strong {
  font-weight: bold;
  }
]]>
</style>
<link rel="stylesheet" href=
"https://www.w3.org/StyleSheets/TR/2016/W3C-WD" />
<link rel="canonical" href=
"https://www.w3.org/TR/wot-scripting-api/" />
<script id="initialUserConfig" type="application/json">
<![CDATA[
  {
  "specStatus": "WD",
  "shortName": "wot-scripting-api",
  "copyrightStart": 2017,
  "noLegacyStyle": true,
  "publishDate": "2018-11-19",
  "previousPublishDate": "2018-04-05",
  "previousMaturity": "",
  "edDraftURI": "https://w3c.github.io/wot-scripting-api/",
  "crEnd": "",
  "inlineCSS": true,
  "noIDLIn": true,
  "format": "markdown",
  "editors": [
    {
      "name": "Zoltan Kis",
      "company": "Intel",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Kazuaki Nimura",
      "company": "Fujitsu Ltd.",
      "companyURL": "https://www.fujitsu.com/"
    },
    {
      "name": "Daniel Peintner",
      "company": "Siemens AG",
      "companyURL": "https://www.siemens.com/"
    },
    {
      "name": "Johannes Hund",
      "note": "Former Editor, when at Siemens AG"
    }
  ],
  "wg": "Web of Things Working Group",
  "wgURI": "https://www.w3.org/WoT/WG/",
  "wgPublicList": "public-wot-wg",
  "issueBase": "https://www.github.com/w3c/wot-scripting-api/issues/",
  "githubAPI": "https://api.github.com/repos/w3c/wot-scripting-api",
  "otherLinks": [
    {
      "key": "Contributors",
      "data": [
        {
          "value": "In the GitHub repository",
          "href": "https://github.com/w3c/wot-scripting-api/graphs/contributors"
        }
      ]
    },
    {
      "key": "Repository",
      "data": [
        {
          "value": "We are on GitHub",
          "href": "https://github.com/w3c/wot-scripting-api"
        },
        {
          "value": "File a bug",
          "href": "https://github.com/w3c/wot-scripting-api/issues"
        }
      ]
    }
  ],
  "localBiblio": {
    "WOT-ARCHITECTURE": {
      "href": "https://w3c.github.io/wot-architecture/",
      "title": "Web of Things Architecture",
      "publisher": "W3C",
      "date": "20 August 2017",
      "id": "wot-architecture"
    },
    "WOT-TD": {
      "href": "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/",
      "title": "WoT Thing Description ",
      "publisher": "W3C",
      "date": "21 October 2018",
      "id": "wot-td"
    },
    "WOT-PROTOCOL-BINDINGS": {
      "href": "https://w3c.github.io/wot-binding-templates/",
      "title": "Web of Things Protocol Binding Templates",
      "publisher": "W3C",
      "date": "20 August 2017"
    },
    "WOT-PRACTICES": {
      "href": "http://w3c.github.io/wot/current-practices/wot-practices.html",
      "title": "Web of Things Current Practices",
      "publisher": "W3C",
      "date": "6 February 2017"
    },
    "WOT-SECURITY-CONSIDERATIONS": {
      "href": "https://w3c.github.io/wot-security/",
      "title": "Web of Things Security and Privacy Considerations",
      "publisher": "W3C",
      "date": "28 August 2017",
      "id": "wot-security-considerations"
    },
    "WOT-SECURITY-BEST-PRACTICES": {
      "href": "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md",
      "title": "Web of Things Security and Privacy Best Practices (WIP)",
      "publisher": "W3C",
      "date": "WIP",
      "id": "wot-security-best-practices"
    },
    "WOT-SECURITY-TESTING": {
      "href": "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md",
      "title": "Web of Things Security Testing and Validation",
      "publisher": "W3C",
      "date": "WIP",
      "id": "wot-security-testing"
    },
    "TYPESCRIPT": {
      "href": "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md",
      "title": "TypeScript Language Specification",
      "publisher": "Microsoft",
      "date": "1 October 2012",
      "id": "typescript"
    },
    "WEBAPPSEC": {
      "href": "https://w3c.github.io/webappsec/specs/powerfulfeatures",
      "title": "Secure Contexts",
      "publisher": "W3C",
      "date": "17 July 2015",
      "id": "webappsec"
    }
  },
  "publishISODate": "2018-11-29T00:00:00.000Z",
  "generatedSubtitle": "Workign Draft 29 November 2018"
  }
]]>
</script>
<meta name="description" content=
"The overall Web of Things (WoT) concepts are described in the WoT Architecture document. The Web of Things is made of entities (Things) that can describe their capabilities in a machine-interpretable format, the Thing Description (TD) and expose these capabilities through the WoT Interface, that is, network interactions modeled as Properties for reading and writing values, Actions to execute remote procedures with or without return values and Events for signaling notifications." />
<style type='text/css'>
.diff-old-a {
  font-size: smaller;
  color: red;
}

.diff-new { background-color: yellow; }
.diff-chg { background-color: lime; }
.diff-new:before,
.diff-new:after
    { content: "\2191" }
.diff-chg:before, .diff-chg:after
    { content: "\2195" }
.diff-old { text-decoration: line-through; background-color: #FBB; }
.diff-old:before,
.diff-old:after
    { content: "\2193" }
:focus { border: thin red solid}
</style>
</head>
<body class="h-entry toc-inline">
<div class="head">
<a href="https://www.w3.org/" class= "logo">
<img alt="W3C" src= "https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72" height="48" />
</a>
<h1 id="title" class="title p-name">
Web
of
Things
(WoT)
Scripting
API
</h1>
<h2>
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Working
Draft
<del class="diff-old">5
April
</del>
<time class="dt-published" datetime="2018-11-29">
<ins class="diff-chg">29
November
</ins>
2018
</time>
</h2>
<dl>
<dt>
This
version:
</dt>
<dd>
<del class="diff-old">https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/
</del>
<a class="u-url" href= "https://www.w3.org/TR/2018/WD-wot-scripting-api-20181129/">
<ins class="diff-chg">https://www.w3.org/TR/2018/WD-wot-scripting-api-20181129/
</ins>
</a>
</dd>
<dt>
Latest
published
version:
</dt>
<dd>
<a href= "https://www.w3.org/TR/wot-scripting-api/">
https://www.w3.org/TR/wot-scripting-api/
</a>
</dd>
<dt>
Latest
editor's
draft:
</dt>
<dd>
<a href= "https://w3c.github.io/wot-scripting-api/">
https://w3c.github.io/wot-scripting-api/
</a>
</dd>
<dt>
Previous
version:
</dt>
<dd>
<del class="diff-old">https://www.w3.org/TR/2017/WD-wot-scripting-api-20170914/
</del>
<a class="u-url" href= "https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/">
<ins class="diff-chg">https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/
</ins>
</a>
</dd>
<dt>
Editors:
</dt>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Zoltan
Kis
</span>
(
<a class="p-org org h-org h-card" href= "https://www.intel.com/">
Intel
</a>
)
</dd>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Kazuaki
Nimura
</span>
(
<a class="p-org org h-org h-card" href= "https://www.fujitsu.com/">
Fujitsu
Ltd.
</a>
)
</dd>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Daniel
Peintner
</span>
(
<a class="p-org org h-org h-card" href= "https://www.siemens.com/">
Siemens
AG
</a>
)
</dd>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Johannes
Hund
</span>
(Former
Editor,
when
at
Siemens
AG)
</dd>
<dt>
Contributors:
</dt>
<dd>
<a href= "https://github.com/w3c/wot-scripting-api/graphs/contributors">
In
the
GitHub
repository
</a>
</dd>
<dt>
Repository:
</dt>
<dd>
<a href="https://github.com/w3c/wot-scripting-api">
We
are
on
GitHub
</a>
</dd>
<dd>
<a href="https://github.com/w3c/wot-scripting-api/issues">
File
a
bug
</a>
</dd>
</dl>
<p class="copyright">
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">
Copyright
</a>
©
2017-2018
<a href="https://www.w3.org/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
</a>
<sup>
®
</sup>
(
<a href= "https://www.csail.mit.edu/">
<abbr title= "Massachusetts Institute of Technology">
MIT
</abbr>
</a>,
<a href= "https://www.ercim.eu/">
<abbr title= "European Research Consortium for Informatics and Mathematics">
ERCIM
</abbr>
</a>,
<a href="https://www.keio.ac.jp/">
Keio
</a>,
<a href= "http://ev.buaa.edu.cn/">
Beihang
</a>
).
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
liability
</a>,
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
trademark
</a>
and
<a rel="license" href= "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">
permissive
document
license
</a>
rules
apply.
</p>
<hr title="Separator for header" />
</div>
<section id="abstract" class="introductory">
<h2>
Abstract
</h2>
<p>
The
<ins class="diff-new">overall
</ins>
<a href="#dfn-web-of-things" class="internalDFN" data-link-type="dfn">
Web
of
Things
</a>
(WoT)
<del class="diff-old">provides
layered
interoperability
between
</del>
<ins class="diff-chg">concepts
are
described
in
the
</ins><a href="https://w3c.github.io/wot-architecture/"><ins class="diff-chg">
WoT
Architecture
</ins></a><ins class="diff-chg">
document.
The
Web
of
</ins>
Things
<ins class="diff-new">is
made
of
entities
(
</ins><a href="#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Thing
</ins>
</a>
<del class="diff-old">by
using
</del>
<ins class="diff-chg">s)
that
can
describe
their
capabilities
in
a
machine-interpretable
format,
the
</ins><a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
Description
</ins></a><ins class="diff-chg">
(TD)
and
expose
these
capabilities
through
</ins>
the
<a href= "#dfn-wot-interface" class="internalDFN" data-link-type="dfn">
WoT
Interface
</a>,
<ins class="diff-new">that
is,
network
interactions
modeled
as
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Properties
</ins>
</a>
<del class="diff-old">s.
</del>
<ins class="diff-chg">for
reading
and
writing
values,
</ins><a href= "#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
s
to
execute
remote
procedures
with
or
without
return
values
and
</ins><a href="#dfn-events" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Event
</ins></a><ins class="diff-chg">
s
for
signaling
notifications.
</ins>
</p>
<p>
This
specification
describes
a
programming
interface
representing
the
<a href="#dfn-wot-interface" class="internalDFN" data-link-type="dfn">
WoT
Interface
</a>
that
allows
scripts
run
on
a
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
to
discover
and
consume
(retrieve)
other
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
<ins class="diff-new">Description
</ins>
</a>
s
and
to
expose
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Things
</a>
characterized
by
<a href="#dfn-wot-interactions" class="internalDFN" data-link-type="dfn">
WoT
Interactions
<del class="diff-old">,
i.e.
Properties
,
Actions
</del>
</a>
<del class="diff-old">and
Events
.
</del>
<ins class="diff-chg">specified
by
a
script.
</ins>
</p>
<p>
Scripting
is
an
optional
"convenience"
building
block
in
WoT
and
it
is
typically
used
in
gateways
that
are
able
to
run
a
<a href= "#dfn-wot-runtime" class="internalDFN" data-link-type="dfn">
WoT
Runtime
</a>
and
<a href= "https://github.com/w3c/wot-scripting-api/tree/master/applications/script-manager">
script
management
</a>,
providing
a
convenient
way
to
extend
WoT
support
to
new
types
of
endpoints
and
implement
WoT
applications
like
<a href= "https://github.com/w3c/wot-scripting-api/tree/master/applications/thing-directory">
Thing
Directory
</a>.
</p>
</section>
<section id="sotd" class="introductory">
<h2>
Status
of
This
Document
</h2>
<p>
<em>
This
section
describes
the
status
of
this
document
at
the
time
of
its
publication.
Other
documents
may
supersede
this
document.
A
list
of
current
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
publications
and
the
latest
revision
of
this
technical
report
can
be
found
in
the
<a href= "https://www.w3.org/TR/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
technical
reports
index
</a>
at
https://www.w3.org/TR/.
</em>
</p>
<p>
Implementers
need
to
be
aware
that
this
specification
is
considered
unstable.
Vendors
interested
in
implementing
this
specification
before
it
eventually
reaches
the
Candidate
Recommendation
phase
should
subscribe
to
the
<a href= "https://github.com/w3c/wot-scripting-api">
repository
</a>
and
take
part
in
the
discussions.
</p>
<div class="ednote" id="issue-container-generatedID">
<div role="heading" class="ednote-title marker" id="h-ednote" aria-level="3">
<span>
Editor's
note
</span>
<span style= "text-transform: none">:
The
W3C
WoT
WG
is
asking
for
feedback
</span>
</div>
<p class="">
Please
contribute
to
this
draft
using
the
<a href= "https://github.com/w3c/wot-scripting-api/issues">
GitHub
Issue
</a>
feature
of
the
<a href= "https://github.com/w3c/wot-scripting-api/">
WoT
Scripting
API
</a>
repository.
For
feedback
on
security
and
privacy
considerations,
please
use
the
<a href= "https://github.com/w3c/wot-security/issues">
WoT
Security
and
Privacy
</a>
Issues.
</p>
</div>
<p>
This
document
was
published
by
the
<a href= "https://www.w3.org/WoT/WG/">
Web
of
Things
Working
Group
</a>
as
a
Working
Draft.
This
document
is
intended
to
become
a
W3C
Recommendation.
</p>
<p>
Comments
regarding
this
document
are
welcome.
Please
send
them
to
<a href="mailto:public-wot-wg@w3.org">
public-wot-wg@w3.org
</a>
(
<del class="diff-old">subscribe
,
</del>
<a href= "https://lists.w3.org/Archives/Public/public-wot-wg/">
archives
</a>
).
</p>
<p>
Changes
from
the
previous
publication
can
be
found
in
<a href= "#changes">
Appendix
<del class="diff-old">A
</del>
<ins class="diff-chg">B
</ins>
</a>.
A
<a href="diff.html">
diff-marked
version
</a>
of
this
document
is
also
available
for
comparison
purposes.
</p>
<p>
Publication
as
a
Working
Draft
does
not
imply
endorsement
by
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Membership.
This
is
a
draft
document
and
may
be
updated,
replaced
or
obsoleted
by
other
documents
at
any
time.
It
is
inappropriate
to
cite
this
document
as
other
than
work
in
progress.
</p>
<p>
This
document
was
produced
by
a
group
operating
under
the
<a href="https://www.w3.org/Consortium/Patent-Policy/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
<abbr title="World Wide Web Consortium">
W3C
</abbr>
maintains
a
<a rel="disclosure" href= "https://www.w3.org/2004/01/pp-impl/95969/status">
public
list
of
any
patent
disclosures
</a>
made
in
connection
with
the
deliverables
of
the
group;
that
page
also
includes
instructions
for
disclosing
a
patent.
An
individual
who
has
actual
knowledge
of
a
patent
which
the
individual
believes
contains
<a href= "https://www.w3.org/Consortium/Patent-Policy/#def-essential">
Essential
Claim(s)
</a>
must
disclose
the
information
in
accordance
with
<a href= "https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">
section
6
of
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
</p>
<p>
This
document
is
governed
by
the
<a id="w3c_process_revision" href="https://www.w3.org/2018/Process-20180201/">
1
February
2018
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Process
Document
</a>.
</p>
</section>
<nav id="toc">
<h2 class="introductory" id="table-of-contents">
Table
of
Contents
</h2>
<ol class="toc">
<li class="tocline">
<a href="#introduction" class= "tocxref">
<span class="secno">
1.
</span>
Introduction
</a>
</li>
<li class="tocline">
<a href="#use-cases" class= "tocxref">
<span class="secno">
2.
</span>
Use
Cases
</a>
<ol class="toc">
<li class="tocline">
<a href="#discovery" class= "tocxref">
<span class="secno">
2.1
</span>
Discovery
</a>
</li>
<li class="tocline">
<a href="#consuming-a-thing" class= "tocxref">
<span class="secno">
2.2
</span>
Consuming
a
Thing
</a>
</li>
<li class="tocline">
<a href="#exposing-a-thing" class= "tocxref">
<span class="secno">
2.3
</span>
Exposing
a
Thing
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-wot-object" class= "tocxref">
<span class="secno">
3.
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "WoT">
<code>
WoT
</code>
</span>
object
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-discover-method" class= "tocxref">
<span class="secno">
3.1
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="operation" data-title= "discover()" data-type="Observable" data-lt= "wot.discover()|wot.discover|discover()|discover">
<code>
discover()
</code>
</span>
method
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-discoverymethod-enumeration" class="tocxref">
<span class="secno">
3.1.1
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title="DiscoveryMethod">
<code>
DiscoveryMethod
</code>
</span>
enumeration
</a>
</li>
<li class="tocline">
<a href="#the-thingfilter-dictionary" class= "tocxref">
<span class="secno">
3.1.2
</span>
The
<span data-dfn-for= "" data-dfn-type="dfn" data-idl="dictionary" data-title= "ThingFilter">
<code>
ThingFilter
</code>
</span>
dictionary
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-fetch-method" class= "tocxref">
<span class="secno">
3.2
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="operation" data-title="fetch()" data-type="Promise" data-lt= "wot.fetch()|wot.fetch|fetch()|fetch">
<code>
fetch()
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-consume-method" class= "tocxref">
<span class="secno">
3.3
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="operation" data-title= "consume()" data-type="ConsumedThing" data-lt= "wot.consume()|wot.consume|consume()|consume">
<code>
<del class="diff-old">ThingDescription
</del>
<ins class="diff-chg">consume()
</ins>
</code>
</span>
<del class="diff-old">type
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-produce-method" class= "tocxref">
<span class="secno">
3.4
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="operation" data-title= "produce()" data-type="ExposedThing" data-lt= "wot.produce()|wot.produce|produce()|produce">
<code>
<del class="diff-old">consume()
</del>
<ins class="diff-chg">produce()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-register-method" class= "tocxref">
<span class="secno">
3.5
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="operation" data-title= "register()" data-type="Promise" data-lt= "wot.register()|wot.register|register()|register">
<code>
<del class="diff-old">produce()
</del>
<ins class="diff-chg">register()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-unregister-method" class= "tocxref">
<span class="secno">
3.6
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="operation" data-title= "unregister()" data-type="Promise" data-lt= "wot.unregister()|wot.unregister|unregister()|unregister">
<code>
<del class="diff-old">ThingModel
</del>
<ins class="diff-chg">unregister()
</ins>
</code>
</span>
<del class="diff-old">type
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#examples" class= "tocxref">
<span class="secno">
3.7
</span>
<del class="diff-old">The
SemanticAnnotations
dictionary
3.8
The
SemanticType
dictionary
</del>
<ins class="diff-chg">Examples
</ins>
</a>
</li>
<del class="diff-old">3.9
The
SemanticMetadata
dictionary
</del>
</ol>
</li>
<li class="tocline">
<a href="#the-consumedthing-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">3.10
</del>
<ins class="diff-chg">4.
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "ConsumedThing">
<code>
<del class="diff-old">ThingTemplate
</del>
<ins class="diff-chg">ConsumedThing
</ins>
</code>
</span>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">interface
</ins>
</a>
<ol class="toc">
<li class="tocline">
<a href="#examples-0" class= "tocxref">
<span class="secno">
<del class="diff-old">3.11
</del>
<ins class="diff-chg">4.1
</ins>
</span>
Examples
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-exposedthing-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">4.
</del>
<ins class="diff-chg">5.
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "ExposedThing">
<code>
<del class="diff-old">ConsumedThing
</del>
<ins class="diff-chg">ExposedThing
</ins>
</code>
</span>
interface
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-expose-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.1
</del>
<ins class="diff-chg">5.1
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "expose()" data-type="Promise" data-lt= "exposedthing.expose()|exposedthing.expose|expose()|expose">
<code>
<del class="diff-old">name
</del>
<ins class="diff-chg">expose()
</ins>
</code>
</span>
<del class="diff-old">property
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-destroy-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">5.2
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "destroy()" data-type="Promise" data-lt= "exposedthing.destroy()|exposedthing.destroy|destroy()|destroy">
<code>
<del class="diff-old">getThingDescription()
</del>
<ins class="diff-chg">destroy()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-addproperty-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.3
</del>
<ins class="diff-chg">5.3
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "addProperty()" data-type="ExposedThing" data-lt= "exposedthing.addproperty()|exposedthing.addproperty|addproperty()|addproperty">
<code>
<del class="diff-old">readProperty()
</del>
<ins class="diff-chg">addProperty()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-removeproperty-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">5.4
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "removeProperty()" data-type="ExposedThing" data-lt= "exposedthing.removeproperty()|exposedthing.removeproperty|removeproperty()|removeproperty">
<code>
<del class="diff-old">writeProperty()
</del>
<ins class="diff-chg">removeProperty()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-addaction-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.5
</del>
<ins class="diff-chg">5.5
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "addAction()" data-type="ExposedThing" data-lt= "exposedthing.addaction()|exposedthing.addaction|addaction()|addaction">
<code>
<del class="diff-old">invokeAction()
</del>
<ins class="diff-chg">addAction()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-removeaction-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.6
</del>
<ins class="diff-chg">5.6
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "removeAction()" data-type="ExposedThing" data-lt= "exposedthing.removeaction()|exposedthing.removeaction|removeaction()|removeaction">
<code>
<del class="diff-old">onPropertyChange()
</del>
<ins class="diff-chg">removeAction()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-addevent-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.7
</del>
<ins class="diff-chg">5.7
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "addEvent()" data-type="ExposedThing" data-lt= "exposedthing.addevent()|exposedthing.addevent|addevent()|addevent">
<code>
<del class="diff-old">onEvent()
</del>
<ins class="diff-chg">addEvent()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-removeevent-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.8
</del>
<ins class="diff-chg">5.8
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "removeEvent()" data-type="ExposedThing" data-lt= "exposedthing.removeevent()|exposedthing.removeevent|removeevent()|removeevent">
<code>
<del class="diff-old">onTDChange()
</del>
<ins class="diff-chg">removeEvent()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<del class="diff-old">4.9
Examples
</del>
<a href="#the-propertyreadhandler-callback" class="tocxref">
<span class="secno">
<del class="diff-old">5.
</del>
<ins class="diff-chg">5.9
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="callback" data-title= "PropertyReadHandler">
<code>
<del class="diff-old">ExposedThing
</del>
<ins class="diff-chg">PropertyReadHandler
</ins>
</code>
</span>
<del class="diff-old">interface
</del>
<ins class="diff-chg">callback
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-propertywritehandler-callback" class="tocxref">
<span class="secno">
<del class="diff-old">5.1
</del>
<ins class="diff-chg">5.10
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="callback" data-title= "PropertyWriteHandler">
<code>
<del class="diff-old">start()
</del>
<ins class="diff-chg">PropertyWriteHandler
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">callback
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-actionhandler-callback" class= "tocxref">
<span class="secno">
<del class="diff-old">5.2
</del>
<ins class="diff-chg">5.11
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="callback" data-title= "ActionHandler">
<code>
<del class="diff-old">stop()
</del>
<ins class="diff-chg">ActionHandler
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">callback
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-setpropertyreadhandler-method" class="tocxref">
<span class="secno">
<del class="diff-old">5.3
</del>
<ins class="diff-chg">5.12
</ins>
</span>
The
<span data-dfn-for="exposedthing" data-dfn-type="dfn" data-idl= "operation" data-title="setPropertyReadHandler()" data-type= "ExposedThing" data-lt= "exposedthing.setpropertyreadhandler()|exposedthing.setpropertyreadhandler|setpropertyreadhandler()|setpropertyreadhandler">
<code>
<del class="diff-old">register()
</del>
<ins class="diff-chg">setPropertyReadHandler()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-setpropertywritehandler-method" class="tocxref">
<span class="secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">5.13
</ins>
</span>
The
<span data-dfn-for="exposedthing" data-dfn-type="dfn" data-idl= "operation" data-title="setPropertyWriteHandler()" data-type= "ExposedThing" data-lt= "exposedthing.setpropertywritehandler()|exposedthing.setpropertywritehandler|setpropertywritehandler()|setpropertywritehandler">
<code>
<del class="diff-old">unregister()
</del>
<ins class="diff-chg">setPropertyWriteHandler()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-setactionhandler-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">5.14
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="operation" data-title= "setActionHandler()" data-type="ExposedThing" data-lt= "exposedthing.setactionhandler()|exposedthing.setactionhandler|setactionhandler()|setactionhandler">
<code>
<del class="diff-old">emitEvent()
</del>
<ins class="diff-chg">setActionHandler()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#examples-1" class= "tocxref">
<span class="secno">
<del class="diff-old">5.6
The
DataSchema
</del>
<ins class="diff-chg">5.15
</ins>
</span>
<del class="diff-old">type
</del>
<ins class="diff-chg">Examples
</ins>
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#data-types-and-structures" class= "tocxref">
<span class="secno">
<del class="diff-old">5.7
The
addProperty()
</del>
<ins class="diff-chg">6.
</ins>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">Data
types
and
structures
</ins>
</a>
<ol class="toc">
<li class="tocline">
<a href= "#the-dataschema-dictionary-and-its-subclasses" class= "tocxref">
<span class="secno">
<del class="diff-old">5.7.1
</del>
<ins class="diff-chg">6.1
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "DataSchema">
<code>
<del class="diff-old">ThingProperty
</del>
<ins class="diff-chg">DataSchema
</ins>
</code>
</span>
dictionary
<ins class="diff-new">and
its
subclasses
</ins>
</a>
</li>
<li class="tocline">
<a href= "#the-securityscheme-dictionary-and-its-subclasses" class= "tocxref">
<span class="secno">
<del class="diff-old">5.8
</del>
<ins class="diff-chg">6.2
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "SecurityScheme">
<code>
<del class="diff-old">removeProperty()
</del>
<ins class="diff-chg">SecurityScheme
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
and
its
subclasses
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-link-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.9
</del>
<ins class="diff-chg">6.3
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "Link">
<code>
<del class="diff-old">addAction()
</del>
<ins class="diff-chg">Link
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-form-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.9.1
</del>
<ins class="diff-chg">6.4
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "Form">
<code>
<del class="diff-old">ThingAction
</del>
<ins class="diff-chg">Form
</ins>
</code>
</span>
dictionary
</a>
</li>
<li class="tocline">
<a href="#the-interactionfragment-dictionary" class="tocxref">
<span class="secno">
<del class="diff-old">5.10
</del>
<ins class="diff-chg">6.5
</ins>
</span>
The
<code>
<del class="diff-old">removeAction()
</del>
<span data-dfn-type="dfn">
<ins class="diff-new">InteractionFragment
</ins>
</span>
<del class="diff-old">method
</del>
</code>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-propertyfragment-dictionary" class="tocxref">
<span class="secno">
<del class="diff-old">5.11
</del>
<ins class="diff-chg">6.6
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title="PropertyFragment">
<code>
<del class="diff-old">addEvent()
</del>
<ins class="diff-chg">PropertyFragment
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-actionfragment-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.11.1
</del>
<ins class="diff-chg">6.7
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "ActionFragment">
<code>
<del class="diff-old">ThingEvent
</del>
<ins class="diff-chg">ActionFragment
</ins>
</code>
</span>
dictionary
</a>
</li>
<li class="tocline">
<a href="#the-eventfragment-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.12
</del>
<ins class="diff-chg">6.8
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "EventFragment">
<code>
<del class="diff-old">removeEvent()
</del>
<ins class="diff-chg">EventFragment
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-thingfragment-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.13
</del>
<ins class="diff-chg">6.9
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "ThingFragment">
<code>
<del class="diff-old">PropertyReadHandler
</del>
<ins class="diff-chg">ThingFragment
</ins>
</code>
</span>
<del class="diff-old">callback
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-thingdescription-type" class= "tocxref">
<span class="secno">
<del class="diff-old">5.14
</del>
<ins class="diff-chg">6.10
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="typedef" data-title= "ThingDescription">
<code>
<del class="diff-old">PropertyWriteHandler
</del>
<ins class="diff-chg">ThingDescription
</ins>
</code>
</span>
<del class="diff-old">callback
</del>
<ins class="diff-chg">type
</ins>
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#interfaces-for-wot-interactions" class="tocxref">
<span class="secno">
<del class="diff-old">5.15
</del>
<ins class="diff-chg">7.
</ins>
</span>
<del class="diff-old">The
ActionHandler
</del>
<ins class="diff-chg">Interfaces
for
</ins><span class="formerLink" data-link-type="dfn"><ins class="diff-chg">
WoT
Interactions
</ins>
</span>
<del class="diff-old">callback
</del>
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-interaction-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">5.16
</del>
<ins class="diff-chg">7.1
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "Interaction">
<code>
<del class="diff-old">setPropertyReadHandler()
</del>
<ins class="diff-chg">Interaction
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">interface
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-thingproperty-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">5.17
</del>
<ins class="diff-chg">7.2
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "ThingProperty">
<code>
<del class="diff-old">setPropertyWriteHandler()
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">interface
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-thingaction-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">5.18
</del>
<ins class="diff-chg">7.3
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "ThingAction">
<code>
<del class="diff-old">setActionHandler()
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</span>
<del class="diff-old">method
5.19
Examples
</del>
<ins class="diff-chg">interface
</ins>
</a>
</li>
<del class="diff-old">6.
Experimental
extensions
to
the
ConsumedThing
interface
</del>
<li class="tocline">
<a href="#the-thingevent-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">6.1
</del>
<ins class="diff-chg">7.4
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "ThingEvent">
<code>
<del class="diff-old">getProperties()
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">interface
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-exposedevent-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">6.2
</del>
<ins class="diff-chg">7.5
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "ExposedEvent">
<code>
<del class="diff-old">getActions()
</del>
<ins class="diff-chg">ExposedEvent
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">interface
</ins>
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-emit-method" class= "tocxref">
<span class="secno">
<del class="diff-old">6.3
</del>
<ins class="diff-chg">7.5.1
</ins>
</span>
The
<span data-dfn-for= "exposedevent" data-dfn-type="dfn" data-idl="operation" data-title= "emit()" data-type="void" data-lt= "exposedevent.emit()|exposedevent.emit|emit()|emit">
<code>
<del class="diff-old">getEvents()
</del>
<ins class="diff-chg">emit()
</ins>
</code>
</span>
method
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-value-matching-algorithm" class= "tocxref">
<span class="secno">
<del class="diff-old">6.4
</del>
<ins class="diff-chg">7.6
</ins>
</span>
The
<del class="diff-old">getLinks()
</del>
<span data-dfn-type= "dfn">
<ins class="diff-chg">value-matching
algorithm
</ins>
</span>
<del class="diff-old">method
</del>
<del class="diff-old">6.4.1
The
TDLink
dictionary
</del>
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#observables" class= "tocxref">
<span class="secno">
<del class="diff-old">7.
</del>
<ins class="diff-chg">8.
</ins>
</span>
Observables
</a>
<ol class="toc">
<li class="tocline">
<del class="diff-old">7.1
The
Observer
interface
</del>
<a href="#the-subscription-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">7.2
</del>
<ins class="diff-chg">8.1
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "Subscription">
<code>
Subscription
</code>
</span>
interface
</a>
</li>
<li class="tocline">
<a href="#the-observable-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">7.3
</del>
<ins class="diff-chg">8.2
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="interface" data-title= "Observable">
<code>
Observable
</code>
</span>
interface
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#security" class= "tocxref">
<span class="secno">
<del class="diff-old">8.
</del>
<ins class="diff-chg">9.
</ins>
</span>
Security
and
Privacy
</a>
</li>
<li class="tocline">
<a href="#terminology-and-conventions" class= "tocxref">
<span class="secno">
<del class="diff-old">9.
</del>
<ins class="diff-chg">10.
</ins>
</span>
Terminology
and
conventions
</a>
</li>
<li class="tocline">
<a href="#conformance" class= "tocxref">
<span class="secno">
<del class="diff-old">10.
</del>
<ins class="diff-chg">11.
</ins>
</span>
Conformance
</a>
</li>
<li class="tocline">
<a href="#Changes" class="tocxref">
<span class= "secno">
A.
</span>
Changes
</a>
</li>
<li class="tocline">
<a href="#openissues" class= "tocxref">
<span class="secno">
B.
</span>
Open
issues
</a>
</li>
<li class="tocline">
<a href="#acknowledgements" class= "tocxref">
<span class="secno">
C.
</span>
<del class="diff-old">Acknowledgements
</del>
<ins class="diff-chg">Acknowledgments
</ins>
</a>
</li>
<li class="tocline">
<a href="#references" class= "tocxref">
<span class="secno">
D.
</span>
References
</a>
<ol class="toc">
<li class="tocline">
<a href="#normative-references" class= "tocxref">
<span class="secno">
D.1
</span>
Normative
references
</a>
</li>
<li class="tocline">
<a href="#informative-references" class= "tocxref">
<span class="secno">
D.2
</span>
Informative
references
</a>
</li>
</ol>
</li>
</ol>
</nav>
<section id="introduction">
<h2 id="x1-introduction">
<span class="secno">
1.
</span>
Introduction
<a class="self-link" aria-label="§" href= "#introduction">
</a>
</h2>
<p>
<del class="diff-old">The
overall
</del>
WoT
<del class="diff-old">concepts
are
described
in
the
WoT
Architecture
document.
The
Web
of
Things
is
made
of
entities
(
Thing
s)
that
can
describe
their
capabilities
in
a
machine-interpretable
format,
the
</del>
<ins class="diff-chg">provides
layered
interoperability
based
on
how
</ins><a href= "#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">Description
</del>
</a>
<del class="diff-old">(TD)
</del>
<ins class="diff-chg">s
are
modeled:
as
being
"consumed"
</ins>
and
<del class="diff-old">expose
these
capabilities
through
the
WoT
Interface
.
Support
for
scripting
is
optional
for
WoT
devices.
</del>
<ins class="diff-chg">"exposed".
</ins>
</p>
<p>
By
<a href="#dfn-consume" class="internalDFN" data-link-type= "dfn">
consuming
a
TD
</a>,
a
client
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
creates
a
runtime
resource
model
that
allows
accessing
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Properties
</a>,
<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
and
<a href="#dfn-events" class="internalDFN" data-link-type= "dfn">
Events
</a>
exposed
by
the
server
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">exposed
on
a
remote
device.
</ins>
</p>
<p>
Exposing
a
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
requires
defining
a
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
(TD)
and
instantiating
a
software
stack
<del class="diff-old">needed
</del>
to
serve
requests
for
accessing
the
exposed
<a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
Properties
</a>,
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
and
<a href="#dfn-events" class= "internalDFN" data-link-type="dfn">
Events
</a>.
This
specification
describes
how
to
expose
and
consume
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
s
by
a
script.
</p>
<div class="note" id="issue-container-generatedID-0">
<div role="heading" class="note-title marker" id="h-note" aria-level="3">
<span>
Note
</span>
</div>
<p class="">
Typically
scripts
are
meant
to
be
used
on
devices
able
to
provide
resources
(with
a
<a href="#dfn-wot-interface" class= "internalDFN" data-link-type="dfn">
WoT
<del class="diff-old">interface
</del>
<ins class="diff-chg">Interface
</ins>
</a>
)
for
managing
(installing,
updating,
running)
scripts,
such
as
bridges
or
gateways
that
expose
and
control
simpler
devices
as
WoT
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
s.
</p>
</div>
<div class="note" id="issue-container-generatedID-1">
<div role="heading" class="note-title marker" id="h-note-0" aria-level="3">
<span>
Note
</span>
</div>
<p class="">
This
specification
does
not
make
assumptions
on
how
the
<a href="#dfn-wot-runtime" class="internalDFN" data-link-type= "dfn">
WoT
Runtime
</a>
handles
and
runs
scripts,
including
single
or
multiple
tenancy,
script
deployment
and
lifecycle
management.
The
API
already
supports
the
generic
mechanisms
that
make
it
possible
to
implement
script
management,
for
instance
by
exposing
a
manager
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
whose
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
(action
handlers)
implement
script
lifecycle
management
operations.
</p>
</div>
<p>
For
an
introduction
on
how
scripts
could
be
used
in
<a href= "#dfn-web-of-things" class="internalDFN" data-link-type="dfn">
Web
of
Things
</a>,
check
the
<a href= "https://w3c.github.io/wot-scripting-api/primer">
Primer
</a>
document.
For
some
background
on
API
design
decisions
check
the
<a href= "https://w3c.github.io/wot-scripting-api/rationale">
Rationale
</a>
document.
</p>
</section>
<section class="informative" id="use-cases">
<h2 id="x2-use-cases">
<span class="secno">
2.
</span>
Use
Cases
<a class="self-link" aria-label="§" href= "#use-cases">
</a>
</h2>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
The
following
scripting
use
cases
are
supported
in
this
specification:
</p>
<section id="discovery">
<h3 id="x2-1-discovery">
<span class="secno">
2.1
</span>
Discovery
<a class="self-link" aria-label="§" href= "#discovery">
</a>
</h3>
<ul>
<li>
Discover
all
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
in
the
WoT
network
by
sending
a
broadcast
request.
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
running
in
the
local
<a href= "#dfn-wot-runtime" class="internalDFN" data-link-type="dfn">
WoT
Runtime
</a>.
</li>
<li>
Discover
nearby
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s,
for
instance
<ins class="diff-new">connected
</ins>
by
NFC
or
Bluetooth.
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
by
sending
a
discovery
request
to
a
given
registry.
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
by
filters
defined
on
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
s
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
by
semantic
<del class="diff-old">filters.
</del>
<ins class="diff-chg">queries.
</ins>
</li>
<li>
Stop
or
suppress
an
ongoing
discovery
process.
</li>
<li>
Optionally
specify
a
timeout
to
the
discovery
process
after
which
it
is
stopped/suppressed.
</li>
</ul>
</section>
<section id="consuming-a-thing">
<h3 id="x2-2-consuming-a-thing">
<span class="secno">
2.2
</span>
Consuming
a
Thing
<a class="self-link" aria-label="§" href= "#consuming-a-thing">
</a>
</h3>
<ul>
<li>
Fetch
a
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
of
a
<a href= "#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
given
its
URL.
</li>
<li>
<a href="#dfn-consume" class="internalDFN" data-link-type= "dfn">
Consume
a
TD
</a>
of
a
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>,
including
parsing
the
<a href="#dfn-td" class="internalDFN" data-link-type="dfn">
TD
</a>
and
generating
the
protocol
bindings
in
order
to
access
lower
level
functionality.
</li>
<li>
On
a
consumed
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>,
<ul>
<li>
Read
the
value
of
a
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
or
set
of
properties.
</li>
<li>
Set
the
value
of
a
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
or
a
set
of
properties.
</li>
<li>
Observe
value
changes
of
a
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>.
</li>
<li>
Invoke
an
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>.
</li>
<li>
Observe
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Events
</a>
emitted
by
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Observe
changes
to
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
</a>
of
the
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Get
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>.
</li>
<li>
Get
the
list
of
linked
resources
based
on
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>.
</li>
</ul>
</li>
</ul>
</section>
<section id="exposing-a-thing">
<h3 id="x2-3-exposing-a-thing">
<span class="secno">
2.3
</span>
Exposing
a
Thing
<a class="self-link" aria-label="§" href= "#exposing-a-thing">
</a>
</h3>
<ul>
<li>
Exposing
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
includes
generating
the
protocol
bindings
in
order
to
access
lower
level
functionality.
</li>
<li>
Create
a
local
<a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
ExposedThing
</code>
</a>
to
be
exposed,
based
on
a
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
provided
in
string
serialized
format,
or
out
of
a
template
or
an
existing
<a href= "#dom-consumedthing" class="internalDFN" data-link-type= "dfn">
<code>
ConsumedThing
</code>
</a>
object.
</li>
<li>
Add
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
definition
to
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Add
an
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
definition
to
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Add
an
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>
definition
to
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Attach
semantic
information
to
the
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>.
</li>
<li>
Attach
semantic
information
to
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>.
</li>
<li>
Attach
semantic
information
to
an
<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn">
Action
</a>.
</li>
<li>
Attach
semantic
information
to
an
<a href="#dfn-events" class= "internalDFN" data-link-type="dfn">
Event
</a>.
</li>
<li>
Emit
an
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>,
i.e.
notify
all
listeners
subscribed
to
that
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>.
</li>
<li>
Provide
notifications
for
<a href="#dfn-td" class="internalDFN" data-link-type="dfn">
TD
</a>
changes
to
clients
subscribed
to
that.
</li>
<li>
Mark/unmark
the
Thing
to
be
discoverable.
</li>
<li>
Mark/unmark
the
Thing
to
be
consumable.
</li>
<li>
Start
the
exposed
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
in
order
to
process
external
requests.
</li>
<li>
Stop
the
exposed
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>.
</li>
<li>
Register
handlers
for
external
requests:
<ul>
<li>
to
retrieve
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
value;
</li>
<li>
to
update
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
value;
</li>
<li>
to
run
an
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>:
take
the
parameters
from
the
request,
execute
the
defined
action,
and
return
the
result;
</li>
</ul>
</li>
</ul>
</section>
</section>
<section data-dfn-for="WoT" id="the-wot-object">
<h2 id="x3-the-wot-object">
<span class="secno">
3.
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-wot" data-idl= "interface" data-title="WoT">
<code>
WoT
</code>
</dfn>
object
<a class= "self-link" aria-label="§" href="#the-wot-object">
</a>
</h2>
<p>
The
WoT
object
is
the
API
entry
point
and
it
is
exposed
by
an
implementation
of
the
<a href="#dfn-wot-runtime" class= "internalDFN" data-link-type="dfn">
WoT
Runtime
</a>.
The
<dfn data-dfn-type="dfn" id="dfn-wot-object">
WoT
object
</dfn>
does
not
expose
properties,
only
methods
for
discovering,
consuming
and
exposing
a
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>.
</p>
<div class="note" id="issue-container-generatedID-2">
<div role="heading" class="note-title marker" id="h-note-1" aria-level="3">
<span>
Note
</span>
</div>
<p class="">
Browser
implementations
<em class="rfc2119" title= "SHOULD">
SHOULD
</em>
use
a
namespace
object
such
as
<code>
<del class="diff-old">wot
,
and
</del>
<ins class="diff-chg">navigator.wot
</ins></code>.
<a href= "https://nodejs.org/en/">
Node.js
</a>
-like
runtimes
<em class= "rfc2119" title="MAY">
MAY
</em>
provide
the
API
object
through
the
<a href="https://nodejs.org/api/modules.html">
require()
</a>
or
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-imports">
import
</a>
mechanism.
</p>
</div>
<div>
<pre class="def idl"><span class="idlInterface" id="idl-def-wot"
<del class="diff-old">data-idl="" data-title="WoT"&gt;interface &lt;span class=
"idlInterfaceID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-wot" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMethod" id="idl-def-wot-discover-filter" data-idl=
"" data-title="discover" data-dfn-for="wot"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-observable" class="internalDFN"
data-link-type="dfn"&gt;&lt;&lt;a href=
"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="wot" data-lt=
"discover()|discover" href="#dom-wot-discover" class="internalDFN"
data-link-type="dfn"&gt;discover(&lt;span class=
"idlParam"&gt;optional &lt;a href=
"#dom-thingfilter" class="internalDFN" data-link-type=
</del>
<ins class="diff-chg">data-idl="" data-title="WoT"><span class=
"idlSectionComment">// [SecureContext]
// [NamespaceObject]
</ins></span>interface <span class="idlInterfaceID"><a data-no-default=""<ins class="diff-chg">
data-link-for="" data-lt="" href="#dom-wot" class="internalDFN"
data-link-type="dfn"><code>WoT</code></a></span> {<span class=
"idlMethod" id="idl-def-wot-discover-filter" data-idl=""
data-title="discover" data-dfn-for="wot"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-observable" class="internalDFN"<ins class="diff-chg">
data-link-type=
"dfn"><code>Observable</code></a></span> <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt=
"wot.discover()|wot.discover|discover()|discover" href=
"#dom-wot-discover" class="internalDFN" data-link-type=
"dfn"><code>discover</code></a></span>(<span class=
"idlParam">optional<span class="idlParamType"> <a data-link-for=""
href="#dom-thingfilter" class="internalDFN" data-link-type=
</ins>
"dfn"><code>ThingFilter</code></a></span> <span class=
<del class="diff-old">"idlParamName"&gt;filter
&lt;span class="idlMethod" id="idl-def-wot-fetch-url" data-idl=""
data-title="fetch" data-dfn-for="wot"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;&lt;a href="#dom-thingdescription"
class="internalDFN" data-link-type=
</del>
<ins class="diff-chg">"idlParamName">filter</span></span>);</span><span class="idlMethod"
id="idl-def-wot-fetch-url" data-idl="" data-title="fetch"
data-dfn-for="wot"><span class="idlMethType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-link-for=""
href="#dom-thingdescription" class="internalDFN" data-link-type=
</ins>
"dfn"><code>ThingDescription</code></a>&gt;</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
<del class="diff-old">"fetch()|fetch" href="#dom-wot-fetch" class="internalDFN"
data-link-type="dfn"&gt;fetch(&lt;span class=
</del>
<ins class="diff-chg">"wot.fetch()|wot.fetch|fetch()|fetch" href="#dom-wot-fetch" class=
"internalDFN" data-link-type=
"dfn"><code>fetch</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString
&lt;span class="idlMethod" id="idl-def-wot-consume-td" data-idl=""
data-title="consume" data-dfn-for="wot"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-consumedthing" class="internalDFN"
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span></span>);</span><span class="idlMethod"
id="idl-def-wot-consume-td" data-idl="" data-title="consume"
data-dfn-for="wot"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-consumedthing" class="internalDFN"
data-link-type=
<del class="diff-old">"dfn"&gt;&lt;a data-no-default=""
data-link-for="wot" data-lt="consume()|consume" href=
</del>
<ins class="diff-chg">"dfn"><code>ConsumedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"wot.consume()|wot.consume|consume()|consume" href=
</ins>
"#dom-wot-consume" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;consume&lt;span class=
"idlParamType"&gt;&lt;a href="#dom-thingdescription" class="internalDFN"
data-link-type=
</del>
<ins class="diff-chg">"dfn"><code>consume</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a data-link-for="" href=
"#dom-thingdescription" class="internalDFN" data-link-type=
</ins>
"dfn"><code>ThingDescription</code></a></span> <span class=
<del class="diff-old">"idlParamName"&gt;td
&lt;span class="idlMethod" id="idl-def-wot-produce-model" data-idl=""
data-title="produce" data-dfn-for="wot"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-exposedthing" class="internalDFN"
</del>
<ins class="diff-chg">"idlParamName">td</span></span>);</span><span class="idlMethod" id=
"idl-def-wot-produce-model" data-idl="" data-title="produce"
data-dfn-for="wot"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
<del class="diff-old">"dfn"&gt;&lt;a data-no-default=""
data-link-for="wot" data-lt="produce()|produce" href=
"#dom-wot-produce" class="internalDFN" data-link-type=
"dfn"&gt;produce&lt;span class=
"idlParamType"&gt;&lt;a href="#dom-thingmodel" class="internalDFN"
</del>
<ins class="diff-chg">"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"wot.produce()|wot.produce|produce()|produce" href=
"#produce-method" class="internalDFN" data-link-type=
"dfn"><code>produce</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a data-link-for="" href=
"#dom-thingmodel" class="internalDFN" data-link-type=
"dfn"><code>ThingModel</code></a></span> <span class=
"idlParamName">model</span></span>);</span><span class="idlMethod"
id="idl-def-wot-register-directory-thing" data-idl="" data-title=
"register" data-dfn-for="wot"><span class="idlMethType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt=
"wot.register()|wot.register|register()|register" href=
"#dom-wot-register" class="internalDFN" data-link-type=
"dfn"><code>register</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">directory</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlParamName">thing</span></span>);</span><span class="idlMethod"
id="idl-def-wot-unregister-directory-thing" data-idl="" data-title=
"unregister" data-dfn-for="wot"><span class="idlMethType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt=
"wot.unregister()|wot.unregister|unregister()|unregister" href=
"#dom-wot-unregister" class="internalDFN" data-link-type=
"dfn"><code>unregister</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">directory</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlParamName">thing</span></span>);</span>
};</span><span class="idlTypedef" id="idl-def-thingfragment"
data-idl="" data-title="ThingFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-thingfragment" class=
"internalDFN" data-link-type=
"dfn"><code>ThingFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-propertyfragment" data-idl="" data-title=
"PropertyFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertyfragment" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-actionfragment" data-idl="" data-title=
"ActionFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-actionfragment" class=
"internalDFN" data-link-type=
"dfn"><code>ActionFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-eventfragment" data-idl="" data-title=
"EventFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-eventfragment" class=
"internalDFN" data-link-type=
"dfn"><code>EventFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-dataschema" data-idl="" data-title=
"DataSchema">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-dataschema" class=
"internalDFN" data-link-type=
"dfn"><code>DataSchema</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-securityscheme" data-idl="" data-title=
"SecurityScheme">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-securityscheme" class=
"internalDFN" data-link-type=
"dfn"><code>SecurityScheme</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-link" data-idl="" data-title="Link">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-link" class="internalDFN"
</ins>
data-link-type=
<del class="diff-old">"dfn"&gt;
};
&lt;span class="idlTypedef" id="idl-def-thingdescription" data-idl=""
data-title="ThingDescription"&gt;typedef &lt;span class=
"idlTypedefType"&gt;&lt;a href=
</del>
<ins class="diff-chg">"dfn"><code>Link</code></a></span>;</span><span class="idlTypedef"
id="idl-def-form" data-idl="" data-title="Form">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-form" class="internalDFN"
data-link-type=
"dfn"><code>Form</code></a></span>;</span><span class="idlTypedef"
id="idl-def-thingdescription" data-idl="" data-title=
"ThingDescription">
typedef<span class="idlTypedefType"> <a href=
</ins>
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-thingdescription" class=
"internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;
&lt;span class="idlTypedef" id="idl-def-thingmodel" data-idl=""
data-title="ThingModel"&gt;typedef &lt;span class=
"idlTypedefType"&gt;(&lt;a href="#dom-thingtemplate" class="internalDFN"
data-link-type="dfn"&gt; or &lt;a href=
</del>
<ins class="diff-chg">"dfn"><code>ThingDescription</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-thingmodel" data-idl="" data-title=
"ThingModel">
typedef<span class="idlTypedefType"> (<a data-link-for="" href=
"#dom-thingfragment" class="internalDFN" data-link-type=
"dfn"><code>ThingFragment</code></a> or <a data-link-for="" href=
</ins>
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a>)</span> <span class=
"idlTypedefID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingmodel" class="internalDFN" data-link-type=
"dfn">
<code>
ThingModel
</code>
</a>
</span>
;
</span>
</pre>
</div>
<div class="ednote" id="issue-container-generatedID-3">
<div role="heading" class="ednote-title marker" id="h-ednote-0" aria-level="3">
<span>
Editor's
note
</span>
</div>
<p class="">
The
algorithms
for
the
WoT
methods
will
be
specified
later,
including
error
handling
and
security
considerations.
</p>
</div>
<p>
<ins class="diff-new">The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingmodel" data-idl="typedef" data-title= "ThingModel"><code><ins class="diff-new">
ThingModel
</ins></code></dfn><ins class="diff-new">
type
represents
either
a
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingFragment
</ins></code></a>,<ins class="diff-new">
or
a
</ins><a href= "#dom-thingdescription" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingDescription
</ins></code></a>.</p>
<section id="the-discover-method">
<h3 id="x3-1-the-discover-method">
<span class="secno">
3.1
</span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id= "dom-wot-discover" data-idl="operation" data-title="discover()" data-type="Observable" data-lt= "wot.discover()|wot.discover|discover()|discover">
<code>
discover()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href= "#the-discover-method">
</a>
</h3>
<p>
Starts
the
discovery
process
that
will
provide
<a href= "#dom-thingdescription" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ConsumedThing
</del>
<ins class="diff-chg">ThingDescription
</ins>
</code>
</a>
<del class="diff-old">objects
</del>
<ins class="diff-chg">s
</ins>
that
match
the
optional
argument
<var>
<ins class="diff-new">filter
</ins></var><ins class="diff-new">
of
type
</ins>
<code>
<a href="#dom-thingfilter" class="internalDFN" data-link-type= "dfn">
<code>
ThingFilter
</code>
</a>
</code>.
<del class="diff-old">When
the
argument
is
not
provided,
starts
the
widest
discovery
the
Thing
Description
and
Protocol
Bindings
allow
and
support.
</del>
Returns
an
<ins class="diff-chg">[
</ins>
<code>
Observable
</code>
<ins class="diff-chg">](https://github.com/tc39/proposal-observable)
</ins>
object
that
can
be
subscribed
to
and
unsubscribed
from.
<ins class="diff-new">The
handler
function
provided
to
the
Observable
during
subscription
will
receive
an
argument
of
type
</ins><code><ins class="diff-new">
USVString
</ins></code><ins class="diff-new">
representing
a
</ins><a href="#dom-thingdescription" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingDescription
</ins></code></a>.
</p>
<section data-dfn-for="DiscoveryMethod" id= "the-discoverymethod-enumeration">
<h4 id="x3-1-1-the-discoverymethod-enumeration">
<span class= "secno">
3.1.1
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-discoverymethod" data-idl="typedef" data-title= "DiscoveryMethod">
<code>
DiscoveryMethod
</code>
</dfn>
enumeration
<a class="self-link" aria-label="§" href= "#the-discoverymethod-enumeration">
</a>
</h4>
<div>
<pre class="def idl"><span class="idlTypedef" id=
"idl-def-discoverymethod" data-idl="" data-title=
<del class="diff-old">"DiscoveryMethod"&gt;typedef &lt;a href=
</del>
<ins class="diff-chg">"DiscoveryMethod">typedef<span class="idlTypedefType"> <a href=
</ins>
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"dfn">
<code>
DiscoveryMethod
</code>
</a>
</span>
;
</span>
</pre>
</div>
<p>
<a href="#dom-discoverymethod" class="internalDFN" data-link-type="dfn">
<code>
DiscoveryMethod
</code>
</a>
represents
the
discovery
type
to
be
used:
</p>
<ul>
<li>
<dfn data-dfn-type="dfn" id="dfn-any">
"any"
</dfn>
does
not
provide
any
restriction
</li>
<li>
<dfn data-dfn-type="dfn" id="dfn-local">
"local"
</dfn>
for
discovering
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
defined
in
the
same
device
<del class="diff-old">"nearby"
for
discovering
Thing
s
nearby
</del>
<ins class="diff-chg">or
connected
to
</ins>
the
<del class="diff-old">device,
e.g.
</del>
<ins class="diff-chg">device
</ins>
by
<del class="diff-old">Bluetooth
</del>
<ins class="diff-chg">wired
</ins>
or
<del class="diff-old">NFC
</del>
<ins class="diff-chg">wireless
means.
</ins>
</li>
<li>
<dfn data-dfn-type="dfn" id="dfn-directory">
"directory"
</dfn>
for
discovery
based
on
a
service
provided
by
a
<del class="diff-old">directory
or
repository
of
</del>
<a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn">
Thing
<del class="diff-old">s
"broadcast"
for
an
open
ended
discovery
based
on
sending
a
request
to
a
broadcast
address
</del>
<ins class="diff-chg">Directory
</ins></a>.
</li>
<li>
<del class="diff-old">"other"
</del>
<dfn data-dfn-type="dfn" id="dfn-multicast">
<ins class="diff-chg">"multicast"
</ins>
</dfn>
for
<del class="diff-old">a
proprietary
method
defined
by
</del>
<ins class="diff-chg">discovering
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
s
in
</ins>
the
<del class="diff-old">solution.
</del>
<ins class="diff-chg">device's
network
by
using
a
supported
multicast
protocol.
</ins>
</li>
</ul>
</section>
<section data-dfn-for="ThingFilter" id= "the-thingfilter-dictionary">
<h4 id="x3-1-2-the-thingfilter-dictionary">
<span class= "secno">
3.1.2
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingfilter" data-idl="dictionary" data-title= "ThingFilter">
<code>
ThingFilter
</code>
</dfn>
dictionary
<a class= "self-link" aria-label="§" href= "#the-thingfilter-dictionary">
</a>
</h4>
<p>
The
<a href="#dom-thingfilter" class="internalDFN" data-link-type="dfn">
<code>
ThingFilter
</code>
</a>
dictionary
that
represents
the
constraints
for
discovering
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
as
key-value
pairs.
</p>
<div>
<pre class="def idl"><span class="idlDictionary" id=
"idl-def-thingfilter" data-idl="" data-title=
"ThingFilter">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingfilter" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-thingfilter-method" data-idl=""
data-title="method" data-dfn-for="thingfilter"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href="#dom-discoverymethod" class="internalDFN"
data-link-type=
"dfn"&gt;      &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for="thingfilter"
data-lt="" href="#dom-thingfilter-method" class="internalDFN"
data-link-type="dfn"&gt; = &lt;span class=
"idlMemberValue"&gt;"any"
&lt;span class="idlMember" id="idl-def-thingfilter-url" data-idl=""
data-title="url" data-dfn-for="thingfilter"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-no-default=""
</del>
<ins class="diff-chg">"dfn"><code>ThingFilter</code></a></span> {<span class="idlMember"
id="idl-def-thingfilter-method" data-idl="" data-title="method"
data-dfn-for="thingfilter"><span class="idlMemberType">
  (<a data-link-for="" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"dfn"><code>DiscoveryMethod</code></a> or <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>)</span> <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-method" class="internalDFN" data-link-type=
"dfn"><code>method</code></a></span> = <span class=
"idlMemberValue">"any"</span>;</span><span class="idlMember" id=
"idl-def-thingfilter-url" data-idl="" data-title="url"
data-dfn-for="thingfilter"><span class="idlMemberType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <span class="idlMemberName"><a data-no-default=""
</ins>
data-link-for="thingfilter" data-lt="" href="#dom-thingfilter-url"
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingfilter-query" data-idl=""
data-title="query" data-dfn-for="thingfilter"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-no-default=""
</del>
<ins class="diff-chg">"dfn"><code>url</code></a></span>;</span><span class="idlMember"
id="idl-def-thingfilter-query" data-idl="" data-title="query"
data-dfn-for="thingfilter"><span class="idlMemberType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <span class="idlMemberName"><a data-no-default=""
</ins>
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-query" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingfilter-constraints"
data-idl="" data-title="constraints" data-dfn-for=
"thingfilter"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;a data-no-default=""
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-constraints" class="internalDFN" data-link-type=
"dfn"&gt;
</del>
<ins class="diff-chg">"dfn"><code>query</code></a></span>;</span><span class="idlMember"
id="idl-def-thingfilter-fragment" data-idl="" data-title="fragment"
data-dfn-for="thingfilter"><span class="idlMemberType">
</ins>  <a data-link-for="" href="#dom-thingfragment" class="internalDFN"<ins class="diff-chg">
data-link-type=
"dfn"><code>ThingFragment</code></a>?</span> <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingfilter"
data-lt="" href="#dom-thingfilter-fragment" class="internalDFN"
data-link-type="dfn"><code>fragment</code></a></span>;</span>
</ins>
};
</span>
</pre>
</div>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-method" data-idl="field" data-title="method" data-type="DiscoveryMethod|DOMString">
<code>
method
</code>
</dfn>
property
represents
the
discovery
type
that
should
be
used
in
the
discovery
process.
The
possible
values
are
defined
by
the
<code>
<a href="#dom-discoverymethod" class="internalDFN" data-link-type="dfn">
<code>
DiscoveryMethod
</code>
</a>
</code>
enumeration
that
<del class="diff-old">can
</del>
<em class="rfc2119" title="MAY">
<ins class="diff-chg">MAY
</ins></em>
be
extended
by
string
values
defined
by
solutions
(with
no
guarantee
of
interoperability).
</p>
<del class="diff-old">Editor's
note
The
DiscoveryMethod
enumeration
can
be
extended
by
the
Thing
Description
with
values
that
are
not
specified
here.
This
extensibility
of
DiscoveryMethod
by
proprietary
or
private
methods
is
a
working
assumption
until
consensus
is
formed
and
may
be
removed
later.
</del>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-url" data-idl="field" data-title="url" data-type= "USVString">
<code>
url
</code>
</dfn>
property
represents
additional
information
for
the
discovery
method,
such
as
the
URL
of
the
target
entity
serving
the
discovery
request,
<del class="diff-old">such
as
</del>
<ins class="diff-chg">for
instance
</ins>
a
<a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn">
Thing
Directory
</a>
<ins class="diff-new">(if
</ins><code><ins class="diff-new">
method
</ins></code><ins class="diff-new">
is
</ins><code><ins class="diff-new">
"directory"
</ins></code><ins class="diff-new">
)
</ins>
or
a
<del class="diff-old">Thing.
</del>
<ins class="diff-chg">Thing
(otherwise).
</ins>
</p>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-query" data-idl="field" data-title="query" data-type="USVString">
<code>
query
</code>
</dfn>
property
represents
a
query
string
accepted
by
the
implementation,
for
instance
a
SPARQL
<ins class="diff-new">or
JSON
</ins>
query.
<ins class="diff-new">Support
may
be
implemented
locally
in
the
</ins><a href="#dfn-wot-runtime" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
WoT
Runtime
</ins></a><ins class="diff-new">
or
remotely
as
a
service
in
a
</ins><a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Thing
Directory
</ins></a>.
</p>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-fragment" data-idl="field" data-title="fragment" data-type="ThingFragment">
<code>
<del class="diff-old">constraints
</del>
<ins class="diff-chg">fragment
</ins>
</code>
</dfn>
property
represents
<del class="diff-old">additional
information
</del>
<ins class="diff-chg">a
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
ThingFragment
</ins></code></a><ins class="diff-chg">
dictionary
used
</ins>
for
<del class="diff-old">the
discovery
</del>
<ins class="diff-chg">matching
property
by
property
against
discovered
</ins><a href= "#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
s.
</ins></p></section><p><ins class="diff-chg">
The
</ins><code><ins class="diff-chg">
discover(filter)
</ins></code>
method
<del class="diff-old">in
</del>
<em class="rfc2119" title="MUST">
<ins class="diff-chg">MUST
</ins></em><ins class="diff-chg">
run
</ins>
the
<del class="diff-old">form
of
a
list
of
sets
of
property-value
pairs
(dictionaries).
The
list
elements
(dictionaries)
are
in
OR
relationship,
</del>
<ins class="diff-chg">following
steps:
</ins></p><ol><li><ins class="diff-chg">
If
invoking
</ins><code><ins class="diff-chg">
discover()
</ins></code><ins class="diff-chg">
is
not
allowed
for
the
current
scripting
context
for
security
reasons,
throw
</ins><code><ins class="diff-chg">
SecurityError
</ins></code>
and
<del class="diff-old">within
a
constraint
dictionary
</del>
<ins class="diff-chg">terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Return
an
</ins><code><a href="#dom-observable" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
Observable
</ins></code></a></code><var><ins class="diff-chg">
obs
</ins></var><ins class="diff-chg">
and
execute
</ins>
the
<del class="diff-old">key-value
pairs
are
</del>
<ins class="diff-chg">next
steps
</ins><a href= "#dfn-in-parallel" class="internalDFN" data-link-type="dfn">
in
<del class="diff-old">AND
relationship.
Implementations
SHOULD
make
</del>
<ins class="diff-chg">parallel
</ins></a>.</li><li><ins class="diff-chg">
If
</ins><code><ins class="diff-chg">
obs.subscribe(handler,
errorHandler,
complete)
</ins></code><ins class="diff-chg">
is
called,
execute
</ins>
the
following
<del class="diff-old">mapping
from
</del>
<ins class="diff-chg">sub-steps:
</ins><ol><li><ins class="diff-chg">
If
</ins>
the
<del class="diff-old">constraint
dictionaries
</del>
<ins class="diff-chg">first
argument
</ins><var><ins class="diff-chg">
handler
</ins></var><ins class="diff-chg">
is
not
defined
or
it
is
not
a
function,
throw
</ins><code><ins class="diff-chg">
TypeError
</ins></code><ins class="diff-chg">
and
terminate
the
algorithm.
Otherwise
configure
</ins><var><ins class="diff-chg">
handler
</ins></var>
to
<ins class="diff-chg">be
invoked
when
a
discovery
hit
happens.
</ins></li><li><ins class="diff-chg">
If
the
second
argument
</ins><var><ins class="diff-chg">
errorHandler
</ins></var><ins class="diff-chg">
is
defined,
but
it
is
not
a
function,
throw
</ins>
<code>
<del class="diff-old">SemanticAnnotations
</del>
<ins class="diff-chg">TypeError
</ins>
</code>
<del class="diff-old">:
for
each
property-value
pair
</del>
<ins class="diff-chg">and
terminate
these
steps.
Otherwise
if
defined,
save
it
to
be
invoked
</ins>
in
<ins class="diff-new">error
conditions.
</ins></li><li><ins class="diff-new">
If
the
third
argument
</ins><var><ins class="diff-new">
onComplete
</ins></var><ins class="diff-new">
is
defined,
but
it
is
not
</ins>
a
<del class="diff-old">constraint
dictionary,
</del>
<ins class="diff-chg">function,
throw
</ins><code><ins class="diff-chg">
TypeError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
Otherwise
if
defined,
save
it
to
be
invoked
when
the
discovery
process
finished
for
other
reasons
than
having
been
canceled.
</ins></li>
<li>
<del class="diff-old">Each
property
name
in
</del>
<ins class="diff-chg">If
</ins><var><ins class="diff-chg">
filter.query
</ins></var><ins class="diff-chg">
is
defined,
pass
it
as
an
opaque
string
to
</ins>
the
<del class="diff-old">constraint
dictionary
SHOULD
</del>
<ins class="diff-chg">underlying
implementation
to
be
matched
against
discovered
items.
The
underlying
implementation
is
responsible
to
parse
it
e.g.
as
a
SPARQL
or
JSON
query
and
</ins>
match
<ins class="diff-new">it
against
</ins>
the
<del class="diff-old">either
</del>
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
Description
</ins></a><ins class="diff-chg">
s
found
during
</ins>
the
<ins class="diff-new">discovery
process.
If
queries
are
not
supported,
implementations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
throw
a
</ins>
<code>
<del class="diff-old">name
</del>
<ins class="diff-chg">NotSupported
</ins>
</code>
<del class="diff-old">property
of
a
</del>
<ins class="diff-chg">error
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
filter.fragment
</ins></var><ins class="diff-chg">
is
defined,
and
if
it
contains
other
properties
than
the
ones
</ins>
defined
<ins class="diff-chg">in
</ins><a href= "#dom-thingfragment" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">SemanticType
</del>
<ins class="diff-chg">ThingFragment
</ins>
</code>
<del class="diff-old">on
</del>
</a>,
<ins class="diff-chg">throw
</ins><code><ins class="diff-chg">
TypeError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
Otherwise
save
</ins>
the
<del class="diff-old">target
</del>
<ins class="diff-chg">object
for
matching
the
discovered
items
against
it.
</ins></li><li><ins class="diff-chg">
Request
the
underlying
platform
to
start
the
discovery
process,
with
the
following
parameters:
</ins><ul><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
filter.method
</ins></var><ins class="diff-chg">
is
not
defined
or
the
value
is
</ins><code><ins class="diff-chg">
"any"
</ins></code>,<ins class="diff-chg">
use
the
widest
discovery
method
supported
by
the
underlying
platform.
</ins></li><li><ins class="diff-chg">
Otherwise
if
</ins><var><ins class="diff-chg">
filter.method
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"local"
</ins></code>,<ins class="diff-chg">
use
the
local
</ins><a href="#dfn-thing-directory" class="internalDFN" data-link-type="dfn">
Thing
<ins class="diff-new">Directory
</ins>
</a>
<del class="diff-old">object,
</del>
<ins class="diff-chg">for
discovery.
Usually
that
defines
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
s
deployed
in
the
same
device,
</ins>
or
<ins class="diff-new">connected
to
</ins>
the
<del class="diff-old">name
of
</del>
<ins class="diff-chg">device
in
slave
mode
(e.g.
sensors
connected
via
Bluetooth
or
</ins>
a
<del class="diff-old">Property
on
</del>
<ins class="diff-chg">serial
connection).
</ins></li><li><ins class="diff-chg">
Otherwise
if
</ins><var><ins class="diff-chg">
filter.method
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"directory"
</ins></code>,<ins class="diff-chg">
use
</ins>
the
<del class="diff-old">target
</del>
<ins class="diff-chg">remote
</ins><a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn">
Thing
<del class="diff-old">.
</del>
<ins class="diff-chg">Directory
</ins></a><ins class="diff-chg">
specified
in
</ins><var><ins class="diff-chg">
filter.url
</ins></var>.
</li>
<li>
<del class="diff-old">When
</del>
<ins class="diff-chg">Otherwise
if
</ins><var><ins class="diff-chg">
filter.method
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"multicast"
</ins></code>,<ins class="diff-chg">
use
all
</ins>
the
<del class="diff-old">name
matches,
</del>
<ins class="diff-chg">multicast
discovery
protocols
supported
by
</ins>
the
<del class="diff-old">values
are
compared.
</del>
<ins class="diff-chg">underlying
platform.
</ins></li></ul></li></ol></li><li><ins class="diff-chg">
Whenever
a
new
item
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
is
discovered
by
the
underlying
platform,
run
the
following
sub-steps:
</ins><ol><li>
If
<var>
<ins class="diff-new">filter.query
</ins></var><ins class="diff-new">
is
defined,
check
if
</ins><var><ins class="diff-new">
td
</ins></var><ins class="diff-new">
is
a
match
for
</ins>
the
<del class="diff-old">values
match,
</del>
<ins class="diff-chg">query.
The
matching
algorithm
is
encapsulated
by
implementations.
If
that
returns
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
discard
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
and
continue
</ins>
the
<del class="diff-old">constraint
</del>
<ins class="diff-chg">discovery
process.
</ins></li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
filter.fragment
</ins></var>
is
<del class="diff-old">matched.
</del>
<ins class="diff-chg">defined,
for
each
property
defined
in
it,
check
if
that
property
exists
in
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
and
has
the
same
value.
If
this
is
</ins><code><ins class="diff-chg">
false
</ins></code><ins class="diff-chg">
in
any
checks,
discard
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
and
continue
the
discovery
process.
</ins>
</li>
<del class="diff-old">Editor's
note
Constraints
are
experimental
feature,
implementations
are
</del>
<li>
<ins class="diff-chg">Otherwise
if
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
has
</ins>
not
<del class="diff-old">required
to
support
them.
Editor's
note
Semantic
annotations
need
revisiting
</del>
<ins class="diff-chg">been
discarded
</ins>
in
<del class="diff-old">order
to
simplify
their
representation.
In
</del>
the
<del class="diff-old">[
WOT-TD
]
specification
they
represent
</del>
<ins class="diff-chg">previous
steps,
invoke
the
</ins><var><ins class="diff-chg">
handler
</ins></var><ins class="diff-chg">
function
with
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
as
parameter.
</ins></li></ol></li><li><ins class="diff-chg">
Whenever
an
error
occurs
during
</ins>
the
<ins class="diff-new">discovery
process,
and
if
</ins><var><ins class="diff-new">
errorHandler
</ins></var><ins class="diff-new">
is
defined,
invoke
it
with
an
argument
of
type
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">Error
</ins>
</code>
<del class="diff-old">construct.
At
the
moment
only
</del>
<ins class="diff-chg">whose
</ins>
<code>
<del class="diff-old">@context
,
</del>
<ins class="diff-chg">message
</ins></code><ins class="diff-chg">
property
is
set
to
</ins>
<code>
<del class="diff-old">@type
</del>
<ins class="diff-chg">UnknownError
</ins>
</code>
<ins class="diff-new">unless
there
was
an
error
code
provided
by
the
</ins><a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Protocol
Bindings
</ins></a>,<ins class="diff-new">
in
which
case
set
it
to
that
value.
</ins></li><li><ins class="diff-new">
When
the
discovery
process
is
finished,
</ins>
and
<ins class="diff-new">if
</ins><var><ins class="diff-new">
onComplete
</ins></var><ins class="diff-new">
is
defined,
invoke
it
run
the
</ins><a href= "#dfn-cancel-discovery" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
cancel
discovery
</ins></a><ins class="diff-new">
steps.
</ins></li><li><ins class="diff-new">
When
the
</ins>
<code>
<del class="diff-old">@id
</del>
<ins class="diff-chg">obs.unsubscribe()
</ins>
</code>
<del class="diff-old">constructs
are
used
in
</del>
<ins class="diff-chg">method
is
called,
run
</ins>
the
<del class="diff-old">TD
.
</del>
<ins class="diff-chg">following
</ins><dfn data-dfn-type="dfn" id= "dfn-cancel-discovery"><ins class="diff-chg">
cancel
discovery
</ins></dfn><ins class="diff-chg">
steps:
</ins><ol><li><ins class="diff-chg">
Request
the
underlying
platform
to
stop
the
discovery
process.
If
this
returns
an
error,
or
if
it
is
not
possible,
for
instance
when
discovery
is
based
on
open
ended
multicast
requests,
the
implementation
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
discard
subsequent
discovered
items.
</ins></li><li><ins class="diff-chg">
Set
</ins><var><ins class="diff-chg">
obs.closed
</ins></var><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
false
</ins></code>.</li></ol></li></ol>
</section>
<section id="the-fetch-method">
<h3 id="x3-2-the-fetch-method">
<span class="secno">
3.2
</span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id="dom-wot-fetch" data-idl="operation" data-title="fetch()" data-type="Promise" data-lt= "wot.fetch()|wot.fetch|fetch()|fetch">
<code>
fetch()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href= "#the-fetch-method">
</a>
</h3>
<p>
Accepts
an
<code>
url
</code>
argument
<ins class="diff-new">of
type
</ins><code><ins class="diff-new">
USVString
</ins></code><ins class="diff-new">
that
represents
a
URL
(e.g.
</ins><code><ins class="diff-new">
"file://..."
</ins></code><ins class="diff-new">
or
</ins><code><ins class="diff-new">
"https://..."
</ins></code><ins class="diff-new">
)
</ins>
and
returns
a
<code>
<a href="#dfn-promise" class="internalDFN" data-link-type="dfn">
Promise
</a>
</code>
that
resolves
with
a
<a href="#dom-thingdescription" class="internalDFN" data-link-type= "dfn">
<code>
ThingDescription
</code>
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">(a
serialized
</ins><a href= "#dfn-json-ld" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
JSON-LD
</ins></a><ins class="diff-chg">
document
of
type
</ins><code><ins class="diff-chg">
USVString
</ins></code><ins class="diff-chg">
).
</ins>
</p>
<del class="diff-old">3.3
</del>
<p>
The
<code>
<del class="diff-old">ThingDescription
</del>
<ins class="diff-chg">fetch(url)
</ins>
</code>
<del class="diff-old">type
Representation
of
</del>
<ins class="diff-chg">method
</ins><em class="rfc2119" title= "MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
run
</ins>
the
<del class="diff-old">Thing
Description
,
standardized
</del>
<ins class="diff-chg">following
steps:
</ins></p><ol><li><ins class="diff-chg">
Return
a
</ins><code><ins class="diff-chg">
Promise
</ins></code><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
and
execute
the
next
steps
</ins><a href="#dfn-in-parallel" class="internalDFN" data-link-type="dfn">
in
<ins class="diff-new">parallel
</ins></a>.</li><li><ins class="diff-new">
If
invoking
</ins><code><ins class="diff-new">
fetch()
</ins></code><ins class="diff-new">
is
not
allowed
for
</ins>
the
<del class="diff-old">Wot
Things
</del>
<ins class="diff-chg">current
scripting
context
for
security
reasons,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins><code><ins class="diff-chg">
SecurityError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
If
the
argument
</ins><var><ins class="diff-chg">
url
</ins></var><ins class="diff-chg">
is
not
a
URL,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins><code><ins class="diff-chg">
TypeError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Make
a
request
to
fetch
the
content
of
</ins><var><ins class="diff-chg">
url
</ins></var><ins class="diff-chg">
as
described
by
the
</ins><a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Protocol
Bindings
</ins></a><ins class="diff-chg">
and
wait
for
the
reply.
Implementations
encapsulate
the
fetching
process
and
the
accepted
media
types
(such
as
</ins><code><ins class="diff-chg">
application/td+json
</ins></code><ins class="diff-chg">
),
as
far
as
a
valid
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
</ins>
Description
</a>
<del class="diff-old">specification.
</del>
<ins class="diff-chg">can
be
obtained
as
defined
in
[
</ins><cite>
<del class="diff-old">Note
</del>
<a class="bibref" href="#bib-wot-td">
<ins class="diff-chg">WOT-TD
</ins></a>
<del class="diff-old">In
this
version
of
</del>
</cite>
<ins class="diff-chg">].
Let
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
be
</ins>
the
<del class="diff-old">API,
</del>
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
</a>
<del class="diff-old">s
are
represented
</del>
<ins class="diff-chg">string-serialized
from
the
returned
content,
</ins>
as
<del class="diff-old">opaque
strings,
denoting
a
serialized
form,
for
instance
JSON
or
JSON-LD.
See
Issue
38
</del>
<ins class="diff-chg">specified
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-td-serialization"><ins class="diff-chg">
Thing
Description
serialization
</ins></a>.</li><li><ins class="diff-chg">
If
there
was
an
error
during
the
request,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
an
</ins><code><ins class="diff-chg">
Error
</ins></code><ins class="diff-chg">
object
</ins><var><ins class="diff-chg">
error
</ins></var><ins class="diff-chg">
with
</ins><code><ins class="diff-chg">
error.message
</ins></code><ins class="diff-chg">
set
to
the
error
code
seen
by
the
</ins><a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Protocol
Bindings
</ins>
</a>
and
<del class="diff-old">Issue
45
.
</del>
<ins class="diff-chg">terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Otherwise
resolve
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
and
terminate
these
steps.
</ins></li></ol>
</section>
<section id="the-consume-method">
<h3 id="x3-3-the-consume-method">
<span class="secno">
<del class="diff-old">3.4
</del>
<ins class="diff-chg">3.3
</ins>
</span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id="dom-wot-consume" data-idl="operation" data-title="consume()" data-type= "ConsumedThing" data-lt= "wot.consume()|wot.consume|consume()|consume">
<code>
consume()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href= "#the-consume-method">
</a>
</h3>
<p>
Accepts
an
<code>
td
</code>
argument
of
type
<code>
<a href= "#dom-thingdescription" class="internalDFN" data-link-type= "dfn">
<code>
ThingDescription
</code>
</a>
</code>
and
returns
a
<a href="#dom-consumedthing" class="internalDFN" data-link-type= "dfn">
<code>
ConsumedThing
</code>
</a>
object
instantiated
based
on
<ins class="diff-new">parsing
</ins>
that
description.
</p>
<p>
<ins class="diff-new">The
</ins><code><ins class="diff-new">
consume(td)
</ins></code><ins class="diff-new">
method
must
run
the
following
steps:
</ins></p><ol><li><ins class="diff-new">
If
the
argument
</ins><var><ins class="diff-new">
td
</ins></var><ins class="diff-new">
is
not
a
string,
throw
a
</ins><code><ins class="diff-new">
TypeError
</ins></code><ins class="diff-new">
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
Let
</ins><var><ins class="diff-new">
stub
</ins></var><ins class="diff-new">
be
the
result
of
running
the
</ins><a href= "#dfn-td-parsing-algorithm" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
TD
parsing
algorithm
</ins></a><ins class="diff-new">
with
</ins><var><ins class="diff-new">
td
</ins></var><ins class="diff-new">
as
argument.
If
that
throws
an
error,
re-throw
the
error
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
If
</ins><var><ins class="diff-new">
stub
</ins></var><ins class="diff-new">
does
not
have
an
own
property
that
is
defined
in
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ThingFragment
</ins></code></a><ins class="diff-new">
with
a
default
value,
add
that
property
and
value
to
</ins><var><ins class="diff-new">
stub
</ins></var>.</li><li><ins class="diff-new">
Create
a
</ins><a href="#dom-consumedthing" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ConsumedThing
</ins></code></a><ins class="diff-new">
object
</ins><var><ins class="diff-new">
thing
</ins></var><ins class="diff-new">
initialized
from
</ins><var><ins class="diff-new">
stub
</ins></var><ins class="diff-new">
that
implements
</ins><a href="#dom-observable" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
Observable
</ins></code></a>.</li><li><ins class="diff-new">
Add
the
</ins><code><ins class="diff-new">
read()
</ins></code><ins class="diff-new">
and
</ins><code><ins class="diff-new">
write()
</ins></code><ins class="diff-new">
methods
to
the
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ThingProperty
</ins></code></a><ins class="diff-new">
elements
so
that
they
make
requests
to
access
the
remote
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
s
and
wait
for
the
reply,
as
defined
by
the
</ins><a href="#dfn-protocol-bindings" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Protocol
Bindings
</ins></a>.<ins class="diff-new">
Also,
all
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ThingProperty
</ins></code></a><ins class="diff-new">
elements
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
implement
</ins><a href= "#dom-observable" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
Observable
</ins></code></a>,<ins class="diff-new">
i.e.
define
a
</ins><code><ins class="diff-new">
subscribe()
</ins></code><ins class="diff-new">
method
that
should
make
request
to
observe
the
given
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Properties
</ins></a><ins class="diff-new">
as
defined
by
the
</ins><a href= "#dfn-protocol-bindings" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Protocol
Bindings
</ins></a>.</li><li><ins class="diff-new">
Add
the
</ins><code><ins class="diff-new">
invoke()
</ins></code><ins class="diff-new">
methods
to
the
</ins><a href= "#dom-thingaction" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingAction
</ins></code></a><ins class="diff-new">
elements
so
that
they
make
requests
to
the
remote
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
to
invoke
its
actions,
as
defined
by
the
</ins><a href="#dfn-protocol-bindings" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Protocol
Bindings
</ins></a>.</li><li><ins class="diff-new">
Add
the
</ins><code><ins class="diff-new">
subscribe()
</ins></code><ins class="diff-new">
method
to
all
</ins><a href= "#dom-thingevent" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingEvent
</ins></code></a><ins class="diff-new">
elements
so
that
they
make
requests
to
subscribe
to
the
events
defined
by
the
remote
</ins><a href= "#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a>,<ins class="diff-new">
as
defined
by
the
</ins><a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Protocol
Bindings
</ins></a>.</li><li><ins class="diff-new">
Return
</ins><var><ins class="diff-new">
thing
</ins></var>.</li></ol>
</section>
<section id="the-produce-method">
<h3 id="x3-4-the-produce-method">
<span class="secno">
<del class="diff-old">3.5
</del>
<ins class="diff-chg">3.4
</ins>
</span>
The
<dfn id="produce-method" data-dfn-for="wot" data-dfn-type="dfn" data-idl="operation" data-title="produce()" data-type= "ExposedThing" data-lt= "wot.produce()|wot.produce|produce()|produce">
<code>
produce()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href= "#the-produce-method">
</a>
</h3>
<p>
Accepts
a
<code>
model
</code>
argument
of
type
<code>
<a href= "#dom-thingmodel" class="internalDFN" data-link-type= "dfn">
<code>
ThingModel
</code>
</a>
</code>
and
returns
an
<a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
<del class="diff-old">object,
locally
created
based
on
the
provided
initialization
parameters.
An
</del>
<ins class="diff-chg">object.
</ins></p><p><ins class="diff-chg">
The
</ins>
<code>
<del class="diff-old">ExposedThing
</del>
<ins class="diff-chg">produce(model)
</ins>
</code>
<del class="diff-old">can
be
created
in
</del>
<ins class="diff-chg">method
</ins><em class="rfc2119" title="MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
run
</ins>
the
following
<del class="diff-old">ways:
</del>
<ins class="diff-chg">steps:
</ins>
</p>
<ol>
<li>
<del class="diff-old">from
an
initial
</del>
<ins class="diff-chg">If
invoking
</ins><code><ins class="diff-chg">
produce()
</ins></code><ins class="diff-chg">
is
not
allowed
for
the
current
scripting
context
for
security
reasons,
throw
</ins><code><ins class="diff-chg">
SecurityError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
If
the
argument
</ins><var>
model
<del class="diff-old">(including
</del>
</var>
<ins class="diff-chg">is
</ins>
a
<del class="diff-old">user
given
name
and
semantic
annotations
),
</del>
<ins class="diff-chg">string,
</ins>
then
<del class="diff-old">adding
properties,
actions,
events
</del>
<ins class="diff-chg">run
the
</ins><i><ins class="diff-chg">
TD
parsing
algorithm
</ins></i><ins class="diff-chg">
with
</ins><var><ins class="diff-chg">
model
</ins></var><ins class="diff-chg">
passed
as
parameter.
If
it
throws
an
error,
re-throw
that
error
</ins>
and
<del class="diff-old">request
handlers;
</del>
<ins class="diff-chg">terminate
this
algorithm.
Otherwise
let
</ins><var><ins class="diff-chg">
model
</ins></var><ins class="diff-chg">
be
the
returned
value.
</ins>
</li>
<li>
<del class="diff-old">from
a
Thing
Description
(possibly
of
a
</del>
<ins class="diff-chg">If
</ins><var><ins class="diff-chg">
model
</ins></var><ins class="diff-chg">
is
not
an
object,
throw
</ins><code><ins class="diff-chg">
TypeError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
model
</ins></var><ins class="diff-chg">
does
not
have
an
own
property
that
is
defined
in
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">ConsumedThing
</del>
<ins class="diff-chg">ThingFragment
</ins>
</code>
</a>
<del class="diff-old">object),
then
adding
request
handlers.
</del>
<ins class="diff-chg">with
a
default
value,
add
that
property
and
value
to
</ins><var><ins class="diff-chg">
model
</ins></var>.
</li>
<del class="diff-old">3.6
The
</del>
<li>
<ins class="diff-chg">Create
an
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">ThingModel
</del>
<ins class="diff-chg">ExposedThing
</ins>
</code>
<del class="diff-old">type
A
Thing
</del>
</a>
<ins class="diff-chg">object
</ins><var><ins class="diff-chg">
thing
</ins></var><ins class="diff-chg">
initialized
from
</ins><var>
model
<del class="diff-old">is
used
for
producing
a
new
</del>
</var>.
</li>
<li>
<ins class="diff-chg">For
each
property
of
</ins><a href="#dom-exposedthing" class= "internalDFN" data-link-type="dfn">
<code>
ExposedThing
</code>
</a>
<del class="diff-old">and
can
be
either
a
</del>
<ins class="diff-chg">defined
in
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">ThingTemplate
</del>
<ins class="diff-chg">ThingFragment
</ins>
</code>
</a>,
<ins class="diff-new">initialize
the
property
based
on
the
provided
initial
</ins>
or
<del class="diff-old">a
</del>
<ins class="diff-chg">default
values
provided
to
the
local
</ins><a href="#dfn-wot-runtime" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
WoT
Runtime
</ins></a><ins class="diff-chg">
implementation,
for
instance
initialize:
</ins><ol><li><ins class="diff-chg">
the
</ins>
<code>
<del class="diff-old">ThingDescription
</del>
<ins class="diff-chg">id
</ins>
</code>
<del class="diff-old">.
3.7
The
</del>
<ins class="diff-chg">property
to
be
the
final
unique
identifier
of
the
</ins><a href="#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
</ins></a>,</li><li><ins class="diff-chg">
the
</ins><code><ins class="diff-chg">
security
</ins></code><ins class="diff-chg">
object
of
type
</ins><a href= "#dom-securityscheme" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">SemanticAnnotations
</del>
<ins class="diff-chg">SecurityScheme
</ins>
</code>
<del class="diff-old">dictionary
A
dictionary
that
provides
</del>
</a>
<ins class="diff-chg">to
represent
</ins>
the
<del class="diff-old">semantic
types
</del>
<ins class="diff-chg">actual
security
scheme
</ins>
and
<del class="diff-old">semantic
metadata.
&lt;span class="idlDictionary" id=
"idl-def-semanticannotations" data-idl="" data-title=
"SemanticAnnotations"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-semanticannotations" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id=
"idl-def-semanticannotations-semantictype" data-idl="" data-title=
"semanticType" data-dfn-for="semanticannotations"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-semantictype"
class="internalDFN" data-link-type=
"dfn"&gt;     &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for=
"semanticannotations" data-lt="" href=
"#dom-semanticannotations-semantictype" class="internalDFN"
data-link-type="dfn"&gt;
&lt;span class="idlMember" id="idl-def-semanticannotations-metadata"
data-idl="" data-title="metadata" data-dfn-for=
"semanticannotations"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-semanticmetadata"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for=
"semanticannotations" data-lt="" href=
"#dom-semanticannotations-metadata" class="internalDFN"
data-link-type="dfn"&gt;
};
The
</del>
<ins class="diff-chg">its
properties
as
set
up
by
the
implementation,
</ins></li><li><ins class="diff-chg">
the
</ins>
<code>
<del class="diff-old">semanticType
</del>
<ins class="diff-chg">properties
</ins>
</code>
property
<del class="diff-old">denotes
a
list
of
</del>
<ins class="diff-chg">to
be
an
object
with
all
properties
being
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">SemanticType
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
</a>
objects
<del class="diff-old">that
</del>
<ins class="diff-chg">in
which
the
</ins><code><ins class="diff-chg">
read()
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
write()
</ins></code><ins class="diff-chg">
methods
are
provided
to
</ins>
define
<ins class="diff-new">local
methods
to
get
and
set
the
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
values,
</ins></li><li>
the
<del class="diff-old">semantic
types
that
can
be
used
in
semantic
metadata
type-value
pairs.
The
</del>
<code>
<del class="diff-old">metadata
</del>
<ins class="diff-chg">actions
</ins>
</code>
property
<del class="diff-old">denotes
a
list
of
</del>
<ins class="diff-chg">to
be
an
object
with
all
properties
being
</ins><a href="#dom-thingaction" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">SemanticMetadata
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</a>
objects
<del class="diff-old">(type-value
pairs).
3.8
The
</del>
<ins class="diff-chg">in
which
the
</ins>
<code>
<del class="diff-old">SemanticType
</del>
<ins class="diff-chg">invoke()
</ins>
</code>
<del class="diff-old">dictionary
&lt;span class="idlDictionary" id=
"idl-def-semantictype" data-idl="" data-title=
"SemanticType"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-semantictype" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-semantictype-name" data-idl=""
data-title="name" data-dfn-for=
"semantictype"&gt;    required &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="semantictype" data-lt="" href=
"#dom-semantictype-name" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-semantictype-context" data-idl=
"" data-title="context" data-dfn-for=
"semantictype"&gt;    required &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-no-default=""
data-link-for="semantictype" data-lt="" href=
"#dom-semantictype-context" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-semantictype-prefix" data-idl=
"" data-title="prefix" data-dfn-for=
"semantictype"&gt;             &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="semantictype" data-lt="" href=
"#dom-semantictype-prefix" class="internalDFN" data-link-type=
"dfn"&gt;
};
Represents
a
semantic
type
annotation,
containing
a
name,
a
context
and
</del>
<ins class="diff-chg">method
is
provided
to
define
</ins>
a
<del class="diff-old">prefix.
</del>
<ins class="diff-chg">local
method
to
run
the
defined
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
s,
</ins></li>
<li>
<del class="diff-old">The
</del>
<ins class="diff-chg">the
</ins><code><ins class="diff-chg">
events
</ins></code><ins class="diff-chg">
property
to
be
an
object
with
all
properties
being
</ins><a href="#dom-exposedevent" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">name
</del>
<ins class="diff-chg">ExposedEvent
</ins>
</code>
<del class="diff-old">attribute
represents
the
name
of
the
semantic
type
</del>
</a>
<ins class="diff-chg">objects
</ins>
in
<ins class="diff-new">which
</ins>
the
<del class="diff-old">given
context.
The
</del>
<code>
<del class="diff-old">context
</del>
<ins class="diff-chg">emit()
</ins>
</code>
<del class="diff-old">attribute
represents
an
URL
link
</del>
<ins class="diff-chg">method
is
provided
</ins>
to
<ins class="diff-new">define
a
local
way
to
trigger
sending
notifications
to
all
subscribed
clients,
</ins></li><li><ins class="diff-new">
and
initialize
</ins>
the
<del class="diff-old">context
of
the
semantic
classification.
</del>
<ins class="diff-chg">other
properties
as
initialized
from
</ins><var><ins class="diff-chg">
model
</ins></var>.
</li>
<li>
<ins class="diff-new">Return
</ins><var><ins class="diff-new">
thing
</ins></var>.</li></ol><p>
The
<del class="diff-old">prefix
</del>
<dfn data-dfn-type="dfn" id="dfn-td-parsing-algorithm">
<ins class="diff-chg">TD
parsing
algorithm
</ins>
</dfn>
<del class="diff-old">attribute
represents
</del>
<ins class="diff-chg">takes
</ins>
a
<del class="diff-old">short
prefix
associated
with
</del>
<ins class="diff-chg">string
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
as
argument
and
runs
the
following
steps:
</ins></p><ol><li><ins class="diff-chg">
Parse
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
according
to
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-td-serialization"><ins class="diff-chg">
WoT
Thing
Description
</ins></a><ins class="diff-chg">
in
order
to
produce
</ins>
a
<del class="diff-old">context.
</del>
<a href= "https://www.w3.org/TR/json-ld/#dfn-json-object">
<ins class="diff-chg">JSON
object
</ins></a><var><ins class="diff-chg">
json
</ins></var>.<ins class="diff-chg">
Update
</ins><var><ins class="diff-chg">
thing
</ins></var><ins class="diff-chg">
with
the
properties
and
values
defined
in
</ins><var><ins class="diff-chg">
json
</ins></var>.
</li>
<del class="diff-old">Editor's
note
Semantic
type
examples
to
be
added.
</del>
<li>
<ins class="diff-chg">If
there
was
an
error
during
the
parsing,
throw
that
error
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Otherwise
return
</ins><var><ins class="diff-chg">
json
</ins></var>.</li></ol></li></ol>
</section>
<section id="the-register-method">
<h3 id="x3-5-the-register-method">
<del class="diff-old">3.9
</del>
<span class="secno">
<ins class="diff-chg">3.5
</ins>
</span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id= "dom-wot-register" data-idl="operation" data-title="register()" data-type="Promise" data-lt= "wot.register()|wot.register|register()|register">
<code>
<del class="diff-old">SemanticMetadata
</del>
<ins class="diff-chg">register()
</ins>
</code>
</dfn>
<del class="diff-old">dictionary
&lt;span class="idlDictionary" id=
"idl-def-semanticmetadata" data-idl="" data-title=
"SemanticMetadata"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-semanticmetadata" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-semanticmetadata-type"
data-idl="" data-title="type" data-dfn-for=
"semanticmetadata"&gt;    &lt;a href=
"#dom-semantictype" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for=
"semanticmetadata" data-lt="" href="#dom-semanticmetadata-type"
class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-semanticmetadata-value"
data-idl="" data-title="value" data-dfn-for=
"semanticmetadata"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any&lt;a data-no-default=""
data-link-for="semanticmetadata" data-lt="" href=
"#dom-semanticmetadata-value" class="internalDFN" data-link-type=
"dfn"&gt;
};
</del>
<ins class="diff-chg">method
</ins><a class="self-link" aria-label="§" href= "#the-register-method">
</a>
</h3>
<p>
<del class="diff-old">The
</del>
<ins class="diff-chg">Takes
two
mandatory
arguments:
</ins></p><ul><li>
<code>
<del class="diff-old">SemanticMetadata
</del>
<ins class="diff-chg">directory
</ins>
</code>
<del class="diff-old">dictionary
describes
</del>
<ins class="diff-chg">denoting
</ins>
a
<del class="diff-old">pair
of
semantic
type
</del>
<a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Thing
Directory
</ins></a>,
and
<del class="diff-old">value:
</del>
</li>
<li>
<del class="diff-old">The
</del>
<code>
<del class="diff-old">type
</del>
<ins class="diff-chg">thing
</ins>
</code>
<del class="diff-old">attribute
represents
the
semantic
type
name
defined
by
a
</del>
<ins class="diff-chg">denoting
an
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">SemanticType
</del>
<ins class="diff-chg">ExposedThing
</ins>
</code>
</a>
object.
</li>
<del class="diff-old">The
value
attribute
represents
the
metadata
value.
</del>
</ul>
<del class="diff-old">3.10
The
ThingTemplate
dictionary
</del>
<p>
<del class="diff-old">A
</del>
<ins class="diff-chg">Generate
the
</ins><a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">Template
is
a
dictionary
that
provides
a
user
</del>
<ins class="diff-chg">Description
</ins></a><ins class="diff-chg">
as
</ins><var><ins class="diff-chg">
td
</ins></var>,
given
<del class="diff-old">name,
and
</del>
the
<del class="diff-old">semantic
types
</del>
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Properties
</ins></a>,<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
s
</ins>
and
<del class="diff-old">semantic
metadata
attached
to
the
</del>
<a href="#dfn-events" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Event
</ins></a><ins class="diff-chg">
s
defined
for
this
</ins>
<a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
<ins class="diff-chg">object.
Then
make
a
request
to
register
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
to
the
given
WoT
</ins><a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn">
Thing
<del class="diff-old">Description
's
root
level.
</del>
<ins class="diff-chg">Directory
</ins></a>.
</p>
<del class="diff-old">&lt;span class="idlDictionary" id=
"idl-def-thingtemplate" data-idl="" data-title=
"ThingTemplate"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingtemplate" class="internalDFN" data-link-type=
"dfn"&gt; : &lt;span class=
"idlSuperclass"&gt;&lt;a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-thingtemplate-name" data-idl=""
data-title="name" data-dfn-for=
"thingtemplate"&gt;    required &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="thingtemplate" data-lt="" href=
"#dom-thingtemplate-name" class="internalDFN" data-link-type=
"dfn"&gt;
};
</del>
</section>
<section id="the-unregister-method">
<h3 id="x3-6-the-unregister-method">
<span class="secno">
<ins class="diff-chg">3.6
</ins></span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id= "dom-wot-unregister" data-idl="operation" data-title="unregister()" data-type="Promise" data-lt= "wot.unregister()|wot.unregister|unregister()|unregister">
<code>
<del class="diff-old">ThingTemplate
</del>
<ins class="diff-chg">unregister()
</ins>
</code>
</dfn>
<ins class="diff-new">method
</ins><a class="self-link" aria-label="§" href= "#the-unregister-method">
</a>
<del class="diff-old">dictionary
extends
</del>
</h3>
<p>
<ins class="diff-chg">Takes
two
mandatory
arguments:
</ins></p><ul><li>
<code>
<del class="diff-old">SemanticAnnotations
</del>
<ins class="diff-chg">directory
</ins>
</code>
<del class="diff-old">and
contains
properties
to
initialize
</del>
<ins class="diff-chg">denoting
</ins>
a
<a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn">
Thing
<del class="diff-old">:
</del>
<ins class="diff-chg">Directory
</ins></a>,<ins class="diff-chg">
and
</ins></li>
<li>
<del class="diff-old">The
</del>
<code>
<del class="diff-old">name
</del>
<ins class="diff-chg">thing
</ins>
</code>
<ins class="diff-new">denoting
an
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<del class="diff-old">attribute
represents
</del>
<code>
<ins class="diff-chg">ExposedThing
</ins></code></a><ins class="diff-chg">
object.
</ins></li></ul><p><ins class="diff-chg">
Makes
a
request
to
unregister
</ins>
the
<del class="diff-old">user
given
name
of
</del>
<code>
<ins class="diff-chg">thing
</ins></code><ins class="diff-chg">
from
</ins>
the
<ins class="diff-chg">given
WoT
</ins><a href="#dfn-thing-directory" class="internalDFN" data-link-type="dfn">
Thing
<ins class="diff-new">Directory
</ins>
</a>.
<del class="diff-old">Editor's
note
Support
for
configuration
and
security
data
might
be
added
later.
</del>
</p>
</section>
<section id="examples">
<h3 id="x3-7-examples">
<span class="secno">
<del class="diff-old">3.11
</del>
<ins class="diff-chg">3.7
</ins>
</span>
Examples
<a class="self-link" aria-label="§" href= "#examples">
</a>
</h3>
<div class="example" id="ex-1-discover-things-via-directory">
<div class="marker">
<a class="self-link" href= "#ex-1-discover-things-via-directory">
Example
1
</a>
<del class="diff-old">:
</del>
<span class= "example-title">:
Discover
Things
via
directory
</span>
</div>
<pre class="hljs javascript" aria-busy="false"><span class=
"hljs-keyword">let</span> discoveryFilter = {
  <span class="hljs-attr">method</span>: <span class=
"hljs-string">"directory"</span>,
  <span class="hljs-attr">url</span>: <span class=
"hljs-string">"http://directory.wotservice.org"</span>
};
<span class=
"hljs-keyword">let</span> subscription = wot.discover(discoveryFilter).subscribe(
  <span class="hljs-function"><span class=
<del class="diff-old">"hljs-params"&gt;thing { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Found Thing " + thing.name); },
</del>
<ins class="diff-chg">"hljs-params">td</span> =&gt;</span> {
</ins>    <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Found Thing "</span> + td.name);
</ins>    <span class=<ins class="diff-chg">
"hljs-comment">// fetch the TD and create a ConsumedThing</span>
</ins>    <span class="hljs-keyword">let</span> thing = wot.consume(td);<ins class="diff-chg">
  },
</ins>
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished because an error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    subscription.unsubscribe();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery timeout"</span>);
  },
<span class="hljs-number">
5000
</span>
);
</pre>
</div>
<del class="diff-old">Note
Note
that
canceling
a
discovery
(through
unsubscribe()
)
may
not
be
successful
in
all
cases,
for
instance
when
discovery
is
based
on
open
ended
broadcast
requests.
However,
once
unsubscribe()
has
been
called,
implementations
MUST
suppress
further
event
handling
(
i.e.
further
discoveries
and
errors)
on
the
Observable.
Also,
a
discovery
error
may
not
mean
the
end
of
the
discovery
process.
However,
in
order
to
respect
Observable
semantics
(error
always
terminates
processing),
implementations
MUST
close
or
suppress
further
event
handling
on
the
Observable.
</del>
<div class="example" id= "ex-2-discover-things-exposed-by-local-hardware">
<div class="marker">
<a class="self-link" href= "#ex-2-discover-things-exposed-by-local-hardware">
Example
2
</a>
<del class="diff-old">:
</del>
<span class="example-title">:
Discover
Things
exposed
by
local
hardware
</span>
</div>
<pre class="hljs javascript" aria-busy="false"><span class=
"hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe(
  <span class="hljs-function"><span class=
<del class="diff-old">"hljs-params"&gt;thing { &lt;span class=
</del>
<ins class="diff-chg">"hljs-params">td</span> =&gt;</span> { <span class=
</ins>
"hljs-built_in">console</span>.log(<span class=
<del class="diff-old">"hljs-string"&gt;"Found local Thing " + thing.name); },
</del>
<ins class="diff-chg">"hljs-string">"Found local Thing "</span> + td.name); },
</ins>
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
</pre>
</div>
<div class="example" id= "ex-3-same-as-above-but-with-different-observable-syntax">
<div class="marker">
<a class="self-link" href= "#ex-3-same-as-above-but-with-different-observable-syntax">
Example
3
</a>
<del class="diff-old">:
</del>
<span class="example-title">:
Same
as
above
but
with
different
Observable
syntax
</span>
</div>
<pre class="hljs javascript" aria-busy="false"><span class=
"hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe({
<del class="diff-old">  thing =&gt; { &lt;span class=
</del>
<ins class="diff-chg">  td =&gt; { <span class=
</ins>
"hljs-built_in">console</span>.log(<span class=
<del class="diff-old">"hljs-string"&gt;"Found local Thing " + thing.name); },
</del>
<ins class="diff-chg">"hljs-string">"Found local Thing "</span> + td.name); },
</ins>
  <span class="hljs-attr">error</span>: <span class=
"hljs-function"><span class=
"hljs-params">err</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + err.message); },
  <span class="hljs-attr">complete</span>: <span class=
"hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
});
</pre>
</div>
<del class="diff-old">Example
4
:
Discover
Things
exposed
nearby,
via
Bluetooth
or
NFC
&lt;span class=
"hljs-keyword"&gt;let subscription = wot.discover({
  : &lt;span class=
"hljs-string"&gt;"nearby",
  : [{ &lt;span class=
"hljs-attr"&gt;protocol: &lt;span class=
"hljs-string"&gt;"BLE-4.2" }, { &lt;span class=
"hljs-attr"&gt;protocol: &lt;span class=
"hljs-string"&gt;"NFC"}]
}).subscribe(
  &lt;span class=
"hljs-params"&gt;thing { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Found nearby Thing " + thing.name); },
  error =&gt; { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Discovery error: " + error.message); },
  () =&gt; { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Discovery finished successfully");}
);
Example
5
:
Discover
Things
exposed
in
a
proprietary
way
&lt;span class=
"hljs-keyword"&gt;let subscription = wot.discover({
  : &lt;span class=
"hljs-string"&gt;"other",
  : [{ &lt;span class=
"hljs-attr"&gt;solution: &lt;span class=
"hljs-string"&gt;"XYZ123", &lt;span class=
"hljs-attr"&gt;key}]
}).subscribe(
  &lt;span class=
"hljs-params"&gt;thing { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Found Thing " + thing.name); },
  error =&gt; { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Discovery error: " + error.message); },
  () =&gt; { &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Discovery finished successfully");}
);
</del>
</section>
</section>
<section data-dfn-for="ConsumedThing" id= "the-consumedthing-interface">
<h2 id="x4-the-consumedthing-interface">
<span class= "secno">
4.
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-consumedthing" data-idl="interface" data-title= "ConsumedThing">
<code>
ConsumedThing
</code>
</dfn>
interface
<a class= "self-link" aria-label="§" href= "#the-consumedthing-interface">
</a>
</h2>
<p>
<del class="diff-old">The
</del>
<ins class="diff-chg">Represents
an
object
that
extends
a
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ConsumedThing
</del>
<ins class="diff-chg">ThingFragment
</ins>
</code>
</a>
<del class="diff-old">interface
is
a
</del>
<ins class="diff-chg">with
methods
for
</ins>
client
<del class="diff-old">API
</del>
<ins class="diff-chg">interactions
(send
request
</ins>
for
<del class="diff-old">sending
requests
to
servers
in
order
to
retrieve
or
update
</del>
<ins class="diff-chg">reading
and
writing
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
Properties
<del class="diff-old">,
</del>
</a>
<ins class="diff-chg">),
</ins>
invoke
<del class="diff-old">Actions
,
</del>
<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins></a><ins class="diff-chg">
s,
subscribe
</ins>
and
<del class="diff-old">observe
Properties
</del>
<ins class="diff-chg">unsubscribe
for
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins>
</a>
<ins class="diff-new">changes
</ins>
and
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
<del class="diff-old">Events
.
</del>
<ins class="diff-chg">Event
</ins></a><ins class="diff-chg">
s.
</ins>
</p>
<div>
<pre class="def idl"><span class="idlInterface" id=
"idl-def-consumedthing" data-idl="" data-title=
"ConsumedThing">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-consumedthing" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; {
&lt;span class="idlAttribute" id="idl-def-consumedthing-name"
data-idl="" data-title="name" data-dfn-for=
"consumedthing"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="consumedthing" data-lt="" href=
"#dom-consumedthing-name" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMethod" id=
"idl-def-consumedthing-getthingdescription" data-idl="" data-title=
"getThingDescription" data-dfn-for="consumedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-thingdescription" class="internalDFN"
</del>
<ins class="diff-chg">"dfn"><code>ConsumedThing</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-thingfragment" class="internalDFN"
</ins>
data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="getthingdescription()|getThingDescription" href=
"#dom-consumedthing-getthingdescription" class="internalDFN"
data-link-type="dfn"&gt;getThingDescription
&lt;span class="idlMethod" id=
"idl-def-consumedthing-readproperty-name" data-idl="" data-title=
"readProperty" data-dfn-for="consumedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-no-default=""
data-link-for="consumedthing" data-lt="readproperty()|readProperty"
href="#dom-consumedthing-readproperty" class="internalDFN"
data-link-type="dfn"&gt;readProperty(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id=
"idl-def-consumedthing-writeproperty-name-value" data-idl=""
data-title="writeProperty" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-no-default=""
data-link-for="consumedthing" data-lt=
"writeproperty()|writeProperty" href=
"#dom-consumedthing-writeproperty" class="internalDFN"
data-link-type="dfn"&gt;writeProperty(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id=
"idl-def-consumedthing-invokeaction-name-parameters" data-idl=""
data-title="invokeAction" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-no-default=""
data-link-for="consumedthing" data-lt="invokeaction()|invokeAction"
href="#dom-consumedthing-invokeaction" class="internalDFN"
data-link-type="dfn"&gt;invokeAction(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id=
"idl-def-consumedthing-onpropertychange-name" data-idl=""
data-title="onPropertyChange" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn"&gt;       &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="onpropertychange()|onPropertyChange" href=
"#dom-consumedthing-onpropertychange" class="internalDFN"
data-link-type="dfn"&gt;onPropertyChange(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id="idl-def-consumedthing-onevent-name"
data-idl="" data-title="onEvent" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn"&gt;       &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="onevent()|onEvent" href="#dom-consumedthing-onevent"
class="internalDFN" data-link-type=
"dfn"&gt;onEvent&lt;span class=
"idlParamType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id="idl-def-consumedthing-ontdchange"
data-idl="" data-title="onTDChange" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
</del>
<ins class="diff-chg">"dfn"><code>ThingFragment</code></a></span> {<span class=
"idlAttribute" id="idl-def-consumedthing-id" data-idl=""
data-title="id" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="consumedthing.id|id" href=
"#dom-consumedthing-id" class="internalDFN" data-link-type=
"dfn"><code>id</code></a></span>;</span><span class="idlAttribute"
id="idl-def-consumedthing-name" data-idl="" data-title="name"
data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="consumedthing.name|name"
href="#dom-consumedthing-name" class="internalDFN" data-link-type=
"dfn"><code>name</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-base" data-idl=""
data-title="base" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="consumedthing.base|base"
href="#dom-consumedthing-base" class="internalDFN" data-link-type=
"dfn"><code>base</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-properties" data-idl=""
data-title="properties" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-propertymap" class="internalDFN" data-link-type=
"dfn"><code>PropertyMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="consumedthing"
data-lt="consumedthing.properties|properties" href=
"#dom-consumedthing-properties" class="internalDFN" data-link-type=
"dfn"><code>properties</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-actions" data-idl=""
data-title="actions" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-actionmap" class="internalDFN" data-link-type=
"dfn"><code>ActionMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="consumedthing"
data-lt="consumedthing.actions|actions" href=
"#dom-consumedthing-actions" class="internalDFN" data-link-type=
"dfn"><code>actions</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-events" data-idl=""
data-title="events" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-eventmap" class="internalDFN" data-link-type=
"dfn"><code>EventMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="consumedthing"
data-lt="consumedthing.events|events" href=
"#dom-consumedthing-events" class="internalDFN" data-link-type=
"dfn"><code>events</code></a></span>;</span><span class="idlMethod"
id="idl-def-consumedthing--name" data-idl="" data-title=""
data-dfn-for="consumedthing"><span class="idlSectionComment">
  // getter for ThingFragment properties
</ins>  </span>getter<span class="idlMethType"> <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-any">any</a></span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
};</span><span class="idlInterface" id="idl-def-propertymap"
data-idl="" data-title="PropertyMap">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertymap" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyMap</code></a></span> {<span class="idlMaplike"
id="idl-def-propertymap-maplike" data-idl="" data-title="iterable"
data-dfn-for="propertymap">
  readonly maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a>&gt;;</span>
};</span><span class="idlInterface" id="idl-def-actionmap"
data-idl="" data-title="ActionMap">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-actionmap" class=
"internalDFN" data-link-type=
"dfn"><code>ActionMap</code></a></span> {<span class="idlMaplike"
id="idl-def-actionmap-maplike" data-idl="" data-title="iterable"
data-dfn-for="actionmap">
  readonly maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-thingaction" class="internalDFN" data-link-type=
"dfn"><code>ThingAction</code></a>&gt;;</span>
};</span><span class="idlInterface" id="idl-def-eventmap" data-idl=
"" data-title="EventMap">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-eventmap" class=
"internalDFN" data-link-type=
"dfn"><code>EventMap</code></a></span> {<span class="idlMaplike"
id="idl-def-eventmap-maplike" data-idl="" data-title="iterable"
data-dfn-for="eventmap">
  readonly maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a>&gt;;</span>
};</span><span class="idlIncludes">
</ins><a href="#dom-consumedthing" class="internalDFN" data-link-type=<ins class="diff-chg">
"dfn"><code>ConsumedThing</code></a> includes <a href=
</ins>
"#dom-observable" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;       &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="ontdchange()|onTDChange" href=
"#dom-consumedthing-ontdchange" class="internalDFN" data-link-type=
"dfn"&gt;onTDChange
};
</del>
<ins class="diff-chg">"dfn"><code>Observable</code></a>;</span><span class=
"idlSectionComment">
//
for
TD
changes
</ins>
</span>
</pre>
</div>
<p>
<ins class="diff-new">The
</ins><dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-id" data-idl="attribute" data-title="id" data-type="DOMString" data-lt= "consumedthing.id|id">
<code>
<del class="diff-old">ConsumedThing
</del>
<ins class="diff-chg">id
</ins>
</code>
</dfn>
<ins class="diff-new">attribute
</ins>
represents
<del class="diff-old">a
local
proxy
object
</del>
<ins class="diff-chg">the
unique
identifier
</ins>
of
the
<del class="diff-old">remote
</del>
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">instance,
typically
a
URI,
IRI,
or
URN
as
</ins><code><ins class="diff-chg">
USVString
</ins></code>.
</p>
<del class="diff-old">4.1
</del>
<p>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-name" data-idl="attribute" data-title="name" data-type="DOMString" data-lt= "consumedthing.name|name">
<code>
name
</code>
</dfn>
<del class="diff-old">property
The
name
property
</del>
<ins class="diff-chg">attribute
</ins>
represents
the
name
of
the
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
as
<del class="diff-old">specified
in
the
TD
.
In
this
version
it
is
read
only.
</del>
<code>
<ins class="diff-chg">DOMString
</ins></code>.
</p>
<del class="diff-old">4.2
</del>
<p>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-base" data-idl="attribute" data-title="base" data-type="DOMString" data-lt= "consumedthing.base|base">
<code>
<del class="diff-old">getThingDescription()
</del>
<ins class="diff-chg">base
</ins>
</code>
</dfn>
<del class="diff-old">method
Returns
the
Thing
Description
of
</del>
<ins class="diff-chg">attribute
represents
</ins>
the
<del class="diff-old">Thing
.
Editor's
note
In
this
version,
introspection
based
on
TD
is
out
of
scope.
Parsing
and
exposing
Thing
Description
s
</del>
<ins class="diff-chg">base
URI
that
</ins>
is
<del class="diff-old">discussed
in
Issue
38
.
</del>
<ins class="diff-chg">valid
for
all
defined
local
interaction
resources.
</ins>
</p>
<del class="diff-old">4.3
</del>
<p>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-properties" data-idl="attribute" data-title= "properties" data-type="PropertyMap" data-lt= "consumedthing.properties|properties">
<code>
<del class="diff-old">readProperty()
</del>
<ins class="diff-chg">properties
</ins>
</code>
</dfn>
<del class="diff-old">method
Takes
the
Property
name
as
the
name
argument,
then
requests
from
the
underlying
platform
and
the
Protocol
Bindings
to
retrieve
the
Property
on
the
remote
Thing
and
return
the
result.
Returns
</del>
<ins class="diff-chg">attribute
represents
</ins>
a
<ins class="diff-new">dictionary
of
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-new">ThingProperty
</ins></code>
<del class="diff-old">Promise
</del>
</a>
<ins class="diff-new">items.
The
</ins><dfn data-dfn-for= "" data-dfn-type="dfn" id="dom-propertymap" data-idl="interface" data-title="PropertyMap">
<code>
<ins class="diff-new">PropertyMap
</ins>
</code>
<del class="diff-old">that
resolves
with
the
Property
value
or
rejects
with
an
Error
.
</del>
<del class="diff-old">4.4
The
</del>
</dfn>
<ins class="diff-chg">interface
represents
a
maplike
dictionary
where
all
values
are
</ins><a href= "#dom-thingproperty" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">writeProperty()
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
<del class="diff-old">method
Takes
the
Property
</del>
</a>
<del class="diff-old">name
as
the
name
argument
and
the
new
value
as
the
value
argument,
then
requests
from
the
underlying
platform
</del>
<ins class="diff-chg">objects.
The
</ins><code><ins class="diff-chg">
read()
</ins></code>
and
<del class="diff-old">the
Protocol
Bindings
</del>
<code>
<ins class="diff-chg">write()
</ins></code><ins class="diff-chg">
methods
make
a
request
</ins>
to
<del class="diff-old">update
</del>
<ins class="diff-chg">access
</ins>
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
<del class="diff-old">Property
</del>
<ins class="diff-chg">Properties
</ins>
</a>
on
the
remote
<a href= "#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
<del class="diff-old">and
return
the
result.
Returns
a
</del>
<ins class="diff-chg">represented
by
this
</ins><a href="#dom-consumedthing" class= "internalDFN" data-link-type="dfn">
<code>
<ins class="diff-new">ConsumedThing
</ins></code>
<del class="diff-old">Promise
</del>
</a>
<del class="diff-old">that
resolves
on
success
or
rejects
with
an
Error
.
</del>
<ins class="diff-chg">proxy
object.
</ins>
</p>
<del class="diff-old">4.5
</del>
<p>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-actions" data-idl="attribute" data-title= "actions" data-type="ActionMap" data-lt= "consumedthing.actions|actions">
<code>
<del class="diff-old">invokeAction()
</del>
<ins class="diff-chg">actions
</ins>
</code>
</dfn>
<del class="diff-old">method
Takes
the
Action
name
from
the
name
argument
and
the
list
of
parameters,
then
requests
from
the
underlying
platform
and
the
Protocol
Bindings
to
invoke
the
Action
on
the
remote
Thing
and
return
the
result.
Returns
</del>
<ins class="diff-chg">attribute
represents
</ins>
a
<del class="diff-old">Promise
</del>
<ins class="diff-chg">dictionary
of
</ins><a href="#dom-thingaction" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-new">ThingAction
</ins>
</code>
<del class="diff-old">that
resolves
with
the
return
value
or
rejects
with
an
Error
.
</del>
<del class="diff-old">4.6
</del>
</a>
<ins class="diff-chg">items.
</ins>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-actionmap" data-idl="interface" data-title="ActionMap">
<code>
<del class="diff-old">onPropertyChange()
</del>
<ins class="diff-chg">ActionMap
</ins>
</code>
</dfn>
<del class="diff-old">method
Returns
an
</del>
<ins class="diff-chg">interface
represents
a
maplike
dictionary
where
all
values
are
</ins><a href= "#dom-thingaction" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">Observable
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</a>
<del class="diff-old">for
the
Property
specified
in
the
name
argument,
allowing
subscribing
to
and
unsubscribing
from
notifications.
</del>
<ins class="diff-chg">objects.
</ins>
The
<del class="diff-old">callback
function
passed
to
the
</del>
<code>
<del class="diff-old">subscribe()
</del>
<ins class="diff-chg">invoke()
</ins>
</code>
method
<del class="diff-old">when
invoked
on
</del>
<ins class="diff-chg">represents
a
request
to
invoke
</ins>
the
<del class="diff-old">returned
observer
will
receive
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Action
</ins></a><ins class="diff-chg">
on
</ins>
the
<del class="diff-old">new
property
value
each
time
it
is
changed.
</del>
<ins class="diff-chg">remote
</ins><a href="#dfn-things" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a>.
</p>
<del class="diff-old">4.7
</del>
<p>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-events" data-idl="attribute" data-title="events" data-type="EventMap" data-lt= "consumedthing.events|events">
<code>
<del class="diff-old">onEvent()
</del>
<ins class="diff-chg">events
</ins>
</code>
</dfn>
<del class="diff-old">method
Returns
an
</del>
<ins class="diff-chg">attribute
represents
a
dictionary
of
</ins><a href="#dom-thingevent" class= "internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">Observable
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
</a>
<del class="diff-old">for
the
Event
specified
in
the
name
argument,
allowing
subscribing
to
and
unsubscribing
from
notifications.
The
callback
function
passed
to
the
subscribe()
method
when
invoked
on
the
returned
observer
will
receive
the
event
data
each
time
the
event
is
fired.
4.8
</del>
<ins class="diff-chg">items.
</ins>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-eventmap" data-idl="interface" data-title= "EventMap">
<code>
<del class="diff-old">onTDChange()
</del>
<ins class="diff-chg">EventMap
</ins>
</code>
</dfn>
<del class="diff-old">method
Returns
an
</del>
<ins class="diff-chg">interface
represents
a
maplike
dictionary
where
all
values
are
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">Observable
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
<del class="diff-old">,
allowing
subscribing
to
and
unsubscribing
from
notifications
to
the
Thing
Description
.
The
callback
function
passed
</del>
</a>
<ins class="diff-chg">objects.
Subscribing
</ins>
to
the
<del class="diff-old">subscribe()
method
when
invoked
</del>
<ins class="diff-chg">events
involves
setting
up
an
observation
(subscription)
mechanism
</ins>
on
the
<del class="diff-old">returned
observer
will
receive
the
new
Thing
Description
each
time
it
is
changed.
</del>
<ins class="diff-chg">remote
object.
</ins>
</p>
<section id="examples-0">
<h3 id="x4-1-examples">
<span class="secno">
<del class="diff-old">4.9
</del>
<ins class="diff-chg">4.1
</ins>
</span>
Examples
<a class="self-link" aria-label="§" href= "#examples-0">
</a>
</h3>
<p>
Below
a
<code>
<a href="#dom-consumedthing" class="internalDFN" data-link-type="dfn">
<code>
ConsumedThing
</code>
</a>
</code>
interface
example
is
given.
</p>
<div class="example" id="ex-4-consume-a-thing">
<div class="marker">
<a class="self-link" href= "#ex-4-consume-a-thing">
Example
<del class="diff-old">6
</del>
<ins class="diff-chg">4
</ins></a>
<del class="diff-old">:
</del>
<span class="example-title">:
Consume
a
Thing
</span>
</div>
<del class="diff-old">try {
  let td = await wot.fetch("http://mmyservice.org/mySensor");
  let thing = wot.consume(td);
  console.log("Thing " + thing.name + " has been consumed.");
  let subscription = thing.onPropertyChange("temperature")
    .subscribe(function(value) {
      console.log("Temperature + " has changed to " + value);
    });
  thing.invokeAction("startMeasurement", { units: "Celsius" })
    .then(() =&gt; { console.log("Temperature measurement started."); })
    .catch(e =&gt; {
       console.log("Error starting measurement.");
       subscription.unsubscribe();
     })
} catch(error) {
  console.log("Error during fetch or consume: " + error.message);
</del>
<pre class="hljs javascript" aria-busy="false"><span class=
<ins class="diff-chg">"hljs-keyword">try</span> {
</ins>  <span class=<ins class="diff-chg">
"hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe(
</ins>    <span class="hljs-function"><span class=<ins class="diff-chg">
"hljs-params">td</span> =&gt;</span> {
</ins>      <span class=<ins class="diff-chg">
"hljs-keyword">let</span> thing = wot.consume(td);
</ins>      <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Thing "</span> + thing.name + <span class=
"hljs-string">" has been consumed."</span>);
</ins>      <span class=<ins class="diff-chg">
"hljs-keyword">let</span> subscription = thing[<span class=
"hljs-string">"temperature"</span>].subscribe(<span class=
"hljs-function"><span class=
"hljs-keyword">function</span>(<span class=
"hljs-params">value</span>) </span>{
</ins>          <span class=<ins class="diff-chg">
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature: "</span> + value);
        });
      thing.actions[<span class=
"hljs-string">"startMeasurement"</span>].invoke({ <span class=
"hljs-attr">units</span>: <span class=
"hljs-string">"Celsius"</span> })
        .then(<span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature measurement started."</span>); })
        .catch(<span class="hljs-function"><span class=
"hljs-params">e</span> =&gt;</span> {
</ins>           <span class=<ins class="diff-chg">
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error starting measurement."</span>);
           subscription.unsubscribe();
         })
    },
    error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
    () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
  );
} <span class="hljs-keyword">catch</span>(error) {
</ins>  <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Error: "</span> + error.message);
</ins>
};
</pre>
</div>
</section>
</section>
<section data-dfn-for="ExposedThing" id= "the-exposedthing-interface">
<h2 id="x5-the-exposedthing-interface">
<span class= "secno">
5.
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-exposedthing" data-idl="interface" data-title= "ExposedThing">
<code>
ExposedThing
</code>
</dfn>
interface
<a class= "self-link" aria-label="§" href= "#the-exposedthing-interface">
</a>
</h2>
<p>
The
<a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
ExposedThing
</code>
</a>
interface
is
the
server
API
that
allows
defining
request
handlers,
properties,
<a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
Actions
</a>,
and
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Events
</a>
to
a
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>.
It
also
implements
the
<a href="#dom-observable" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ConsumedThing
</del>
<ins class="diff-chg">Observable
</ins>
</code>
</a>
interface.
An
<a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
is
created
by
the
<a href= "#the-produce-method">
produce()
</a>
method.
</p>
<del class="diff-old">Editor's
note
It
is
under
consideration
to
use
a
constructor
for
ExposedThing
instead
of
a
factory
method.
</del>
<div>
<del class="diff-old">&lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt; implements &lt;a href=
"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlInterface" id="idl-def-exposedthing" data-idl=""
data-title="ExposedThing"&gt;interface &lt;span class=
</del>
<pre class="def idl"><span class="idlInterface" id=
<ins class="diff-chg">"idl-def-exposedthing" data-idl="" data-title=
"ExposedThing">interface <span class=
</ins>
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-exposedthing" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; {
&lt;span class=
"idlSectionComment"&gt;    // define how to expose and run the Thing
&lt;span class="idlMethod" id="idl-def-exposedthing-start" data-idl=""
data-title="start" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-no-default=""
data-link-for="exposedthing" data-lt="start()|start" href=
"#dom-exposedthing-start" class="internalDFN" data-link-type=
"dfn"&gt;start
&lt;span class="idlMethod" id="idl-def-exposedthing-stop" data-idl=""
data-title="stop" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-no-default=""
data-link-for="exposedthing" data-lt="stop()|stop" href=
"#dom-exposedthing-stop" class="internalDFN" data-link-type=
"dfn"&gt;stop
&lt;span class="idlMethod" id=
"idl-def-exposedthing-register-directory" data-idl="" data-title=
"register" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-no-default=""
data-link-for="exposedthing" data-lt="register()|register" href=
"#dom-exposedthing-register" class="internalDFN" data-link-type=
"dfn"&gt;register(&lt;span class=
"idlParam"&gt;optional &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString
&lt;span class="idlMethod" id=
"idl-def-exposedthing-unregister-directory" data-idl="" data-title=
"unregister" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
</del>
<ins class="diff-chg">"dfn"><code>ExposedThing</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-thingfragment" class="internalDFN"
data-link-type=
"dfn"><code>ThingFragment</code></a></span> {<span class=
"idlAttribute" id="idl-def-exposedthing-properties" data-idl=""
data-title="properties" data-dfn-for="exposedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-propertymap" class="internalDFN" data-link-type=
"dfn"><code>PropertyMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="exposedthing"
data-lt="exposedthing.properties|properties" href=
"#dom-exposedthing-properties" class="internalDFN" data-link-type=
"dfn"><code>properties</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-exposedthing-actions" data-idl=""
data-title="actions" data-dfn-for="exposedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-actionmap" class="internalDFN" data-link-type=
"dfn"><code>ActionMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="exposedthing"
data-lt="exposedthing.actions|actions" href=
"#dom-exposedthing-actions" class="internalDFN" data-link-type=
"dfn"><code>actions</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-exposedthing-events" data-idl=""
data-title="events" data-dfn-for="exposedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-exposedevents" class="internalDFN" data-link-type=
"dfn"><code>ExposedEvents</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="exposedthing"
data-lt="exposedthing.events|events" href=
"#dom-exposedthing-events" class="internalDFN" data-link-type=
"dfn"><code>events</code></a></span>;</span><span class="idlMethod"
id="idl-def-exposedthing--name" data-idl="" data-title=""
data-dfn-for="exposedthing"><span class="idlSectionComment">
  // getter for ThingFragment properties
</ins>  </span>getter<span class="idlMethType"> <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-any">any</a></span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing--name-value" data-idl="" data-title=""
data-dfn-for="exposedthing"><span class="idlSectionComment">
  // setter for ThingFragment properties
</ins>  </span>setter<span class="idlMethType"> void</span> (<span class=<ins class="diff-chg">
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-expose" data-idl="" data-title="expose"
data-dfn-for="exposedthing"><span class="idlMethType"><span class=
"idlSectionComment">
  // methods to expose and destroy the Thing
</ins>  </span><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
<del class="diff-old">data-link-for="exposedthing" data-lt="unregister()|unregister"
href="#dom-exposedthing-unregister" class="internalDFN"
data-link-type="dfn"&gt;unregister(&lt;span class=
"idlParam"&gt;optional &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString
&lt;span class="idlMethod" id=
"idl-def-exposedthing-emitevent-eventname-payload" data-idl=""
data-title="emitEvent" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
</del>
<ins class="diff-chg">data-link-for="exposedthing" data-lt=
"exposedthing.expose()|exposedthing.expose|expose()|expose" href=
"#dom-exposedthing-expose" class="internalDFN" data-link-type=
"dfn"><code>expose</code></a></span>();</span><span class=
"idlMethod" id="idl-def-exposedthing-destroy" data-idl=""
data-title="destroy" data-dfn-for="exposedthing"><span class=
"idlMethType">
</ins>  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
<del class="diff-old">data-link-for="exposedthing" data-lt="emitevent()|emitEvent" href=
"#dom-exposedthing-emitevent" class="internalDFN" data-link-type=
"dfn"&gt;emitEvent&lt;span class=
"idlParamType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class=
"idlSectionComment"&gt;    // define Thing Description modifiers
&lt;span class="idlMethod" id=
"idl-def-exposedthing-addproperty-property" data-idl="" data-title=
"addProperty" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"&gt;  &lt;span class=
</del>
<ins class="diff-chg">data-link-for="exposedthing" data-lt=
"exposedthing.destroy()|exposedthing.destroy|destroy()|destroy"
href="#dom-exposedthing-destroy" class="internalDFN"
data-link-type="dfn"><code>destroy</code></a></span>();</span><span class="idlMethod"
id="idl-def-exposedthing-addproperty-name-property-initvalue"
data-idl="" data-title="addProperty" data-dfn-for=
"exposedthing"><span class="idlMethType"><span class=
"idlSectionComment">
  // define Properties
</ins>  </span><a data-link-for="" href="#dom-exposedthing" class=<ins class="diff-chg">
"internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
</ins>
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
<del class="diff-old">data-lt="addproperty()|addProperty" href=
"#dom-exposedthing-addproperty" class="internalDFN" data-link-type=
"dfn"&gt;addProperty&lt;span class=
"idlParamType"&gt;&lt;a href="#dom-thingproperty" class="internalDFN"
</del>
<ins class="diff-chg">data-lt=
"exposedthing.addproperty()|exposedthing.addproperty|addproperty()|addproperty"
href="#dom-exposedthing-addproperty" class="internalDFN"
</ins>
data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlParamName"&gt;property
&lt;span class="idlMethod" id=
"idl-def-exposedthing-removeproperty-name" data-idl="" data-title=
"removeProperty" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-exposedthing" class="internalDFN"
</del>
<ins class="diff-chg">"dfn"><code>addProperty</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-propertyfragment" class="internalDFN" data-link-type=
"dfn"><code>PropertyFragment</code></a></span> <span class=
"idlParamName">property</span></span>,<span class=
"idlParam"> optional<span class="idlParamType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">initValue</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-setpropertyreadhandler-name-readhandler"
data-idl="" data-title="setPropertyReadHandler" data-dfn-for=
"exposedthing"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
<del class="diff-old">"dfn"&gt;  &lt;span class=
</del>
<ins class="diff-chg">"dfn"><code>ExposedThing</code></a></span> <span class=
</ins>
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
<del class="diff-old">data-lt="removeproperty()|removeProperty" href=
"#dom-exposedthing-removeproperty" class="internalDFN"
data-link-type="dfn"&gt;removeProperty(&lt;span class=
</del>
<ins class="diff-chg">data-lt=
"exposedthing.setpropertyreadhandler()|exposedthing.setpropertyreadhandler|setpropertyreadhandler()|setpropertyreadhandler"
href="#dom-exposedthing-setpropertyreadhandler" class="internalDFN"
data-link-type=
"dfn"><code>setPropertyReadHandler</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id="idl-def-exposedthing-addaction-action"
data-idl="" data-title="addAction" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="exposedthing"
data-lt="addaction()|addAction" href="#dom-exposedthing-addaction"
class="internalDFN" data-link-type=
"dfn"&gt;addAction&lt;span class=
"idlParamType"&gt;&lt;a href="#dom-thingaction" class="internalDFN"
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-propertyreadhandler" class="internalDFN" data-link-type=
"dfn"><code>PropertyReadHandler</code></a></span> <span class=
"idlParamName">readHandler</span></span>);</span><span class=
"idlMethod" id=
"idl-def-exposedthing-setpropertywritehandler-name-writehandler"
data-idl="" data-title="setPropertyWriteHandler" data-dfn-for=
"exposedthing"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlParamName"&gt;action
&lt;span class="idlMethod" id="idl-def-exposedthing-removeaction-name"
data-idl="" data-title="removeAction" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
</del>
<ins class="diff-chg">"dfn"><code>ExposedThing</code></a></span> <span class=
</ins>
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
<del class="diff-old">data-lt="removeaction()|removeAction" href=
"#dom-exposedthing-removeaction" class="internalDFN"
data-link-type="dfn"&gt;removeAction(&lt;span class=
</del>
<ins class="diff-chg">data-lt=
"exposedthing.setpropertywritehandler()|exposedthing.setpropertywritehandler|setpropertywritehandler()|setpropertywritehandler"
href="#dom-exposedthing-setpropertywritehandler" class=
"internalDFN" data-link-type=
"dfn"><code>setPropertyWriteHandler</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id="idl-def-exposedthing-addevent-event"
data-idl="" data-title="addEvent" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="exposedthing"
data-lt="addevent()|addEvent" href="#dom-exposedthing-addevent"
class="internalDFN" data-link-type=
"dfn"&gt;addEvent&lt;span class=
"idlParamType"&gt;&lt;a href="#dom-thingevent" class="internalDFN"
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-propertywritehandler" class="internalDFN"
data-link-type="dfn"><code>PropertyWriteHandler</code></a></span> <span class="idlParamName">writeHandler</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-removeproperty-name" data-idl=""
data-title="removeProperty" data-dfn-for=
"exposedthing"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
<del class="diff-old">"dfn"&gt;
&lt;span class="idlMethod" id="idl-def-exposedthing-removeevent-name"
data-idl="" data-title="removeEvent" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="exposedthing"
data-lt="removeevent()|removeEvent" href=
"#dom-exposedthing-removeevent" class="internalDFN" data-link-type=
"dfn"&gt;removeEvent&lt;span class=
"idlParamType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class=
"idlSectionComment"&gt;    // define request handlers
&lt;span class="idlMethod" id=
"idl-def-exposedthing-setpropertyreadhandler-name-readhandler"
data-idl="" data-title="setPropertyReadHandler" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
</del>
<ins class="diff-chg">"dfn"><code>ExposedThing</code></a></span> <span class=
</ins>
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
<del class="diff-old">data-lt="setpropertyreadhandler()|setPropertyReadHandler" href=
"#dom-exposedthing-setpropertyreadhandler" class="internalDFN"
data-link-type="dfn"&gt;setPropertyReadHandler(&lt;span class=
</del>
<ins class="diff-chg">data-lt=
"exposedthing.removeproperty()|exposedthing.removeproperty|removeproperty()|removeproperty"
href="#dom-exposedthing-removeproperty" class="internalDFN"
data-link-type=
"dfn"><code>removeProperty</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString,
                                         &lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-addaction-name-init-action" data-idl=""
data-title="addAction" data-dfn-for="exposedthing"><span class=
"idlMethType"><span class="idlSectionComment">
  // define Actions
</ins>  </span><a data-link-for="" href="#dom-exposedthing" class=<ins class="diff-chg">
"internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.addaction()|exposedthing.addaction|addaction()|addaction"
href="#dom-exposedthing-addaction" class="internalDFN"
data-link-type="dfn"><code>addAction</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"#dom-propertyreadhandler" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;readHandler
&lt;span class="idlMethod" id=
"idl-def-exposedthing-setpropertywritehandler-name-writehandler"
data-idl="" data-title="setPropertyWriteHandler" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-actionfragment" class="internalDFN" data-link-type=
"dfn"><code>ActionFragment</code></a></span> <span class=
"idlParamName">init</span></span>,<span class=
"idlParam"><span class="idlParamType"> <a data-link-for="" href=
"#dom-actionhandler" class="internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-removeaction-name" data-idl="" data-title=
"removeAction" data-dfn-for="exposedthing"><span class=
"idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"<ins class="diff-chg">
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
</ins>
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
<del class="diff-old">data-lt="setpropertywritehandler()|setPropertyWriteHandler" href=
"#dom-exposedthing-setpropertywritehandler" class="internalDFN"
</del>
<ins class="diff-chg">data-lt=
"exposedthing.removeaction()|exposedthing.removeaction|removeaction()|removeaction"
href="#dom-exposedthing-removeaction" class="internalDFN"
</ins>
data-link-type=
<del class="diff-old">"dfn"&gt;setPropertyWriteHandler,
                                          &lt;span class=
</del>
<ins class="diff-chg">"dfn"><code>removeAction</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"#dom-propertywritehandler" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;writeHandler
&lt;span class="idlMethod" id=
"idl-def-exposedthing-setactionhandler-name-action" data-idl=""
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-setactionhandler-name-action" data-idl=""
</ins>
data-title="setActionHandler" data-dfn-for=
<del class="diff-old">"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"&gt;  &lt;span class=
</del>
<ins class="diff-chg">"exposedthing"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"<ins class="diff-chg">
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
</ins>
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
<del class="diff-old">data-lt="setactionhandler()|setActionHandler" href=
"#dom-exposedthing-setactionhandler" class="internalDFN"
data-link-type="dfn"&gt;setActionHandler(&lt;span class=
</del>
<ins class="diff-chg">data-lt=
"exposedthing.setactionhandler()|exposedthing.setactionhandler|setactionhandler()|setactionhandler"
href="#dom-exposedthing-setactionhandler" class="internalDFN"
data-link-type=
"dfn"><code>setActionHandler</code></a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a href="#dom-actionhandler"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;action
};
&lt;span class="idlCallback" id="idl-def-propertyreadhandler"
data-idl="" data-title="PropertyReadHandler"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-propertyreadhandler" class="internalDFN" data-link-type=
"dfn"&gt; = &lt;span class=
"idlCallbackType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise
&lt;span class="idlCallback" id="idl-def-propertywritehandler"
data-idl="" data-title="PropertyWriteHandler"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-propertywritehandler" class="internalDFN"
data-link-type="dfn"&gt;
&lt;span class="idlCallback" id="idl-def-actionhandler" data-idl=""
data-title="ActionHandler"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
</ins>
href="#dom-actionhandler" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; = &lt;span class=
"idlCallbackType"&gt;&lt;a href=
</del>
<ins class="diff-chg">"dfn"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-addevent-name-event" data-idl=""
data-title="addEvent" data-dfn-for="exposedthing"><span class=
"idlMethType"><span class="idlSectionComment">
  // define Events
</ins>  </span><a data-link-for="" href="#dom-exposedthing" class=<ins class="diff-chg">
"internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.addevent()|exposedthing.addevent|addevent()|addevent"
href="#dom-exposedthing-addevent" class="internalDFN"
data-link-type="dfn"><code>addEvent</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-eventfragment" class="internalDFN" data-link-type=
"dfn"><code>EventFragment</code></a></span> <span class=
"idlParamName">event</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-removeevent-name" data-idl="" data-title=
"removeEvent" data-dfn-for="exposedthing"><span class=
"idlMethType">
</ins>  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"<ins class="diff-chg">
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.removeevent()|exposedthing.removeevent|removeevent()|removeevent"
href="#dom-exposedthing-removeevent" class="internalDFN"
data-link-type=
"dfn"><code>removeEvent</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
};</span><span class="idlInterface" id="idl-def-exposedevents"
data-idl="" data-title="ExposedEvents">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-exposedevents" class=
"internalDFN" data-link-type=
"dfn"><code>ExposedEvents</code></a></span> {<span class=
"idlMaplike" id="idl-def-exposedevents-maplike" data-idl=""
data-title="iterable" data-dfn-for="exposedevents">
  maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-exposedevent" class="internalDFN" data-link-type=
"dfn"><code>ExposedEvent</code></a>&gt;;</span>
};</span><span class="idlCallback" id="idl-def-propertyreadhandler"
data-idl="" data-title="PropertyReadHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertyreadhandler" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyReadHandler</code></a></span> =<span class=
"idlCallbackType"> <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> ();</span><span class="idlCallback"
id="idl-def-propertywritehandler" data-idl="" data-title=
"PropertyWriteHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertywritehandler" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyWriteHandler</code></a></span> =<span class=
"idlCallbackType"> <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span><span class="idlCallback"
id="idl-def-actionhandler" data-idl="" data-title="ActionHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-actionhandler" class=
"internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> =<span class=
"idlCallbackType"> <a href=
</ins>
"https://heycam.github.io/webidl/#idl-promise">
Promise
</a>
&lt;
<a
href="https://heycam.github.io/webidl/#idl-any">
any
</a>
&gt;
</span>
(
<span class="idlParam">
<span class="idlParamType">
<a href="https://heycam.github.io/webidl/#idl-any">
any
</a>
</span>
<span class="idlParamName">
parameters
</span>
</span>
);
</span>
</pre>
</div>
<del class="diff-old">5.1
The
start()
method
</del>
<p>
<del class="diff-old">Start
serving
external
requests
for
the
Thing
.
5.2
</del>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-properties" data-idl="attribute" data-title= "properties" data-type="PropertyMap" data-lt= "exposedthing.properties|properties">
<code>
<del class="diff-old">stop()
</del>
<ins class="diff-chg">properties
</ins>
</code>
</dfn>
<del class="diff-old">method
Stop
serving
external
requests
for
the
Thing
.
5.3
The
</del>
<ins class="diff-chg">attribute
represents
a
dictionary
of
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">register()
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
<del class="diff-old">method
Generates
the
Thing
Description
</del>
</a>
<del class="diff-old">given
</del>
<ins class="diff-chg">items
in
which
</ins>
the
<del class="diff-old">properties,
Actions
</del>
<code>
<ins class="diff-chg">read()
</ins></code>
and
<del class="diff-old">Event
defined
for
this
object.
If
a
</del>
<code>
<del class="diff-old">directory
</del>
<ins class="diff-chg">write()
</ins>
</code>
<del class="diff-old">argument
is
given,
make
a
request
to
register
</del>
<ins class="diff-chg">methods
define
local
methods
that
access
</ins>
the
<del class="diff-old">Thing
Description
with
</del>
<ins class="diff-chg">physical
representations
of
</ins>
the
<del class="diff-old">given
WoT
repository
by
invoking
its
register
Action
</del>
<a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Properties
</ins>
</a>.
</p>
<del class="diff-old">5.4
</del>
<p>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-actions" data-idl="attribute" data-title= "actions" data-type="ActionMap" data-lt= "exposedthing.actions|actions">
<code>
<del class="diff-old">unregister()
</del>
<ins class="diff-chg">actions
</ins>
</code>
</dfn>
<del class="diff-old">method
If
</del>
<ins class="diff-chg">attribute
represents
</ins>
a
<ins class="diff-new">dictionary
of
</ins><a href="#dom-thingaction" class= "internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">directory
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
<del class="diff-old">argument
is
given,
make
a
request
to
unregister
the
Thing
Description
</del>
</a>
<del class="diff-old">with
</del>
<ins class="diff-chg">items
in
which
</ins>
the
<del class="diff-old">given
WoT
repository
by
invoking
its
</del>
<code>
<del class="diff-old">unregister
</del>
<ins class="diff-chg">invoke()
</ins>
</code>
<del class="diff-old">Action
.
Then,
and
in
the
case
no
arguments
were
provided
</del>
<ins class="diff-chg">method
represents
a
local
method
</ins>
to
<del class="diff-old">this
function,
stop
the
Thing
and
remove
</del>
<ins class="diff-chg">invoke
</ins>
the
<del class="diff-old">Thing
Description
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins>
</a>.
</p>
<del class="diff-old">5.5
</del>
<p>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-events" data-idl="attribute" data-title="events" data-type="ExposedEvents" data-lt= "exposedthing.events|events">
<code>
<del class="diff-old">emitEvent()
</del>
<ins class="diff-chg">events
</ins>
</code>
</dfn>
<del class="diff-old">method
Emits
an
the
event
initialized
with
the
event
name
specified
by
</del>
<ins class="diff-chg">attribute
represents
a
dictionary
of
</ins><a href="#dom-exposedevent" class= "internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
ExposedEvent
</ins></code></a><ins class="diff-chg">
items
that
add
</ins>
the
<code>
<del class="diff-old">eventName
</del>
<ins class="diff-chg">emit()
</ins>
</code>
<del class="diff-old">argument
and
data
specified
by
</del>
<ins class="diff-chg">method
to
</ins>
the
<a href= "#dom-thingevent" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">payload
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
<del class="diff-old">argument.
</del>
<del class="diff-old">5.6
</del>
</a>
<ins class="diff-chg">definition.
</ins>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-exposedevents" data-idl="interface" data-title= "ExposedEvents">
<code>
<del class="diff-old">DataSchema
</del>
<ins class="diff-chg">ExposedEvents
</ins>
</code>
</dfn>
<del class="diff-old">type
&lt;span class="idlTypedef" id=
"idl-def-dataschema" data-idl="" data-title=
"DataSchema"&gt;typedef &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-no-default=""
data-link-for="" data-lt="" href="#dom-dataschema" class=
"internalDFN" data-link-type=
"dfn"&gt;
</del>
<ins class="diff-chg">interface
represents
a
maplike
dictionary
where
all
values
are
</ins><a href= "#dom-exposedevent" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">DataSchema
</del>
<ins class="diff-chg">ExposedEvent
</ins>
</code>
</a>
<ins class="diff-new">objects.
</ins></p><section id="the-expose-method"><h3 id="x5-1-the-expose-method">
<span class="secno">
<ins class="diff-new">5.1
</ins>
</span>
<del class="diff-old">;
</del>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-expose" data-idl="operation" data-title= "expose()" data-type="Promise" data-lt= "exposedthing.expose()|exposedthing.expose|expose()|expose">
<code>
<del class="diff-old">DataSchema
</del>
<ins class="diff-chg">expose()
</ins>
</code>
</dfn>
<ins class="diff-new">method
</ins><a class="self-link" aria-label="§" href= "#the-expose-method">
</a>
<del class="diff-old">type
represents
a
data
type
specified
in
</del>
</h3>
<p>
<ins class="diff-chg">Start
serving
external
requests
for
</ins>
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">Description
</del>
</a>,
<ins class="diff-chg">so
that
</ins><a href="#dfn-wot-interactions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
WoT
Interactions
</ins>
</a>
<del class="diff-old">in
a
serialized
form.
</del>
<ins class="diff-chg">using
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Properties
</ins></a>,<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
s
and
</ins><a href="#dfn-events" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Event
</ins></a><ins class="diff-chg">
s
will
be
possible.
</ins>
</p>
<del class="diff-old">Editor's
note
</del>
<p>
<ins class="diff-chg">The
</ins>
<code>
<del class="diff-old">DataSchema
</del>
<ins class="diff-chg">expose()
</ins>
</code>
<del class="diff-old">is
under
development,
currently
it
can
denote
any
type
supported
by
</del>
<ins class="diff-chg">method
</ins><em class="rfc2119" title= "MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
run
</ins>
the
<del class="diff-old">Thing
Description
</del>
<ins class="diff-chg">following
steps:
</ins></p><ol><li><ins class="diff-chg">
Return
a
</ins><code><ins class="diff-chg">
Promise
</ins></code><var><ins class="diff-chg">
promise
</ins></var>
and
<ins class="diff-new">execute
</ins>
the
<del class="diff-old">WoT
Runtime
</del>
<ins class="diff-chg">next
steps
</ins><a href="#dfn-in-parallel" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
in
parallel
</ins>
</a>.
<del class="diff-old">5.7
The
</del>
</li>
<li>
<ins class="diff-chg">If
invoking
</ins>
<code>
<del class="diff-old">addProperty()
</del>
<ins class="diff-chg">expose()
</ins>
</code>
<del class="diff-old">method
Adds
</del>
<ins class="diff-chg">is
not
allowed
for
the
current
scripting
context
for
security
reasons,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins><code><ins class="diff-chg">
SecurityError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Make
</ins>
a
<del class="diff-old">Property
defined
by
</del>
<ins class="diff-chg">request
to
</ins>
the
<del class="diff-old">argument
</del>
<ins class="diff-chg">underlying
platform
to
attach
protocol
handlers
</ins>
and
<del class="diff-old">updates
</del>
<ins class="diff-chg">start
serving
external
requests
for
</ins><a href= "#dfn-wot-interactions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
WoT
Interactions
</ins></a><ins class="diff-chg">
(read,
write
and
observe
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Properties
</ins></a>,<ins class="diff-chg">
invoke
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
s
and
manage
</ins><a href= "#dfn-events" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Event
</ins></a><ins class="diff-chg">
subscriptions),
based
on
</ins>
the
<del class="diff-old">Thing
Description
</del>
<a href="#dfn-protocol-bindings" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Protocol
Bindings
</ins>
</a>.
<del class="diff-old">Throws
on
error.
Returns
a
reference
to
</del>
</li>
<li>
<ins class="diff-chg">If
there
was
an
error
during
</ins>
the
<del class="diff-old">same
</del>
<ins class="diff-chg">request,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
an
</ins><code><ins class="diff-chg">
Error
</ins></code>
object
<del class="diff-old">for
supporting
chaining.
</del>
<var>
<ins class="diff-chg">error
</ins></var><ins class="diff-chg">
with
</ins><code><ins class="diff-chg">
error.message
</ins></code><ins class="diff-chg">
set
to
the
error
code
seen
by
the
</ins><a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Protocol
Bindings
</ins></a><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Otherwise
resolve
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
and
terminate
these
steps.
</ins></li></ol></section><section id="the-destroy-method"><h3 id="x5-2-the-destroy-method">
<del class="diff-old">5.7.1
</del>
<span class="secno">
<ins class="diff-chg">5.2
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-destroy" data-idl="operation" data-title= "destroy()" data-type="Promise" data-lt= "exposedthing.destroy()|exposedthing.destroy|destroy()|destroy">
<code>
<del class="diff-old">ThingProperty
</del>
<ins class="diff-chg">destroy()
</ins>
</code>
</dfn>
<del class="diff-old">dictionary
&lt;span class="idlDictionary" id=
"idl-def-thingproperty" data-idl="" data-title=
"ThingProperty"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"&gt; : &lt;span class=
"idlSuperclass"&gt;&lt;a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-thingproperty-name" data-idl=""
data-title="name" data-dfn-for=
"thingproperty"&gt;    required &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-name" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingproperty-schema" data-idl=
"" data-title="schema" data-dfn-for=
"thingproperty"&gt;    required &lt;a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for="thingproperty"
data-lt="" href="#dom-thingproperty-schema" class="internalDFN"
data-link-type="dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingproperty-value" data-idl=
"" data-title="value" data-dfn-for=
"thingproperty"&gt;             &lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any&lt;a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-value" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingproperty-writable"
data-idl="" data-title="writable" data-dfn-for=
"thingproperty"&gt;             &lt;a href=
"https://heycam.github.io/webidl/#idl-boolean"&gt;boolean&lt;a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-writable" class="internalDFN" data-link-type=
"dfn"&gt; = &lt;span class=
"idlMemberValue"&gt;false
&lt;span class="idlMember" id="idl-def-thingproperty-observable"
data-idl="" data-title="observable" data-dfn-for=
"thingproperty"&gt;             &lt;a href=
"https://heycam.github.io/webidl/#idl-boolean"&gt;boolean&lt;a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-observable" class="internalDFN" data-link-type=
"dfn"&gt; = &lt;span class=
"idlMemberValue"&gt;false
};
</del>
<ins class="diff-chg">method
</ins><a class="self-link" aria-label="§" href="#the-destroy-method">
</a>
</h3>
<p>
<del class="diff-old">Represents
</del>
<ins class="diff-chg">Stop
serving
external
requests
for
</ins>
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
<del class="diff-old">Property
description.
</del>
<ins class="diff-chg">and
destroy
the
object.
Note
that
eventual
unregistering
should
be
done
before
invoking
this
method.
</ins>
</p>
<p>
The
<code>
<del class="diff-old">name
</del>
<ins class="diff-chg">destroy()
</ins>
</code>
<del class="diff-old">attribute
represents
</del>
<ins class="diff-chg">method
</ins><em class="rfc2119" title= "MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
run
</ins>
the
<del class="diff-old">name
of
</del>
<ins class="diff-chg">following
steps:
</ins></p><ol><li><ins class="diff-chg">
Return
a
</ins><code><ins class="diff-chg">
Promise
</ins></code><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
and
execute
</ins>
the
<del class="diff-old">Property
</del>
<ins class="diff-chg">next
steps
</ins><a href="#dfn-in-parallel" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
in
parallel
</ins>
</a>.
</li>
<li>
<del class="diff-old">The
</del>
<ins class="diff-chg">If
invoking
</ins>
<code>
<del class="diff-old">schema
</del>
<ins class="diff-chg">destroy()
</ins>
</code>
<del class="diff-old">attribute
represents
the
data
type
</del>
<ins class="diff-chg">is
not
allowed
</ins>
for
the
<del class="diff-old">Property
described
by
</del>
<ins class="diff-chg">current
scripting
context
for
security
reasons,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins>
<code>
<del class="diff-old">DataSchema
</del>
<ins class="diff-chg">SecurityError
</ins>
</code>
<del class="diff-old">.
</del>
<ins class="diff-chg">and
terminate
these
steps.
</ins>
</li>
<li>
<del class="diff-old">The
value
attribute
represents
</del>
<ins class="diff-chg">Make
a
request
to
</ins>
the
<del class="diff-old">value
of
</del>
<ins class="diff-chg">underlying
platform
to
stop
serving
external
requests
for
</ins><a href="#dfn-wot-interactions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
WoT
Interactions
</ins></a>,<ins class="diff-chg">
based
on
</ins>
the
<del class="diff-old">Property
</del>
<a href="#dfn-protocol-bindings" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Protocol
Bindings
</ins>
</a>.
</li>
<li>
<del class="diff-old">The
</del>
<ins class="diff-chg">If
there
was
an
error
during
the
request,
reject
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
an
</ins>
<code>
<del class="diff-old">writable
</del>
<ins class="diff-chg">Error
</ins>
</code>
<del class="diff-old">attribute
defines
whether
</del>
<ins class="diff-chg">object
</ins><var><ins class="diff-chg">
error
</ins></var><ins class="diff-chg">
with
</ins><code><ins class="diff-chg">
error.message
</ins></code><ins class="diff-chg">
set
to
</ins>
the
<del class="diff-old">Property
</del>
<ins class="diff-chg">error
code
seen
by
the
</ins><a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Protocol
Bindings
</ins>
</a>
<del class="diff-old">can
be
updated.
The
default
value
is
false
.
</del>
<ins class="diff-chg">and
terminate
these
steps.
</ins>
</li>
<li>
<del class="diff-old">The
</del>
<ins class="diff-chg">Otherwise
resolve
</ins><var><ins class="diff-chg">
promise
</ins></var><ins class="diff-chg">
with
</ins><var><ins class="diff-chg">
td
</ins></var><ins class="diff-chg">
and
terminate
these
steps.
</ins></li></ol></section><section id="the-addproperty-method"><h3 id="x5-3-the-addproperty-method">
<span class="secno">
<ins class="diff-new">5.3
</ins></span><ins class="diff-new">
The
</ins><dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-addproperty" data-idl="operation" data-title= "addProperty()" data-type="ExposedThing" data-lt= "exposedthing.addproperty()|exposedthing.addproperty|addproperty()|addproperty">
<code>
<del class="diff-old">observable
</del>
<ins class="diff-chg">addProperty()
</ins>
</code>
</dfn>
<del class="diff-old">attribute
defines
whether
the
</del>
<ins class="diff-chg">method
</ins><a class="self-link" aria-label="§" href="#the-addproperty-method"></a></h3><p><ins class="diff-chg">
Adds
a
</ins>
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
<del class="diff-old">changes
can
be
observed
</del>
<ins class="diff-chg">with
name
defined
by
the
</ins><var><ins class="diff-chg">
name
</ins></var><ins class="diff-chg">
argument,
the
data
schema
provided
</ins>
by
<ins class="diff-new">the
</ins><var><ins class="diff-new">
property
</ins></var><ins class="diff-new">
argument
of
type
</ins><a href= "#dom-propertyfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
PropertyFragment
</ins></code></a>,<ins class="diff-new">
and
optionally
</ins>
an
<del class="diff-old">external
client.
The
default
</del>
<ins class="diff-chg">initial
</ins>
value
<ins class="diff-new">provided
in
the
argument
</ins><var><ins class="diff-new">
initValue
</ins></var><ins class="diff-new">
whose
type
should
match
the
one
defined
in
the
</ins><code><ins class="diff-new">
type
</ins></code><ins class="diff-new">
property
according
to
the
</ins><a href="#dfn-value-matching-algorithm" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
value-matching
algorithm
</ins></a>.<ins class="diff-new">
If
</ins><var><ins class="diff-new">
initValue
</ins></var>
is
<ins class="diff-new">not
provided,
it
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
be
initialized
as
</ins>
<code>
<del class="diff-old">false
</del>
<ins class="diff-chg">undefined
</ins>
</code>.
<ins class="diff-chg">Implementations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
update
the
</ins><a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
Description
</ins></a>.<ins class="diff-chg">
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</ins></p>
</section>
<section id="the-removeproperty-method">
<h3 id="x5-4-the-removeproperty-method">
<span class= "secno">
<del class="diff-old">5.8
</del>
<ins class="diff-chg">5.4
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-removeproperty" data-idl= "operation" data-title="removeProperty()" data-type="ExposedThing" data-lt= "exposedthing.removeproperty()|exposedthing.removeproperty|removeproperty()|removeproperty">
<code>
removeProperty()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href="#the-removeproperty-method">
</a>
</h3>
<p>
Removes
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
specified
by
the
<code>
name
</code>
argument
and
updates
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
</section>
<section id="the-addaction-method">
<h3 id="x5-5-the-addaction-method">
<span class="secno">
<del class="diff-old">5.9
</del>
<ins class="diff-chg">5.5
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-addaction" data-idl="operation" data-title= "addAction()" data-type="ExposedThing" data-lt= "exposedthing.addaction()|exposedthing.addaction|addaction()|addaction">
<code>
addAction()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href="#the-addaction-method">
</a>
</h3>
<p>
Adds
<del class="diff-old">an
Action
</del>
to
the
<code>
<ins class="diff-chg">actions
</ins></code><ins class="diff-chg">
property
of
a
</ins><a href= "#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
object
<del class="diff-old">as
</del>
<ins class="diff-chg">an
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
with
name
</ins>
defined
by
the
<del class="diff-old">action
</del>
<var>
<ins class="diff-chg">name
</ins></var><ins class="diff-chg">
argument,
defines
input
and
output
data
format
by
the
</ins><var><ins class="diff-chg">
init
</ins></var>
argument
of
type
<a href="#dom-actionfragment" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ThingAction
</del>
<ins class="diff-chg">ActionFragment
</ins>
</code>
</a>,
and
<ins class="diff-new">adds
the
function
provided
in
the
</ins><var><ins class="diff-new">
action
</ins></var><ins class="diff-new">
argument
as
a
handler,
then
</ins>
updates
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
<del class="diff-old">5.9.1
The
ThingAction
dictionary
&lt;span class="idlDictionary" id=
"idl-def-thingaction" data-idl="" data-title=
"ThingAction"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingaction" class="internalDFN" data-link-type=
"dfn"&gt; : &lt;span class=
"idlSuperclass"&gt;&lt;a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-thingaction-name" data-idl=""
data-title="name" data-dfn-for=
"thingaction"&gt;    required &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="thingaction" data-lt="" href="#dom-thingaction-name"
class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingaction-inputschema"
data-idl="" data-title="inputSchema" data-dfn-for=
"thingaction"&gt;             &lt;a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for="thingaction"
data-lt="" href="#dom-thingaction-inputschema" class="internalDFN"
data-link-type="dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingaction-outputschema"
data-idl="" data-title="outputSchema" data-dfn-for=
"thingaction"&gt;             &lt;a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for="thingaction"
data-lt="" href="#dom-thingaction-outputschema" class="internalDFN"
data-link-type="dfn"&gt;
};
</del>
<p>
The
<del class="diff-old">ThingAction
</del>
<ins class="diff-chg">provided
</ins><var><ins class="diff-chg">
action
</ins></var><ins class="diff-chg">
callback
function
will
implement
invoking
an
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins>
</a>
<del class="diff-old">dictionary
describes
the
arguments
</del>
and
<em class="rfc2119" title= "SHOULD">
<ins class="diff-new">SHOULD
</ins></em><ins class="diff-new">
be
called
by
implementations
when
a
request
for
invoking
</ins>
the
<del class="diff-old">return
value.
The
name
attribute
provides
the
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
<del class="diff-old">name.
The
inputSchema
attribute
provides
the
description
of
the
input
arguments
(argument
list
</del>
is
<del class="diff-old">represented
by
an
object).
If
missing,
it
means
</del>
<ins class="diff-chg">received
from
</ins>
the
<del class="diff-old">action
does
not
accept
arguments.
</del>
<ins class="diff-chg">underlying
platform.
</ins>
The
<ins class="diff-chg">callback
will
receive
a
</ins>
<code>
<del class="diff-old">outputSchema
</del>
<ins class="diff-chg">parameters
</ins>
</code>
<del class="diff-old">attribute
provides
</del>
<ins class="diff-chg">dictionary
argument
according
to
</ins>
the
<del class="diff-old">description
</del>
<ins class="diff-chg">definition
in
the
</ins><var><ins class="diff-chg">
init.input
</ins></var><ins class="diff-chg">
argument
and
will
return
a
value
</ins>
of
<ins class="diff-new">type
defined
by
</ins>
the
<del class="diff-old">returned
data.
If
missing,
it
means
</del>
<var>
<ins class="diff-chg">init.output
</ins></var><ins class="diff-chg">
argument
according
to
</ins>
the
<del class="diff-old">action
does
not
return
data.
</del>
<a href="#dfn-value-matching-algorithm" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">value-matching
algorithm
</ins></a>.</p><p><ins class="diff-chg">
There
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
exactly
one
handler
for
any
given
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a>.<ins class="diff-chg">
If
no
handler
is
initialized
for
any
given
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a>,<ins class="diff-chg">
implementations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
throw
a
</ins><code><ins class="diff-chg">
TypeError
</ins></code>.</p>
</section>
<section id="the-removeaction-method">
<h3 id="x5-6-the-removeaction-method">
<span class= "secno">
<del class="diff-old">5.10
</del>
<ins class="diff-chg">5.6
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-removeaction" data-idl= "operation" data-title="removeAction()" data-type="ExposedThing" data-lt= "exposedthing.removeaction()|exposedthing.removeaction|removeaction()|removeaction">
<code>
removeAction()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href="#the-removeaction-method">
</a>
</h3>
<p>
Removes
the
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
specified
by
the
<code>
name
</code>
argument
and
updates
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
</a>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
</section>
<section id="the-addevent-method">
<h3 id="x5-7-the-addevent-method">
<span class="secno">
<del class="diff-old">5.11
</del>
<ins class="diff-chg">5.7
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-addevent" data-idl="operation" data-title= "addEvent()" data-type="ExposedThing" data-lt= "exposedthing.addevent()|exposedthing.addevent|addevent()|addevent">
<code>
addEvent()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href="#the-addevent-method">
</a>
</h3>
<p>
Adds
an
event
<del class="diff-old">to
the
Thing
object
as
</del>
<ins class="diff-chg">with
name
</ins>
defined
by
the
<var>
<ins class="diff-chg">name
</ins></var><ins class="diff-chg">
argument
and
qualifiers
and
initialization
value
provided
by
the
</ins><var>
event
</var>
argument
of
type
<a href="#dom-eventfragment" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ThingEvent
</del>
<ins class="diff-chg">EventFragment
</ins>
</code>
</a>
<ins class="diff-new">to
the
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
object
</ins>
and
updates
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
<del class="diff-old">5.11.1
The
ThingEvent
dictionary
&lt;span class="idlDictionary" id=
"idl-def-thingevent" data-idl="" data-title=
"ThingEvent"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"&gt; : &lt;span class=
"idlSuperclass"&gt;&lt;a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-thingevent-name" data-idl=""
data-title="name" data-dfn-for=
"thingevent"&gt;    required &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="thingevent" data-lt="" href="#dom-thingevent-name"
class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-thingevent-schema" data-idl=""
data-title="schema" data-dfn-for=
"thingevent"&gt;             &lt;a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-no-default="" data-link-for="thingevent"
data-lt="" href="#dom-thingevent-schema" class="internalDFN"
data-link-type="dfn"&gt;
};
The
name
attribute
represents
the
event
name.
The
schema
attribute
represents
the
type
of
the
data
that
is
attached
to
the
event.
If
missing,
it
means
the
event
does
not
carry
data.
</del>
</section>
<section id="the-removeevent-method">
<h3 id="x5-8-the-removeevent-method">
<del class="diff-old">5.12
</del>
<span class="secno">
<ins class="diff-chg">5.8
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-removeevent" data-idl="operation" data-title= "removeEvent()" data-type="ExposedThing" data-lt= "exposedthing.removeevent()|exposedthing.removeevent|removeevent()|removeevent">
<code>
removeEvent()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href="#the-removeevent-method">
</a>
</h3>
<p>
Removes
the
event
specified
by
the
<code>
name
</code>
argument
and
updates
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
</a>.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
</section>
<section data-dfn-for="PropertyReadHandler" id= "the-propertyreadhandler-callback">
<h3 id="x5-9-the-propertyreadhandler-callback">
<span class= "secno">
<del class="diff-old">5.13
</del>
<ins class="diff-chg">5.9
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-propertyreadhandler" data-idl="callback" data-title= "PropertyReadHandler">
<code>
PropertyReadHandler
</code>
</dfn>
callback
<a class="self-link" aria-label="§" href= "#the-propertyreadhandler-callback">
</a>
</h3>
<p>
A
function
that
<del class="diff-old">returns
</del>
<ins class="diff-chg">is
called
when
an
external
request
for
reading
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
is
received.
It
should
return
</ins>
a
Promise
and
resolves
it
with
the
value
of
the
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
matching
the
<code>
name
</code>
argument
to
the
<code>
setPropertyReadHandler
</code>
function,
or
rejects
with
an
error
if
the
property
is
not
found
or
the
value
cannot
be
retrieved.
</p>
</section>
<section data-dfn-for="PropertyWriteHandler" id= "the-propertywritehandler-callback">
<h3 id="x5-10-the-propertywritehandler-callback">
<span class= "secno">
<del class="diff-old">5.14
</del>
<ins class="diff-chg">5.10
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-propertywritehandler" data-idl="callback" data-title= "PropertyWriteHandler">
<code>
PropertyWriteHandler
</code>
</dfn>
callback
<a class="self-link" aria-label="§" href= "#the-propertywritehandler-callback">
</a>
</h3>
<p>
A
function
<ins class="diff-new">that
is
</ins>
called
<del class="diff-old">with
</del>
<ins class="diff-chg">when
an
external
request
for
writing
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
is
received.
It
is
given
the
requested
new
</ins>
<code>
value
</code>
as
argument
<del class="diff-old">that
returns
</del>
<ins class="diff-chg">and
should
return
</ins>
a
Promise
which
is
resolved
when
the
value
of
the
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
<del class="diff-old">matching
</del>
<ins class="diff-chg">that
matches
</ins>
the
<code>
name
</code>
argument
<del class="diff-old">to
the
setPropertyReadHandler
function
is
</del>
<ins class="diff-chg">has
been
</ins>
updated
with
<code>
value
</code>,
or
rejects
with
an
error
if
the
property
is
not
found
or
the
value
cannot
be
updated.
</p>
<div class="ednote" id="issue-container-generatedID-4">
<div role="heading" class="ednote-title marker" id="h-ednote-1" aria-level="4">
<span>
Editor's
note
</span>
</div>
<p class="">
Note
that
this
function
is
invoked
by
implementations
before
the
property
is
<del class="diff-old">updated,
so
the
</del>
<ins class="diff-chg">updated
and
it
actually
defines
what
to
do
when
a
write
request
is
received.
The
</ins>
code
in
this
callback
function
can
invoke
the
<code>
<del class="diff-old">readProperty()
</del>
<ins class="diff-chg">read()
</ins>
</code>
method
to
find
out
the
old
value
of
the
property,
if
needed.
Therefore
the
old
value
is
not
provided
to
this
<del class="diff-old">method.
</del>
<ins class="diff-chg">function.
</ins>
</p>
</div>
</section>
<section data-dfn-for="ActionHandler" id= "the-actionhandler-callback">
<h3 id="x5-11-the-actionhandler-callback">
<span class= "secno">
<del class="diff-old">5.15
</del>
<ins class="diff-chg">5.11
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-actionhandler" data-idl="callback" data-title= "ActionHandler">
<code>
ActionHandler
</code>
</dfn>
callback
<a class= "self-link" aria-label="§" href= "#the-actionhandler-callback">
</a>
</h3>
<p>
A
function
called
with
a
<code>
parameters
</code>
dictionary
argument
assembled
by
the
<a href="#dfn-wot-runtime" class= "internalDFN" data-link-type="dfn">
WoT
runtime
</a>
based
on
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
and
the
external
client
request.
It
returns
a
Promise
that
rejects
with
an
error
or
resolves
if
the
action
is
successful
or
ongoing
(may
also
resolve
with
a
control
object
such
as
an
<a href="#dom-observable" class= "internalDFN" data-link-type="dfn">
<code>
Observable
</code>
</a>
for
actions
that
need
progress
notifications
or
that
can
be
canceled).
</p>
</section>
<section id="the-setpropertyreadhandler-method">
<h3 id="x5-12-the-setpropertyreadhandler-method">
<span class= "secno">
<del class="diff-old">5.16
</del>
<ins class="diff-chg">5.12
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-setpropertyreadhandler" data-idl="operation" data-title="setPropertyReadHandler()" data-type="ExposedThing" data-lt= "exposedthing.setpropertyreadhandler()|exposedthing.setpropertyreadhandler|setpropertyreadhandler()|setpropertyreadhandler">
<code>
setPropertyReadHandler()
</code>
</dfn>
method
<a class= "self-link" aria-label="§" href= "#the-setpropertyreadhandler-method">
</a>
</h3>
<p>
Takes
<code>
name
</code>
as
string
argument
and
<code>
readHandler
</code>
as
argument
of
type
<a href= "#dom-propertyreadhandler" class="internalDFN" data-link-type= "dfn">
<code>
PropertyReadHandler
</code>
</a>.
Sets
the
handler
function
for
reading
the
specified
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
matched
by
<code>
name
</code>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
<p>
The
<code>
readHandler
</code>
callback
function
will
implement
reading
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
and
<em class="rfc2119" title= "SHOULD">
SHOULD
</em>
be
called
by
implementations
when
a
request
for
reading
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
is
received
from
the
underlying
platform.
</p>
<p>
There
<em class="rfc2119" title="SHOULD">
SHOULD
</em>
be
at
most
one
handler
for
any
given
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
and
newly
added
handlers
replace
the
old
handlers.
If
no
handler
is
initialized
for
any
given
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>,
implementations
<em class= "rfc2119" title="SHOULD">
SHOULD
</em>
implement
a
default
property
read
handler.
</p>
<p>
<ins class="diff-new">When
an
external
request
for
reading
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Property
</ins></a><var><ins class="diff-new">
propertyName
</ins></var><ins class="diff-new">
is
received,
the
runtime
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
execute
the
following
steps:
</ins></p><ol><li><ins class="diff-new">
Return
a
</ins><code><ins class="diff-new">
Promise
</ins></code><a href="#dfn-promise" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
and
execute
the
next
steps
</ins><a href="#dfn-in-parallel" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
in
parallel
</ins></a>.</li><li><ins class="diff-new">
If
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
with
</ins><var><ins class="diff-new">
propertyName
</ins></var><ins class="diff-new">
does
not
exist,
reject
</ins><a href="#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
with
a
</ins><code><ins class="diff-new">
ReferenceError
</ins></code><ins class="diff-new">
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
Otherwise,
if
no
read
handler
has
been
defined
for
</ins><var><ins class="diff-new">
propertyName
</ins></var>,<ins class="diff-new">
resolve
</ins><var><ins class="diff-new">
promise
</ins></var><ins class="diff-new">
with
the
value
of
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
named
</ins><var><ins class="diff-new">
propertyName
</ins></var><ins class="diff-new">
provided
by
the
runtime
implementation
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
Otherwise,
invoke
the
read
handler
associated
with
</ins><var><ins class="diff-new">
propertyName
</ins></var>.<ins class="diff-new">
If
it
rejects,
then
reject
</ins><var><ins class="diff-new">
promise
</ins></var><ins class="diff-new">
with
the
same
error,
and
resolve
</ins><a href= "#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
with
the
same
value.
</ins></li></ol>
</section>
<section id="the-setpropertywritehandler-method">
<h3 id="x5-13-the-setpropertywritehandler-method">
<span class= "secno">
<del class="diff-old">5.17
</del>
<ins class="diff-chg">5.13
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-setpropertywritehandler" data-idl="operation" data-title="setPropertyWriteHandler()" data-type="ExposedThing" data-lt= "exposedthing.setpropertywritehandler()|exposedthing.setpropertywritehandler|setpropertywritehandler()|setpropertywritehandler">
<code>
setPropertyWriteHandler()
</code>
</dfn>
method
<a class= "self-link" aria-label="§" href= "#the-setpropertywritehandler-method">
</a>
</h3>
<p>
Takes
<code>
name
</code>
as
string
argument
and
<code>
writeHandler
</code>
as
argument
of
type
<a href= "#dom-propertywritehandler" class="internalDFN" data-link-type= "dfn">
<code>
PropertyWriteHandler
</code>
</a>.
Sets
the
handler
function
for
writing
the
specified
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
matched
by
<code>
name
</code>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
<p>
There
<em class="rfc2119" title="SHOULD">
SHOULD
</em>
be
at
most
one
write
handler
for
any
given
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
and
newly
added
handlers
replace
the
old
handlers.
If
no
write
handler
is
initialized
for
any
given
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>,
implementations
<em class="rfc2119" title="SHOULD">
SHOULD
</em>
implement
default
property
update
and
notifying
observers
on
change.
</p>
<p>
<ins class="diff-new">When
an
external
request
for
writing
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Property
</ins></a><var><ins class="diff-new">
propertyName
</ins></var><ins class="diff-new">
with
a
new
value
</ins><var><ins class="diff-new">
value
</ins></var><ins class="diff-new">
is
received,
the
runtime
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
execute
the
following
steps:
</ins></p><ol><li><ins class="diff-new">
Return
a
</ins><code><ins class="diff-new">
Promise
</ins></code><a href="#dfn-promise" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
and
execute
the
next
steps
</ins><a href="#dfn-in-parallel" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
in
parallel
</ins></a>.</li><li><ins class="diff-new">
If
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
with
</ins><var><ins class="diff-new">
propertyName
</ins></var><ins class="diff-new">
does
not
exist,
reject
</ins><a href="#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
with
a
</ins><code><ins class="diff-new">
ReferenceError
</ins></code><ins class="diff-new">
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
Otherwise,
if
no
write
handler
has
been
defined
for
</ins><var><ins class="diff-new">
propertyName
</ins></var>,<ins class="diff-new">
the
runtime
implementation
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
update
the
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
value
with
</ins><var><ins class="diff-new">
value
</ins></var>,<ins class="diff-new">
resolve
</ins><var><ins class="diff-new">
promise
</ins></var><ins class="diff-new">
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
Otherwise,
invoke
the
write
handler
associated
with
</ins><var><ins class="diff-new">
propertyName
</ins></var><ins class="diff-new">
providing
</ins><var><ins class="diff-new">
value
</ins></var><ins class="diff-new">
as
argument.
If
it
rejects,
then
reject
</ins><var><ins class="diff-new">
promise
</ins></var><ins class="diff-new">
with
the
same
error,
and
resolve
</ins><a href="#dfn-promise" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
with
the
same
value.
</ins></li></ol>
</section>
<section id="the-setactionhandler-method">
<h3 id="x5-14-the-setactionhandler-method">
<span class= "secno">
<del class="diff-old">5.18
</del>
<ins class="diff-chg">5.14
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-setactionhandler" data-idl="operation" data-title="setActionHandler()" data-type= "ExposedThing" data-lt= "exposedthing.setactionhandler()|exposedthing.setactionhandler|setactionhandler()|setactionhandler">
<code>
setActionHandler()
</code>
</dfn>
method
<a class="self-link" aria-label="§" href="#the-setactionhandler-method">
</a>
</h3>
<p>
Takes
<code>
name
</code>
as
string
argument
and
<code>
action
</code>
as
argument
of
type
<a href= "#dom-actionhandler" class="internalDFN" data-link-type= "dfn">
<code>
ActionHandler
</code>
</a>.
Sets
the
handler
function
for
the
specified
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
matched
by
<code>
name
</code>.
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</p>
<p>
<del class="diff-old">If
provided,
this
</del>
<ins class="diff-chg">The
</ins><code><ins class="diff-chg">
action
</ins></code>
callback
function
will
implement
<del class="diff-old">invoking
</del>
an
<a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
Action
</a>
and
<em class="rfc2119" title="SHOULD">
SHOULD
</em>
be
called
by
implementations
when
a
request
for
invoking
<del class="diff-old">a
</del>
<ins class="diff-chg">the
</ins><a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
Action
</a>
is
received
from
the
underlying
platform.
<del class="diff-old">The
callback
will
receive
a
parameters
dictionary
argument.
</del>
</p>
<p>
There
<em class="rfc2119" title="SHOULD">
SHOULD
</em>
be
<del class="diff-old">exactly
</del>
<ins class="diff-chg">at
most
</ins>
one
handler
for
any
given
<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn">
Action
</a>
<ins class="diff-new">and
newly
added
handlers
replace
the
old
handlers.
</ins></p><p><ins class="diff-new">
When
an
external
request
for
invoking
the
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins></a><ins class="diff-new">
identified
by
</ins><var><ins class="diff-new">
name
</ins></var><ins class="diff-new">
is
received,
the
runtime
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
execute
the
following
steps:
</ins></p><ol><li><ins class="diff-new">
Return
a
</ins><code><ins class="diff-new">
Promise
</ins></code><a href="#dfn-promise" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
and
execute
the
next
steps
</ins><a href="#dfn-in-parallel" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
in
parallel
</ins>
</a>.
</li>
<li>
If
<ins class="diff-new">an
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins></a><ins class="diff-new">
identified
by
</ins><var><ins class="diff-new">
name
</ins></var><ins class="diff-new">
does
not
exist,
reject
</ins><a href="#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
with
a
</ins><code><ins class="diff-new">
ReferenceError
</ins></code><ins class="diff-new">
and
terminate
these
steps.
</ins></li><li><ins class="diff-new">
Otherwise,
if
</ins>
no
<ins class="diff-new">action
</ins>
handler
<del class="diff-old">is
initialized
</del>
<ins class="diff-chg">has
been
defined
</ins>
for
<del class="diff-old">any
given
</del>
<var>
<ins class="diff-chg">name
</ins></var>,<ins class="diff-chg">
reject
</ins><a href="#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
promise
</ins></a><ins class="diff-chg">
with
a
</ins><code><ins class="diff-chg">
ReferenceError
</ins></code><ins class="diff-chg">
and
terminate
these
steps.
</ins></li><li><ins class="diff-chg">
Otherwise,
invoke
the
</ins>
<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn">
Action
<del class="diff-old">,
implementations
SHOULD
return
</del>
</a>
<ins class="diff-chg">handler
associated
with
</ins><var><ins class="diff-chg">
name
</ins></var>.<ins class="diff-chg">
If
it
rejects
with
</ins><var>
error
</var>,
<ins class="diff-new">then
reject
</ins><var><ins class="diff-new">
promise
</ins></var><ins class="diff-new">
with
the
same
</ins><var><ins class="diff-new">
error
</ins></var>,<ins class="diff-new">
otherwise
</ins>
if
<ins class="diff-new">it
resolves
with
</ins><var><ins class="diff-new">
value
</ins></var>,<ins class="diff-new">
then
resolve
</ins><a href= "#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
promise
</ins></a><ins class="diff-new">
with
</ins>
the
<del class="diff-old">action
is
invoked
by
any
client.
</del>
<ins class="diff-chg">same
</ins><var><ins class="diff-chg">
value
</ins></var>.</li></ol>
</section>
<section id="examples-1">
<h3 id="x5-15-examples">
<span class="secno">
<del class="diff-old">5.19
</del>
<ins class="diff-chg">5.15
</ins>
</span>
Examples
<a class="self-link" aria-label="§" href= "#examples-1">
</a>
</h3>
<p>
Below
some
<code>
<a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
ExposedThing
</code>
</a>
</code>
interface
examples
are
given.
</p>
<div class="example" id= "ex-5-create-a-new-exposed-thing-with-a-simple-property">
<div class="marker">
<a class="self-link" href= "#ex-5-create-a-new-exposed-thing-with-a-simple-property">
Example
<del class="diff-old">7
</del>
<ins class="diff-chg">5
</ins></a>
<del class="diff-old">:
</del>
<span class="example-title">:
Create
a
new
<del class="diff-old">blank
</del>
exposed
Thing
<ins class="diff-new">with
a
simple
property
</ins>
</span>
</div>
<pre class="highlight hljs javascript" aria-busy="false">
        <span class="hljs-keyword">try</span> {
  <span class=
<del class="diff-old">"hljs-keyword"&gt;var thing = WoT.produce({ &lt;span class=
"hljs-attr"&gt;name: &lt;span class=
"hljs-string"&gt;"tempSensor" });
  
  thing.addProperty({
    : &lt;span class=
"hljs-string"&gt;"temperature",
    : &lt;span class=
"hljs-number"&gt;0.0,
    : &lt;span class=
"hljs-string"&gt;'{ "type": "number" }'
    &lt;span class=
"hljs-comment"&gt;// use default values for the rest
  }).addProperty({
    : &lt;span class=
"hljs-string"&gt;"max",
    : &lt;span class=
"hljs-number"&gt;0.0,
    : &lt;span class=
"hljs-string"&gt;'{ "type": "number" }'
    &lt;span class=
"hljs-comment"&gt;// use default values for the rest
  }).addAction({
    : &lt;span class=
"hljs-string"&gt;"reset",
    
  }).addEvent({
</del>
<ins class="diff-chg">"hljs-keyword">var</span> temperatureValueDefinition = {
</ins>    <span class="hljs-attr">type</span>: <span class=<ins class="diff-chg">
"hljs-string">"number"</span>,
</ins>    <span class="hljs-attr">minimum</span>: <span class=<ins class="diff-chg">
"hljs-number">-50</span>,
</ins>    <span class="hljs-attr">maximum</span>: <span class=<ins class="diff-chg">
"hljs-number">10000</span>
  };
</ins>  <span class=<ins class="diff-chg">
"hljs-keyword">var</span> temperaturePropertyDefinition = temperatureValueDefinition;
</ins>  <span class="hljs-comment">// add the 'forms' property</span><ins class="diff-chg">
  temperaturePropertyDefinition.forms = [ ... ];
</ins>  <span class="hljs-keyword">var</span> thing = WoT.produce({
    <span class="hljs-attr">name</span>: <span class=
<del class="diff-old">"hljs-string"&gt;"onchange",
    : &lt;span class=
"hljs-string"&gt;'{ "type": "number" }'
  });
  
  thing.setActionHandler(&lt;span class=
"hljs-string"&gt;"reset", () =&gt; {
    .log(&lt;span class=
"hljs-string"&gt;"Resetting maximum");
    thing.writeProperty(&lt;span class=
"hljs-string"&gt;"max");
  });
  thing.start().then(&lt;span class=
"hljs-params"&gt;() {
      thing.register();
</del>
<ins class="diff-chg">"hljs-string">"tempSensor"</span>,
</ins>    <span class="hljs-attr">properties</span>: {      <span class=<ins class="diff-chg">
"hljs-attr">temperature</span>: temperaturePropertyDefinition
    },
</ins>    <span class="hljs-attr">actions</span>: {      <span class="hljs-attr">reset</span>: {        <span class="hljs-attr">description</span>: <span class=<ins class="diff-chg">
"hljs-string">"Reset the temperature sensor"</span>,
</ins>        <span class="hljs-attr">input</span>: {          <span class=<ins class="diff-chg">
"hljs-attr">temperature</span>: temperatureValueDefinition
        },
</ins>        <span class="hljs-attr">output</span>: <span class=<ins class="diff-chg">
"hljs-literal">null</span>,
</ins>        <span class="hljs-attr">forms</span>: []<ins class="diff-chg">
      },
    },
</ins>    <span class="hljs-attr">events</span>: {      <span class=<ins class="diff-chg">
"hljs-attr">onchange</span>: temperatureValueDefinition
    },
</ins>    <span class="hljs-attr">links</span>: []
  });
  <span class="hljs-keyword">await</span> thing.expose();
  <span class="hljs-keyword">await</span> wot.register(<span class=
<ins class="diff-new">"hljs-string">"https://mydirectory.org"</span>, thing);
</ins>
  <span class="hljs-comment">// define Thing business logic</span>
  setInterval( <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">let</span> mock = <span class=
"hljs-built_in">Math</span>.random()*<span class=
"hljs-number">100</span>;
<del class="diff-old">    thing.writeProperty(&lt;span class=
"hljs-string"&gt;"temperature", mock);
</del>
    <span class="hljs-keyword">let</span> old = <span class=
<del class="diff-old">"hljs-keyword"&gt;await thing.readProperty(&lt;span class=
"hljs-string"&gt;"max");
</del>
<ins class="diff-chg">"hljs-keyword">await</span> thing[<span class=
"hljs-string">"temperature"</span>].read();
</ins>
    <span class="hljs-keyword">if</span> (old &lt; mock) {
<del class="diff-old">      thing.writeProperty(&lt;span class=
"hljs-string"&gt;"max", mock);
      thing.emitEvent();
</del>
      <span class="hljs-keyword">await</span> thing[<span class=
<ins class="diff-chg">"hljs-string">"temperature"</span>].write(mock);
      thing.emitEvent(<span class=
"hljs-string">"onchange"</span>, mock);
</ins>
    }
  }, <span class="hljs-number">1000</span>);
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}
</pre>
</div>
<div class="example" id= "ex-6-create-a-new-exposed-thing-with-object-property">
<div class="marker">
<a class="self-link" href= "#ex-6-create-a-new-exposed-thing-with-object-property">
Example
<del class="diff-old">8
</del>
<ins class="diff-chg">6
</ins></a><span class="example-title">:<ins class="diff-chg">
Create
a
new
exposed
Thing
with
object
property
</ins>
</span>
<del class="diff-old">:
</del>
</div>
<pre class="highlight hljs javascript" aria-busy="false">
        <span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">var</span> statusValueDefinition = {
    <span class="hljs-attr">type</span>: <span class=
<ins class="diff-chg">"hljs-string">"object"</span>,
</ins>    <span class="hljs-attr">properties</span>: {      <span class="hljs-attr">brightness</span>: {        <span class="hljs-attr">type</span>: <span class=<ins class="diff-chg">
"hljs-string">"number"</span>,
</ins>        <span class="hljs-attr">minimum</span>: <span class=<ins class="diff-chg">
"hljs-number">0.0</span>,
</ins>        <span class="hljs-attr">maximum</span>: <span class=<ins class="diff-chg">
"hljs-number">100.0</span>,
</ins>        <span class="hljs-attr">required</span>: <span class=<ins class="diff-chg">
"hljs-literal">true</span>
      },
</ins>      <span class="hljs-attr">rgb</span>: {        <span class="hljs-attr">type</span>: <span class=<ins class="diff-chg">
"hljs-string">"array"</span>,
</ins>        <span class="hljs-string">"minItems"</span>: <span class=<ins class="diff-chg">
"hljs-number">3</span>,
</ins>        <span class="hljs-string">"maxItems"</span>: <span class=<ins class="diff-chg">
"hljs-number">3</span>,
</ins>        <span class="hljs-attr">items</span> : {            <span class="hljs-string">"type"</span> : <span class=<ins class="diff-chg">
"hljs-string">"number"</span>,
</ins>            <span class=<ins class="diff-chg">
"hljs-string">"minimum"</span>: <span class="hljs-number">0</span>,
</ins>            <span class=<ins class="diff-chg">
"hljs-string">"maximum"</span>: <span class="hljs-number">255</span>
        }
      }
  };
</ins>  <span class=<ins class="diff-chg">
"hljs-keyword">var</span> statusPropertyDefinition = statusValueDefinition;
</ins>  <span class="hljs-comment">// add the 'forms' property</span><ins class="diff-chg">
  statusPropertyDefinition[<span class=
"hljs-string">"forms"</span>] = [];
</ins>  <span class="hljs-keyword">var</span> thing = WoT.produce({    <span class="hljs-attr">name</span>: <span class=<ins class="diff-chg">
"hljs-string">"mySensor"</span>,
</ins>    <span class="hljs-attr">properties</span>: {      <span class="hljs-attr">brightness</span>: {        <span class="hljs-attr">type</span>: <span class=<ins class="diff-chg">
"hljs-string">"number"</span>,
</ins>        <span class="hljs-attr">minimum</span>: <span class=<ins class="diff-chg">
"hljs-number">0.0</span>,
</ins>        <span class="hljs-attr">maximum</span>: <span class=<ins class="diff-chg">
"hljs-number">100.0</span>,
</ins>        <span class="hljs-attr">required</span>: <span class=<ins class="diff-chg">
"hljs-literal">true</span>,
      },
</ins>      <span class=<ins class="diff-chg">
"hljs-attr">status</span>: statusPropertyDefinition
    },
</ins>    <span class="hljs-attr">actions</span>: {      <span class="hljs-attr">status</span>: {        <span class="hljs-attr">description</span>: <span class=<ins class="diff-chg">
"hljs-string">"Get status object"</span>,
</ins>        <span class="hljs-attr">input</span>: <span class=<ins class="diff-chg">
"hljs-literal">null</span>,
</ins>        <span class="hljs-attr">output</span>: {          <span class=<ins class="diff-chg">
"hljs-attr">status</span> : statusValueDefinition;
        },
</ins>        <span class="hljs-attr">forms</span>: []<ins class="diff-chg">
      },
    },
</ins>    <span class="hljs-attr">events</span>: {      <span class=<ins class="diff-chg">
"hljs-attr">onstatuschange</span>: statusValueDefinition;
    },
</ins>    <span class="hljs-attr">links</span>: []<ins class="diff-chg">
  });
  thing.expose().then(<span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
      thing.register();
  });
} <span class="hljs-keyword">catch</span> (err) {
</ins>   <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Error creating ExposedThing: "</span> + err);
}
</ins></pre></div><div class="example" id= "ex-7-create-a-new-exposed-thing-from-a-thing-description"><div class="marker"><a class="self-link" href= "#ex-7-create-a-new-exposed-thing-from-a-thing-description"><ins class="diff-chg">
Example
7
</ins></a><span class="example-title">:
Create
a
new
exposed
Thing
from
a
Thing
Description
</span>
</div>
<pre class="highlight hljs javascript" aria-busy="false">
        <span class=
"hljs-keyword">let</span> thingDescription = <span class=
<del class="diff-old">"hljs-string"&gt;'{ "@context": [ "https://w3c.github.io/wot/w3c-wot-td-context.jsonld", "https://w3c.github.io/wot/w3c-wot-common-context.jsonld" ], "@type": [ "Thing", "Sensor" ], "name": "mySensor", "geo:location": "testspace", "interaction": [ { "@type": [ "Property", "Temperature" ], "name": "prop1", "schema": { "type": "number" }, "saref:TemperatureUnit": "degree_Celsius" } ] }';
</del>
<ins class="diff-chg">"hljs-string">'{ \
  "name": "mySensor", \
  "@context": [ "http://www.w3.org/ns/td",\
     "https://w3c.github.io/wot/w3c-wot-common-context.jsonld" ],\
  "@type": [ "Thing", "Sensor" ], \
  "geo:location": "testspace", \
  "properties": { \
    "prop1": { \
      "type": "number",\
      "@type": [ "Property", "Temperature" ], \
      "saref:TemperatureUnit": "degree_Celsius" \
  } } }'</span>;
</ins>
<span class="hljs-keyword">try</span> {
  <span class=
"hljs-comment">// note that produce() fails if thingDescription contains error</span>
  <span class=
"hljs-keyword">let</span> thing = WoT.produce(thingDescription);
  <span class=
"hljs-comment">// Interactions were added from TD</span>
  <span class=
"hljs-comment">// WoT adds generic handler for reading any property</span>
  <span class=
"hljs-comment">// define a specific handler for one property</span>
  <span class="hljs-keyword">let</span> name = <span class=
"hljs-string">"examplePropertyName"</span>;
  thing.setPropertyReadHandler(name, () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Handling read request for "</span> + name);
    <span class="hljs-keyword">return</span> <span class=
"hljs-keyword">new</span> <span class=
"hljs-built_in">Promise</span>(<span class=
"hljs-function">(<span class=
"hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class=
"hljs-keyword">let</span> examplePropertyValue = <span class=
"hljs-number">5</span>;
        resolve(examplePropertyValue);
      },
      e =&gt; {
        <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error"</span>);
      });
  });
<del class="diff-old">  thing.start();
</del>
<ins class="diff-chg">  thing.expose();
</ins>
} <span class="hljs-keyword">catch</span>(err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}
</pre>
</div>
<div class="example" id= "ex-8-create-a-new-exposed-thing-from-a-td-uri">
<div class="marker">
<a class="self-link" href= "#ex-8-create-a-new-exposed-thing-from-a-td-uri">
Example
<del class="diff-old">9
</del>
<ins class="diff-chg">8
</ins></a>
<del class="diff-old">:
</del>
<span class="example-title">:
Create
a
new
exposed
Thing
from
a
TD
URI
</span>
</div>
<pre class="highlight hljs javascript" aria-busy="false">
        <span class=
"hljs-comment">// fetch an external TD, e.g., to set up a proxy for that Thing</span>
WoT.fetch(<span class=
"hljs-string">"http://myservice.org/mySensor/description"</span>).then(<span class="hljs-function"><span class="hljs-params">td</span> =&gt;</span> {
  <span class=
"hljs-comment">// WoT.produce() ignores instance-specific metadata (security, form)</span>
  <span class="hljs-keyword">let</span> thing = WoT.produce(td);
  <span class=
"hljs-comment">// Interactions were added from TD</span>
  <span class="hljs-comment">// add server functionality</span>
  <span class="hljs-comment">// ...</span>
});
</pre>
</div>
</section>
</section>
<section data-dfn-for="TD-structures" id= "data-types-and-structures">
<h2 id="x6-data-types-and-structures">
<span class="secno">
6.
</span>
<del class="diff-old">Experimental
extensions
to
the
ConsumedThing
interface
</del>
<ins class="diff-chg">Data
types
and
structures
</ins><a class="self-link" aria-label="§" href= "#data-types-and-structures"></a>
</h2>
<p>
<ins class="diff-new">The
[
</ins><cite>
<del class="diff-old">This
section
is
non-normative.
</del>
<a class="bibref" href= "#bib-wot-td">
<ins class="diff-chg">WOT-TD
</ins></a>
</cite>
<ins class="diff-new">]
specification
defines
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-vocabulary-definition"><ins class="diff-new">
WoT
information
model
</ins></a>,<ins class="diff-new">
i.e.
the
data
types
and
data
structures
used
in
</ins><a href="#dfn-wot-interactions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
WoT
Interactions
</ins></a>.<ins class="diff-new">
In
this
API
these
definitions
translate
to
dictionary
objects
that
are
extended
with
methods
by
the
interfaces
defined
in
this
specification.
</ins>
</p>
<p>
<ins class="diff-new">In
order
to
avoid
duplication
of
definitions,
references
to
these
data
types
and
structures
is
defined
in
this
section,
but
for
their
full
description
please
refer
to
the
</ins><a href=""><ins class="diff-new">
Thing
Description
specification
</ins></a>.</p><section data-dfn-for="ValueTypes" id= "the-dataschema-dictionary-and-its-subclasses"><h3 id="x6-1-the-dataschema-dictionary-and-its-subclasses"><span class="secno"><ins class="diff-new">
6.1
</ins></span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-dataschema" data-idl="typedef" data-title="DataSchema">
<code>
<del class="diff-old">ThingDescription
</del>
<ins class="diff-chg">DataSchema
</ins></code></dfn><ins class="diff-chg">
dictionary
and
its
subclasses
</ins><a class="self-link" aria-label="§" href= "#the-dataschema-dictionary-and-its-subclasses"></a></h3><p><ins class="diff-chg">
Value
types
basically
represent
types
that
may
be
used
in
</ins><a href="#dfn-json" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
JSON
</ins></a><ins class="diff-chg">
object
definitions
and
are
used
in
</ins><a href= "#dom-thingfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingFragment
</ins>
</code>
</a>
<del class="diff-old">related
functionality,
such
as
enumerating
</del>
<ins class="diff-chg">to
define
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
Properties
</a>,
<del class="diff-old">Action
s,
</del>
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>
s
and
<del class="diff-old">links
(introspection)
</del>
<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins></a><ins class="diff-chg">
parameters.
Value
types
are
represented
as
dictionary
objects
whose
properties
and
possible
sub-classes
are
defined
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-data-schema-vocabulary-definition"><ins class="diff-chg">
DataSchema
</ins></a><ins class="diff-chg">
section
of
[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins></a></cite><ins class="diff-chg">
].
</ins></p><p><ins class="diff-chg">
One
property
of
all
</ins><a href="#dom-dataschema" class= "internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
DataSchema
</ins></code></a><ins class="diff-chg">
dictionary
</ins>
is
<del class="diff-old">an
API
extension
that
</del>
<ins class="diff-chg">the
</ins><code><ins class="diff-chg">
type
</ins></code><ins class="diff-chg">
property
whose
value
</ins>
is
<del class="diff-old">out
</del>
<ins class="diff-chg">from
a
set
</ins>
of
<del class="diff-old">scope
for
</del>
<ins class="diff-chg">enumerated
strings
defined
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#dataschema"><ins class="diff-chg">
DataSchema
</ins></a><ins class="diff-chg">
section
of
[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins></a></cite><ins class="diff-chg">
]
and
is
referred
as
</ins><dfn data-dfn-type="dfn" id="dfn-datatype"><ins class="diff-chg">
DataType
</ins></dfn><ins class="diff-chg">
in
</ins>
this
specification.
<del class="diff-old">However,
</del>
</p>
<p>
<ins class="diff-chg">Based
on
</ins><code><ins class="diff-chg">
type
</ins></code>,
the
<del class="diff-old">draft
interfaces
</del>
<ins class="diff-chg">following
sub-classes
of
</ins><a href="#dom-dataschema" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
DataSchema
</ins></code></a>
are
defined
<del class="diff-old">here
for
informative
purposes.
&lt;span class="idlInterface" id=
"idl-def-consumedthing-partial-1" data-idl="" data-title=
"ConsumedThing"&gt;partial interface &lt;span class=
"idlInterfaceID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMethod" id="idl-def-consumedthing-getproperties"
data-idl="" data-title="getProperties" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-thingproperty"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="getproperties()|getProperties" href=
"#dom-consumedthing-getproperties" class="internalDFN"
data-link-type="dfn"&gt;getProperties
&lt;span class="idlMethod" id="idl-def-consumedthing-getactions"
data-idl="" data-title="getActions" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-thingaction"
class="internalDFN" data-link-type=
"dfn"&gt;   &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="getactions()|getActions" href=
"#dom-consumedthing-getactions" class="internalDFN" data-link-type=
"dfn"&gt;getActions
&lt;span class="idlMethod" id="idl-def-consumedthing-getevents"
data-idl="" data-title="getEvents" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-thingevent"
class="internalDFN" data-link-type=
"dfn"&gt;    &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="getevents()|getEvents" href="#dom-consumedthing-getevents"
class="internalDFN" data-link-type=
"dfn"&gt;getEvents
&lt;span class="idlMethod" id="idl-def-consumedthing-getlinks"
data-idl="" data-title="getLinks" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-tdlink"
class="internalDFN" data-link-type=
"dfn"&gt;        &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="consumedthing"
data-lt="getlinks()|getLinks" href="#dom-consumedthing-getlinks"
class="internalDFN" data-link-type=
"dfn"&gt;getLinks
};
</del>
<ins class="diff-chg">in
[
</ins><cite>
<a class= "bibref" href="#bib-wot-td">
<ins class="diff-chg">WOT-TD
</ins></a>
</cite>
<ins class="diff-chg">]:
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#booleanschema"><dfn data-dfn-type="dfn" id= "dfn-booleanschema"><ins class="diff-chg">
BooleanSchema
</ins></dfn>
<del class="diff-old">6.1
</del>
</a>,
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#numberschema">
<dfn data-dfn-type="dfn" id= "dfn-numberschema">
<ins class="diff-chg">NumberSchema
</ins></dfn></a>,<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#integerschema"><dfn data-dfn-type="dfn" id= "dfn-integerschema"><ins class="diff-chg">
IntegerSchema
</ins></dfn></a>,<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#stringschema"><dfn data-dfn-type="dfn" id= "dfn-stringschema"><ins class="diff-chg">
StringSchema
</ins></dfn></a>,<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#objectschema"><dfn data-dfn-type="dfn" id= "dfn-objectschema"><ins class="diff-chg">
ObjectSchema
</ins></dfn></a>,<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#arrayschema"><dfn data-dfn-type="dfn" id= "dfn-arrayschema"><ins class="diff-chg">
ArraySchema
</ins></dfn></a>.</p></section><section data-dfn-for="SecurityScheme" id= "the-securityscheme-dictionary-and-its-subclasses"><h3 id="x6-2-the-securityscheme-dictionary-and-its-subclasses"><span class="secno"><ins class="diff-chg">
6.2
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-securityscheme" data-idl="typedef" data-title="SecurityScheme">
<code>
<del class="diff-old">getProperties()
</del>
<ins class="diff-chg">SecurityScheme
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
and
its
subclasses
</ins><a class="self-link" aria-label="§" href="#the-securityscheme-dictionary-and-its-subclasses"></a>
</h3>
<p>
<del class="diff-old">Returns
the
list
of
Properties
</del>
<ins class="diff-chg">Security
metadata
is
represented
as
dictionary
objects
whose
properties
and
sub-classes
are
</ins>
defined
in
the
<del class="diff-old">Thing
Description
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-security-vocabulary-definition">
<ins class="diff-chg">SecurityScheme
</ins>
</a>
<ins class="diff-new">section
of
[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-new">
WOT-TD
</ins></a></cite><ins class="diff-new">
].
</ins></p><p><ins class="diff-new">
One
property
</ins>
of
the
<del class="diff-old">Thing
</del>
<a href="#dom-securityscheme" class= "internalDFN" data-link-type="dfn">
<code>
<ins class="diff-chg">SecurityScheme
</ins></code>
</a>
<ins class="diff-new">dictionary
is
the
</ins><code><ins class="diff-new">
scheme
</ins></code><ins class="diff-new">
property
whose
value
is
from
a
set
of
enumerated
strings
defined
</ins>
in
the
<del class="diff-old">form
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#securityscheme">
<ins class="diff-chg">SecurityScheme
</ins></a><ins class="diff-chg">
section
</ins>
of
<del class="diff-old">a
list
</del>
<ins class="diff-chg">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins></a></cite><ins class="diff-chg">
].
Based
on
</ins><code><ins class="diff-chg">
type
</ins></code>,<ins class="diff-chg">
multiple
subclasses
</ins>
of
<a href="#dom-securityscheme" class= "internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">ThingProperty
</del>
<ins class="diff-chg">SecurityScheme
</ins>
</code>
</a>
<del class="diff-old">objects.
</del>
<ins class="diff-chg">are
defined.
</ins>
</p>
</section>
<section data-dfn-for="Link" id="the-link-dictionary">
<h3 id="x6-3-the-link-dictionary">
<span class="secno">
<del class="diff-old">6.2
</del>
<ins class="diff-chg">6.3
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-link" data-idl="typedef" data-title="Link">
<code>
<del class="diff-old">getActions()
</del>
<ins class="diff-chg">Link
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins><a class="self-link" aria-label="§" href= "#the-link-dictionary"></a>
</h3>
<p>
<del class="diff-old">Returns
</del>
<ins class="diff-chg">Represents
a
</ins><a href="https://tools.ietf.org/html/rfc8288"><ins class="diff-chg">
Web
Link
</ins></a><ins class="diff-chg">
with
properties
defined
in
</ins>
the
<del class="diff-old">list
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#link">
<ins class="diff-chg">Link
</ins></a><ins class="diff-chg">
section
</ins>
of
<del class="diff-old">Action
</del>
<ins class="diff-chg">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins>
</a>
<del class="diff-old">s
</del>
</cite>
<ins class="diff-chg">].
</ins></p></section><section data-dfn-for="Form" id="the-form-dictionary"><h3 id="x6-4-the-form-dictionary"><span class="secno"><ins class="diff-chg">
6.4
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-form" data-idl="typedef" data-title="Form"><code><ins class="diff-chg">
Form
</ins></code></dfn><ins class="diff-chg">
dictionary
</ins><a class="self-link" aria-label="§" href= "#the-form-dictionary"></a></h3><p><ins class="diff-chg">
Represents
metadata
describing
service
details,
with
properties
</ins>
defined
in
the
<del class="diff-old">Thing
Description
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#form">
<ins class="diff-chg">Form
</ins>
</a>
<ins class="diff-new">section
</ins>
of
<ins class="diff-new">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-new">
WOT-TD
</ins></a></cite><ins class="diff-new">
].
</ins></p></section><section data-dfn-for="InteractionFragment" id= "the-interactionfragment-dictionary"><h3 id="x6-5-the-interactionfragment-dictionary"><span class= "secno"><ins class="diff-new">
6.5
</ins></span><ins class="diff-new">
The
</ins><code><dfn data-dfn-type="dfn" id= "dfn-interactionfragment"><ins class="diff-new">
InteractionFragment
</ins></dfn></code><ins class="diff-new">
dictionary
</ins><a class="self-link" aria-label="§" href= "#the-interactionfragment-dictionary"></a></h3><p><ins class="diff-new">
Represents
</ins>
the
<del class="diff-old">Thing
</del>
<ins class="diff-chg">common
properties
of
</ins><a href= "#dfn-wot-interactions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
WoT
Interactions
</ins></a>,<ins class="diff-chg">
one
of
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a>,<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins>
</a>
<ins class="diff-new">or
</ins><a href="#dfn-events" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Event
</ins></a>,<ins class="diff-new">
as
defined
</ins>
in
the
<del class="diff-old">form
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#interactionpattern">
<ins class="diff-chg">InteractionPattern
</ins></a><ins class="diff-chg">
section
</ins>
of
<ins class="diff-new">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-new">
WOT-TD
</ins></a></cite><ins class="diff-new">
].
Its
subclasses
are
referred
as
</ins><a href="#dom-propertyfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
PropertyFragment
</ins></code></a>,<a href= "#dom-actionfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ActionFragment
</ins></code></a><ins class="diff-new">
and
</ins><a href= "#dom-eventfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
EventFragment
</ins></code></a>.</p></section><section data-dfn-for="PropertyFragment" id= "the-propertyfragment-dictionary"><h3 id="x6-6-the-propertyfragment-dictionary"><span class= "secno"><ins class="diff-new">
6.6
</ins></span><ins class="diff-new">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-propertyfragment" data-idl="typedef" data-title= "PropertyFragment"><code><ins class="diff-new">
PropertyFragment
</ins></code></dfn><ins class="diff-new">
dictionary
</ins><a class="self-link" aria-label="§" href= "#the-propertyfragment-dictionary"></a></h3><p><ins class="diff-new">
Represents
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
interaction
data
that
initializes
</ins>
a
<del class="diff-old">list
</del>
<a href="#dom-thingproperty" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">ThingProperty
</ins></code></a><ins class="diff-chg">
object.
Its
properties
are
defined
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#property"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
and
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#interactionpattern"><ins class="diff-chg">
InteractionPattern
</ins></a><ins class="diff-chg">
sections
</ins>
of
<ins class="diff-new">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-new">
WOT-TD
</ins></a></cite><ins class="diff-new">
].
</ins></p></section><section data-dfn-for="ActionFragment" id= "the-actionfragment-dictionary"><h3 id="x6-7-the-actionfragment-dictionary"><span class= "secno"><ins class="diff-new">
6.7
</ins></span><ins class="diff-new">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-actionfragment" data-idl="typedef" data-title= "ActionFragment"><code><ins class="diff-new">
ActionFragment
</ins></code></dfn><ins class="diff-new">
dictionary
</ins><a class="self-link" aria-label="§" href= "#the-actionfragment-dictionary"></a></h3><p><ins class="diff-new">
Represents
the
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins></a><ins class="diff-new">
interaction
data
that
initializes
a
</ins>
<a href="#dom-thingaction" class="internalDFN" data-link-type= "dfn">
<code>
ThingAction
</code>
</a>
<del class="diff-old">objects.
</del>
<ins class="diff-chg">object.
Its
properties
are
defined
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#action"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
and
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#interactionpattern"><ins class="diff-chg">
InteractionPattern
</ins></a><ins class="diff-chg">
sections
of
[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins></a></cite><ins class="diff-chg">
].
</ins>
</p>
</section>
<section data-dfn-for="EventFragment" id= "the-eventfragment-dictionary">
<h3 id="x6-8-the-eventfragment-dictionary">
<del class="diff-old">6.3
</del>
<span class= "secno">
<ins class="diff-chg">6.8
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-eventfragment" data-idl="typedef" data-title= "EventFragment">
<code>
<del class="diff-old">getEvents()
</del>
<ins class="diff-chg">EventFragment
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins><a class="self-link" aria-label="§" href= "#the-eventfragment-dictionary"></a>
</h3>
<p>
<del class="diff-old">Returns
</del>
<ins class="diff-chg">Represents
</ins>
the
<del class="diff-old">list
of
</del>
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>
<del class="diff-old">s
</del>
<ins class="diff-chg">interaction
data
that
initializes
a
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingEvent
</ins></code></a><ins class="diff-chg">
object.
Its
properties
are
</ins>
defined
in
the
<del class="diff-old">Thing
Description
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#event">
<ins class="diff-chg">Event
</ins>
</a>
<ins class="diff-new">section
</ins>
of
<del class="diff-old">the
</del>
<ins class="diff-chg">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins></a></cite><ins class="diff-chg">
].
</ins></p></section><section data-dfn-for="ThingFragment" id= "the-thingfragment-dictionary"><h3 id="x6-9-the-thingfragment-dictionary"><span class= "secno"><ins class="diff-chg">
6.9
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-thingfragment" data-idl="typedef" data-title= "ThingFragment"><code><ins class="diff-chg">
ThingFragment
</ins></code></dfn><ins class="diff-chg">
dictionary
</ins><a class="self-link" aria-label="§" href= "#the-thingfragment-dictionary"></a></h3><p><ins class="diff-chg">
The
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
ThingFragment
</ins></code></a><ins class="diff-chg">
dictionary
is
defined
as
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#thing"><b>
Thing
</b>
</a>
in
<del class="diff-old">the
form
of
</del>
<ins class="diff-chg">[
</ins><cite><a class="bibref" href= "#bib-wot-td"><ins class="diff-chg">
WOT-TD
</ins></a></cite><ins class="diff-chg">
].
It
is
</ins>
a
<del class="diff-old">list
</del>
<ins class="diff-chg">dictionary
that
contains
properties
representing
semantic
metadata
and
interactions
(
</ins><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Properties
</ins></a>,<a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
s
and
</ins><a href="#dfn-events" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Event
</ins></a><ins class="diff-chg">
s).
It
is
used
for
initializing
an
internal
representation
</ins>
of
<ins class="diff-chg">a
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
Description
</ins></a><ins class="diff-chg">
and
its
properties
may
be
used
in
</ins><a href="#dom-thingfilter" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ThingEvent
</del>
<ins class="diff-chg">ThingFilter
</ins>
</code>
<del class="diff-old">objects.
</del>
</a>.
</p>
</section>
<section data-dfn-for="ThingDescription" id= "the-thingdescription-type">
<h3 id="x6-10-the-thingdescription-type">
<del class="diff-old">6.4
</del>
<span class= "secno">
<ins class="diff-chg">6.10
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingdescription" data-idl="typedef" data-title= "ThingDescription">
<code>
<del class="diff-old">getLinks()
</del>
<ins class="diff-chg">ThingDescription
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">type
</ins><a class="self-link" aria-label="§" href= "#the-thingdescription-type"></a>
</h3>
<p>
<del class="diff-old">Returns
the
list
</del>
<ins class="diff-chg">Serialized
representation
</ins>
of
<del class="diff-old">linked
resources
in
</del>
<ins class="diff-chg">the
</ins>
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
<ins class="diff-new">(a
</ins><a href="#dfn-json-ld" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
JSON-LD
</ins></a><ins class="diff-new">
document).
</ins></p><div class="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span><ins class="diff-new">
Note
</ins></span></div><p class=""><ins class="diff-new">
In
this
version
</ins>
of
the
<ins class="diff-chg">API,
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
<ins class="diff-new">Description
</ins></a><ins class="diff-new">
s
are
represented
as
an
opaque
</ins><code><ins class="diff-new">
USVString
</ins></code><ins class="diff-new">
that
can
be
transmitted
between
devices.
</ins></p></div></section></section><section id="interfaces-for-wot-interactions"><h2 id="x7-interfaces-for-wot-interactions"><span class= "secno"><ins class="diff-new">
7.
</ins></span><ins class="diff-new">
Interfaces
for
</ins><a href="#dfn-wot-interactions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
WoT
Interactions
</ins></a><a class="self-link" aria-label="§" href= "#interfaces-for-wot-interactions">
</a>
</h2>
<p>
<ins class="diff-new">The
data
types
and
structures
imported
from
[
</ins><cite><a class= "bibref" href="#bib-wot-td"><ins class="diff-new">
WOT-TD
</ins></a></cite><ins class="diff-new">
]
are
extended
by
this
specification
</ins>
in
<ins class="diff-new">order
to
provide
</ins>
the
<del class="diff-old">form
of
a
list
of
</del>
<ins class="diff-chg">interfaces
for
</ins><a href= "#dfn-wot-interactions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
WoT
Interactions
</ins></a>.</p><p><ins class="diff-chg">
Every
</ins><a href="#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
describes
its
metadata
as
defined
in
</ins><a href= "#dom-thingfragment" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">TDLink
</del>
<ins class="diff-chg">ThingFragment
</ins>
</code>
</a>,
<ins class="diff-new">and
basic
interactions
defined
as
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Properties
</ins></a>,<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins>
</a>
<del class="diff-old">objects.
</del>
<ins class="diff-chg">s
and
</ins><a href= "#dfn-events" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Event
</ins></a><ins class="diff-chg">
s.
The
following
interfaces
are
used
for
representing
these
interactions.
</ins>
</p>
<section data-dfn-for="Interaction" id="the-interaction-interface">
<h3 id="x7-1-the-interaction-interface">
<span class= "secno">
<del class="diff-old">6.4.1
</del>
<ins class="diff-chg">7.1
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-interaction" data-idl="interface" data-title= "Interaction">
<code>
<del class="diff-old">TDLink
</del>
<ins class="diff-chg">Interaction
</ins>
</code>
</dfn>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">interface
</ins><a class= "self-link" aria-label="§" href= "#the-interaction-interface"></a></h3>
<p>
<del class="diff-old">Contains
a
hyperlink
reference,
a
relation
type
</del>
<ins class="diff-chg">The
</ins><a href="#dom-interaction" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
Interaction
</ins></code></a><ins class="diff-chg">
interface
is
an
abstract
class
to
represent
</ins><a href="#dfn-things" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
interactions:
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Properties
</ins></a>,<a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Actions
</ins></a><ins class="diff-chg">
and
</ins><a href="#dfn-events" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Events
</ins></a>.</p><p><ins class="diff-chg">
The
</ins><a href="#dfn-interactionfragment" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
InteractionFragment
</ins></code></a><ins class="diff-chg">
dictionary
holds
the
common
properties
of
</ins><a href= "#dom-propertyfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
PropertyFragment
</ins></code></a>,<a href= "#dom-actionfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ActionFragment
</ins></code></a>
and
<a href= "#dom-eventfragment" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-new">EventFragment
</ins></code></a><ins class="diff-new">
dictionaries
used
for
initializing
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ThingProperty
</ins></code></a>,<a href= "#dom-thingaction" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingAction
</ins></code></a><ins class="diff-new">
and
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingEvent
</ins></code></a><ins class="diff-new">
objects
in
</ins>
a
<del class="diff-old">media
type.
</del>
<a href= "#dom-thingfragment" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">ThingFragment
</ins></code></a><ins class="diff-chg">
dictionary
used
for
creating
an
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ExposedThing
</ins></code></a><ins class="diff-chg">
object.
</ins>
</p>
<div>
<del class="diff-old">&lt;span class="idlDictionary" id=
"idl-def-tdlink" data-idl="" data-title=
"TDLink"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-tdlink" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMember" id="idl-def-tdlink-href" data-idl=""
data-title="href" data-dfn-for="tdlink"&gt;    required &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-no-default=""
data-link-for="tdlink" data-lt="" href="#dom-tdlink-href" class=
"internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlMember" id="idl-def-tdlink-mediatype" data-idl=""
data-title="mediaType" data-dfn-for=
"tdlink"&gt;             &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-no-default=""
data-link-for="tdlink" data-lt="" href="#dom-tdlink-mediatype"
</del>
<pre class="def idl"><span class="idlInterface" id=
<ins class="diff-chg">"idl-def-interaction" data-idl="" data-title=
"Interaction">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-interaction" class="internalDFN" data-link-type=
"dfn"><code>Interaction</code></a></span> {<span class=
"idlAttribute" id="idl-def-interaction-forms" data-idl=""
data-title="forms" data-dfn-for="interaction">
  readonly attribute<span class="idlAttrType"> (<a data-link-for=""
href="#dom-form" class="internalDFN" data-link-type=
"dfn"><code>Form</code></a> or <a href=
"https://heycam.github.io/webidl/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-for=""
href="#dom-form" class="internalDFN" data-link-type=
"dfn"><code>Form</code></a>&gt;)</span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="interaction"
data-lt="interaction.forms|forms" href="#dom-interaction-forms"
</ins>
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;
&lt;span class="idlMember" id="idl-def-tdlink-rel" data-idl=""
data-title="rel" data-dfn-for="tdlink"&gt;             &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-no-default=""
data-link-for="tdlink" data-lt="" href="#dom-tdlink-rel" class=
"internalDFN" data-link-type=
"dfn"&gt;
};
</del>
<ins class="diff-chg">"dfn"><code>forms</code></a></span>;</span>
};</span><span class="idlIncludes">
</ins><a href="#dom-interaction" class="internalDFN" data-link-type=<ins class="diff-chg">
"dfn"><code>Interaction</code></a> includes <a href=
"#dfn-interactionfragment" class="internalDFN" data-link-type=
"dfn">
</ins><code><ins class="diff-chg">
InteractionFragment
</ins></code></a><ins class="diff-chg">
;
</ins>
</span>
</pre>
</div>
<p>
The
<dfn data-dfn-for="interaction" data-dfn-type="dfn" id= "dom-interaction-forms" data-idl="attribute" data-title="forms" data-type="Form|FrozenArray" data-lt= "interaction.forms|forms">
<code>
<del class="diff-old">TDLink
</del>
<ins class="diff-chg">forms
</ins></code></dfn><ins class="diff-chg">
read-only
property
represents
the
protocol
bindings
initialization
data
and
is
initialized
by
the
</ins><a href="#dfn-wot-runtime" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
WoT
Runtime
</ins></a>.</p></section><section data-dfn-for="ThingProperty" id= "the-thingproperty-interface"><h3 id="x7-2-the-thingproperty-interface"><span class= "secno"><ins class="diff-chg">
7.2
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-thingproperty" data-idl="interface" data-title= "ThingProperty"><code><ins class="diff-chg">
ThingProperty
</ins></code></dfn><ins class="diff-chg">
interface
</ins><a class= "self-link" aria-label="§" href= "#the-thingproperty-interface"></a></h3><p><ins class="diff-chg">
The
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
ThingProperty
</ins></code></a><ins class="diff-chg">
interface
is
used
in
</ins><a href="#dom-consumedthing" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
ConsumedThing
</ins></code></a><ins class="diff-chg">
and
</ins><a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ExposedThing
</ins></code></a><ins class="diff-chg">
objects
to
represent
</ins><a href= "#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
interactions.
</ins></p><p><ins class="diff-chg">
The
</ins><a href="#dom-propertyfragment" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
PropertyFragment
</ins>
</code>
</a>
dictionary
<del class="diff-old">contains
</del>
<ins class="diff-chg">is
used
for
initializing
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
objects
in
a
</ins><a href="#dom-thingfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingFragment
</ins></code></a><ins class="diff-chg">
dictionary
used
for
creating
an
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ExposedThing
</ins></code></a><ins class="diff-chg">
object.
It
</ins><em class="rfc2119" title="MUST"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
implement
one
of
</ins>
the
<del class="diff-old">following
properties:
</del>
<a href= "#dom-dataschema" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">DataSchema
</ins></code></a><ins class="diff-chg">
dictionaries.
</ins>
</p>
<div>
<pre class="def idl"><span class="idlInterface" id=
<ins class="diff-chg">"idl-def-thingproperty" data-idl="" data-title=
"ThingProperty">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-interaction" class="internalDFN"
data-link-type=
"dfn"><code>Interaction</code></a></span> {<span class="idlMethod"
id="idl-def-thingproperty--name" data-idl="" data-title=""
data-dfn-for="thingproperty"><span class="idlSectionComment">
  // getter for PropertyFragment properties
</ins>  </span>getter<span class="idlMethType"> <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-any">any</a></span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-thingproperty-read" data-idl="" data-title="read"
data-dfn-for="thingproperty"><span class="idlMethType"><span class=
"idlSectionComment">
  // get and set interface for the Property
</ins>  </span><a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="thingproperty" data-lt=
"thingproperty.read()|thingproperty.read|read()|read" href=
"#dom-thingproperty-read" class="internalDFN" data-link-type=
"dfn"><code>read</code></a></span>();</span><span class="idlMethod"
id="idl-def-thingproperty-write-value" data-idl="" data-title=
"write" data-dfn-for="thingproperty"><span class="idlMethType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="thingproperty" data-lt=
"thingproperty.write()|thingproperty.write|write()|write" href=
"#dom-thingproperty-write" class="internalDFN" data-link-type=
"dfn"><code>write</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span>
};</span><span class="idlIncludes">
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type=<ins class="diff-chg">
"dfn"><code>ThingProperty</code></a> includes <a href=
"#dom-propertyfragment" class="internalDFN" data-link-type=
"dfn"><code>PropertyFragment</code></a>;</span><span class=
"idlIncludes">
</ins><a href="#dom-thingproperty" class="internalDFN" data-link-type=<ins class="diff-chg">
"dfn"><code>ThingProperty</code></a> includes <a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn">
</ins><code><ins class="diff-chg">
Observable
</ins></code></a><ins class="diff-chg">
;
</ins></span></pre></div><p>
The
<a href="#dom-thingproperty" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">href
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
</a>
<ins class="diff-new">interface
contains
all
the
properties
defined
on
</ins><a href= "#dom-propertyfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
PropertyFragment
</ins></code></a><ins class="diff-new">
as
read-only
properties.
</ins></p><p><ins class="diff-new">
The
</ins><dfn data-dfn-type="dfn" id="dfn-type"><ins class="diff-new">
type
</ins>
</dfn>
<del class="diff-old">attribute
</del>
<ins class="diff-chg">read-only
property
</ins>
represents
<ins class="diff-new">the
type
definition
for
the
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Property
</ins></a><ins class="diff-new">
as
</ins>
a
<del class="diff-old">hyperlink
reference
</del>
<a href="#dom-dataschema" class= "internalDFN" data-link-type="dfn">
<code>
<ins class="diff-chg">DataSchema
</ins></code></a><ins class="diff-chg">
dictionary
object.
</ins></p><p><ins class="diff-chg">
The
</ins><dfn data-dfn-type="dfn" id="dfn-writable"><ins class="diff-chg">
writable
</ins></dfn><ins class="diff-chg">
read-only
property
tells
whether
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
value
can
be
updated.
If
it
is
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
then
the
</ins><code><ins class="diff-chg">
set(value)
</ins></code><ins class="diff-chg">
method
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
always
reject.
</ins></p><p><ins class="diff-chg">
The
</ins><strong><em><ins class="diff-chg">
observable
</ins></em></strong><ins class="diff-chg">
read-only
property
tells
whether
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
supports
subscribing
to
value
change
notifications.
If
it
is
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
then
the
</ins><code><ins class="diff-chg">
subscribe()
</ins></code><ins class="diff-chg">
method
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
always
fail.
</ins></p><p><ins class="diff-chg">
The
</ins><strong><em><ins class="diff-chg">
constant
</ins></em></strong><ins class="diff-chg">
read-only
property
-
defined
in
</ins><a href="#dom-dataschema" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
DataSchema
</ins></code></a><ins class="diff-chg">
-
tells
whether
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
value
is
a
constant.
If
</ins><code><ins class="diff-chg">
true
</ins></code>,<ins class="diff-chg">
the
</ins><code><ins class="diff-chg">
set()
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
subscribe()
</ins></code><ins class="diff-chg">
methods
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
always
fail.
</ins></p><p><ins class="diff-chg">
The
</ins><strong><em><ins class="diff-chg">
required
</ins></em></strong><ins class="diff-chg">
read-only
property
-
defined
in
</ins><a href="#dom-dataschema" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
DataSchema
</ins></code></a><ins class="diff-chg">
-
tells
whether
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
should
be
always
present
on
the
</ins><a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ExposedThing
</ins></code></a><ins class="diff-chg">
object.
</ins></p><p><ins class="diff-chg">
The
</ins><dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-read" data-idl="operation" data-title="read()" data-type="Promise" data-lt= "thingproperty.read()|thingproperty.read|read()|read"><code><ins class="diff-chg">
read()
</ins></code></dfn><ins class="diff-chg">
method
will
fetch
the
value
of
the
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins>
</a>.
<ins class="diff-chg">Returns
a
</ins><a href= "#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Promise
</ins></a><ins class="diff-chg">
that
resolves
with
the
value,
or
rejects
with
an
error.
</ins></p><p>
The
<dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-write" data-idl="operation" data-title="write()" data-type="Promise" data-lt= "thingproperty.write()|thingproperty.write|write()|write">
<code>
<del class="diff-old">rel
</del>
<ins class="diff-chg">write()
</ins>
</code>
</dfn>
<del class="diff-old">attribute
represents
</del>
<ins class="diff-chg">method
will
attempt
to
set
the
value
of
the
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
specified
in
the
</ins><code><ins class="diff-chg">
value
</ins></code><ins class="diff-chg">
argument
whose
type
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
match
the
one
specified
by
the
</ins><code><ins class="diff-chg">
type
</ins></code><ins class="diff-chg">
property.
Returns
</ins>
a
<del class="diff-old">relation
</del>
<a href= "#dfn-promise" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Promise
</ins></a><ins class="diff-chg">
that
resolves
on
success,
or
rejects
on
an
error.
</ins></p></section><section data-dfn-for="ThingAction" id="the-thingaction-interface"><h3 id="x7-3-the-thingaction-interface"><span class= "secno"><ins class="diff-chg">
7.3
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-thingaction" data-idl="interface" data-title= "ThingAction"><code><ins class="diff-chg">
ThingAction
</ins></code></dfn><ins class="diff-chg">
interface
</ins><a class= "self-link" aria-label="§" href= "#the-thingaction-interface"></a></h3><div><pre class="def idl"><span class="idlInterface" id=<ins class="diff-chg">
"idl-def-thingaction" data-idl="" data-title=
"ThingAction">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingaction" class="internalDFN" data-link-type=
"dfn"><code>ThingAction</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-interaction" class="internalDFN"
data-link-type=
"dfn"><code>Interaction</code></a></span> {<span class="idlMethod"
id="idl-def-thingaction-invoke-inputvalue" data-idl="" data-title=
"invoke" data-dfn-for="thingaction"><span class="idlMethType">
</ins>  <a href=<ins class="diff-chg">
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="thingaction" data-lt=
"thingaction.invoke()|thingaction.invoke|invoke()|invoke" href=
"#dom-thingaction-invoke" class="internalDFN" data-link-type=
"dfn"><code>invoke</code></a></span>(<span class=
"idlParam">optional<span class="idlParamType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">inputValue</span></span>);</span>
};</span><span class="idlIncludes">
</ins><a href="#dom-thingaction" class="internalDFN" data-link-type=<ins class="diff-chg">
"dfn"><code>ThingAction</code></a> includes <a href=
"#dom-actionfragment" class="internalDFN" data-link-type=
"dfn">
</ins><code><ins class="diff-chg">
ActionFragment
</ins></code></a><ins class="diff-chg">
;
</ins></span></pre></div><p><ins class="diff-chg">
The
</ins><dfn data-dfn-for="thingaction" data-dfn-type="dfn" id= "dom-thingaction-invoke" data-idl="operation" data-title="invoke()" data-type="Promise" data-lt= "thingaction.invoke()|thingaction.invoke|invoke()|invoke"><code><ins class="diff-chg">
invoke()
</ins></code></dfn><ins class="diff-chg">
method
when
invoked,
starts
the
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
interaction
with
the
input
value
provided
by
the
</ins><var><ins class="diff-chg">
inputValue
</ins></var><ins class="diff-chg">
argument.
If
</ins><var><ins class="diff-chg">
inputValue
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
null
</ins></code>,<ins class="diff-chg">
the
action
does
not
take
any
arguments
and
rejects
if
any
arguments
are
provided.
If
the
value
is
</ins><code><ins class="diff-chg">
undefined
</ins></code>,<ins class="diff-chg">
the
action
will
ignore
any
arguments
provided.
Otherwise
the
</ins>
type
<ins class="diff-new">of
</ins><var><ins class="diff-new">
inputValue
</ins></var><em class="rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
match
the
</ins><a href= "#dom-dataschema" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
DataSchema
</ins></code></a><ins class="diff-new">
definition
in
the
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
property.
Returns
a
</ins><a href="#dfn-promise" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Promise
</ins></a><ins class="diff-new">
that
will
reject
with
an
error
or
will
resolve
with
a
value
of
type
defined
by
the
</ins><code><ins class="diff-new">
output
</ins></code><ins class="diff-new">
property.
</ins></p></section><section data-dfn-for="ThingEvent" id="the-thingevent-interface"><h3 id="x7-4-the-thingevent-interface"><span class= "secno"><ins class="diff-new">
7.4
</ins></span><ins class="diff-new">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-thingevent" data-idl="interface" data-title= "ThingEvent"><code><ins class="diff-new">
ThingEvent
</ins></code></dfn><ins class="diff-new">
interface
</ins><a class= "self-link" aria-label="§" href= "#the-thingevent-interface"></a></h3><div><pre class="def idl"><span class="idlInterface" id=<ins class="diff-new">
"idl-def-thingevent" data-idl="" data-title=
"ThingEvent">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-interaction" class="internalDFN"
data-link-type="dfn"><code>Interaction</code></a></span> {
};</span><span class="idlIncludes">
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type=<ins class="diff-new">
"dfn"><code>ThingEvent</code></a> includes <a href=
"#dom-eventfragment" class="internalDFN" data-link-type=
"dfn"><code>EventFragment</code></a>;</span><span class=
"idlIncludes">
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type=<ins class="diff-new">
"dfn"><code>ThingEvent</code></a> includes <a href=
"#dom-thingproperty" class="internalDFN" data-link-type=
"dfn">
</ins><code><ins class="diff-new">
ThingProperty
</ins></code></a><ins class="diff-new">
;
</ins></span></pre></div><p><ins class="diff-new">
Since
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ThingEvent
</ins></code></a><ins class="diff-new">
implements
</ins><a href="#dom-observable" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
Observable
</ins></code></a><ins class="diff-new">
through
the
</ins><a href= "#dom-thingproperty" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingProperty
</ins></code></a><ins class="diff-new">
interface,
event
subscription
is
done
by
invoking
the
</ins><code><ins class="diff-new">
subscribe()
</ins></code><ins class="diff-new">
method
on
the
event
object
that
returns
a
cancelable
</ins><a href="#dom-subscription" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
Subscription
</ins></code>
</a>.
</p>
</section>
<section data-dfn-for="ExposedEvent" id= "the-exposedevent-interface">
<h3 id="x7-5-the-exposedevent-interface">
<span class= "secno">
<ins class="diff-chg">7.5
</ins></span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-exposedevent" data-idl="interface" data-title= "ExposedEvent">
<code>
<del class="diff-old">mediaType
</del>
<ins class="diff-chg">ExposedEvent
</ins>
</code>
</dfn>
<del class="diff-old">attribute
represents
</del>
<ins class="diff-chg">interface
</ins><a class= "self-link" aria-label="§" href= "#the-exposedevent-interface"></a></h3><div><pre class="def idl"><span class="idlInterface" id=<ins class="diff-chg">
"idl-def-exposedevent" data-idl="" data-title=
"ExposedEvent">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-exposedevent" class="internalDFN" data-link-type=
"dfn"><code>ExposedEvent</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-thingevent" class="internalDFN"
data-link-type=
"dfn"><code>ThingEvent</code></a></span> {<span class="idlMethod"
id="idl-def-exposedevent-emit-payload" data-idl="" data-title=
"emit" data-dfn-for="exposedevent"><span class="idlMethType">
  void</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedevent" data-lt=
"exposedevent.emit()|exposedevent.emit|emit()|emit" href=
"#dom-exposedevent-emit" class="internalDFN" data-link-type=
"dfn"><code>emit</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">payload</span></span>);</span>
};
</ins></span></pre></div><section id="the-emit-method"><h4 id="x7-5-1-the-emit-method"><span class="secno"><ins class="diff-chg">
7.5.1
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="exposedevent" data-dfn-type="dfn" id= "dom-exposedevent-emit" data-idl="operation" data-title="emit()" data-type="void" data-lt= "exposedevent.emit()|exposedevent.emit|emit()|emit"><code><ins class="diff-chg">
emit()
</ins></code></dfn><ins class="diff-chg">
method
</ins><a class="self-link" aria-label="§" href= "#the-emit-method"></a></h4><p><ins class="diff-chg">
Emits
an
event
that
carries
data
specified
by
the
</ins><code><ins class="diff-chg">
payload
</ins></code><ins class="diff-chg">
argument.
</ins></p></section></section><section id="the-value-matching-algorithm"><h3 id="x7-6-the-value-matching-algorithm"><span class= "secno"><ins class="diff-chg">
7.6
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-type="dfn" id= "dfn-value-matching-algorithm"><ins class="diff-chg">
value-matching
algorithm
</ins></dfn><a class="self-link" aria-label="§" href= "#the-value-matching-algorithm"></a></h3><p><ins class="diff-chg">
The
value-matching
algorithm
is
applied
to
</ins>
a
<del class="diff-old">IANA
media
</del>
<var>
<ins class="diff-chg">value
</ins></var><ins class="diff-chg">
input
in
relation
to
a
</ins><var><ins class="diff-chg">
valueType
</ins></var><ins class="diff-chg">
property
of
</ins>
type
<del class="diff-old">.
For
TD
</del>
<a href="#dom-dataschema" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">DataSchema
</ins></code></a>,<ins class="diff-chg">
for
instance
the
</ins><code><ins class="diff-chg">
value
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
type
</ins></code><ins class="diff-chg">
properties
of
a
</ins><a href= "#dom-propertyfragment" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
PropertyFragment
</ins></code>
</a>
<del class="diff-old">s
there
will
be
registered
media
types,
so
applications
will
be
able
</del>
<ins class="diff-chg">object,
or
the
</ins><var><ins class="diff-chg">
inputValue
</ins></var><ins class="diff-chg">
parameter
</ins>
to
<del class="diff-old">check
whether
an
</del>
<ins class="diff-chg">the
</ins>
<code>
<del class="diff-old">href
</del>
<ins class="diff-chg">invoke()
</ins>
</code>
<del class="diff-old">link
points
</del>
<ins class="diff-chg">method
of
a
</ins><a href="#dom-thingaction" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingAction
</ins></code></a><ins class="diff-chg">
object
in
relation
</ins>
to
<ins class="diff-new">the
same
object.
It
executes
the
following
steps:
</ins></p><ol><li><ins class="diff-new">
If
</ins><var><ins class="diff-new">
valueType.type
</ins></var><ins class="diff-new">
is
not
defined,
or
does
not
fully
match
</ins>
a
<del class="diff-old">TD
</del>
<ins class="diff-chg">string
enumerated
in
</ins><a href="#dfn-datatype" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
DataType
</ins>
</a>,
<del class="diff-old">i.e.
whether
</del>
<ins class="diff-chg">return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"null"
</ins></code>:<ins class="diff-chg">
if
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
null
</ins></code>,<ins class="diff-chg">
return
</ins><code><ins class="diff-chg">
true
</ins></code>,<ins class="diff-chg">
otherwise
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"boolean"
</ins></code>:<ins class="diff-chg">
if
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
either
</ins><code><ins class="diff-chg">
true
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
then
return
</ins><code><ins class="diff-chg">
true
</ins></code>,<ins class="diff-chg">
otherwise
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"integer"
</ins></code>:<ins class="diff-chg">
if
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
an
integer
type
defined
by
</ins>
the
<del class="diff-old">link
</del>
<ins class="diff-chg">underlying
platform
(such
as
</ins><code><ins class="diff-chg">
long
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
long
long
</ins></code><ins class="diff-chg">
),
then
return
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
otherwise
execute
the
following
sub-steps:
</ins><ol><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.minimum
</ins></var>
is
<del class="diff-old">fetcheable
with
</del>
<ins class="diff-chg">defined
and
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
greater
or
equal
than
that
value,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.maximum
</ins></var><ins class="diff-chg">
is
defined
and
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
less
or
equal
than
that
value,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li><li><ins class="diff-chg">
Return
</ins><code><ins class="diff-chg">
true
</ins></code>.</li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"number"
</ins></code>,<ins class="diff-chg">
if
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
an
integer
or
floating
point
type
defined
by
the
underlying
platform
(such
as
</ins><code><ins class="diff-chg">
long
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
long
long
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
double
</ins></code><ins class="diff-chg">
),
then
return
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
otherwise
otherwise
execute
the
following
sub-steps:
</ins><ol><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.minimum
</ins></var><ins class="diff-chg">
is
defined
and
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
greater
or
equal
than
that
value,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.maximum
</ins></var><ins class="diff-chg">
is
defined
and
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
less
or
equal
than
that
value,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li><li><ins class="diff-chg">
Return
</ins><code><ins class="diff-chg">
true
</ins></code>.</li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"string"
</ins></code>:<ins class="diff-chg">
if
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
a
string
type
defined
by
the
underlying
platform,
then
return
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
otherwise
return
</ins><code><ins class="diff-chg">
true
</ins></code>.<ins class="diff-chg">
In
</ins>
this
<del class="diff-old">API.
</del>
<ins class="diff-chg">case
the
algorithm
expects
a
third
parameter
</ins><var><ins class="diff-chg">
valueType.enum
</ins></var><ins class="diff-chg">
and
runs
the
following
sub-steps:
</ins><ul><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.enum
</ins></var><ins class="diff-chg">
is
an
array
of
strings,
then
if
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
fully
matches
one
of
the
strings
defined
in
the
array,
return
</ins><var><ins class="diff-chg">
true
</ins></var>.</li><li><ins class="diff-chg">
Otherwise,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.
</li>
</ul>
</li>
<li>
<ins class="diff-chg">Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"array"
</ins></code>,<ins class="diff-chg">
execute
the
following
sub-steps:
</ins><ol><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
an
array,
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.minItems
</ins></var><ins class="diff-chg">
is
defined,
and
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
does
not
contain
at
least
</ins><var><ins class="diff-chg">
valueType.minItems
</ins></var><ins class="diff-chg">
elements,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.maxItems
</ins></var><ins class="diff-chg">
is
defined,
and
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
contains
more
than
</ins><var><ins class="diff-chg">
valueType.maxItems
</ins></var><ins class="diff-chg">
elements,
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.items
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
undefined
</ins></code>,<ins class="diff-chg">
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
valueType.items
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
null
</ins></code>,<ins class="diff-chg">
return
</ins><code><ins class="diff-chg">
true
</ins></code><ins class="diff-chg">
(i.e.
any
type
is
accepted
as
array
element,
including
heterogenous
arrays).
</ins></li><li><ins class="diff-chg">
Otherwise,
for
each
element
of
the
array
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
run
the
</ins><a href="#dfn-value-matching-algorithm" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
value-matching
algorithm
</ins></a><ins class="diff-chg">
against
the
</ins><var><ins class="diff-chg">
valueType.items
</ins></var><ins class="diff-chg">
object.
If
any
of
these
runs
returns
</ins><code><ins class="diff-chg">
false
</ins></code>,<ins class="diff-chg">
then
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
Otherwise,
return
</ins><code><ins class="diff-chg">
true
</ins></code>.</li></ol></li><li><ins class="diff-chg">
Otherwise,
if
</ins><var><ins class="diff-chg">
type
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
"object"
</ins></code>,<ins class="diff-chg">
execute
the
following
sub-steps:
</ins><ol><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
is
not
an
</ins><code><ins class="diff-chg">
Object
</ins></code>,<ins class="diff-chg">
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.properties
</ins></var><ins class="diff-chg">
is
not
defined,
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
If
</ins><var><ins class="diff-chg">
valueType.properties
</ins></var><ins class="diff-chg">
is
</ins><code><ins class="diff-chg">
null
</ins></code>,<ins class="diff-chg">
return
</ins><code><ins class="diff-chg">
true
</ins></code><ins class="diff-chg">
(i.e.
accept
any
object
value).
</ins></li><li><ins class="diff-chg">
For
each
string
in
the
</ins><var><ins class="diff-chg">
valueType.required
</ins></var><ins class="diff-chg">
array,
if
it
does
not
match
a
property
name
in
the
</ins><var><ins class="diff-chg">
value.properties
</ins></var><ins class="diff-chg">
object
or
in
the
</ins><var><ins class="diff-chg">
value
</ins></var><ins class="diff-chg">
object,
then
return
</ins><code><ins class="diff-chg">
false
</ins></code>.</li><li><ins class="diff-chg">
For
each
property
with
name
</ins><var><ins class="diff-chg">
propName
</ins></var><ins class="diff-chg">
and
value
</ins><var><ins class="diff-chg">
propDataSchema
</ins></var><ins class="diff-chg">
found
in
</ins><var><ins class="diff-chg">
valueType.properties
</ins></var>,<ins class="diff-chg">
run
the
following
sub-steps:
</ins><ol><li><ins class="diff-chg">
If
the
result
of
applying
the
</ins><a href= "#dfn-value-matching-algorithm" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
value-matching
algorithm
</ins></a><ins class="diff-chg">
on
the
value
</ins><var><ins class="diff-chg">
value[propName]
</ins></var><ins class="diff-chg">
and
</ins><var><ins class="diff-chg">
propDataSchema
</ins></var><ins class="diff-chg">
is
</ins><var><ins class="diff-chg">
false
</ins></var>,<ins class="diff-chg">
then
return
</ins><var><ins class="diff-chg">
false
</ins></var>.</li></ol></li><li><ins class="diff-chg">
Return
</ins><code><ins class="diff-chg">
true
</ins></code>.</li></ol></li></ol>
</section>
</section>
<section data-dfn-for="Observable" class="informative" id= "observables">
<h2 id="x8-observables">
<span class="secno">
<del class="diff-old">7.
</del>
<ins class="diff-chg">8.
</ins>
</span>
Observables
<a class="self-link" aria-label="§" href= "#observables">
</a>
</h2>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
<dfn data-dfn-type="dfn" id="dfn-observables">
Observables
</dfn>
are
<a href= "https://github.com/tc39/proposal-observable">
proposed
</a>
to
be
included
in
ECMAScript
and
are
used
for
handling
pushed
data
associated
with
various
possible
sources,
for
instance
events,
timers,
streams,
etc.
A
minimal
required
implementation
is
described
here.
</p>
<div class="ednote" id="issue-container-generatedID-6">
<div role="heading" class="ednote-title marker" id="h-ednote-2" aria-level="3">
<span>
Editor's
note
</span>
</div>
<p class="">
This
section
is
informal
and
contains
rather
laconic
information
for
implementations
on
what
to
support
for
interoperability.
</p>
</div>
<div>
<pre class="def idl"><span class="idlInterface" id=
"idl-def-observable" data-idl="" data-title=
"Observable">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-observable" class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; {
&lt;span class="idlMethod" id=
"idl-def-observable-subscribe-next-error-complete" data-idl=""
data-title="subscribe" data-dfn-for="observable"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-subscription" class="internalDFN"
</del>
<ins class="diff-chg">"dfn"><code>Observable</code></a></span> {<span class="idlMethod"
id="idl-def-observable-subscribe-handler-errorhandler-oncomplete"
data-idl="" data-title="subscribe" data-dfn-for=
"observable"><span class="idlMethType">
</ins>  <a data-link-for="" href="#dom-subscription" class="internalDFN"
data-link-type=
"dfn"><code>Subscription</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="observable"
data-lt="subscribe|subscribe()" href="#dom-observable-subscribe"
class="internalDFN" data-link-type=
"dfn"><code>subscribe</code></a></span>(<span class=
<del class="diff-old">"idlParam"&gt;(&lt;a href="#dom-observer"
class="internalDFN" data-link-type=
"dfn"&gt; or &lt;a href="#dom-onnext" class=
</del>
<ins class="diff-chg">"idlParam"><span class="idlParamType"><a href=
"https://www.w3.org/TR/html52/single-page.html#typedefdef-eventhandler">EventHandler</a></span> <span class="idlParamName">handler</span></span>,<span class="idlParam">
                         optional<span class=
"idlParamType"> <a data-link-for="" href="#dom-errorhandler" class=
"internalDFN" data-link-type=
"dfn"><code>ErrorHandler</code></a></span> <span class=
"idlParamName">errorHandler</span></span>,<span class="idlParam">
                         optional<span class=
"idlParamType"> <a data-link-for="" href="#dom-oncomplete" class=
</ins>
"internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlParamName"&gt;next,
                           &lt;span class=
"idlParam"&gt;optional &lt;a href=
"#dom-onerror" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;error,
                           &lt;span class=
"idlParam"&gt;optional &lt;a href=
"#dom-oncomplete" class="internalDFN" data-link-type=
</del>
"dfn"><code>OnComplete</code></a></span> <span class=
<del class="diff-old">"idlParamName"&gt;complete
};
&lt;span class="idlInterface" id="idl-def-subscription" data-idl=""
data-title="Subscription"&gt;interface &lt;span class=
"idlInterfaceID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-subscription" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMethod" id="idl-def-subscription-unsubscribe"
data-idl="" data-title="unsubscribe" data-dfn-for=
"subscription"&gt;    &lt;span class=
"idlMethType"&gt;void &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="subscription"
data-lt="unsubscribe|unsubscribe()" href=
"#dom-subscription-unsubscribe" class="internalDFN" data-link-type=
"dfn"&gt;
&lt;span class="idlAttribute" id="idl-def-subscription-closed"
data-idl="" data-title="closed" data-dfn-for=
"subscription"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href=
</del>
<ins class="diff-chg">"idlParamName">onComplete</span></span>);</span>
};</span><span class="idlInterface" id="idl-def-subscription"
data-idl="" data-title="Subscription">
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-subscription" class=
"internalDFN" data-link-type=
"dfn"><code>Subscription</code></a></span> {<span class="idlMethod"
id="idl-def-subscription-unsubscribe" data-idl="" data-title=
"unsubscribe" data-dfn-for="subscription"><span class=
"idlMethType">
  void</span> <span class="idlMethName"><a data-no-default=""
data-link-for="subscription" data-lt="unsubscribe|unsubscribe()"
href="#dom-subscription-unsubscribe" class="internalDFN"
data-link-type=
"dfn"><code>unsubscribe</code></a></span>();</span><span class=
"idlAttribute" id="idl-def-subscription-closed" data-idl=""
data-title="closed" data-dfn-for="subscription">
  readonly attribute<span class="idlAttrType"> <a href=
</ins>
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <span class="idlAttrName"><a data-no-default=""
<del class="diff-old">data-link-for="subscription" data-lt="" href=
"#dom-subscription-closed" class="internalDFN" data-link-type=
</del>
<ins class="diff-chg">data-link-for="subscription" data-lt="subscription.closed|closed"
href="#dom-subscription-closed" class="internalDFN" data-link-type=
</ins>
"dfn"><code>closed</code></a></span>;</span>
<del class="diff-old">};
&lt;span class="idlInterface" id="idl-def-observer" data-idl=""
data-title="Observer"&gt;interface &lt;span class=
"idlInterfaceID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-observer" class="internalDFN" data-link-type=
"dfn"&gt; {
&lt;span class="idlMethod" id="idl-def-observer-next-value" data-idl=
"" data-title="next" data-dfn-for="observer"&gt;    &lt;span class=
"idlMethType"&gt;void &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="observer"
data-lt="next()|next" href="#dom-observer-next" class="internalDFN"
data-link-type="dfn"&gt;next(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any
&lt;span class="idlMethod" id="idl-def-observer-error-error" data-idl=
"" data-title="error" data-dfn-for="observer"&gt;    &lt;span class=
"idlMethType"&gt;void &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="observer"
data-lt="error()|error" href="#dom-observer-error" class=
"internalDFN" data-link-type="dfn"&gt;error(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-Error"&gt;Error
&lt;span class="idlMethod" id="idl-def-observer-complete" data-idl=""
data-title="complete" data-dfn-for="observer"&gt;    &lt;span class=
"idlMethType"&gt;void &lt;span class=
"idlMethName"&gt;&lt;a data-no-default="" data-link-for="observer"
data-lt="complete()|complete" href="#dom-observer-complete" class=
"internalDFN" data-link-type="dfn"&gt;complete
};
&lt;span class="idlCallback" id="idl-def-onnext" data-idl=""
data-title="OnNext"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-onnext" class="internalDFN" data-link-type=
"dfn"&gt; = &lt;span class=
"idlCallbackType"&gt;void&lt;span class=
</del>
<ins class="diff-chg">};</span><span class="idlCallback" id="idl-def-eventhandler"
data-idl="" data-title="EventHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-eventhandler" class=
"internalDFN" data-link-type=
"dfn"><code>EventHandler</code></a></span> =<span class=
"idlCallbackType"> void</span> (<span class="idlParam"><span class=
</ins>
"idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-any"&gt;any
&lt;span class="idlCallback" id="idl-def-onerror" data-idl=""
data-title="OnError"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-onerror" class="internalDFN" data-link-type=
"dfn"&gt; = &lt;span class=
"idlCallbackType"&gt;void&lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span><span class="idlCallback"
id="idl-def-errorhandler" data-idl="" data-title="ErrorHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-errorhandler" class=
"internalDFN" data-link-type=
"dfn"><code>ErrorHandler</code></a></span> =<span class=
"idlCallbackType"> void</span> (<span class="idlParam"><span class=
</ins>
"idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-Error"&gt;Error
&lt;span class="idlCallback" id="idl-def-oncomplete" data-idl=""
data-title="OnComplete"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-no-default="" data-link-for="" data-lt=""
href="#dom-oncomplete" class="internalDFN" data-link-type=
"dfn"&gt; = &lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-Error">Error</a></span> <span class="idlParamName">error</span></span>);</span><span class="idlCallback"
id="idl-def-oncomplete" data-idl="" data-title="OnComplete">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-oncomplete" class=
"internalDFN" data-link-type=
"dfn"><code>OnComplete</code></a></span> =<span class=
</ins>
"idlCallbackType">
void
</span>
();
</span>
</pre>
</div>
<del class="diff-old">7.1
The
Observer
interface
</del>
<p>
The
<del class="diff-old">Observer
interface
defines
the
</del>
<ins class="diff-chg">following
</ins>
callbacks
<del class="diff-old">needed
</del>
<ins class="diff-chg">can
be
provided
when
subscribing
</ins>
to
<del class="diff-old">handle
</del>
an
<a href="#dom-observable" class="internalDFN" data-link-type= "dfn">
<code>
Observable
</code>
</a>:
</p>
<ul>
<li>
The
<del class="diff-old">next()
function,
as
well
as
the
</del>
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-eventhandler" data-idl="callback" data-title= "EventHandler">
<code>
<del class="diff-old">OnNext
</del>
<ins class="diff-chg">EventHandler
</ins>
</code>
</dfn>
callback
takes
the
next
sample
for
the
data
in
the
<code>
value
</code>
argument.
</li>
<li>
The
<del class="diff-old">error()
function,
as
well
as
the
</del>
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-errorhandler" data-idl="callback" data-title= "ErrorHandler">
<code>
<del class="diff-old">OnError
</del>
<ins class="diff-chg">ErrorHandler
</ins>
</code>
</dfn>
callback
takes
an
error
in
the
<code>
value
</code>
argument.
It
is
called
when
an
error
<del class="diff-old">occured
</del>
<ins class="diff-chg">occurred
</ins>
in
producing
the
data
the
client
should
know
about.
</li>
<li>
The
<del class="diff-old">complete()
function,
as
well
as
the
</del>
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-oncomplete" data-idl="callback" data-title= "OnComplete">
<code>
OnComplete
</code>
</dfn>
callback
is
called
when
the
data
source
has
finished
sending
values.
</li>
</ul>
<section data-dfn-for="Subscription" id= "the-subscription-interface">
<h3 id="x8-1-the-subscription-interface">
<span class= "secno">
<del class="diff-old">7.2
</del>
<ins class="diff-chg">8.1
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-subscription" data-idl="interface" data-title= "Subscription">
<code>
Subscription
</code>
</dfn>
interface
<a class= "self-link" aria-label="§" href= "#the-subscription-interface">
</a>
</h3>
<p>
Contains
the
<dfn data-dfn-for="subscription" data-dfn-type= "dfn" id="dom-subscription-closed" data-idl="attribute" data-title= "closed" data-type="boolean" data-lt= "subscription.closed|closed">
<code>
closed
</code>
</dfn>
property
of
type
<code>
boolean
</code>
that
tells
if
the
subscription
is
closed
or
active.
</p>
<p>
Also,
contains
the
<dfn data-dfn-for="subscription" data-dfn-type="dfn" id="dom-subscription-unsubscribe" data-idl= "operation" data-title="unsubscribe" data-type="void" data-lt= "unsubscribe|unsubscribe()">
<code>
unsubscribe
</code>
</dfn>
()
method
that
cancels
the
subscription,
i.e.
makes
a
request
to
the
underlying
platform
to
stop
receiving
data
from
the
source,
and
sets
the
<code>
closed
</code>
property
to
<code>
false
</code>.
</p>
</section>
<section data-dfn-for="Observable" id="the-observable-interface">
<h3 id="x8-2-the-observable-interface">
<span class= "secno">
<del class="diff-old">7.3
</del>
<ins class="diff-chg">8.2
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-observable" data-idl="interface" data-title= "Observable">
<code>
Observable
</code>
</dfn>
interface
<a class= "self-link" aria-label="§" href= "#the-observable-interface">
</a>
</h3>
<p>
The
<a href="#dom-observable" class="internalDFN" data-link-type="dfn">
<code>
Observable
</code>
</a>
interface
enabled
subscribing
to
pushed
data
notifications
by
the
<dfn data-dfn-for= "observable" data-dfn-type="dfn" id="dom-observable-subscribe" data-idl="operation" data-title="subscribe" data-type= "Subscription" data-lt= "subscribe|subscribe()">
<code>
subscribe
</code>
</dfn>
()
method:
</p>
<ul>
<li>
<del class="diff-old">If
the
subscribe()
method
is
called
with
an
Observer
object,
initialize
the
data,
error
and
completion
handling
callbacks
from
that
object,
or
throw
on
error.
Otherwise,
if
the
subscribe()
method
is
called
with
a
function,
initialize
</del>
<ins class="diff-chg">Initialize
</ins>
the
data
handler
callback
with
<del class="diff-old">that
function.
</del>
<ins class="diff-chg">the
first
function
argument.
</ins></li><li>
If
the
next
argument
is
provided
and
is
a
function,
initialize
the
error
handling
callback
with
that
function,
or
throw
on
error.
</li>
<li>
If
the
third
argument
is
provided
and
is
a
function,
initialize
the
completion
handler
with
that
function,
or
throw
on
error.
</li>
<li>
After
callback
initializations,
the
implementation
should
request
the
underlying
platform
to
provide
data,
error
and
completion
notifications
for
the
supported
data
source.
</li>
</ul>
</section>
</section>
<section>
<h2 id="security">
<span class="secno">
<del class="diff-old">8.
</del>
<ins class="diff-chg">9.
</ins>
</span>
Security
and
Privacy
<a class="self-link" aria-label="§" href= "#security">
<del class="diff-old">Editor's
note
</del>
</a>
<del class="diff-old">Please
see
</del>
</h2>
<p>
<ins class="diff-chg">In
general
</ins>
the
<ins class="diff-chg">security
measures
taken
to
protect
a
</ins>
WoT
<del class="diff-old">Security
</del>
<ins class="diff-chg">system
will
depend
on
the
threats
</ins>
and
<del class="diff-old">Privacy
repository
</del>
<ins class="diff-chg">attackers
that
system
may
face
and
the
value
of
the
assets
needs
to
protect.
A
detailed
discussion
of
security
and
privacy
considerations
</ins>
for
<del class="diff-old">work
in
progress
regarding
</del>
<ins class="diff-chg">the
Web
of
Things,
including
a
</ins>
threat
<del class="diff-old">models,
assets,
risks,
recommended
mitigations,
</del>
<ins class="diff-chg">model
that
can
be
adapted
to
various
circumstances,
is
presented
in
the
informative
document
[
</ins><cite><a class="bibref" href= "#bib-wot-security-considerations"><ins class="diff-chg">
WOT-SECURITY-CONSIDERATIONS
</ins></a></cite><ins class="diff-chg">
].
This
section
includes
only
normative
recommendations
relevant
to
the
WoT
Thing
Description.
</ins></p><p><span class="rfc2119-assertion" id="td-sec-best-practices"><ins class="diff-chg">
When
designing
new
devices
</ins>
and
<ins class="diff-new">services
for
use
with
the
WoT,
we
have
documented
a
set
of
</ins>
best
practices
<del class="diff-old">for
</del>
<ins class="diff-chg">in
[
</ins><cite><a class="bibref" href="#bib-wot-security-best-practices"><ins class="diff-chg">
WOT-SECURITY-BEST-PRACTICES
</ins></a></cite><ins class="diff-chg">
]
that
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
followed.
</ins></span><ins class="diff-chg">
This
best-practices
document
may
be
updated
as
</ins>
security
<ins class="diff-new">measures
evolve.
Following
these
practices
does
not
guarantee
security,
but
it
at
least
will
help
to
avoid
common
known
vulnerabilities
</ins>
and
<del class="diff-old">privacy
for
systems
</del>
<ins class="diff-chg">pitfalls.
</ins></p><p><ins class="diff-chg">
Below
are
specific
recommendations
related
to
WoT
runtime
implementations:
</ins></p><ul><li><ins class="diff-chg">
In
basic
WoT
setups,
all
scripts
running
inside
the
WoT
runtime
are
considered
trusted,
and
therefore
there
is
no
strong
need
to
perform
strict
isolation
between
each
running
script
instance.
However,
depending
on
device
capabilities
and
deployment
use
case
scenario
risk
level
it
might
be
desirable
to
do
so.
</ins><ul><li><ins class="diff-chg">
For
example,
if
one
script
handles
sensitive
privacy-related
data
and
well-audited,
it
might
be
desirable
to
separate
it
from
the
rest
of
the
script
instances
to
minimize
the
risk
of
data
exposure
in
case
some
other
script
inside
WoT
gets
compromised
during
the
runtime.
</ins><span class="rfc2119-assertion" id= "scripting-sec-isolation-scripts"><ins class="diff-chg">
Therefore
the
WoT
runtime
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
perform
isolation
of
script
instances
and
their
data
in
cases
when
scripts
handle
privacy-related
or
other
critical
security
data.
</ins></span></li><li><ins class="diff-chg">
Another
example
is
mutual
co-existence
of
different
tenants
on
a
single
WoT
device.
In
this
case
each
WoT
runtime
instance
will
be
hosting
a
different
tenant,
and
isolation
between
them
is
required.
</ins><span class="rfc2119-assertion" id= "scripting-sec-isolation-runtimes"><ins class="diff-chg">
Therefore
the
WoT
runtime
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
perform
isolation
of
WoT
runtime
instances
and
their
data
if
a
WoT
device
has
more
than
one
tenant.
</ins></span></li></ul><ins class="diff-chg">
Such
isolation
can
be
performed
within
the
WoT
Runtime
</ins>
using
<ins class="diff-new">platform
security
mechanisms
available
on
</ins>
the
<del class="diff-old">Web
</del>
<ins class="diff-chg">device.
For
more
information
see
Section
"WoT
Servient
Single-Tenant"
and
"WoT
Servient
Multi-Tenant"
</ins>
of
<ins class="diff-new">[
</ins><cite><a class="bibref" href= "#bib-wot-security-considerations"><ins class="diff-new">
WOT-SECURITY-CONSIDERATIONS
</ins></a></cite><ins class="diff-new">
].
</ins></li><li><ins class="diff-new">
WoT
scripts
are
using
WoT
Scripting
API
to
implement
the
functionality
and
logic
for
WoT
</ins>
Things.
<del class="diff-old">Once
complete,
</del>
<ins class="diff-chg">In
addition
to
providing
the
isolation
between
script
and
runtime
instances,
the
WoT
runtime
needs
to
protect
the
underlying
physical
device
from
potentially
misbehaving
WoT
scripts.
</ins><span class="rfc2119-assertion" id= "scripting-sec-native"><ins class="diff-chg">
Therefore
the
WoT
Runtime
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
avoid
directly
exposing
the
native
device
interfaces
to
the
script
developers.
</ins></span><ins class="diff-chg">
Instead
a
WoT
Runtime
should
provide
a
hardware
abstraction
layer
for
accessing
the
native
device
interfaces.
Additionally,
in
order
to
reduce
the
damage
to
a
physical
WoT
device
in
cases
a
WoT
script
gets
compromised,
it
is
important
to
minimize
the
number
of
interfaces
that
are
exposed
or
accessible
to
a
particular
WoT
script
based
on
its
functionality.
</ins><span class="rfc2119-assertion" id="scripting-sec-interface-min"><ins class="diff-chg">
Therefore
the
WoT
Runtime
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
only
expose
a
minimal
set
of
interfaces
to
a
WoT
script
based
on
its
intended
functionality.
</ins></span></li><li><ins class="diff-chg">
If
the
WoT
runtime
supports
post-manufacturing
provisioning
or
update
of
WoT
scripts,
WoT
runtime
or
any
related
data
(including
</ins>
security
<ins class="diff-new">credentials),
it
can
be
a
major
attack
vector.
An
attacker
can
try
to
modify
any
above
described
part
during
the
update
or
provisioning
process
or
simply
provision
attacker's
code
</ins>
and
<del class="diff-old">privacy
considerations
relevant
</del>
<ins class="diff-chg">data
directly.
</ins><span class="rfc2119-assertion" id= "scripting-sec-update"><ins class="diff-chg">
Therefore,
if
WoT
Runtime
supports
post-manufacturing
provisioning
or
update
of
WoT
scripts,
WoT
runtime
or
any
related
data,
such
operations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
done
in
a
secure
fashion.
</ins></span><ins class="diff-chg">
A
set
of
recommendations
for
secure
update
and
post-manufacturing
provisioning
can
be
found
in
[
</ins><cite><a class="bibref" href= "#bib-wot-security-best-practices"><ins class="diff-chg">
WOT-SECURITY-BEST-PRACTICES
</ins></a></cite><ins class="diff-chg">
].
</ins></li><li><ins class="diff-chg">
Typically
the
WoT
runtime
needs
</ins>
to
<ins class="diff-new">store
</ins>
the
<del class="diff-old">Scripting
API
will
</del>
<ins class="diff-chg">security
credentials
that
are
provisioned
to
a
WoT
device
to
operate
in
WoT
network.
The
confidentiality
or
integrity
of
these
credentials
should
not
</ins>
be
<del class="diff-old">summarized
</del>
<ins class="diff-chg">compromised.
</ins><span class="rfc2119-assertion" id= "scripting-sec-creds1"><ins class="diff-chg">
Therefore
the
WoT
runtime
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
securely
store
the
provisioned
security
credentials,
guaranteeing
their
integrity
and
confidentiality.
</ins></span><span class="rfc2119-assertion" id= "scripting-sec-creds2"><ins class="diff-chg">
In
case
there
are
more
than
one
tenant
on
a
single
WoT-enabled
device,
a
WoT
Runtime
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
guarantee
isolation
of
each
tenant
provisioned
security
credentials.
</ins></span><ins class="diff-chg">
Additionally,
</ins>
in
<del class="diff-old">this
section.
</del>
<ins class="diff-chg">order
to
minimize
a
risk
that
provisioned
security
credentials
get
compromised,
the
WoT
runtime
should
not
have
any
way
for
WoT
scripts
to
query
these
credentials.
</ins><span class="rfc2119-assertion" id= "scripting-sec-creds3"><ins class="diff-chg">
Therefore,
the
WoT
Runtime
</ins><em class= "rfc2119" title="SHOULD NOT"><ins class="diff-chg">
SHOULD
NOT
</ins></em><ins class="diff-chg">
expose
any
API
for
WoT
scripts
to
query
the
provisioned
security
credentials.
</ins></span></li></ul><p><ins class="diff-chg">
Some
additional
specific
recommendations
relevant
for
WoT
script
developers:
</ins>
</p>
<ul>
<li>
<ins class="diff-chg">A
typical
way
to
compromise
any
process
is
to
send
it
a
corrupted
input
via
one
of
the
exposed
interfaces.
</ins><span class= "rfc2119-assertion" id="scripting-sec-inputs"><ins class="diff-chg">
Therefore
developers
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
perform
validation
on
all
WoT
script
inputs,
including
</ins><a href= "https://en.wikipedia.org/wiki/Fuzzing"><ins class="diff-chg">
fuzzing
</ins></a>.</span><ins class="diff-chg">
There
are
many
tool
and
techniques
in
existence
to
do
such
validation.
More
details
can
be
found
in
[
</ins><cite><a class="bibref" href= "#bib-wot-security-testing"><ins class="diff-chg">
WOT-SECURITY-TESTING
</ins></a></cite><ins class="diff-chg">
].
</ins></li><li><ins class="diff-chg">
As
any
software,
complex
scripts
with
a
lot
of
functionality
presents
a
higher
risk
of
development
mistakes.
Such
scripts
are
also
hard
to
verify
and
test
appropriately.
</ins><span class= "rfc2119-assertion" id="scripting-sec-complexity"><ins class="diff-chg">
Therefore
developers
SHOUD
minimize
the
functionality
and
complexity
of
WoT
scripts.
</ins></span></li><li><ins class="diff-chg">
If
a
WoT
script
performs
a
heavy
functional
processing
on
received
requests
before
the
request
is
authenticated,
it
presents
a
great
risk
for
Denial-Of-Service
(DOS)
attacks.
</ins><span class= "rfc2119-assertion" id="scripting-sec-dos"><ins class="diff-chg">
Therefore
WoT
scripts
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
avoid
heavy
functional
processing
without
prior
successful
authentication
of
requestor.
</ins></span><ins class="diff-chg">
The
set
of
recommended
authentication
mechanisms
can
be
found
in
[
</ins><cite><a class="bibref" href= "#bib-wot-security-best-practices"><ins class="diff-chg">
WOT-SECURITY-BEST-PRACTICES
</ins></a></cite><ins class="diff-chg">
].
</ins></li><li><ins class="diff-chg">
WoT
developers
should
remember
that
a
content
of
a
TD
can
change,
including
its
identified,
id,
which
is
not
an
immutable
identifier.
</ins><span class="rfc2119-assertion" id= "scripting-sec-id"><ins class="diff-chg">
Therefore
WoT
scripts
</ins><em class="rfc2119" title= "SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
use
the
provided
WoT
script
API
to
subscribe
for
notifications
on
TD
changes.
</ins></span></li></ul>
</section>
<section id="terminology-and-conventions">
<h2 id="x10-terminology-and-conventions">
<span class= "secno">
<del class="diff-old">9.
</del>
<ins class="diff-chg">10.
</ins>
</span>
Terminology
and
conventions
<a class="self-link" aria-label="§" href="#terminology-and-conventions">
</a>
</h2>
<p>
The
generic
WoT
terminology
is
defined
in
[
<cite>
<a class= "bibref" href="#bib-wot-architecture">
WOT-ARCHITECTURE
</a>
</cite>
]:
<dfn data-lt="things|thing" data-dfn-type="dfn" id= "dfn-things">
Thing
</dfn>,
<dfn data-lt= "thing descriptions|thing description" data-dfn-type="dfn" id= "dfn-thing-descriptions">
Thing
Description
</dfn>
(in
short
<dfn data-dfn-type="dfn" id="dfn-td">
TD
</dfn>
),
<dfn data-dfn-type= "dfn" id="dfn-web-of-things">
Web
of
Things
</dfn>
(in
short
<b>
<i>
WoT
</i>
</b>
),
<dfn data-dfn-type="dfn" id= "dfn-wot-interface">
WoT
Interface
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-protocol-bindings">
Protocol
Bindings
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-wot-runtime">
WoT
Runtime
</dfn>,
<dfn data-lt= "consume|consume a td|consuming a td|consuming a thing description" data-dfn-type="dfn" id="dfn-consume">
Consuming
a
Thing
Description
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-thing-directory">
Thing
Directory
</dfn>,
<dfn data-dfn-type= "dfn" id="dfn-wot-interactions">
WoT
Interactions
</dfn>,
<dfn data-lt="properties|property" data-dfn-type="dfn" id= "dfn-properties">
Property
</dfn>,
<dfn data-lt="actions|action" data-dfn-type="dfn" id="dfn-actions">
Action
</dfn>,
<dfn data-lt= "events|wot-event|event" data-dfn-type="dfn" id= "dfn-events">
Event
</dfn>
etc.
</p>
<p>
<dfn data-dfn-type="dfn" id="dfn-json-ld">
JSON-LD
</dfn>
is
defined
in
[
<cite>
<a class="bibref" href= "#bib-json-ld">
JSON-LD
</a>
</cite>
]
as
a
JSON
document
that
is
augmented
with
support
for
Linked
<del class="diff-old">Data
by
providing
a
@context
property
with
a
defining
URI
.
</del>
<ins class="diff-chg">Data.
</ins>
</p>
<p>
The
terms
<a href= "http://www.w3.org/TR/url-1/">
<dfn data-dfn-type="dfn" id= "dfn-url">
URL
</dfn>
</a>
and
<a href= "https://url.spec.whatwg.org/#concept-url-path">
<dfn data-dfn-type= "dfn" id="dfn-url-path">
URL
path
</dfn>
</a>
are
defined
in
[
<cite>
<a class="bibref" href="#bib-url">
URL
</a>
</cite>
].
</p>
<p>
The
following
terms
are
defined
in
[
<cite>
<a class="bibref" href="#bib-HTML52">
HTML52
</a>
</cite>
]
and
are
used
in
the
context
of
browser
implementations:
<a href= "https://www.w3.org/TR/html52/single-page.html#browsing-context">
<dfn data-dfn-type="dfn" id="dfn-browsing-context">
browsing
context
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#top-level-browsing-context">
<dfn data-dfn-type="dfn" id= "dfn-top-level-browsing-context">
top-level
browsing
context
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#global-object">
<dfn data-dfn-type="dfn" id="dfn-global-object">
global
object
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#incumbent-settings-object">
<dfn data-dfn-type="dfn" id= "dfn-incumbent-settings-object">
incumbent
settings
object
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#document">
<dfn data-dfn-type="dfn" id="dfn-document">
Document
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#document-base-url">
<dfn data-dfn-type="dfn" id="dfn-document-base-url">
document
base
URL
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#window">
<dfn data-dfn-type="dfn" id="dfn-window">
Window
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#windowproxy">
<dfn data-dfn-type="dfn" id="dfn-windowproxy">
WindowProxy
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#section-origin">
<dfn data-dfn-type="dfn" id="dfn-origin">
origin
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#ascii-serialization-of-an-origin">
<dfn data-dfn-type="dfn" id="dfn-ascii-serialized-origin">
ASCII
serialized
origin
</dfn>
</a>,
executing
algorithms
<a href= "https://www.w3.org/TR/html52/single-page.html#in-parallel">
<dfn data-dfn-type="dfn" id="dfn-in-parallel">
in
parallel
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#queuing">
<dfn data-dfn-type="dfn" id="dfn-queue-a-task">
queue
a
task
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#task-source">
<dfn data-dfn-type="dfn" id="dfn-task-source">
task
source
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#the-iframe-element">
<dfn data-dfn-type="dfn" id="dfn-iframe">
iframe
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#valid-mime-type">
<dfn data-dfn-type="dfn" id="dfn-valid-mime-type">
valid
MIME
type
</dfn>
</a>.
</p>
<p>
A
<a href="#dfn-browsing-context" class="internalDFN" data-link-type="dfn">
browsing
context
</a>
refers
to
the
environment
in
which
<a href="#dfn-document" class="internalDFN" data-link-type="dfn">
Document
</a>
objects
are
presented
to
the
user.
A
given
<a href="#dfn-browsing-context" class="internalDFN" data-link-type="dfn">
browsing
context
</a>
has
a
single
<code>
<a href="#dfn-windowproxy" class="internalDFN" data-link-type="dfn">
WindowProxy
</a>
</code>
object,
but
it
can
have
many
<code>
<a href="#dfn-document" class="internalDFN" data-link-type="dfn">
Document
</a>
</code>
objects,
with
their
associated
<code>
<a href="#dfn-window" class="internalDFN" data-link-type="dfn">
Window
</a>
</code>
objects.
The
<a href= "#dfn-script-execution-context" class="internalDFN" data-link-type= "dfn">
script
execution
context
</a>
associated
with
the
<i>
browsing
context
</i>
identifies
the
entity
which
invokes
this
API,
which
can
be
a
<i>
web
app
</i>,
a
<i>
web
page
</i>,
or
an
<a href="#dfn-iframe" class="internalDFN" data-link-type="dfn">
iframe
</a>.
</p>
<p>
The
term
<a href= "https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">
<dfn data-dfn-type="dfn" id="dfn-secure-context">
secure
context
</dfn>
</a>
is
defined
in
[
<cite>
<a class="bibref" href= "#bib-webappsec">
WEBAPPSEC
</a>
</cite>
].
</p>
<p>
<a href= "https://tc39.github.io/ecma262/#sec-error-objects">
<dfn data-dfn-type="dfn" id="dfn-error">
Error
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-evalerror">
EvalError
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-rangeerror">
RangeError
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-referenceerror">
ReferenceError
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-syntaxerror">
SyntaxError
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-typeerror">
TypeError
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-urierror">
URIError
</dfn>
</a>
,
<a href= "https://tc39.github.io/ecma262/#sec-execution-contexts">
<dfn data-dfn-type="dfn" id="dfn-script-execution-context">
script
execution
context
</dfn>
</a>,
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects">
<dfn data-dfn-type="dfn" id="dfn-promise">
Promise
</dfn>
</a>,
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-json-object">
<dfn data-dfn-type="dfn" id="dfn-json">
JSON
</dfn>
</a>,
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-json.stringify">
<dfn data-dfn-type="dfn" id= "dfn-json-stringify">
JSON.stringify
</dfn>
</a>
and
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-json.parse">
<dfn data-dfn-type="dfn" id="dfn-json-parse">
JSON.parse
</dfn>
</a>
are
defined
in
[
<cite>
<a class="bibref" href= "#bib-ecmascript">
ECMASCRIPT
</a>
</cite>
].
</p>
<p>
<a href= "http://heycam.github.io/webidl/#idl-DOMString">
<dfn data-dfn-type= "dfn" id="dfn-domstring">
DOMString
</dfn>
</a>,
<a href= "https://heycam.github.io/webidl/#idl-USVString">
<dfn data-dfn-type="dfn" id="dfn-usvstring">
USVString
</dfn>
</a>,
<a href= "http://heycam.github.io/webidl/#idl-ArrayBuffer">
<dfn data-dfn-type="dfn" id="dfn-arraybuffer">
ArrayBuffer
</dfn>
</a>,
<a href= "http://heycam.github.io/webidl/#common-BufferSource">
<dfn data-dfn-type="dfn" id="dfn-buffersource">
BufferSource
</dfn>
</a>
and
<a href= "http://heycam.github.io/webidl/#idl-any">
<dfn data-dfn-type="dfn" id="dfn-any-0">
any
</dfn>
</a>
are
defined
in
[
<cite>
<a class= "bibref" href="#bib-webidl">
WEBIDL
</a>
</cite>
].
</p>
<p>
The
algorithms
<a href= "http://www.w3.org/TR/encoding/#utf-8-encode">
<dfn data-dfn-type= "dfn" id="dfn-utf-8-encode">
utf-8
encode
</dfn>
</a>,
and
<a href= "http://www.w3.org/TR/encoding/#utf-8-decode">
<dfn data-dfn-type= "dfn" id="dfn-utf-8-decode">
utf-8
decode
</dfn>
</a>
are
defined
in
[
<cite>
<a class="bibref" href= "#bib-encoding">
ENCODING
</a>
</cite>
].
</p>
<p>
<dfn data-dfn-type="dfn" id="dfn-iana-media-type">
IANA
media
type
</dfn>
s
(formerly
known
as
MIME
types)
are
defined
in
<a href= "http://tools.ietf.org/html/rfc2046">
RFC2046
</a>.
</p>
<p>
The
terms
<dfn data-dfn-type="dfn" id= "dfn-hyperlink-reference">
hyperlink
reference
</dfn>
and
<dfn data-dfn-type="dfn" id="dfn-relation-type">
relation
type
</dfn>
are
defined
in
[
<cite>
<a class="bibref" href= "#bib-HTML52">
HTML52
</a>
</cite>
]
and
<a href= "https://tools.ietf.org/html/rfc8288">
RFC8288
</a>.
</p>
</section>
<section id="conformance">
<h2 id="x11-conformance">
<span class="secno">
<del class="diff-old">10.
</del>
<ins class="diff-chg">11.
</ins>
</span>
Conformance
<a class="self-link" aria-label="§" href= "#conformance">
</a>
</h2>
<p>
As
well
as
sections
marked
as
non-normative,
all
authoring
guidelines,
diagrams,
examples,
and
notes
in
this
specification
are
non-normative.
Everything
else
in
this
specification
is
normative.
</p>
<p id="respecRFC2119">
The
key
words
<em class="rfc2119">
MAY
</em>,
<em class="rfc2119">
MUST
</em>,
<em class="rfc2119">
<ins class="diff-new">SHOULD
</ins></em>,
and
<em class="rfc2119">
SHOULD
<ins class="diff-new">NOT
</ins>
</em>
are
to
be
interpreted
as
described
in
[
<cite>
<a class="bibref" href= "#bib-rfc2119">
RFC2119
</a>
</cite>
].
</p>
<p>
This
document
defines
conformance
criteria
that
apply
to
a
single
product:
the
<dfn data-dfn-type="dfn" id="dfn-ua">
UA
</dfn>
(user
agent)
that
implements
the
interfaces
it
contains.
</p>
<p>
This
specification
can
be
used
for
implementing
the
WoT
Scripting
API
in
multiple
programming
languages.
The
interface
definitions
are
specified
in
[
<cite>
<a class="bibref" href= "#bib-webidl">
WEBIDL
</a>
</cite>
].
</p>
<p>
The
user
agent
(UA)
may
be
implemented
in
the
browser,
or
in
a
separate
runtime
environment,
such
as
<a href= "https://nodejs.org/en/">
Node.js
</a>
or
small
embedded
runtimes.
</p>
<p>
Implementations
that
use
ECMAScript
executed
in
a
browser
to
implement
the
APIs
defined
in
this
document
<em class="rfc2119" title="MUST">
MUST
</em>
implement
them
in
a
manner
consistent
with
the
ECMAScript
Bindings
defined
in
the
Web
IDL
specification
[
<cite>
<a class="bibref" href="#bib-webidl">
WEBIDL
</a>
</cite>
].
</p>
<p>
Implementations
that
use
TypeScript
or
ECMAScript
in
a
runtime
to
implement
the
APIs
defined
in
this
document
<em class="rfc2119" title="MUST">
MUST
</em>
implement
them
in
a
manner
consistent
with
the
TypeScript
Bindings
defined
in
the
TypeScript
specification
[
<cite>
<a class="bibref" href= "#bib-typescript">
TYPESCRIPT
</a>
</cite>
].
</p>
<p>
This
document
serves
a
general
description
of
the
WoT
Scripting
API.
Language
and
runtime
specific
issues
are
discussed
in
separate
extensions
of
this
document.
</p>
</section>
<section class="appendix" id="Changes">
<h2 id="a-changes">
<span class="secno">
A.
</span>
Changes
<a class= "self-link" aria-label="§" href="#Changes">
</a>
</h2>
<p>
The
following
is
a
list
of
major
changes
to
the
document.
For
a
complete
list
of
changes,
see
the
<a href= "https://github.com/w3c/wot-scripting-api/commits/master">
github
change
log
</a>.
You
can
also
view
the
<a href= "https://github.com/w3c/wot-scripting-api/issues?page=1&amp;state=closed">
recently
closed
<del class="diff-old">bugs
</del>
<ins class="diff-chg">issues
</ins>
</a>.
</p>
<ul>
<li>
<del class="diff-old">Synchronized
</del>
<ins class="diff-chg">Make
</ins>
the
Scripting
API
<del class="diff-old">with
</del>
<ins class="diff-chg">refer
to
(rather
then
locally
re-define)
</ins>
the
<ins class="diff-chg">data
structures
defined
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/">
Thing
Description
specification
</a>.
<del class="diff-old">Defined
ThingDescription
,
ThingTemplate
,
SemanticAnnotations
,
SemanticType
,
SemanticMetadata
,
input
and
output
data
descriptions,
etc.
Separated
consume()
to
fetch()
and
consume()
.
Changed
expose()
to
accept
a
Thing
Template
.
Instead
of
addListener()
,
removeListener()
introduced
onEvent()
,
onPropertyChange()
,
onTDChange()
.
Revised
ExposedThing
handlers
for
Property,
Action
and
Event.
Added
an
informal
section
on
TD
introspection.
Added
informal
section
for
Observable
.
</del>
</li>
</ul>
</section>
<section>
<h2 class="appendix" id="openissues">
<span class="secno">
B.
</span>
Open
issues
<a class="self-link" aria-label="§" href= "#openissues">
</a>
</h2>
<p>
The
following
problems
are
being
discussed
and
need
most
attention:
</p>
<ul>
<li>
<del class="diff-old">Revised
API
for
tracking
the
TD
better
(
https://github.com/w3c/wot-scripting-api/issues/96)
.
</del>
Security
related
metadata
<del class="diff-old">(
https://github.com/w3c/wot-scripting-api/issues/91)
.
Defining
DataSchema
better
(
https://github.com/w3c/wot-scripting-api/issues/89)
.
</del>
<ins class="diff-chg">(https://github.com/w3c/wot-scripting-api/issues/91).
</ins>
</li>
<li>
Providing
Protocol
Binding
for
<a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
<del class="diff-old">(
https://github.com/w3c/wot-scripting-api/issues/45)
.
Retrieving
information
from
Thing
Description
(
https://github.com/w3c/wot-scripting-api/issues/38
)
</del>
<ins class="diff-chg">(https://github.com/w3c/wot-scripting-api/issues/45).
</ins>
</li>
<li>
Script
management
and
runtime
related
issues
<del class="diff-old">(
https://github.com/w3c/wot-scripting-api/issues/
)
</del>
<ins class="diff-chg">(https://github.com/w3c/wot-scripting-api/issues/)
</ins>
</li>
</ul>
</section>
<section id="acknowledgements">
<h2 id="c-acknowledgements">
<span class="secno">
C.
</span>
<del class="diff-old">Acknowledgements
</del>
<ins class="diff-chg">Acknowledgments
</ins><a class="self-link" aria-label="§" href= "#acknowledgements"></a>
</h2>
<p>
Special
thanks
to
former
editor
Johannes
Hund
(until
August
2017,
when
at
Siemens
AG)
for
developing
this
specification.
Also,
the
editors
would
like
to
thank
Dave
Raggett,
Matthias
Kovatsch,
Michael
Koster
and
Michael
McCool
for
their
comments
and
guidance.
</p>
</section>
<section id="references" class="appendix">
<h2 id="d-references">
<span class="secno">
D.
</span>
References
<a class="self-link" aria-label="§" href= "#references">
</a>
</h2>
<section id="normative-references">
<h3 id="d-1-normative-references">
<span class="secno">
D.1
</span>
Normative
references
<a class="self-link" aria-label="§" href= "#normative-references">
</a>
</h3>
<dl class="bibliography">
<dt id="bib-ecmascript">
[ECMASCRIPT]
</dt>
<dd>
<a href="https://tc39.github.io/ecma262/">
<cite>
ECMAScript
Language
Specification
</cite>
</a>.
Ecma
International.
URL:
<a href="https://tc39.github.io/ecma262/">
https://tc39.github.io/ecma262/
</a>
</dd>
<dt id="bib-encoding">
[ENCODING]
</dt>
<dd>
<a href= "https://www.w3.org/TR/encoding/">
<cite>
Encoding
</cite>
</a>.
Anne
van
Kesteren;
Joshua
Bell;
Addison
Phillips.
W3C.
15
December
2016.
W3C
Candidate
Recommendation.
URL:
<a href= "https://www.w3.org/TR/encoding/">
https://www.w3.org/TR/encoding/
</a>
</dd>
<dt id="bib-HTML52">
[HTML52]
</dt>
<dd>
<a href="https://www.w3.org/TR/html52/">
<cite>
HTML
5.2
</cite>
</a>.
Steve
Faulkner;
Arron
Eicholz;
Travis
Leithead;
Alex
Danilo;
Sangwhan
Moon;
Erika
Doyle
Navara;
Theresa
O'Connor;
Robin
Berjon.
W3C.
14
December
2017.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/html52/">
https://www.w3.org/TR/html52/
</a>
</dd>
<dt id="bib-json-ld">
[JSON-LD]
</dt>
<dd>
<a href="https://www.w3.org/TR/json-ld/">
<cite>
JSON-LD
1.0
</cite>
</a>.
Manu
Sporny;
Gregg
Kellogg;
Markus
Lanthaler.
W3C.
16
January
2014.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/json-ld/">
https://www.w3.org/TR/json-ld/
</a>
</dd>
<dt id="bib-rfc2119">
[RFC2119]
</dt>
<dd>
<a href="https://tools.ietf.org/html/rfc2119">
<cite>
Key
words
for
use
in
RFCs
to
Indicate
Requirement
Levels
</cite>
</a>.
S.
Bradner.
IETF.
March
1997.
Best
Current
Practice.
URL:
<a href= "https://tools.ietf.org/html/rfc2119">
https://tools.ietf.org/html/rfc2119
</a>
</dd>
<dt id="bib-typescript">
[TYPESCRIPT]
</dt>
<dd>
<a href= "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
<cite>
TypeScript
Language
Specification
</cite>
</a>.
Microsoft.
1
October
2012.
URL:
<a href= "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md
</a>
</dd>
<dt id="bib-url">
[URL]
</dt>
<dd>
<a href="https://url.spec.whatwg.org/">
<cite>
URL
Standard
</cite>
</a>.
Anne
van
Kesteren.
WHATWG.
Living
Standard.
URL:
<a href= "https://url.spec.whatwg.org/">
https://url.spec.whatwg.org/
</a>
</dd>
<dt id="bib-webappsec">
[WEBAPPSEC]
</dt>
<dd>
<a href= "https://w3c.github.io/webappsec/specs/powerfulfeatures">
<cite>
Secure
Contexts
</cite>
</a>.
W3C.
17
July
2015.
URL:
<del class="diff-old">https://w3c.github.io/webappsec/specs/powerfulfeatures/
</del>
<a href= "https://w3c.github.io/webappsec/specs/powerfulfeatures">
<ins class="diff-chg">https://w3c.github.io/webappsec/specs/powerfulfeatures
</ins>
</a>
</dd>
<dt id="bib-webidl">
[WEBIDL]
</dt>
<dd>
<a href="https://heycam.github.io/webidl/">
<cite>
Web
IDL
</cite>
</a>.
Cameron
McCormack;
Boris
Zbarsky;
Tobie
Langel.
W3C.
15
December
2016.
W3C
Editor's
Draft.
URL:
<a href= "https://heycam.github.io/webidl/">
https://heycam.github.io/webidl/
</a>
</dd>
<dt id="bib-wot-architecture">
[WOT-ARCHITECTURE]
</dt>
<dd>
<a href="https://w3c.github.io/wot-architecture/">
<cite>
Web
of
Things
Architecture
</cite>
</a>.
W3C.
<del class="diff-old">14
September
</del>
<ins class="diff-chg">20
August
</ins>
2017.
URL:
<del class="diff-old">https://www.w3.org/TR/2017/WD-wot-architecture-20170914/
</del>
<a href= "https://w3c.github.io/wot-architecture/">
<ins class="diff-chg">https://w3c.github.io/wot-architecture/
</ins></a></dd><dt id="bib-wot-security-best-practices"><ins class="diff-chg">
[WOT-SECURITY-BEST-PRACTICES]
</ins></dt><dd><a href= "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md"><cite><ins class="diff-chg">
Web
of
Things
Security
and
Privacy
Best
Practices
(WIP)
</ins></cite></a>.<ins class="diff-chg">
W3C.
WIP.
URL:
</ins><a href= "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md"><ins class="diff-chg">
https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md
</ins></a></dd><dt id="bib-wot-security-considerations"><ins class="diff-chg">
[WOT-SECURITY-CONSIDERATIONS]
</ins></dt><dd><a href="https://w3c.github.io/wot-security/"><cite><ins class="diff-chg">
Web
of
Things
Security
and
Privacy
Considerations
</ins></cite></a>.<ins class="diff-chg">
W3C.
28
August
2017.
URL:
</ins><a href= "https://w3c.github.io/wot-security/"><ins class="diff-chg">
https://w3c.github.io/wot-security/
</ins></a></dd><dt id="bib-wot-security-testing"><ins class="diff-chg">
[WOT-SECURITY-TESTING]
</ins></dt><dd><a href= "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md"><cite><ins class="diff-chg">
Web
of
Things
Security
Testing
and
Validation
</ins></cite></a>.<ins class="diff-chg">
W3C.
WIP.
URL:
</ins><a href= "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md"><ins class="diff-chg">
https://github.com/w3c/wot-security/blob/master/wot-security-testing.md
</ins></a></dd><dt id="bib-wot-td"><ins class="diff-chg">
[WOT-TD]
</ins></dt><dd><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/"><cite><ins class="diff-chg">
WoT
Thing
Description
</ins></cite></a><ins class="diff-chg">
.
W3C.
21
October
2018.
URL:
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/"><ins class="diff-chg">
https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/
</ins>
</a>
</dd>
</dl>
</section>
<section id="informative-references">
<h3 id="d-2-informative-references">
<span class="secno">
D.2
</span>
Informative
references
<a class="self-link" aria-label="§" href= "#informative-references">
</a>
</h3>
<dl class="bibliography">
<del class="diff-old">[WOT-TD]
</del>
<dt id="bib-html">
<ins class="diff-chg">[HTML]
</ins>
</dt>
<dd>
<a href="https://html.spec.whatwg.org/multipage/">
<cite>
<del class="diff-old">WoT
Thing
Description
</del>
<ins class="diff-chg">HTML
Standard
</ins>
</cite>
<del class="diff-old">.
W3C.
20
August
2017.
</del>
</a>.
<ins class="diff-chg">Anne
van
Kesteren;
Domenic
Denicola;
Ian
Hickson;
Philip
Jägenstedt;
Simon
Pieters.
WHATWG.
Living
Standard.
</ins>
URL:
<del class="diff-old">https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/
</del>
<a href= "https://html.spec.whatwg.org/multipage/">
<ins class="diff-chg">https://html.spec.whatwg.org/multipage/
</ins>
</a>
</dd>
</dl>
</section>
</section>
<p role="navigation" id="back-to-top">
<a href="#toc">
<abbr title= "Back to Top">
↑
</abbr>
</a>
</p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js">
</script>
</body>
</html>
