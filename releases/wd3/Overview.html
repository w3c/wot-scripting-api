<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.2.0">
  <meta charset="utf-8">
  <meta name="generator" content="ReSpec 23.4.0">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1, shrink-to-fit=no">
  <style>
  /* --- EXAMPLES --- */
  span.example-title {
    text-transform: none;
  }
  aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  div.illegal-example { color: red }
  div.illegal-example p { color: black }
  aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
  }

  aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
  }
  aside.example div.example span.example-title {
    color: #999;
  }
  </style>
  <style>
  /* --- ISSUES/NOTES --- */
  div.issue-title, div.note-title , div.ednote-title, div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
  }
  div.issue-title { color: #e05252; }
  div.note-title, div.ednote-title { color: #2b2; }
  div.warning-title { color: #f22; }
  div.issue-title span, div.note-title span, div.ednote-title span, div.warning-title span {
    text-transform: uppercase;
  }
  div.note, div.issue, div.ednote, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
  }
  .note > p:first-child, .ednote > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
  .issue, .note, .ednote, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
  }
  div.issue, div.note , div.ednote,  div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  span.note, span.ednote, span.issue, span.warning { padding: .1em .5em .15em; }

  .issue {
    border-color: #e05252;
    background: #fbe9e9;
  }
  .issue.closed span.issue-number {
    text-decoration: line-through;
  }

  .note, .ednote {
    border-color: #52e052;
    background: #e9fbe9;
  }

  .warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
  }

  .warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
  }

  li.task-list-item {
    list-style: none;
  }

  input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
  }

  .issue a.respec-gh-label {
  padding: 5px;
  margin: 0 2px 0 2px;
  font-size: 10px;
  text-transform: none;
  text-decoration: none;
  font-weight: bold;
  border-radius: 4px;
  position: relative;
  bottom: 2px;
  }

  .issue a.respec-label-dark {
  color: #fff;
  background-color: #000;
  }

  .issue a.respec-label-light {
  color: #000;
  background-color: #fff;
  }
  </style>
  <style>
  /* --- WEB IDL --- */

  pre.idl {
  padding: 1em;
  }

  @media print {
  pre.idl {
    white-space: pre-wrap;
  }
  }

  pre.idl::before {
  content: "WebIDL";
  display: block;
  width: 150px;
  background: #90b8de;
  color: #fff;
  font-family: sans-serif;
  font-weight: bold;
  margin: -1em 0 1em -1em;
  height: 28px;
  line-height: 28px;  
  }

  .idlType {
  color: #ff4500;
  font-weight: bold;
  text-decoration: none;
  }


  /*.idlModule*/


  /*.idlModuleID*/


  /*.idlInterface*/

  .idlInterfaceID,
  .idlDictionaryID,
  .idlCallbackID,
  .idlEnumID {
  font-weight: bold;
  color: #005a9c;
  }

  a.idlEnumItem {
  color: #000;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  .idlSuperclass {
  font-style: italic;
  color: #005a9c;
  }


  /*.idlAttribute*/

  .idlAttrType,
  .idlFieldType,
  .idlMemberType {
  color: #005a9c;
  }

  .idlAttrName,
  .idlFieldName,
  .idlMemberName {
  color: #ff4500;
  }

  .idlAttrName a,
  .idlFieldName a,
  .idlMemberName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlMethod*/

  .idlMethType,
  .idlCallbackType {
  color: #005a9c;
  }

  .idlMethName {
  color: #ff4500;
  }

  .idlMethName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlCtor*/

  .idlCtorName {
  color: #ff4500;
  }

  .idlCtorName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlParam*/

  .idlParamType {
  color: #005a9c;
  }

  .idlParamName,
  .idlDefaultValue {
  font-style: italic;
  }

  .extAttr {
  color: #666;
  }


  /*.idlSectionComment*/

  .idlSectionComment {
  color: gray;
  }


  /*.idlIterable*/

  .idlIterableKeyType,
  .idlIterableValueType {
  color: #005a9c;
  }


  /*.idlMaplike*/

  .idlMaplikeKeyType,
  .idlMaplikeValueType {
  color: #005a9c;
  }


  /*.idlConst*/

  .idlConstType {
  color: #005a9c;
  }

  .idlConstName {
  color: #ff4500;
  }

  .idlConstName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlException*/

  .idlExceptionID {
  font-weight: bold;
  color: #c00;
  }

  .idlTypedefID,
  .idlTypedefType {
  color: #005a9c;
  }

  .idlRaises,
  .idlRaises a.idlType,
  .idlRaises a.idlType code,
  .excName a,
  .excName a code {
  color: #c00;
  font-weight: normal;
  }

  .excName a {
  font-family: monospace;
  }

  .idlRaises a.idlType,
  .excName a.idlType {
  border-bottom: 1px dotted #c00;
  }

  .excGetSetTrue,
  .excGetSetFalse,
  .prmNullTrue,
  .prmNullFalse,
  .prmOptTrue,
  .prmOptFalse {
  width: 45px;
  text-align: center;
  }

  .excGetSetTrue,
  .prmNullTrue,
  .prmOptTrue {
  color: #0c0;
  }

  .excGetSetFalse,
  .prmNullFalse,
  .prmOptFalse {
  color: #c00;
  }

  .idlImplements a, .idlIncludes a {
  font-weight: bold;
  }

  dl.attributes,
  dl.methods,
  dl.constants,
  dl.constructors,
  dl.fields,
  dl.dictionary-members {
  margin-left: 2em;
  }

  .attributes dt,
  .methods dt,
  .constants dt,
  .constructors dt,
  .fields dt,
  .dictionary-members dt {
  font-weight: normal;
  }

  .attributes dt code,
  .methods dt code,
  .constants dt code,
  .constructors dt code,
  .fields dt code,
  .dictionary-members dt code {
  font-weight: bold;
  color: #000;
  font-family: monospace;
  }

  .attributes dt code,
  .fields dt code,
  .dictionary-members dt code {
  background: #ffffd2;
  }

  .attributes dt .idlAttrType code,
  .fields dt .idlFieldType code,
  .dictionary-members dt .idlMemberType code {
  color: #005a9c;
  background: transparent;
  font-family: inherit;
  font-weight: normal;
  font-style: italic;
  }

  .methods dt code {
  background: #d9e6f8;
  }

  .constants dt code {
  background: #ddffd2;
  }

  .constructors dt code {
  background: #cfc;
  }

  .attributes dd,
  .methods dd,
  .constants dd,
  .constructors dd,
  .fields dd,
  .dictionary-members dd {
  margin-bottom: 1em;
  }

  table.parameters,
  table.exceptions {
  border-spacing: 0;
  border-collapse: collapse;
  margin: 0.5em 0;
  width: 100%;
  }

  table.parameters {
  border-bottom: 1px solid #90b8de;
  }

  table.exceptions {
  border-bottom: 1px solid #deb890;
  }

  .parameters th,
  .exceptions th {
  color: inherit;
  padding: 3px 5px;
  text-align: left;
  font-weight: normal;
  }

  .parameters th {
  color: #fff;
  background: #005a9c;
  }

  .exceptions th {
  background: #deb890;
  }

  .parameters td,
  .exceptions td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  vertical-align: top;
  }

  .parameters tr:first-child td,
  .exceptions tr:first-child td {
  border-top: none;
  }

  .parameters td.prmName,
  .exceptions td.excName,
  .exceptions td.excCodeName {
  width: 100px;
  }

  .parameters td.prmType {
  width: 120px;
  }

  table.exceptions table {
  border-spacing: 0;
  border-collapse: collapse;
  width: 100%;
  }

  .respec-button-copy-paste:focus {
  text-decoration: none;
  border-color: #51a7e8;
  outline: none;
  box-shadow: 0 0 5px rgba(81, 167, 232, 0.5);
  }

  .respec-button-copy-paste:focus:hover,
  .respec-button-copy-paste.selected:focus {
  border-color: #51a7e8;
  }

  .respec-button-copy-paste:hover,
  .respec-button-copy-paste:active,
  .respec-button-copy-paste.zeroclipboard-is-hover,
  .respec-button-copy-paste.zeroclipboard-is-active {
  text-decoration: none;
  background-color: #ddd;
  background-image: linear-gradient(#eee, #ddd);
  border-color: #ccc;
  }

  .respec-button-copy-paste:active,
  .respec-button-copy-paste.selected,
  .respec-button-copy-paste.zeroclipboard-is-active {
  background-color: #dcdcdc;
  background-image: none;
  border-color: #b5b5b5;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15)
  }

  .respec-button-copy-paste.selected:hover {
  background-color: #cfcfcf;
  }

  .respec-button-copy-paste:disabled,
  .respec-button-copy-paste:disabled:hover,
  .respec-button-copy-paste.disabled,
  .respec-button-copy-paste.disabled:hover {
  color: rgba(102, 102, 102, 0.5);
  cursor: default;
  background-color: rgba(229, 229, 229, 0.5);
  background-image: none;
  border-color: rgba(197, 197, 197, 0.5);
  box-shadow: none;
  }
  </style>
  <title>Web of Things (WoT) Scripting API</title>
  <style id="respec-mainstyle">
  /*****************************************************************
  * ReSpec 3 CSS
  * Robin Berjon - http://berjon.com/
  *****************************************************************/

  /* Override code highlighter background */
  .hljs {
  background: transparent !important;
  }

  /* --- INLINES --- */
  h1 abbr,
  h2 abbr,
  h3 abbr,
  h4 abbr,
  h5 abbr,
  h6 abbr,
  a abbr {
  border: none;
  }

  dfn {
  font-weight: bold;
  }

  a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
  }

  a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  a.bibref {
  text-decoration: none;
  }

  #references :target {
  background: #eaf3ff;
  }

  cite .bibref {
  font-style: normal;
  }

  code {
  color: #c83500;
  }

  th code {
  color: inherit;
  }

  /* --- TOC --- */

  .toc a,
  .tof a {
  text-decoration: none;
  }

  a .secno,
  a .figno {
  color: #000;
  }

  ul.tof,
  ol.tof {
  list-style: none outside none;
  }

  .caption {
  margin-top: 0.5em;
  font-style: italic;
  }

  /* --- TABLE --- */

  table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
  }

  .simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
  }

  .simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
  }

  .simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  }

  .simple tr:nth-child(even) {
  background: #f0f6ff;
  }

  /* --- DL --- */

  .section dd>p:first-child {
  margin-top: 0;
  }

  .section dd>p:last-child {
  margin-bottom: 0;
  }

  .section dd {
  margin-bottom: 1em;
  }

  .section dl.attrs dd,
  .section dl.eldef dd {
  margin-bottom: 0;
  }

  #issue-summary>ul,
  .respec-dfn-list {
  column-count: 2;
  }

  #issue-summary li,
  .respec-dfn-list li {
  list-style: none;
  }

  details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
  }

  details.respec-tests-details>* {
  padding-right: 2em;
  }

  details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: 0.3em;
  background-color: white;
  padding-bottom: 0.5em;
  }

  details.respec-tests-details[open]>summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
  }

  details.respec-tests-details>ul {
  width: 100%;
  margin-top: -0.3em;
  }

  details.respec-tests-details>li {
  padding-left: 1em;
  }

  a[href].self-link:hover {
  opacity: 1;
  text-decoration: none;
  background-color: transparent;
  }

  h2,
  h3,
  h4,
  h5,
  h6 {
  position: relative;
  }

  aside.example .marker > a.self-link {
  color: inherit;
  }

  h2>a.self-link,
  h3>a.self-link,
  h4>a.self-link,
  h5>a.self-link,
  h6>a.self-link {
  border: none;
  color: inherit;
  font-size: 83%;
  height: 2em;
  left: -1.6em;
  opacity: .5;
  position: absolute;
  text-align: center;
  text-decoration: none;
  top: 0;
  transition: opacity .2s;
  width: 2em;
  }

  h2>a.self-link::before,
  h3>a.self-link::before,
  h4>a.self-link::before,
  h5>a.self-link::before,
  h6>a.self-link::before {
  content: "§";
  display: block;
  }

  @media (max-width: 767px) {
  dd {
    margin-left: 0;
  }

  /* Don't position self-link in headings off-screen */
  h2>a.self-link,
  h3>a.self-link,
  h4>a.self-link,
  h5>a.self-link,
  h6>a.self-link {
    left: auto;
    top: auto;
  }
  }

  @media print {
  .removeOnSave {
    display: none;
  }
  }
  </style>
  <style>
  /*

  github.com style (c) Vasily Polovnyov <vast@whiteants.net>

  */

  .hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
  }

  .hljs-comment,
  .hljs-quote {
  color: #998;
  font-style: italic;
  }

  .hljs-keyword,
  .hljs-selector-tag,
  .hljs-subst {
  color: #333;
  font-weight: bold;
  }

  .hljs-number,
  .hljs-literal,
  .hljs-variable,
  .hljs-template-variable,
  .hljs-tag .hljs-attr {
  color: #008080;
  }

  .hljs-string,
  .hljs-doctag {
  color: #d14;
  }

  .hljs-title,
  .hljs-section,
  .hljs-selector-id {
  color: #900;
  font-weight: bold;
  }

  .hljs-subst {
  font-weight: normal;
  }

  .hljs-type,
  .hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
  }

  .hljs-tag,
  .hljs-name,
  .hljs-attribute {
  color: #000080;
  font-weight: normal;
  }

  .hljs-regexp,
  .hljs-link {
  color: #009926;
  }

  .hljs-symbol,
  .hljs-bullet {
  color: #990073;
  }

  .hljs-built_in,
  .hljs-builtin-name {
  color: #0086b3;
  }

  .hljs-meta {
  color: #999;
  font-weight: bold;
  }

  .hljs-deletion {
  background: #fdd;
  }

  .hljs-addition {
  background: #dfd;
  }

  .hljs-emphasis {
  font-style: italic;
  }

  .hljs-strong {
  font-weight: bold;
  }
  </style>
  <link rel="stylesheet" href=
  "https://www.w3.org/StyleSheets/TR/2016/W3C-WD">
  <link rel="canonical" href=
  "https://www.w3.org/TR/wot-scripting-api/">
  <script id="initialUserConfig" type="application/json">
  {
  "specStatus": "WD",
  "shortName": "wot-scripting-api",
  "copyrightStart": 2017,
  "noLegacyStyle": true,
  "publishDate": "2018-11-19",
  "previousPublishDate": "2018-04-05",
  "previousMaturity": "",
  "edDraftURI": "https://w3c.github.io/wot-scripting-api/",
  "crEnd": "",
  "inlineCSS": true,
  "noIDLIn": true,
  "format": "markdown",
  "editors": [
    {
      "name": "Zoltan Kis",
      "company": "Intel",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Kazuaki Nimura",
      "company": "Fujitsu Ltd.",
      "companyURL": "https://www.fujitsu.com/"
    },
    {
      "name": "Daniel Peintner",
      "company": "Siemens AG",
      "companyURL": "https://www.siemens.com/"
    },
    {
      "name": "Johannes Hund",
      "note": "Former Editor, when at Siemens AG"
    }
  ],
  "wg": "Web of Things Working Group",
  "wgURI": "https://www.w3.org/WoT/WG/",
  "wgPublicList": "public-wot-wg",
  "issueBase": "https://www.github.com/w3c/wot-scripting-api/issues/",
  "githubAPI": "https://api.github.com/repos/w3c/wot-scripting-api",
  "otherLinks": [
    {
      "key": "Contributors",
      "data": [
        {
          "value": "In the GitHub repository",
          "href": "https://github.com/w3c/wot-scripting-api/graphs/contributors"
        }
      ]
    },
    {
      "key": "Repository",
      "data": [
        {
          "value": "We are on GitHub",
          "href": "https://github.com/w3c/wot-scripting-api"
        },
        {
          "value": "File a bug",
          "href": "https://github.com/w3c/wot-scripting-api/issues"
        }
      ]
    }
  ],
  "localBiblio": {
    "WOT-ARCHITECTURE": {
      "href": "https://w3c.github.io/wot-architecture/",
      "title": "Web of Things Architecture",
      "publisher": "W3C",
      "date": "20 August 2017",
      "id": "wot-architecture"
    },
    "WOT-TD": {
      "href": "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/",
      "title": "WoT Thing Description ",
      "publisher": "W3C",
      "date": "21 October 2018",
      "id": "wot-td"
    },
    "WOT-PROTOCOL-BINDINGS": {
      "href": "https://w3c.github.io/wot-binding-templates/",
      "title": "Web of Things Protocol Binding Templates",
      "publisher": "W3C",
      "date": "20 August 2017"
    },
    "WOT-PRACTICES": {
      "href": "http://w3c.github.io/wot/current-practices/wot-practices.html",
      "title": "Web of Things Current Practices",
      "publisher": "W3C",
      "date": "6 February 2017"
    },
    "WOT-SECURITY-CONSIDERATIONS": {
      "href": "https://w3c.github.io/wot-security/",
      "title": "Web of Things Security and Privacy Considerations",
      "publisher": "W3C",
      "date": "28 August 2017",
      "id": "wot-security-considerations"
    },
    "WOT-SECURITY-BEST-PRACTICES": {
      "href": "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md",
      "title": "Web of Things Security and Privacy Best Practices (WIP)",
      "publisher": "W3C",
      "date": "WIP",
      "id": "wot-security-best-practices"
    },
    "WOT-SECURITY-TESTING": {
      "href": "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md",
      "title": "Web of Things Security Testing and Validation",
      "publisher": "W3C",
      "date": "WIP",
      "id": "wot-security-testing"
    },
    "TYPESCRIPT": {
      "href": "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md",
      "title": "TypeScript Language Specification",
      "publisher": "Microsoft",
      "date": "1 October 2012",
      "id": "typescript"
    },
    "WEBAPPSEC": {
      "href": "https://w3c.github.io/webappsec/specs/powerfulfeatures",
      "title": "Secure Contexts",
      "publisher": "W3C",
      "date": "17 July 2015",
      "id": "webappsec"
    }
  },
  "publishISODate": "2018-11-19T00:00:00.000Z",
  "generatedSubtitle": "Workign Draft 19 November 2018"
  }
  </script>
  <meta name="description" content=
  "The overall Web of Things (WoT) concepts are described in the WoT Architecture document. The Web of Things is made of entities (Things) that can describe their capabilities in a machine-interpretable format, the Thing Description (TD) and expose these capabilities through the WoT Interface, that is, network interactions modeled as Properties for reading and writing values, Actions to execute remote procedures with or without return values and Events for signaling notifications.">
</head>
<body class="h-entry toc-inline">
  <div class="head">
    <a href="https://www.w3.org/" class="logo"><img alt="W3C" src=
    "https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"
    height="48"></a>
    <h1 id="title" class="title p-name">Web of Things (WoT)
    Scripting API</h1>
    <h2><abbr title="World Wide Web Consortium">W3C</abbr> Working
    Draft <time class="dt-published" datetime="2018-11-19">19
    November 2018</time></h2>
    <dl>
      <dt>This version:</dt>
      <dd>
        <a class="u-url" href=
           "https://www.w3.org/TR/2018/WD-wot-scripting-api-20181119/">
          https://www.w3.org/TR/2018/WD-wot-scripting-api-20181119/</a>
      </dd>
      <dt>Latest published version:</dt>
      <dd>
        <a href=
        "https://www.w3.org/TR/wot-scripting-api/">https://www.w3.org/TR/wot-scripting-api/</a>
      </dd>
      <dt>Latest editor's draft:</dt>
      <dd>
        <a href=
        "https://w3c.github.io/wot-scripting-api/">https://w3c.github.io/wot-scripting-api/</a>
      </dd>
      <dt>Previous version:</dt>
      <dd>
        <a class="u-url" href=
           "https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/">
          https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/</a>
      </dd>
      <dt>Editors:</dt>
      <dd class="p-author h-card vcard">
        <span class="p-name fn">Zoltan Kis</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.intel.com/">Intel</a>)
      </dd>
      <dd class="p-author h-card vcard">
        <span class="p-name fn">Kazuaki Nimura</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.fujitsu.com/">Fujitsu Ltd.</a>)
      </dd>
      <dd class="p-author h-card vcard">
        <span class="p-name fn">Daniel Peintner</span> (<a class=
        "p-org org h-org h-card" href=
        "https://www.siemens.com/">Siemens AG</a>)
      </dd>
      <dd class="p-author h-card vcard"><span class=
      "p-name fn">Johannes Hund</span> (Former Editor, when at
      Siemens AG)</dd>
      <dt>Contributors:</dt>
      <dd>
        <a href=
        "https://github.com/w3c/wot-scripting-api/graphs/contributors">
        In the GitHub repository</a>
      </dd>
      <dt>Repository:</dt>
      <dd>
        <a href="https://github.com/w3c/wot-scripting-api">We are
        on GitHub</a>
      </dd>
      <dd>
        <a href=
        "https://github.com/w3c/wot-scripting-api/issues">File a
        bug</a>
      </dd>
    </dl>
    <p class="copyright"><a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    © 2017-2018 <a href="https://www.w3.org/"><abbr title=
    "World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
    (<a href="https://www.csail.mit.edu/"><abbr title=
    "Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title=
    "European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
    <a href="https://www.keio.ac.jp/">Keio</a>, <a href=
    "http://ev.buaa.edu.cn/">Beihang</a>). <abbr title=
    "World Wide Web Consortium">W3C</abbr> <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
    liability</a>, <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
    trademark</a> and <a rel="license" href=
    "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">
    permissive document license</a> rules apply.</p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory">
    <h2>Abstract</h2>
    <p>The overall <a href="#dfn-web-of-things" class="internalDFN"
    data-link-type="dfn">Web of Things</a> (WoT) concepts are
    described in the <a href=
    "https://w3c.github.io/wot-architecture/">WoT Architecture</a>
    document. The Web of Things is made of entities (<a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a>s) that can describe their capabilities in a
    machine-interpretable format, the <a href=
    "#dfn-thing-descriptions" class="internalDFN" data-link-type=
    "dfn">Thing Description</a> (TD) and expose these capabilities
    through the <a href="#dfn-wot-interface" class="internalDFN"
    data-link-type="dfn">WoT Interface</a>, that is, network
    interactions modeled as <a href="#dfn-properties" class=
    "internalDFN" data-link-type="dfn">Properties</a> for reading
    and writing values, <a href="#dfn-actions" class="internalDFN"
    data-link-type="dfn">Action</a>s to execute remote procedures
    with or without return values and <a href="#dfn-events" class=
    "internalDFN" data-link-type="dfn">Event</a>s for signaling
    notifications.</p>
    <p>This specification describes a programming interface
    representing the <a href="#dfn-wot-interface" class=
    "internalDFN" data-link-type="dfn">WoT Interface</a> that
    allows scripts run on a <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn">Thing</a> to discover and
    consume (retrieve) other <a href="#dfn-thing-descriptions"
    class="internalDFN" data-link-type="dfn">Thing Description</a>s
    and to expose <a href="#dfn-things" class="internalDFN"
    data-link-type="dfn">Things</a> characterized by <a href=
    "#dfn-wot-interactions" class="internalDFN" data-link-type=
    "dfn">WoT Interactions</a> specified by a script.</p>
    <p>Scripting is an optional "convenience" building block in WoT
    and it is typically used in gateways that are able to run a
    <a href="#dfn-wot-runtime" class="internalDFN" data-link-type=
    "dfn">WoT Runtime</a> and <a href=
    "https://github.com/w3c/wot-scripting-api/tree/master/applications/script-manager">
    script management</a>, providing a convenient way to extend WoT
    support to new types of endpoints and implement WoT
    applications like <a href=
    "https://github.com/w3c/wot-scripting-api/tree/master/applications/thing-directory">
    Thing Directory</a>.</p>
  </section>
  <section id="sotd" class="introductory">
    <h2>Status of This Document</h2>
    <p><em>This section describes the status of this document at
    the time of its publication. Other documents may supersede this
    document. A list of current <abbr title=
    "World Wide Web Consortium">W3C</abbr> publications and the
    latest revision of this technical report can be found in the
    <a href="https://www.w3.org/TR/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> technical reports
    index</a> at https://www.w3.org/TR/.</em></p>
    <p>Implementers need to be aware that this specification is
    considered unstable. Vendors interested in implementing this
    specification before it eventually reaches the Candidate
    Recommendation phase should subscribe to the <a href=
    "https://github.com/w3c/wot-scripting-api">repository</a> and
    take part in the discussions.</p>
    <div class="ednote" id="issue-container-generatedID">
      <div role="heading" class="ednote-title marker" id="h-ednote"
      aria-level="3">
        <span>Editor's note</span><span style=
        "text-transform: none">: The W3C WoT WG is asking for
        feedback</span>
      </div>
      <p class="">Please contribute to this draft using the
      <a href="https://github.com/w3c/wot-scripting-api/issues">GitHub
      Issue</a> feature of the <a href=
      "https://github.com/w3c/wot-scripting-api/">WoT Scripting
      API</a> repository. For feedback on security and privacy
      considerations, please use the <a href=
      "https://github.com/w3c/wot-security/issues">WoT Security and
      Privacy</a> Issues.</p>
    </div>
    <p>This document was published by the <a href=
    "https://www.w3.org/WoT/WG/">Web of Things Working Group</a> as
    a Working Draft. This document is intended to become a W3C
    Recommendation.</p>
    <p>Comments regarding this document are welcome. Please send
    them to <a href=
    "mailto:public-wot-wg@w3.org">public-wot-wg@w3.org</a>
    (<a href="https://lists.w3.org/Archives/Public/public-wot-wg/">archives</a>).</p>
    <p>Changes from the previous publication can be found in
    <a href="#changes">Appendix B</a>. A <a href=
    "diff.html">diff-marked version</a> of this document is also
    available for comparison purposes.</p>
    <p>Publication as a Working Draft does not imply endorsement by
    the <abbr title="World Wide Web Consortium">W3C</abbr>
    Membership. This is a draft document and may be updated,
    replaced or obsoleted by other documents at any time. It is
    inappropriate to cite this document as other than work in
    progress.</p>
    <p>This document was produced by a group operating under the
    <a href=
    "https://www.w3.org/Consortium/Patent-Policy/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
    <a rel="disclosure" href=
    "https://www.w3.org/2004/01/pp-impl/95969/status">public list
    of any patent disclosures</a> made in connection with the
    deliverables of the group; that page also includes instructions
    for disclosing a patent. An individual who has actual knowledge
    of a patent which the individual believes contains <a href=
    "https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with
    <a href=
    "https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section
    6 of the <abbr title="World Wide Web Consortium">W3C</abbr>
    Patent Policy</a>.</p>
    <p>This document is governed by the <a id=
    "w3c_process_revision" href=
    "https://www.w3.org/2018/Process-20180201/">1 February 2018
    <abbr title="World Wide Web Consortium">W3C</abbr> Process
    Document</a>.</p>
  </section>
  <nav id="toc">
    <h2 class="introductory" id="table-of-contents">Table of
    Contents</h2>
    <ol class="toc">
      <li class="tocline">
        <a href="#introduction" class="tocxref"><span class=
        "secno">1.</span> Introduction</a>
      </li>
      <li class="tocline">
        <a href="#use-cases" class="tocxref"><span class=
        "secno">2.</span> Use Cases</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#discovery" class="tocxref"><span class=
            "secno">2.1</span> Discovery</a>
          </li>
          <li class="tocline">
            <a href="#consuming-a-thing" class=
            "tocxref"><span class="secno">2.2</span> Consuming a
            Thing</a>
          </li>
          <li class="tocline">
            <a href="#exposing-a-thing" class=
            "tocxref"><span class="secno">2.3</span> Exposing a
            Thing</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#the-wot-object" class="tocxref"><span class=
        "secno">3.</span> The <span data-dfn-for="" data-dfn-type=
        "dfn" data-idl="interface" data-title=
        "WoT"><code>WoT</code></span> object</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#the-discover-method" class=
            "tocxref"><span class="secno">3.1</span> The
            <span data-dfn-for="wot" data-dfn-type="dfn" data-idl=
            "operation" data-title="discover()" data-type=
            "Observable" data-lt=
            "wot.discover()|wot.discover|discover()|discover"><code>
            discover()</code></span> method</a>
            <ol class="toc">
              <li class="tocline">
                <a href="#the-discoverymethod-enumeration" class=
                "tocxref"><span class="secno">3.1.1</span> The
                <span data-dfn-for="" data-dfn-type="dfn" data-idl=
                "typedef" data-title=
                "DiscoveryMethod"><code>DiscoveryMethod</code></span>
                enumeration</a>
              </li>
              <li class="tocline">
                <a href="#the-thingfilter-dictionary" class=
                "tocxref"><span class="secno">3.1.2</span> The
                <span data-dfn-for="" data-dfn-type="dfn" data-idl=
                "dictionary" data-title=
                "ThingFilter"><code>ThingFilter</code></span>
                dictionary</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a href="#the-fetch-method" class=
            "tocxref"><span class="secno">3.2</span> The
            <span data-dfn-for="wot" data-dfn-type="dfn" data-idl=
            "operation" data-title="fetch()" data-type="Promise"
            data-lt=
            "wot.fetch()|wot.fetch|fetch()|fetch"><code>fetch()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a href="#the-consume-method" class=
            "tocxref"><span class="secno">3.3</span> The
            <span data-dfn-for="wot" data-dfn-type="dfn" data-idl=
            "operation" data-title="consume()" data-type=
            "ConsumedThing" data-lt=
            "wot.consume()|wot.consume|consume()|consume"><code>consume()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a href="#the-produce-method" class=
            "tocxref"><span class="secno">3.4</span> The
            <span data-dfn-for="wot" data-dfn-type="dfn" data-idl=
            "operation" data-title="produce()" data-type=
            "ExposedThing" data-lt=
            "wot.produce()|wot.produce|produce()|produce"><code>produce()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a href="#the-register-method" class=
            "tocxref"><span class="secno">3.5</span> The
            <span data-dfn-for="wot" data-dfn-type="dfn" data-idl=
            "operation" data-title="register()" data-type="Promise"
            data-lt=
            "wot.register()|wot.register|register()|register"><code>
            register()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-unregister-method" class=
            "tocxref"><span class="secno">3.6</span> The
            <span data-dfn-for="wot" data-dfn-type="dfn" data-idl=
            "operation" data-title="unregister()" data-type=
            "Promise" data-lt=
            "wot.unregister()|wot.unregister|unregister()|unregister">
            <code>unregister()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#examples" class="tocxref"><span class=
            "secno">3.7</span> Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#the-consumedthing-interface" class=
        "tocxref"><span class="secno">4.</span> The
        <span data-dfn-for="" data-dfn-type="dfn" data-idl=
        "interface" data-title=
        "ConsumedThing"><code>ConsumedThing</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#examples-0" class="tocxref"><span class=
            "secno">4.1</span> Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#the-exposedthing-interface" class=
        "tocxref"><span class="secno">5.</span> The
        <span data-dfn-for="" data-dfn-type="dfn" data-idl=
        "interface" data-title=
        "ExposedThing"><code>ExposedThing</code></span>
        interface</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#the-expose-method" class=
            "tocxref"><span class="secno">5.1</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="expose()" data-type=
            "Promise" data-lt=
            "exposedthing.expose()|exposedthing.expose|expose()|expose">
            <code>expose()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-destroy-method" class=
            "tocxref"><span class="secno">5.2</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="destroy()" data-type=
            "Promise" data-lt=
            "exposedthing.destroy()|exposedthing.destroy|destroy()|destroy">
            <code>destroy()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-addproperty-method" class=
            "tocxref"><span class="secno">5.3</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="addProperty()"
            data-type="ExposedThing" data-lt=
            "exposedthing.addproperty()|exposedthing.addproperty|addproperty()|addproperty">
            <code>addProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-removeproperty-method" class=
            "tocxref"><span class="secno">5.4</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="removeProperty()"
            data-type="ExposedThing" data-lt=
            "exposedthing.removeproperty()|exposedthing.removeproperty|removeproperty()|removeproperty">
            <code>removeProperty()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-addaction-method" class=
            "tocxref"><span class="secno">5.5</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="addAction()"
            data-type="ExposedThing" data-lt=
            "exposedthing.addaction()|exposedthing.addaction|addaction()|addaction">
            <code>addAction()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-removeaction-method" class=
            "tocxref"><span class="secno">5.6</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="removeAction()"
            data-type="ExposedThing" data-lt=
            "exposedthing.removeaction()|exposedthing.removeaction|removeaction()|removeaction">
            <code>removeAction()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-addevent-method" class=
            "tocxref"><span class="secno">5.7</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="addEvent()" data-type=
            "ExposedThing" data-lt=
            "exposedthing.addevent()|exposedthing.addevent|addevent()|addevent">
            <code>addEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-removeevent-method" class=
            "tocxref"><span class="secno">5.8</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="removeEvent()"
            data-type="ExposedThing" data-lt=
            "exposedthing.removeevent()|exposedthing.removeevent|removeevent()|removeevent">
            <code>removeEvent()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-propertyreadhandler-callback" class=
            "tocxref"><span class="secno">5.9</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "callback" data-title=
            "PropertyReadHandler"><code>PropertyReadHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a href="#the-propertywritehandler-callback" class=
            "tocxref"><span class="secno">5.10</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "callback" data-title=
            "PropertyWriteHandler"><code>PropertyWriteHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a href="#the-actionhandler-callback" class=
            "tocxref"><span class="secno">5.11</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "callback" data-title=
            "ActionHandler"><code>ActionHandler</code></span>
            callback</a>
          </li>
          <li class="tocline">
            <a href="#the-setpropertyreadhandler-method" class=
            "tocxref"><span class="secno">5.12</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title=
            "setPropertyReadHandler()" data-type="ExposedThing"
            data-lt=
            "exposedthing.setpropertyreadhandler()|exposedthing.setpropertyreadhandler|setpropertyreadhandler()|setpropertyreadhandler">
            <code>setPropertyReadHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#the-setpropertywritehandler-method" class=
            "tocxref"><span class="secno">5.13</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title=
            "setPropertyWriteHandler()" data-type="ExposedThing"
            data-lt=
            "exposedthing.setpropertywritehandler()|exposedthing.setpropertywritehandler|setpropertywritehandler()|setpropertywritehandler">
            <code>setPropertyWriteHandler()</code></span>
            method</a>
          </li>
          <li class="tocline">
            <a href="#the-setactionhandler-method" class=
            "tocxref"><span class="secno">5.14</span> The
            <span data-dfn-for="exposedthing" data-dfn-type="dfn"
            data-idl="operation" data-title="setActionHandler()"
            data-type="ExposedThing" data-lt=
            "exposedthing.setactionhandler()|exposedthing.setactionhandler|setactionhandler()|setactionhandler">
            <code>setActionHandler()</code></span> method</a>
          </li>
          <li class="tocline">
            <a href="#examples-1" class="tocxref"><span class=
            "secno">5.15</span> Examples</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#data-types-and-structures" class=
        "tocxref"><span class="secno">6.</span> Data types and
        structures</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#the-dataschema-dictionary-and-its-subclasses"
            class="tocxref"><span class="secno">6.1</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "DataSchema"><code>DataSchema</code></span> dictionary
            and its subclasses</a>
          </li>
          <li class="tocline">
            <a href=
            "#the-securityscheme-dictionary-and-its-subclasses"
            class="tocxref"><span class="secno">6.2</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "SecurityScheme"><code>SecurityScheme</code></span>
            dictionary and its subclasses</a>
          </li>
          <li class="tocline">
            <a href="#the-link-dictionary" class=
            "tocxref"><span class="secno">6.3</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title="Link"><code>Link</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-form-dictionary" class=
            "tocxref"><span class="secno">6.4</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title="Form"><code>Form</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-interactionfragment-dictionary" class=
            "tocxref"><span class="secno">6.5</span> The
            <code><span data-dfn-type=
            "dfn">InteractionFragment</span></code> dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-propertyfragment-dictionary" class=
            "tocxref"><span class="secno">6.6</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "PropertyFragment"><code>PropertyFragment</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-actionfragment-dictionary" class=
            "tocxref"><span class="secno">6.7</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "ActionFragment"><code>ActionFragment</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-eventfragment-dictionary" class=
            "tocxref"><span class="secno">6.8</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "EventFragment"><code>EventFragment</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-thingfragment-dictionary" class=
            "tocxref"><span class="secno">6.9</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "ThingFragment"><code>ThingFragment</code></span>
            dictionary</a>
          </li>
          <li class="tocline">
            <a href="#the-thingdescription-type" class=
            "tocxref"><span class="secno">6.10</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "typedef" data-title=
            "ThingDescription"><code>ThingDescription</code></span>
            type</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#interfaces-for-wot-interactions" class=
        "tocxref"><span class="secno">7.</span> Interfaces for
        <span class="formerLink" data-link-type="dfn">WoT
        Interactions</span></a>
        <ol class="toc">
          <li class="tocline">
            <a href="#the-interaction-interface" class=
            "tocxref"><span class="secno">7.1</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "Interaction"><code>Interaction</code></span>
            interface</a>
          </li>
          <li class="tocline">
            <a href="#the-thingproperty-interface" class=
            "tocxref"><span class="secno">7.2</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "ThingProperty"><code>ThingProperty</code></span>
            interface</a>
          </li>
          <li class="tocline">
            <a href="#the-thingaction-interface" class=
            "tocxref"><span class="secno">7.3</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "ThingAction"><code>ThingAction</code></span>
            interface</a>
          </li>
          <li class="tocline">
            <a href="#the-thingevent-interface" class=
            "tocxref"><span class="secno">7.4</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "ThingEvent"><code>ThingEvent</code></span>
            interface</a>
          </li>
          <li class="tocline">
            <a href="#the-exposedevent-interface" class=
            "tocxref"><span class="secno">7.5</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "ExposedEvent"><code>ExposedEvent</code></span>
            interface</a>
            <ol class="toc">
              <li class="tocline">
                <a href="#the-emit-method" class=
                "tocxref"><span class="secno">7.5.1</span> The
                <span data-dfn-for="exposedevent" data-dfn-type=
                "dfn" data-idl="operation" data-title="emit()"
                data-type="void" data-lt=
                "exposedevent.emit()|exposedevent.emit|emit()|emit">
                <code>emit()</code></span> method</a>
              </li>
            </ol>
          </li>
          <li class="tocline">
            <a href="#the-value-matching-algorithm" class=
            "tocxref"><span class="secno">7.6</span> The
            <span data-dfn-type="dfn">value-matching
            algorithm</span></a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#observables" class="tocxref"><span class=
        "secno">8.</span> Observables</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#the-subscription-interface" class=
            "tocxref"><span class="secno">8.1</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "Subscription"><code>Subscription</code></span>
            interface</a>
          </li>
          <li class="tocline">
            <a href="#the-observable-interface" class=
            "tocxref"><span class="secno">8.2</span> The
            <span data-dfn-for="" data-dfn-type="dfn" data-idl=
            "interface" data-title=
            "Observable"><code>Observable</code></span>
            interface</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a href="#security" class="tocxref"><span class=
        "secno">9.</span> Security and Privacy</a>
      </li>
      <li class="tocline">
        <a href="#terminology-and-conventions" class=
        "tocxref"><span class="secno">10.</span> Terminology and
        conventions</a>
      </li>
      <li class="tocline">
        <a href="#conformance" class="tocxref"><span class=
        "secno">11.</span> Conformance</a>
      </li>
      <li class="tocline">
        <a href="#Changes" class="tocxref"><span class=
        "secno">A.</span> Changes</a>
      </li>
      <li class="tocline">
        <a href="#openissues" class="tocxref"><span class=
        "secno">B.</span> Open issues</a>
      </li>
      <li class="tocline">
        <a href="#acknowledgements" class="tocxref"><span class=
        "secno">C.</span> Acknowledgments</a>
      </li>
      <li class="tocline">
        <a href="#references" class="tocxref"><span class=
        "secno">D.</span> References</a>
        <ol class="toc">
          <li class="tocline">
            <a href="#normative-references" class=
            "tocxref"><span class="secno">D.1</span> Normative
            references</a>
          </li>
          <li class="tocline">
            <a href="#informative-references" class=
            "tocxref"><span class="secno">D.2</span> Informative
            references</a>
          </li>
        </ol>
      </li>
    </ol>
  </nav>
  <section id="introduction">
    <!--OddPage-->
    <h2 id="x1-introduction"><span class="secno">1.</span>
    Introduction<a class="self-link" aria-label="§" href=
    "#introduction"></a></h2>
    <p>WoT provides layered interoperability based on how <a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a>s are modeled: as being "consumed" and
    "exposed".</p>
    <p>By <a href="#dfn-consume" class="internalDFN"
    data-link-type="dfn">consuming a TD</a>, a client <a href=
    "#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a> creates a runtime resource model that allows
    accessing the <a href="#dfn-properties" class="internalDFN"
    data-link-type="dfn">Properties</a>, <a href="#dfn-actions"
    class="internalDFN" data-link-type="dfn">Actions</a> and
    <a href="#dfn-events" class="internalDFN" data-link-type=
    "dfn">Events</a> exposed by the server <a href="#dfn-things"
    class="internalDFN" data-link-type="dfn">Thing</a> exposed on a
    remote device.</p>
    <p>Exposing a <a href="#dfn-things" class="internalDFN"
    data-link-type="dfn">Thing</a> requires defining a <a href=
    "#dfn-thing-descriptions" class="internalDFN" data-link-type=
    "dfn">Thing Description</a> (TD) and instantiating a software
    stack to serve requests for accessing the exposed <a href=
    "#dfn-properties" class="internalDFN" data-link-type=
    "dfn">Properties</a>, <a href="#dfn-actions" class=
    "internalDFN" data-link-type="dfn">Actions</a> and <a href=
    "#dfn-events" class="internalDFN" data-link-type=
    "dfn">Events</a>. This specification describes how to expose
    and consume <a href="#dfn-things" class="internalDFN"
    data-link-type="dfn">Thing</a>s by a script.</p>
    <div class="note" id="issue-container-generatedID-0">
      <div role="heading" class="note-title marker" id="h-note"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">Typically scripts are meant to be used on devices
      able to provide resources (with a <a href=
      "#dfn-wot-interface" class="internalDFN" data-link-type=
      "dfn">WoT Interface</a>) for managing (installing, updating,
      running) scripts, such as bridges or gateways that expose and
      control simpler devices as WoT <a href="#dfn-things" class=
      "internalDFN" data-link-type="dfn">Thing</a>s.</p>
    </div>
    <div class="note" id="issue-container-generatedID-1">
      <div role="heading" class="note-title marker" id="h-note-0"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">This specification does not make assumptions on
      how the <a href="#dfn-wot-runtime" class="internalDFN"
      data-link-type="dfn">WoT Runtime</a> handles and runs
      scripts, including single or multiple tenancy, script
      deployment and lifecycle management. The API already supports
      the generic mechanisms that make it possible to implement
      script management, for instance by exposing a manager
      <a href="#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> whose <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Actions</a> (action
      handlers) implement script lifecycle management
      operations.</p>
    </div>
    <p>For an introduction on how scripts could be used in <a href=
    "#dfn-web-of-things" class="internalDFN" data-link-type=
    "dfn">Web of Things</a>, check the <a href=
    "https://w3c.github.io/wot-scripting-api/primer">Primer</a>
    document. For some background on API design decisions check the
    <a href=
    "https://w3c.github.io/wot-scripting-api/rationale">Rationale</a>
    document.</p>
  </section>
  <section class="informative" id="use-cases">
    <!--OddPage-->
    <h2 id="x2-use-cases"><span class="secno">2.</span> Use
    Cases<a class="self-link" aria-label="§" href=
    "#use-cases"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The following scripting use cases are supported in this
    specification:</p>
    <section id="discovery">
      <h3 id="x2-1-discovery"><span class="secno">2.1</span>
      Discovery<a class="self-link" aria-label="§" href=
      "#discovery"></a></h3>
      <ul>
        <li>Discover all <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn">Thing</a>s in the WoT network by
          sending a broadcast request.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s running in the local
        <a href="#dfn-wot-runtime" class="internalDFN"
        data-link-type="dfn">WoT Runtime</a>.
        </li>
        <li>Discover nearby <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a>s, for instance
        connected by NFC or Bluetooth.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s by sending a discovery
        request to a given registry.
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s by filters defined on
        <a href="#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn">Thing Description</a>s
        </li>
        <li>Discover <a href="#dfn-things" class="internalDFN"
        data-link-type="dfn">Thing</a>s by semantic queries.
        </li>
        <li>Stop or suppress an ongoing discovery process.</li>
        <li>Optionally specify a timeout to the discovery process
        after which it is stopped/suppressed.</li>
      </ul>
    </section>
    <section id="consuming-a-thing">
      <h3 id="x2-2-consuming-a-thing"><span class=
      "secno">2.2</span> Consuming a Thing<a class="self-link"
      aria-label="§" href="#consuming-a-thing"></a></h3>
      <ul>
        <li>Fetch a <a href="#dfn-thing-descriptions" class=
        "internalDFN" data-link-type="dfn">Thing Description</a> of
        a <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn">Thing</a> given its URL.
        </li>
        <li>
          <a href="#dfn-consume" class="internalDFN"
          data-link-type="dfn">Consume a TD</a> of a <a href=
          "#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>, including parsing the <a href="#dfn-td"
          class="internalDFN" data-link-type="dfn">TD</a> and
          generating the protocol bindings in order to access lower
          level functionality.
        </li>
        <li>On a consumed <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn">Thing</a>,
          <ul>
            <li>Read the value of a <a href="#dfn-properties"
              class="internalDFN" data-link-type="dfn">Property</a>
              or set of properties.
            </li>
            <li>Set the value of a <a href="#dfn-properties"
              class="internalDFN" data-link-type="dfn">Property</a>
              or a set of properties.
            </li>
            <li>Observe value changes of a <a href=
            "#dfn-properties" class="internalDFN" data-link-type=
            "dfn">Property</a>.
            </li>
            <li>Invoke an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn">Action</a>.
            </li>
            <li>Observe <a href="#dfn-events" class="internalDFN"
            data-link-type="dfn">Events</a> emitted by the
              <a href="#dfn-things" class="internalDFN"
              data-link-type="dfn">Thing</a>.
            </li>
            <li>Observe changes to the <a href=
            "#dfn-thing-descriptions" class="internalDFN"
            data-link-type="dfn">Thing Description</a> of the
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn">Thing</a>.
            </li>
            <li>Get the <a href="#dfn-thing-descriptions" class=
            "internalDFN" data-link-type="dfn">Thing
            Description</a>.
            </li>
            <li>Get the list of linked resources based on the
            <a href="#dfn-thing-descriptions" class="internalDFN"
            data-link-type="dfn">Thing Description</a>.
            </li>
          </ul>
        </li>
      </ul>
    </section>
    <section id="exposing-a-thing">
      <h3 id="x2-3-exposing-a-thing"><span class="secno">2.3</span>
      Exposing a Thing<a class="self-link" aria-label="§" href=
      "#exposing-a-thing"></a></h3>
      <ul>
        <li>Exposing the <a href="#dfn-things" class="internalDFN"
          data-link-type="dfn">Thing</a> includes generating the
          protocol bindings in order to access lower level
          functionality.
        </li>
        <li>Create a local <a href="#dom-exposedthing" class=
        "internalDFN" data-link-type=
        "dfn"><code>ExposedThing</code></a> to be exposed, based on
        a <a href="#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn">Thing Description</a> provided in
        string serialized format, or out of a template or an
        existing <a href="#dom-consumedthing" class="internalDFN"
        data-link-type="dfn"><code>ConsumedThing</code></a> object.
        </li>
        <li>Add a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> definition to the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Add an <a href="#dfn-actions" class="internalDFN"
        data-link-type="dfn">Action</a> definition to the
          <a href="#dfn-things" class="internalDFN" data-link-type=
          "dfn">Thing</a>.
        </li>
        <li>Add an <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn">Event</a> definition to the <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>.
        </li>
        <li>Attach semantic information to the <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>.
        </li>
        <li>Attach semantic information to a <a href=
        "#dfn-properties" class="internalDFN" data-link-type="dfn">
          Property</a>.
        </li>
        <li>Attach semantic information to an <a href=
        "#dfn-actions" class="internalDFN" data-link-type=
        "dfn">Action</a>.
        </li>
        <li>Attach semantic information to an <a href="#dfn-events"
          class="internalDFN" data-link-type="dfn">Event</a>.
        </li>
        <li>Emit an <a href="#dfn-events" class="internalDFN"
        data-link-type="dfn">Event</a>, i.e. notify all listeners
        subscribed to that <a href="#dfn-events" class=
        "internalDFN" data-link-type="dfn">Event</a>.
        </li>
        <li>Provide notifications for <a href="#dfn-td" class=
        "internalDFN" data-link-type="dfn">TD</a> changes to
        clients subscribed to that.
        </li>
        <li>Mark/unmark the Thing to be discoverable.</li>
        <li>Mark/unmark the Thing to be consumable.</li>
        <li>Start the exposed <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> in order to
        process external requests.
        </li>
        <li>Stop the exposed <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a>.
        </li>
        <li>Register handlers for external requests:
          <ul>
            <li>to retrieve a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn">Property</a> value;
            </li>
            <li>to update a <a href="#dfn-properties" class=
            "internalDFN" data-link-type="dfn">Property</a> value;
            </li>
            <li>to run an <a href="#dfn-actions" class=
            "internalDFN" data-link-type="dfn">Action</a>: take the
            parameters from the request, execute the defined
            action, and return the result;
            </li>
          </ul>
        </li>
      </ul>
    </section>
  </section>
  <section data-dfn-for="WoT" id="the-wot-object">
    <!--OddPage-->
    <h2 id="x3-the-wot-object"><span class="secno">3.</span> The
    <dfn data-dfn-for="" data-dfn-type="dfn" id="dom-wot" data-idl=
    "interface" data-title="WoT"><code>WoT</code></dfn>
    object<a class="self-link" aria-label="§" href=
    "#the-wot-object"></a></h2>
    <p>The WoT object is the API entry point and it is exposed by
    an implementation of the <a href="#dfn-wot-runtime" class=
    "internalDFN" data-link-type="dfn">WoT Runtime</a>. The
    <dfn data-dfn-type="dfn" id="dfn-wot-object">WoT object</dfn>
    does not expose properties, only methods for discovering,
    consuming and exposing a <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn">Thing</a>.</p>
    <div class="note" id="issue-container-generatedID-2">
      <div role="heading" class="note-title marker" id="h-note-1"
      aria-level="3">
        <span>Note</span>
      </div>
      <p class="">Browser implementations <em class="rfc2119"
      title="SHOULD">SHOULD</em> use a namespace object such as
      <code>navigator.wot</code>. <a href=
      "https://nodejs.org/en/">Node.js</a>-like runtimes <em class=
      "rfc2119" title="MAY">MAY</em> provide the API object through
      the <a href=
      "https://nodejs.org/api/modules.html">require()</a> or
      <a href=
      "http://www.ecma-international.org/ecma-262/6.0/#sec-imports">
      import</a> mechanism.</p>
    </div>
    <div>
      <pre class="def idl"><span class="idlInterface" id=
      "idl-def-wot" data-idl="" data-title="WoT"><span class=
      "idlSectionComment">// [SecureContext]
// [NamespaceObject]
</span>interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-wot" class="internalDFN"
data-link-type="dfn"><code>WoT</code></a></span> {<span class=
"idlMethod" id="idl-def-wot-discover-filter" data-idl=""
data-title="discover" data-dfn-for="wot"><span class="idlMethType">
  <a data-link-for="" href="#dom-observable" class="internalDFN"
data-link-type=
"dfn"><code>Observable</code></a></span> <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt=
"wot.discover()|wot.discover|discover()|discover" href=
"#dom-wot-discover" class="internalDFN" data-link-type=
"dfn"><code>discover</code></a></span>(<span class=
"idlParam">optional<span class="idlParamType"> <a data-link-for=""
href="#dom-thingfilter" class="internalDFN" data-link-type=
"dfn"><code>ThingFilter</code></a></span> <span class=
"idlParamName">filter</span></span>);</span><span class="idlMethod"
id="idl-def-wot-fetch-url" data-idl="" data-title="fetch"
data-dfn-for="wot"><span class="idlMethType">
  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-link-for=""
href="#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a>&gt;</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"wot.fetch()|wot.fetch|fetch()|fetch" href="#dom-wot-fetch" class=
"internalDFN" data-link-type=
"dfn"><code>fetch</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span></span>);</span><span class="idlMethod"
id="idl-def-wot-consume-td" data-idl="" data-title="consume"
data-dfn-for="wot"><span class="idlMethType">
  <a data-link-for="" href="#dom-consumedthing" class="internalDFN"
data-link-type=
"dfn"><code>ConsumedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"wot.consume()|wot.consume|consume()|consume" href=
"#dom-wot-consume" class="internalDFN" data-link-type=
"dfn"><code>consume</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a data-link-for="" href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span></span>);</span><span class="idlMethod" id=
"idl-def-wot-produce-model" data-idl="" data-title="produce"
data-dfn-for="wot"><span class="idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"wot.produce()|wot.produce|produce()|produce" href=
"#produce-method" class="internalDFN" data-link-type=
"dfn"><code>produce</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a data-link-for="" href=
"#dom-thingmodel" class="internalDFN" data-link-type=
"dfn"><code>ThingModel</code></a></span> <span class=
"idlParamName">model</span></span>);</span><span class="idlMethod"
id="idl-def-wot-register-directory-thing" data-idl="" data-title=
"register" data-dfn-for="wot"><span class="idlMethType">
  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt=
"wot.register()|wot.register|register()|register" href=
"#dom-wot-register" class="internalDFN" data-link-type=
"dfn"><code>register</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">directory</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlParamName">thing</span></span>);</span><span class="idlMethod"
id="idl-def-wot-unregister-directory-thing" data-idl="" data-title=
"unregister" data-dfn-for="wot"><span class="idlMethType">
  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt=
"wot.unregister()|wot.unregister|unregister()|unregister" href=
"#dom-wot-unregister" class="internalDFN" data-link-type=
"dfn"><code>unregister</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">directory</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlParamName">thing</span></span>);</span>
};</span><span class="idlTypedef" id="idl-def-thingfragment"
data-idl="" data-title="ThingFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-thingfragment" class=
"internalDFN" data-link-type=
"dfn"><code>ThingFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-propertyfragment" data-idl="" data-title=
"PropertyFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertyfragment" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-actionfragment" data-idl="" data-title=
"ActionFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-actionfragment" class=
"internalDFN" data-link-type=
"dfn"><code>ActionFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-eventfragment" data-idl="" data-title=
"EventFragment">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-eventfragment" class=
"internalDFN" data-link-type=
"dfn"><code>EventFragment</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-dataschema" data-idl="" data-title=
"DataSchema">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-dataschema" class=
"internalDFN" data-link-type=
"dfn"><code>DataSchema</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-securityscheme" data-idl="" data-title=
"SecurityScheme">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-securityscheme" class=
"internalDFN" data-link-type=
"dfn"><code>SecurityScheme</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-link" data-idl="" data-title="Link">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-link" class="internalDFN"
data-link-type=
"dfn"><code>Link</code></a></span>;</span><span class="idlTypedef"
id="idl-def-form" data-idl="" data-title="Form">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-object">object</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-form" class="internalDFN"
data-link-type=
"dfn"><code>Form</code></a></span>;</span><span class="idlTypedef"
id="idl-def-thingdescription" data-idl="" data-title=
"ThingDescription">
typedef<span class="idlTypedefType"> <a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-thingdescription" class=
"internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a></span>;</span><span class=
"idlTypedef" id="idl-def-thingmodel" data-idl="" data-title=
"ThingModel">
typedef<span class="idlTypedefType"> (<a data-link-for="" href=
"#dom-thingfragment" class="internalDFN" data-link-type=
"dfn"><code>ThingFragment</code></a> or <a data-link-for="" href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a>)</span> <span class=
"idlTypedefID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingmodel" class="internalDFN" data-link-type=
"dfn"><code>ThingModel</code></a></span>;</span></pre>
    </div>
    <div class="ednote" id="issue-container-generatedID-3">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-0" aria-level="3">
        <span>Editor's note</span>
      </div>
      <p class="">The algorithms for the WoT methods will be
      specified later, including error handling and security
      considerations.</p>
    </div>
    <p>The <dfn data-dfn-for="" data-dfn-type="dfn" id=
    "dom-thingmodel" data-idl="typedef" data-title=
    "ThingModel"><code>ThingModel</code></dfn> type represents
    either a <a href="#dom-thingfragment" class="internalDFN"
    data-link-type="dfn"><code>ThingFragment</code></a>, or a
    <a href="#dom-thingdescription" class="internalDFN"
    data-link-type="dfn"><code>ThingDescription</code></a>.</p>
    <section id="the-discover-method">
      <h3 id="x3-1-the-discover-method"><span class=
      "secno">3.1</span> The <dfn data-dfn-for="wot" data-dfn-type=
      "dfn" id="dom-wot-discover" data-idl="operation" data-title=
      "discover()" data-type="Observable" data-lt=
      "wot.discover()|wot.discover|discover()|discover"><code>discover()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-discover-method"></a></h3>
      <p>Starts the discovery process that will provide <a href=
      "#dom-thingdescription" class="internalDFN" data-link-type=
      "dfn"><code>ThingDescription</code></a>s that match the
      optional argument <var>filter</var> of type <code><a href=
      "#dom-thingfilter" class="internalDFN" data-link-type=
      "dfn"><code>ThingFilter</code></a></code>. Returns an
      [<code>Observable</code>](https://github.com/tc39/proposal-observable)
      object that can be subscribed to and unsubscribed from. The
      handler function provided to the Observable during
      subscription will receive an argument of type
      <code>USVString</code> representing a <a href=
      "#dom-thingdescription" class="internalDFN" data-link-type=
      "dfn"><code>ThingDescription</code></a>.</p>
      <section data-dfn-for="DiscoveryMethod" id=
      "the-discoverymethod-enumeration">
        <h4 id="x3-1-1-the-discoverymethod-enumeration">
        <span class="secno">3.1.1</span> The <dfn data-dfn-for=""
        data-dfn-type="dfn" id="dom-discoverymethod" data-idl=
        "typedef" data-title=
        "DiscoveryMethod"><code>DiscoveryMethod</code></dfn>
        enumeration<a class="self-link" aria-label="§" href=
        "#the-discoverymethod-enumeration"></a></h4>
        <div>
          <pre class="def idl"><span class="idlTypedef" id=
          "idl-def-discoverymethod" data-idl="" data-title=
          "DiscoveryMethod">typedef<span class=
          "idlTypedefType"> <a href=
          "https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"dfn"><code>DiscoveryMethod</code></a></span>;</span></pre>
        </div>
        <p><a href="#dom-discoverymethod" class="internalDFN"
        data-link-type="dfn"><code>DiscoveryMethod</code></a>
        represents the discovery type to be used:</p>
        <ul>
          <li><dfn data-dfn-type="dfn" id="dfn-any">"any"</dfn>
          does not provide any restriction</li>
          <li>
            <dfn data-dfn-type="dfn" id="dfn-local">"local"</dfn>
            for discovering <a href="#dfn-things" class=
            "internalDFN" data-link-type="dfn">Thing</a>s defined
            in the same device or connected to the device by wired
            or wireless means.
          </li>
          <li>
            <dfn data-dfn-type="dfn" id=
            "dfn-directory">"directory"</dfn> for discovery based
            on a service provided by a <a href=
            "#dfn-thing-directory" class="internalDFN"
            data-link-type="dfn">Thing Directory</a>.
          </li>
          <li>
            <dfn data-dfn-type="dfn" id=
            "dfn-multicast">"multicast"</dfn> for discovering
            <a href="#dfn-things" class="internalDFN"
            data-link-type="dfn">Thing</a>s in the device's network
            by using a supported multicast protocol.
          </li>
        </ul>
      </section>
      <section data-dfn-for="ThingFilter" id=
      "the-thingfilter-dictionary">
        <h4 id="x3-1-2-the-thingfilter-dictionary"><span class=
        "secno">3.1.2</span> The <dfn data-dfn-for=""
        data-dfn-type="dfn" id="dom-thingfilter" data-idl=
        "dictionary" data-title=
        "ThingFilter"><code>ThingFilter</code></dfn>
        dictionary<a class="self-link" aria-label="§" href=
        "#the-thingfilter-dictionary"></a></h4>
        <p>The <a href="#dom-thingfilter" class="internalDFN"
        data-link-type="dfn"><code>ThingFilter</code></a>
        dictionary that represents the constraints for discovering
        <a href="#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>s as key-value pairs.</p>
        <div>
          <pre class="def idl"><span class="idlDictionary" id=
          "idl-def-thingfilter" data-idl="" data-title=
          "ThingFilter">dictionary <span class=
          "idlDictionaryID"><a data-no-default="" data-link-for=""
          data-lt="" href="#dom-thingfilter" class="internalDFN"
          data-link-type=
          "dfn"><code>ThingFilter</code></a></span> {<span class=
          "idlMember" id="idl-def-thingfilter-method" data-idl=""
          data-title="method" data-dfn-for=
          "thingfilter"><span class="idlMemberType">
  (<a data-link-for="" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"dfn"><code>DiscoveryMethod</code></a> or <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>)</span> <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-method" class="internalDFN" data-link-type=
"dfn"><code>method</code></a></span> = <span class=
"idlMemberValue">"any"</span>;</span><span class="idlMember" id=
"idl-def-thingfilter-url" data-idl="" data-title="url"
data-dfn-for="thingfilter"><span class="idlMemberType">
  <a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href="#dom-thingfilter-url"
class="internalDFN" data-link-type=
"dfn"><code>url</code></a></span>;</span><span class="idlMember"
id="idl-def-thingfilter-query" data-idl="" data-title="query"
data-dfn-for="thingfilter"><span class="idlMemberType">
  <a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a>?</span> <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-query" class="internalDFN" data-link-type=
"dfn"><code>query</code></a></span>;</span><span class="idlMember"
id="idl-def-thingfilter-fragment" data-idl="" data-title="fragment"
data-dfn-for="thingfilter"><span class="idlMemberType">
  <a data-link-for="" href="#dom-thingfragment" class="internalDFN"
data-link-type=
"dfn"><code>ThingFragment</code></a>?</span> <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingfilter"
data-lt="" href="#dom-thingfilter-fragment" class="internalDFN"
data-link-type="dfn"><code>fragment</code></a></span>;</span>
};</span></pre>
        </div>
        <p>The <dfn data-dfn-for="thingfilter" data-dfn-type="dfn"
        id="dom-thingfilter-method" data-idl="field" data-title=
        "method" data-type=
        "DiscoveryMethod|DOMString"><code>method</code></dfn>
        property represents the discovery type that should be used
        in the discovery process. The possible values are defined
        by the <code><a href="#dom-discoverymethod" class=
        "internalDFN" data-link-type=
        "dfn"><code>DiscoveryMethod</code></a></code> enumeration
        that <em class="rfc2119" title="MAY">MAY</em> be extended
        by string values defined by solutions (with no guarantee of
        interoperability).</p>
        <p>The <dfn data-dfn-for="thingfilter" data-dfn-type="dfn"
        id="dom-thingfilter-url" data-idl="field" data-title="url"
        data-type="USVString"><code>url</code></dfn> property
        represents additional information for the discovery method,
        such as the URL of the target entity serving the discovery
        request, for instance a <a href="#dfn-thing-directory"
        class="internalDFN" data-link-type="dfn">Thing
        Directory</a> (if <code>method</code> is
        <code>"directory"</code>) or a Thing (otherwise).</p>
        <p>The <dfn data-dfn-for="thingfilter" data-dfn-type="dfn"
        id="dom-thingfilter-query" data-idl="field" data-title=
        "query" data-type="USVString"><code>query</code></dfn>
        property represents a query string accepted by the
        implementation, for instance a SPARQL or JSON query.
        Support may be implemented locally in the <a href=
        "#dfn-wot-runtime" class="internalDFN" data-link-type=
        "dfn">WoT Runtime</a> or remotely as a service in a
        <a href="#dfn-thing-directory" class="internalDFN"
        data-link-type="dfn">Thing Directory</a>.</p>
        <p>The <dfn data-dfn-for="thingfilter" data-dfn-type="dfn"
        id="dom-thingfilter-fragment" data-idl="field" data-title=
        "fragment" data-type=
        "ThingFragment"><code>fragment</code></dfn> property
        represents a <a href="#dom-thingfragment" class=
        "internalDFN" data-link-type=
        "dfn"><code>ThingFragment</code></a> dictionary used for
        matching property by property against discovered <a href=
        "#dfn-things" class="internalDFN" data-link-type=
        "dfn">Thing</a>s.</p>
      </section>
      <p>The <code>discover(filter)</code> method <em class=
      "rfc2119" title="MUST">MUST</em> run the following steps:</p>
      <ol>
        <li>If invoking <code>discover()</code> is not allowed for
        the current scripting context for security reasons, throw
        <code>SecurityError</code> and terminate these steps.</li>
        <li>Return an <code><a href="#dom-observable" class=
        "internalDFN" data-link-type=
        "dfn"><code>Observable</code></a></code> <var>obs</var> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If <code>obs.subscribe(handler, errorHandler,
        complete)</code> is called, execute the following
        sub-steps:
          <ol>
            <li>If the first argument <var>handler</var> is not
            defined or it is not a function, throw
            <code>TypeError</code> and terminate the algorithm.
            Otherwise configure <var>handler</var> to be invoked
            when a discovery hit happens.</li>
            <li>If the second argument <var>errorHandler</var> is
            defined, but it is not a function, throw
            <code>TypeError</code> and terminate these steps.
            Otherwise if defined, save it to be invoked in error
            conditions.</li>
            <li>If the third argument <var>onComplete</var> is
            defined, but it is not a function, throw
            <code>TypeError</code> and terminate these steps.
            Otherwise if defined, save it to be invoked when the
            discovery process finished for other reasons than
            having been canceled.</li>
            <li>If <var>filter.query</var> is defined, pass it as
            an opaque string to the underlying implementation to be
            matched against discovered items. The underlying
            implementation is responsible to parse it e.g. as a
            SPARQL or JSON query and match it against the
              <a href="#dfn-thing-descriptions" class="internalDFN"
              data-link-type="dfn">Thing Description</a>s found
              during the discovery process. If queries are not
              supported, implementations <em class="rfc2119" title=
              "SHOULD">SHOULD</em> throw a
              <code>NotSupported</code> error and terminate these
              steps.
            </li>
            <li>If <var>filter.fragment</var> is defined, and if it
            contains other properties than the ones defined in
            <a href="#dom-thingfragment" class="internalDFN"
            data-link-type="dfn"><code>ThingFragment</code></a>,
            throw <code>TypeError</code> and terminate these steps.
            Otherwise save the object for matching the discovered
            items against it.
            </li>
            <li>Request the underlying platform to start the
            discovery process, with the following parameters:
              <ul>
                <li>If <var>filter.method</var> is not defined or
                the value is <code>"any"</code>, use the widest
                discovery method supported by the underlying
                platform.</li>
                <li>Otherwise if <var>filter.method</var> is <code>
                  "local"</code>, use the local <a href=
                  "#dfn-thing-directory" class="internalDFN"
                  data-link-type="dfn">Thing Directory</a> for
                  discovery. Usually that defines <a href=
                  "#dfn-things" class="internalDFN" data-link-type=
                  "dfn">Thing</a>s deployed in the same device, or
                  connected to the device in slave mode (e.g.
                  sensors connected via Bluetooth or a serial
                  connection).
                </li>
                <li>Otherwise if <var>filter.method</var> is <code>
                  "directory"</code>, use the remote <a href=
                  "#dfn-thing-directory" class="internalDFN"
                  data-link-type="dfn">Thing Directory</a>
                  specified in <var>filter.url</var>.
                </li>
                <li>Otherwise if <var>filter.method</var> is
                <code>"multicast"</code>, use all the multicast
                discovery protocols supported by the underlying
                platform.</li>
              </ul>
            </li>
          </ol>
        </li>
        <li>Whenever a new item <var>td</var> is discovered by the
        underlying platform, run the following sub-steps:
          <ol>
            <li>If <var>filter.query</var> is defined, check if
            <var>td</var> is a match for the query. The matching
            algorithm is encapsulated by implementations. If that
            returns <code>false</code>, discard <var>td</var> and
            continue the discovery process.</li>
            <li>If <var>filter.fragment</var> is defined, for each
            property defined in it, check if that property exists
            in <var>td</var> and has the same value. If this is
            <code>false</code> in any checks, discard <var>td</var>
            and continue the discovery process.</li>
            <li>Otherwise if <var>td</var> has not been discarded
            in the previous steps, invoke the <var>handler</var>
            function with <var>td</var> as parameter.</li>
          </ol>
        </li>
        <li>Whenever an error occurs during the discovery process,
        and if <var>errorHandler</var> is defined, invoke it with
        an argument of type <code>Error</code> whose
        <code>message</code> property is set to
        <code>UnknownError</code> unless there was an error code
        provided by the <a href="#dfn-protocol-bindings" class=
        "internalDFN" data-link-type="dfn">Protocol Bindings</a>,
        in which case set it to that value.
        </li>
        <li>When the discovery process is finished, and if
        <var>onComplete</var> is defined, invoke it run the
          <a href="#dfn-cancel-discovery" class="internalDFN"
          data-link-type="dfn">cancel discovery</a> steps.
        </li>
        <li>When the <code>obs.unsubscribe()</code> method is
        called, run the following <dfn data-dfn-type="dfn" id=
        "dfn-cancel-discovery">cancel discovery</dfn> steps:
          <ol>
            <li>Request the underlying platform to stop the
            discovery process. If this returns an error, or if it
            is not possible, for instance when discovery is based
            on open ended multicast requests, the implementation
            <em class="rfc2119" title="SHOULD">SHOULD</em> discard
            subsequent discovered items.</li>
            <li>Set <var>obs.closed</var> to
            <code>false</code>.</li>
          </ol>
        </li>
      </ol>
    </section>
    <section id="the-fetch-method">
      <h3 id="x3-2-the-fetch-method"><span class="secno">3.2</span>
      The <dfn data-dfn-for="wot" data-dfn-type="dfn" id=
      "dom-wot-fetch" data-idl="operation" data-title="fetch()"
      data-type="Promise" data-lt=
      "wot.fetch()|wot.fetch|fetch()|fetch"><code>fetch()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-fetch-method"></a></h3>
      <p>Accepts an <code>url</code> argument of type
      <code>USVString</code> that represents a URL (e.g.
      <code>"file://..."</code> or <code>"https://..."</code>) and
      returns a <code><a href="#dfn-promise" class="internalDFN"
      data-link-type="dfn">Promise</a></code> that resolves with a
      <a href="#dom-thingdescription" class="internalDFN"
      data-link-type="dfn"><code>ThingDescription</code></a> (a
      serialized <a href="#dfn-json-ld" class="internalDFN"
      data-link-type="dfn">JSON-LD</a> document of type
      <code>USVString</code>).</p>
      <p>The <code>fetch(url)</code> method <em class="rfc2119"
      title="MUST">MUST</em> run the following steps:</p>
      <ol>
        <li>Return a <code>Promise</code> <var>promise</var> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If invoking <code>fetch()</code> is not allowed for the
        current scripting context for security reasons, reject
        <var>promise</var> with <code>SecurityError</code> and
        terminate these steps.</li>
        <li>If the argument <var>url</var> is not a URL, reject
        <var>promise</var> with <code>TypeError</code> and
        terminate these steps.</li>
        <li>Make a request to fetch the content of <var>url</var>
        as described by the <a href="#dfn-protocol-bindings"
          class="internalDFN" data-link-type="dfn">Protocol
          Bindings</a> and wait for the reply. Implementations
          encapsulate the fetching process and the accepted media
          types (such as <code>application/td+json</code>), as far
          as a valid <a href="#dfn-thing-descriptions" class=
          "internalDFN" data-link-type="dfn">Thing Description</a>
          can be obtained as defined in [<cite><a class="bibref"
          href="#bib-wot-td">WOT-TD</a></cite>]. Let <var>td</var>
          be the <a href="#dfn-thing-descriptions" class=
          "internalDFN" data-link-type="dfn">Thing Description</a>
          string-serialized from the returned content, as specified
          in the <a href=
          "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-td-serialization">
          Thing Description serialization</a>.
        </li>
        <li>If there was an error during the request, reject <var>
          promise</var> with an <code>Error</code> object
          <var>error</var> with <code>error.message</code> set to
          the error code seen by the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
        </li>
        <li>Otherwise resolve <var>promise</var> with <var>td</var>
        and terminate these steps.</li>
      </ol>
    </section>
    <section id="the-consume-method">
      <h3 id="x3-3-the-consume-method"><span class=
      "secno">3.3</span> The <dfn data-dfn-for="wot" data-dfn-type=
      "dfn" id="dom-wot-consume" data-idl="operation" data-title=
      "consume()" data-type="ConsumedThing" data-lt=
      "wot.consume()|wot.consume|consume()|consume"><code>consume()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-consume-method"></a></h3>
      <p>Accepts an <code>td</code> argument of type <code><a href=
      "#dom-thingdescription" class="internalDFN" data-link-type=
      "dfn"><code>ThingDescription</code></a></code> and returns a
      <a href="#dom-consumedthing" class="internalDFN"
      data-link-type="dfn"><code>ConsumedThing</code></a> object
      instantiated based on parsing that description.</p>
      <p>The <code>consume(td)</code> method must run the following
      steps:</p>
      <ol>
        <li>If the argument <var>td</var> is not a string, throw a
        <code>TypeError</code> and terminate these steps.</li>
        <li>Let <var>stub</var> be the result of running the
        <a href="#dfn-td-parsing-algorithm" class="internalDFN"
        data-link-type="dfn">TD parsing algorithm</a> with
        <var>td</var> as argument. If that throws an error,
        re-throw the error and terminate these steps.
        </li>
        <li>If <var>stub</var> does not have an own property that
        is defined in <a href="#dom-thingfragment" class=
        "internalDFN" data-link-type=
        "dfn"><code>ThingFragment</code></a> with a default value,
        add that property and value to <var>stub</var>.
        </li>
        <li>Create a <a href="#dom-consumedthing" class=
        "internalDFN" data-link-type=
        "dfn"><code>ConsumedThing</code></a> object
        <var>thing</var> initialized from <var>stub</var> that
        implements <a href="#dom-observable" class="internalDFN"
        data-link-type="dfn"><code>Observable</code></a>.
        </li>
        <li>Add the <code>read()</code> and <code>write()</code>
        methods to the <a href="#dom-thingproperty" class=
        "internalDFN" data-link-type=
        "dfn"><code>ThingProperty</code></a> elements so that they
        make requests to access the remote <a href="#dfn-things"
        class="internalDFN" data-link-type="dfn">Thing</a>s and
        wait for the reply, as defined by the <a href=
        "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>. Also, all
          <a href="#dom-thingproperty" class="internalDFN"
          data-link-type="dfn"><code>ThingProperty</code></a>
          elements <em class="rfc2119" title="SHOULD">SHOULD</em>
          implement <a href="#dom-observable" class="internalDFN"
          data-link-type="dfn"><code>Observable</code></a>, i.e.
          define a <code>subscribe()</code> method that should make
          request to observe the given <a href="#dfn-properties"
          class="internalDFN" data-link-type="dfn">Properties</a>
          as defined by the <a href="#dfn-protocol-bindings" class=
          "internalDFN" data-link-type="dfn">Protocol Bindings</a>.
        </li>
        <li>Add the <code>invoke()</code> methods to the <a href=
        "#dom-thingaction" class="internalDFN" data-link-type=
        "dfn"><code>ThingAction</code></a> elements so that they
        make requests to the remote <a href="#dfn-things" class=
        "internalDFN" data-link-type="dfn">Thing</a> to invoke its
        actions, as defined by the <a href="#dfn-protocol-bindings"
          class="internalDFN" data-link-type="dfn">Protocol
          Bindings</a>.
        </li>
        <li>Add the <code>subscribe()</code> method to all
          <a href="#dom-thingevent" class="internalDFN"
          data-link-type="dfn"><code>ThingEvent</code></a> elements
          so that they make requests to subscribe to the events
          defined by the remote <a href="#dfn-things" class=
          "internalDFN" data-link-type="dfn">Thing</a>, as defined
          by the <a href="#dfn-protocol-bindings" class=
          "internalDFN" data-link-type="dfn">Protocol Bindings</a>.
        </li>
        <li>Return <var>thing</var>.</li>
      </ol>
    </section>
    <section id="the-produce-method">
      <h3 id="x3-4-the-produce-method"><span class=
      "secno">3.4</span> The <dfn id="produce-method" data-dfn-for=
      "wot" data-dfn-type="dfn" data-idl="operation" data-title=
      "produce()" data-type="ExposedThing" data-lt=
      "wot.produce()|wot.produce|produce()|produce"><code>produce()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-produce-method"></a></h3>
      <p>Accepts a <code>model</code> argument of type
      <code><a href="#dom-thingmodel" class="internalDFN"
      data-link-type="dfn"><code>ThingModel</code></a></code> and
      returns an <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="dfn"><code>ExposedThing</code></a>
      object.</p>
      <p>The <code>produce(model)</code> method <em class="rfc2119"
      title="MUST">MUST</em> run the following steps:</p>
      <ol>
        <li>If invoking <code>produce()</code> is not allowed for
        the current scripting context for security reasons, throw
        <code>SecurityError</code> and terminate these steps.</li>
        <li>If the argument <var>model</var> is a string, then run
        the <i>TD parsing algorithm</i> with <var>model</var>
        passed as parameter. If it throws an error, re-throw that
        error and terminate this algorithm. Otherwise let
        <var>model</var> be the returned value.</li>
        <li>If <var>model</var> is not an object, throw
        <code>TypeError</code> and terminate these steps.</li>
        <li>If <var>model</var> does not have an own property that
        is defined in <a href="#dom-thingfragment" class=
        "internalDFN" data-link-type=
        "dfn"><code>ThingFragment</code></a> with a default value,
        add that property and value to <var>model</var>.
        </li>
        <li>Create an <a href="#dom-exposedthing" class=
        "internalDFN" data-link-type=
        "dfn"><code>ExposedThing</code></a> object <var>thing</var>
        initialized from <var>model</var>.
        </li>
        <li>For each property of <a href="#dom-exposedthing"
          class="internalDFN" data-link-type=
          "dfn"><code>ExposedThing</code></a> defined in <a href=
          "#dom-thingfragment" class="internalDFN" data-link-type=
          "dfn"><code>ThingFragment</code></a>, initialize the
          property based on the provided initial or default values
          provided to the local <a href="#dfn-wot-runtime" class=
          "internalDFN" data-link-type="dfn">WoT Runtime</a>
          implementation, for instance initialize:
          <ol>
            <li>the <code>id</code> property to be the final unique
            identifier of the <a href="#dfn-things" class=
            "internalDFN" data-link-type="dfn">Thing</a>,
            </li>
            <li>the <code>security</code> object of type <a href=
            "#dom-securityscheme" class="internalDFN"
            data-link-type="dfn"><code>SecurityScheme</code></a> to
            represent the actual security scheme and its properties
            as set up by the implementation,
            </li>
            <li>the <code>properties</code> property to be an
            object with all properties being <a href=
            "#dom-thingproperty" class="internalDFN"
              data-link-type="dfn"><code>ThingProperty</code></a>
              objects in which the <code>read()</code> and
              <code>write()</code> methods are provided to define
              local methods to get and set the <a href=
              "#dfn-properties" class="internalDFN" data-link-type=
              "dfn">Property</a> values,
            </li>
            <li>the <code>actions</code> property to be an object
            with all properties being <a href="#dom-thingaction"
            class="internalDFN" data-link-type=
            "dfn"><code>ThingAction</code></a> objects in which the
            <code>invoke()</code> method is provided to define a
            local method to run the defined <a href="#dfn-actions"
              class="internalDFN" data-link-type="dfn">Action</a>s,
            </li>
            <li>the <code>events</code> property to be an object
            with all properties being <a href="#dom-exposedevent"
            class="internalDFN" data-link-type=
            "dfn"><code>ExposedEvent</code></a> objects in which
            the <code>emit()</code> method is provided to define a
            local way to trigger sending notifications to all
            subscribed clients,
            </li>
            <li>and initialize the other properties as initialized
            from <var>model</var>.</li>
            <li>Return <var>thing</var>.</li>
          </ol>
          <p>The <dfn data-dfn-type="dfn" id=
          "dfn-td-parsing-algorithm">TD parsing algorithm</dfn>
          takes a string <var>td</var> as argument and runs the
          following steps:</p>
          <ol>
            <li>Parse <var>td</var> according to the <a href=
            "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-td-serialization">
              WoT Thing Description</a> in order to produce a
              <a href=
              "https://www.w3.org/TR/json-ld/#dfn-json-object">JSON
              object</a> <var>json</var>. Update <var>thing</var>
              with the properties and values defined in
              <var>json</var>.
            </li>
            <li>If there was an error during the parsing, throw
            that error and terminate these steps.</li>
            <li>Otherwise return <var>json</var>.</li>
          </ol>
        </li>
      </ol>
    </section>
    <section id="the-register-method">
      <h3 id="x3-5-the-register-method"><span class=
      "secno">3.5</span> The <dfn data-dfn-for="wot" data-dfn-type=
      "dfn" id="dom-wot-register" data-idl="operation" data-title=
      "register()" data-type="Promise" data-lt=
      "wot.register()|wot.register|register()|register"><code>register()</code></dfn>
      method<a class="self-link" aria-label="§" href=
      "#the-register-method"></a></h3>
      <p>Takes two mandatory arguments:</p>
      <ul>
        <li>
          <code>directory</code> denoting a <a href=
          "#dfn-thing-directory" class="internalDFN"
          data-link-type="dfn">Thing Directory</a>, and
        </li>
        <li>
          <code>thing</code> denoting an <a href=
          "#dom-exposedthing" class="internalDFN" data-link-type=
          "dfn"><code>ExposedThing</code></a> object.
        </li>
      </ul>
      <p>Generate the <a href="#dfn-thing-descriptions" class=
      "internalDFN" data-link-type="dfn">Thing Description</a> as
      <var>td</var>, given the <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Properties</a>, <a href=
      "#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a>s and <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn">Event</a>s defined for
      this <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="dfn"><code>ExposedThing</code></a> object.
      Then make a request to register <var>td</var> to the given
      WoT <a href="#dfn-thing-directory" class="internalDFN"
      data-link-type="dfn">Thing Directory</a>.</p>
    </section>
    <section id="the-unregister-method">
      <h3 id="x3-6-the-unregister-method"><span class=
      "secno">3.6</span> The <dfn data-dfn-for="wot" data-dfn-type=
      "dfn" id="dom-wot-unregister" data-idl="operation"
      data-title="unregister()" data-type="Promise" data-lt=
      "wot.unregister()|wot.unregister|unregister()|unregister"><code>
      unregister()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-unregister-method"></a></h3>
      <p>Takes two mandatory arguments:</p>
      <ul>
        <li>
          <code>directory</code> denoting a <a href=
          "#dfn-thing-directory" class="internalDFN"
          data-link-type="dfn">Thing Directory</a>, and
        </li>
        <li>
          <code>thing</code> denoting an <a href=
          "#dom-exposedthing" class="internalDFN" data-link-type=
          "dfn"><code>ExposedThing</code></a> object.
        </li>
      </ul>
      <p>Makes a request to unregister the <code>thing</code> from
      the given WoT <a href="#dfn-thing-directory" class=
      "internalDFN" data-link-type="dfn">Thing Directory</a>.</p>
    </section>
    <section id="examples">
      <h3 id="x3-7-examples"><span class="secno">3.7</span>
      Examples<a class="self-link" aria-label="§" href=
      "#examples"></a></h3>
      <div class="example" id="ex-1-discover-things-via-directory">
        <div class="marker">
          <a class="self-link" href=
          "#ex-1-discover-things-via-directory">Example
          1</a><span class="example-title">: Discover Things via
          directory</span>
        </div>
        <pre class="hljs javascript" aria-busy="false"><span class=
        "hljs-keyword">let</span> discoveryFilter = {
  <span class="hljs-attr">method</span>: <span class=
"hljs-string">"directory"</span>,
  <span class="hljs-attr">url</span>: <span class=
"hljs-string">"http://directory.wotservice.org"</span>
};
<span class=
"hljs-keyword">let</span> subscription = wot.discover(discoveryFilter).subscribe(
  <span class="hljs-function"><span class=
"hljs-params">td</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found Thing "</span> + td.name);
    <span class=
"hljs-comment">// fetch the TD and create a ConsumedThing</span>
    <span class="hljs-keyword">let</span> thing = wot.consume(td);
  },
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished because an error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    subscription.unsubscribe();
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery timeout"</span>);
  },
  <span class="hljs-number">5000</span>);</pre>
      </div>
      <div class="example" id=
      "ex-2-discover-things-exposed-by-local-hardware">
        <div class="marker">
          <a class="self-link" href=
          "#ex-2-discover-things-exposed-by-local-hardware">Example
          2</a><span class="example-title">: Discover Things
          exposed by local hardware</span>
        </div>
        <pre class="hljs javascript" aria-busy="false"><span class=
        "hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe(
  <span class="hljs-function"><span class=
"hljs-params">td</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found local Thing "</span> + td.name); },
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);</pre>
      </div>
      <div class="example" id=
      "ex-3-same-as-above-but-with-different-observable-syntax">
        <div class="marker">
          <a class="self-link" href=
          "#ex-3-same-as-above-but-with-different-observable-syntax">
          Example 3</a><span class="example-title">: Same as above
          but with different Observable syntax</span>
        </div>
        <pre class="hljs javascript" aria-busy="false"><span class=
        "hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe({
  td =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found local Thing "</span> + td.name); },
  <span class="hljs-attr">error</span>: <span class=
"hljs-function"><span class=
"hljs-params">err</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + err.message); },
  <span class="hljs-attr">complete</span>: <span class=
"hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
});</pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="ConsumedThing" id=
  "the-consumedthing-interface">
    <!--OddPage-->
    <h2 id="x4-the-consumedthing-interface"><span class=
    "secno">4.</span> The <dfn data-dfn-for="" data-dfn-type="dfn"
    id="dom-consumedthing" data-idl="interface" data-title=
    "ConsumedThing"><code>ConsumedThing</code></dfn>
    interface<a class="self-link" aria-label="§" href=
    "#the-consumedthing-interface"></a></h2>
    <p>Represents an object that extends a <a href=
    "#dom-thingfragment" class="internalDFN" data-link-type=
    "dfn"><code>ThingFragment</code></a> with methods for client
    interactions (send request for reading and writing <a href=
    "#dfn-properties" class="internalDFN" data-link-type=
    "dfn">Properties</a>), invoke <a href="#dfn-actions" class=
    "internalDFN" data-link-type="dfn">Action</a>s, subscribe and
    unsubscribe for <a href="#dfn-properties" class="internalDFN"
    data-link-type="dfn">Property</a> changes and <a href=
    "#dfn-events" class="internalDFN" data-link-type=
    "dfn">Event</a>s.</p>
    <div>
      <pre class="def idl"><span class="idlInterface" id=
      "idl-def-consumedthing" data-idl="" data-title=
      "ConsumedThing">interface <span class=
      "idlInterfaceID"><a data-no-default="" data-link-for=""
      data-lt="" href="#dom-consumedthing" class="internalDFN"
      data-link-type=
      "dfn"><code>ConsumedThing</code></a></span> : <span class=
      "idlSuperclass"><a href="#dom-thingfragment" class=
      "internalDFN" data-link-type=
      "dfn"><code>ThingFragment</code></a></span> {<span class=
      "idlAttribute" id="idl-def-consumedthing-id" data-idl=""
      data-title="id" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="consumedthing.id|id" href=
"#dom-consumedthing-id" class="internalDFN" data-link-type=
"dfn"><code>id</code></a></span>;</span><span class="idlAttribute"
id="idl-def-consumedthing-name" data-idl="" data-title="name"
data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="consumedthing.name|name"
href="#dom-consumedthing-name" class="internalDFN" data-link-type=
"dfn"><code>name</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-base" data-idl=""
data-title="base" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="consumedthing.base|base"
href="#dom-consumedthing-base" class="internalDFN" data-link-type=
"dfn"><code>base</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-properties" data-idl=""
data-title="properties" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-propertymap" class="internalDFN" data-link-type=
"dfn"><code>PropertyMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="consumedthing"
data-lt="consumedthing.properties|properties" href=
"#dom-consumedthing-properties" class="internalDFN" data-link-type=
"dfn"><code>properties</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-actions" data-idl=""
data-title="actions" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-actionmap" class="internalDFN" data-link-type=
"dfn"><code>ActionMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="consumedthing"
data-lt="consumedthing.actions|actions" href=
"#dom-consumedthing-actions" class="internalDFN" data-link-type=
"dfn"><code>actions</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-consumedthing-events" data-idl=""
data-title="events" data-dfn-for="consumedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-eventmap" class="internalDFN" data-link-type=
"dfn"><code>EventMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="consumedthing"
data-lt="consumedthing.events|events" href=
"#dom-consumedthing-events" class="internalDFN" data-link-type=
"dfn"><code>events</code></a></span>;</span><span class="idlMethod"
id="idl-def-consumedthing--name" data-idl="" data-title=""
data-dfn-for="consumedthing"><span class="idlSectionComment">
  // getter for ThingFragment properties
  </span>getter<span class="idlMethType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
};</span><span class="idlInterface" id="idl-def-propertymap"
data-idl="" data-title="PropertyMap">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertymap" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyMap</code></a></span> {<span class="idlMaplike"
id="idl-def-propertymap-maplike" data-idl="" data-title="iterable"
data-dfn-for="propertymap">
  readonly maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a>&gt;;</span>
};</span><span class="idlInterface" id="idl-def-actionmap"
data-idl="" data-title="ActionMap">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-actionmap" class=
"internalDFN" data-link-type=
"dfn"><code>ActionMap</code></a></span> {<span class="idlMaplike"
id="idl-def-actionmap-maplike" data-idl="" data-title="iterable"
data-dfn-for="actionmap">
  readonly maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-thingaction" class="internalDFN" data-link-type=
"dfn"><code>ThingAction</code></a>&gt;;</span>
};</span><span class="idlInterface" id="idl-def-eventmap" data-idl=
"" data-title="EventMap">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-eventmap" class=
"internalDFN" data-link-type=
"dfn"><code>EventMap</code></a></span> {<span class="idlMaplike"
id="idl-def-eventmap-maplike" data-idl="" data-title="iterable"
data-dfn-for="eventmap">
  readonly maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a>&gt;;</span>
};</span><span class="idlIncludes">
<a href="#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"><code>ConsumedThing</code></a> includes <a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn"><code>Observable</code></a>;</span><span class=
"idlSectionComment">  // for TD changes</span></pre>
    </div>
    <p>The <dfn data-dfn-for="consumedthing" data-dfn-type="dfn"
    id="dom-consumedthing-id" data-idl="attribute" data-title="id"
    data-type="DOMString" data-lt=
    "consumedthing.id|id"><code>id</code></dfn> attribute
    represents the unique identifier of the <a href="#dfn-things"
    class="internalDFN" data-link-type="dfn">Thing</a> instance,
    typically a URI, IRI, or URN as <code>USVString</code>.</p>
    <p>The <dfn data-dfn-for="consumedthing" data-dfn-type="dfn"
    id="dom-consumedthing-name" data-idl="attribute" data-title=
    "name" data-type="DOMString" data-lt=
    "consumedthing.name|name"><code>name</code></dfn> attribute
    represents the name of the <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn">Thing</a> as
    <code>DOMString</code>.</p>
    <p>The <dfn data-dfn-for="consumedthing" data-dfn-type="dfn"
    id="dom-consumedthing-base" data-idl="attribute" data-title=
    "base" data-type="DOMString" data-lt=
    "consumedthing.base|base"><code>base</code></dfn> attribute
    represents the base URI that is valid for all defined local
    interaction resources.</p>
    <p>The <dfn data-dfn-for="consumedthing" data-dfn-type="dfn"
    id="dom-consumedthing-properties" data-idl="attribute"
    data-title="properties" data-type="PropertyMap" data-lt=
    "consumedthing.properties|properties"><code>properties</code></dfn>
    attribute represents a dictionary of <a href=
    "#dom-thingproperty" class="internalDFN" data-link-type=
    "dfn"><code>ThingProperty</code></a> items. The
    <dfn data-dfn-for="" data-dfn-type="dfn" id="dom-propertymap"
    data-idl="interface" data-title=
    "PropertyMap"><code>PropertyMap</code></dfn> interface
    represents a maplike dictionary where all values are <a href=
    "#dom-thingproperty" class="internalDFN" data-link-type=
    "dfn"><code>ThingProperty</code></a> objects. The
    <code>read()</code> and <code>write()</code> methods make a
    request to access the <a href="#dfn-properties" class=
    "internalDFN" data-link-type="dfn">Properties</a> on the remote
    <a href="#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a> represented by this <a href=
    "#dom-consumedthing" class="internalDFN" data-link-type=
    "dfn"><code>ConsumedThing</code></a> proxy object.</p>
    <p>The <dfn data-dfn-for="consumedthing" data-dfn-type="dfn"
    id="dom-consumedthing-actions" data-idl="attribute" data-title=
    "actions" data-type="ActionMap" data-lt=
    "consumedthing.actions|actions"><code>actions</code></dfn>
    attribute represents a dictionary of <a href="#dom-thingaction"
    class="internalDFN" data-link-type=
    "dfn"><code>ThingAction</code></a> items. The
    <dfn data-dfn-for="" data-dfn-type="dfn" id="dom-actionmap"
    data-idl="interface" data-title=
    "ActionMap"><code>ActionMap</code></dfn> interface represents a
    maplike dictionary where all values are <a href=
    "#dom-thingaction" class="internalDFN" data-link-type=
    "dfn"><code>ThingAction</code></a> objects. The
    <code>invoke()</code> method represents a request to invoke the
    <a href="#dfn-actions" class="internalDFN" data-link-type=
    "dfn">Action</a> on the remote <a href="#dfn-things" class=
    "internalDFN" data-link-type="dfn">Thing</a>.</p>
    <p>The <dfn data-dfn-for="consumedthing" data-dfn-type="dfn"
    id="dom-consumedthing-events" data-idl="attribute" data-title=
    "events" data-type="EventMap" data-lt=
    "consumedthing.events|events"><code>events</code></dfn>
    attribute represents a dictionary of <a href="#dom-thingevent"
    class="internalDFN" data-link-type=
    "dfn"><code>ThingEvent</code></a> items. The <dfn data-dfn-for=
    "" data-dfn-type="dfn" id="dom-eventmap" data-idl="interface"
    data-title="EventMap"><code>EventMap</code></dfn> interface
    represents a maplike dictionary where all values are <a href=
    "#dom-thingevent" class="internalDFN" data-link-type=
    "dfn"><code>ThingEvent</code></a> objects. Subscribing to the
    events involves setting up an observation (subscription)
    mechanism on the remote object.</p>
    <section id="examples-0">
      <h3 id="x4-1-examples"><span class="secno">4.1</span>
      Examples<a class="self-link" aria-label="§" href=
      "#examples-0"></a></h3>
      <p>Below a <code><a href="#dom-consumedthing" class=
      "internalDFN" data-link-type=
      "dfn"><code>ConsumedThing</code></a></code> interface example
      is given.</p>
      <div class="example" id="ex-4-consume-a-thing">
        <div class="marker">
          <a class="self-link" href="#ex-4-consume-a-thing">Example
          4</a><span class="example-title">: Consume a Thing</span>
        </div>
        <pre class="hljs javascript" aria-busy="false"><span class=
        "hljs-keyword">try</span> {
  <span class=
"hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe(
    <span class="hljs-function"><span class=
"hljs-params">td</span> =&gt;</span> {
      <span class=
"hljs-keyword">let</span> thing = wot.consume(td);
      <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Thing "</span> + thing.name + <span class=
"hljs-string">" has been consumed."</span>);
      <span class=
"hljs-keyword">let</span> subscription = thing[<span class=
"hljs-string">"temperature"</span>].subscribe(<span class=
"hljs-function"><span class=
"hljs-keyword">function</span>(<span class=
"hljs-params">value</span>) </span>{
          <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature: "</span> + value);
        });
      thing.actions[<span class=
"hljs-string">"startMeasurement"</span>].invoke({ <span class=
"hljs-attr">units</span>: <span class=
"hljs-string">"Celsius"</span> })
        .then(<span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Temperature measurement started."</span>); })
        .catch(<span class="hljs-function"><span class=
"hljs-params">e</span> =&gt;</span> {
           <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error starting measurement."</span>);
           subscription.unsubscribe();
         })
    },
    error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
    () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
  );
} <span class="hljs-keyword">catch</span>(error) {
  <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error: "</span> + error.message);
};</pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="ExposedThing" id=
  "the-exposedthing-interface">
    <!--OddPage-->
    <h2 id="x5-the-exposedthing-interface"><span class=
    "secno">5.</span> The <dfn data-dfn-for="" data-dfn-type="dfn"
    id="dom-exposedthing" data-idl="interface" data-title=
    "ExposedThing"><code>ExposedThing</code></dfn>
    interface<a class="self-link" aria-label="§" href=
    "#the-exposedthing-interface"></a></h2>
    <p>The <a href="#dom-exposedthing" class="internalDFN"
    data-link-type="dfn"><code>ExposedThing</code></a> interface is
    the server API that allows defining request handlers,
    properties, <a href="#dfn-actions" class="internalDFN"
    data-link-type="dfn">Actions</a>, and <a href="#dfn-events"
    class="internalDFN" data-link-type="dfn">Events</a> to a
    <a href="#dfn-things" class="internalDFN" data-link-type=
    "dfn">Thing</a>. It also implements the <a href=
    "#dom-observable" class="internalDFN" data-link-type=
    "dfn"><code>Observable</code></a> interface. An <a href=
    "#dom-exposedthing" class="internalDFN" data-link-type=
    "dfn"><code>ExposedThing</code></a> is created by the <a href=
    "#the-produce-method">produce()</a> method.</p>
    <div>
      <pre class="def idl"><span class="idlInterface" id=
      "idl-def-exposedthing" data-idl="" data-title=
      "ExposedThing">interface <span class=
      "idlInterfaceID"><a data-no-default="" data-link-for=""
      data-lt="" href="#dom-exposedthing" class="internalDFN"
      data-link-type=
      "dfn"><code>ExposedThing</code></a></span> : <span class=
      "idlSuperclass"><a href="#dom-thingfragment" class=
      "internalDFN" data-link-type=
      "dfn"><code>ThingFragment</code></a></span> {<span class=
      "idlAttribute" id="idl-def-exposedthing-properties" data-idl=
      "" data-title="properties" data-dfn-for="exposedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-propertymap" class="internalDFN" data-link-type=
"dfn"><code>PropertyMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="exposedthing"
data-lt="exposedthing.properties|properties" href=
"#dom-exposedthing-properties" class="internalDFN" data-link-type=
"dfn"><code>properties</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-exposedthing-actions" data-idl=""
data-title="actions" data-dfn-for="exposedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-actionmap" class="internalDFN" data-link-type=
"dfn"><code>ActionMap</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="exposedthing"
data-lt="exposedthing.actions|actions" href=
"#dom-exposedthing-actions" class="internalDFN" data-link-type=
"dfn"><code>actions</code></a></span>;</span><span class=
"idlAttribute" id="idl-def-exposedthing-events" data-idl=""
data-title="events" data-dfn-for="exposedthing">
  readonly attribute<span class="idlAttrType"> <a data-link-for=""
href="#dom-exposedevents" class="internalDFN" data-link-type=
"dfn"><code>ExposedEvents</code></a></span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="exposedthing"
data-lt="exposedthing.events|events" href=
"#dom-exposedthing-events" class="internalDFN" data-link-type=
"dfn"><code>events</code></a></span>;</span><span class="idlMethod"
id="idl-def-exposedthing--name" data-idl="" data-title=""
data-dfn-for="exposedthing"><span class="idlSectionComment">
  // getter for ThingFragment properties
  </span>getter<span class="idlMethType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing--name-value" data-idl="" data-title=""
data-dfn-for="exposedthing"><span class="idlSectionComment">
  // setter for ThingFragment properties
  </span>setter<span class="idlMethType"> void</span> (<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-expose" data-idl="" data-title="expose"
data-dfn-for="exposedthing"><span class="idlMethType"><span class=
"idlSectionComment">
  // methods to expose and destroy the Thing
  </span><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt=
"exposedthing.expose()|exposedthing.expose|expose()|expose" href=
"#dom-exposedthing-expose" class="internalDFN" data-link-type=
"dfn"><code>expose</code></a></span>();</span><span class=
"idlMethod" id="idl-def-exposedthing-destroy" data-idl=""
data-title="destroy" data-dfn-for="exposedthing"><span class=
"idlMethType">
  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt=
"exposedthing.destroy()|exposedthing.destroy|destroy()|destroy"
href="#dom-exposedthing-destroy" class="internalDFN"
data-link-type="dfn"><code>destroy</code></a></span>();</span><span class="idlMethod"
id="idl-def-exposedthing-addproperty-name-property-initvalue"
data-idl="" data-title="addProperty" data-dfn-for=
"exposedthing"><span class="idlMethType"><span class=
"idlSectionComment">
  // define Properties
  </span><a data-link-for="" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.addproperty()|exposedthing.addproperty|addproperty()|addproperty"
href="#dom-exposedthing-addproperty" class="internalDFN"
data-link-type=
"dfn"><code>addProperty</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-propertyfragment" class="internalDFN" data-link-type=
"dfn"><code>PropertyFragment</code></a></span> <span class=
"idlParamName">property</span></span>,<span class=
"idlParam"> optional<span class="idlParamType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">initValue</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-setpropertyreadhandler-name-readhandler"
data-idl="" data-title="setPropertyReadHandler" data-dfn-for=
"exposedthing"><span class="idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.setpropertyreadhandler()|exposedthing.setpropertyreadhandler|setpropertyreadhandler()|setpropertyreadhandler"
href="#dom-exposedthing-setpropertyreadhandler" class="internalDFN"
data-link-type=
"dfn"><code>setPropertyReadHandler</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-propertyreadhandler" class="internalDFN" data-link-type=
"dfn"><code>PropertyReadHandler</code></a></span> <span class=
"idlParamName">readHandler</span></span>);</span><span class=
"idlMethod" id=
"idl-def-exposedthing-setpropertywritehandler-name-writehandler"
data-idl="" data-title="setPropertyWriteHandler" data-dfn-for=
"exposedthing"><span class="idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.setpropertywritehandler()|exposedthing.setpropertywritehandler|setpropertywritehandler()|setpropertywritehandler"
href="#dom-exposedthing-setpropertywritehandler" class=
"internalDFN" data-link-type=
"dfn"><code>setPropertyWriteHandler</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-propertywritehandler" class="internalDFN"
data-link-type="dfn"><code>PropertyWriteHandler</code></a></span> <span class="idlParamName">writeHandler</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-removeproperty-name" data-idl=""
data-title="removeProperty" data-dfn-for=
"exposedthing"><span class="idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.removeproperty()|exposedthing.removeproperty|removeproperty()|removeproperty"
href="#dom-exposedthing-removeproperty" class="internalDFN"
data-link-type=
"dfn"><code>removeProperty</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-addaction-name-init-action" data-idl=""
data-title="addAction" data-dfn-for="exposedthing"><span class=
"idlMethType"><span class="idlSectionComment">
  // define Actions
  </span><a data-link-for="" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.addaction()|exposedthing.addaction|addaction()|addaction"
href="#dom-exposedthing-addaction" class="internalDFN"
data-link-type="dfn"><code>addAction</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-actionfragment" class="internalDFN" data-link-type=
"dfn"><code>ActionFragment</code></a></span> <span class=
"idlParamName">init</span></span>,<span class=
"idlParam"><span class="idlParamType"> <a data-link-for="" href=
"#dom-actionhandler" class="internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-removeaction-name" data-idl="" data-title=
"removeAction" data-dfn-for="exposedthing"><span class=
"idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.removeaction()|exposedthing.removeaction|removeaction()|removeaction"
href="#dom-exposedthing-removeaction" class="internalDFN"
data-link-type=
"dfn"><code>removeAction</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-setactionhandler-name-action" data-idl=""
data-title="setActionHandler" data-dfn-for=
"exposedthing"><span class="idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.setactionhandler()|exposedthing.setactionhandler|setactionhandler()|setactionhandler"
href="#dom-exposedthing-setactionhandler" class="internalDFN"
data-link-type=
"dfn"><code>setActionHandler</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-actionhandler" class="internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-addevent-name-event" data-idl=""
data-title="addEvent" data-dfn-for="exposedthing"><span class=
"idlMethType"><span class="idlSectionComment">
  // define Events
  </span><a data-link-for="" href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.addevent()|exposedthing.addevent|addevent()|addevent"
href="#dom-exposedthing-addevent" class="internalDFN"
data-link-type="dfn"><code>addEvent</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,<span class="idlParam"><span class="idlParamType"> <a data-link-for=""
href="#dom-eventfragment" class="internalDFN" data-link-type=
"dfn"><code>EventFragment</code></a></span> <span class=
"idlParamName">event</span></span>);</span><span class="idlMethod"
id="idl-def-exposedthing-removeevent-name" data-idl="" data-title=
"removeEvent" data-dfn-for="exposedthing"><span class=
"idlMethType">
  <a data-link-for="" href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt=
"exposedthing.removeevent()|exposedthing.removeevent|removeevent()|removeevent"
href="#dom-exposedthing-removeevent" class="internalDFN"
data-link-type=
"dfn"><code>removeEvent</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
};</span><span class="idlInterface" id="idl-def-exposedevents"
data-idl="" data-title="ExposedEvents">
[<span class="extAttr"><span class="extAttrName"><a href=
"https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a></span></span>]
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-exposedevents" class=
"internalDFN" data-link-type=
"dfn"><code>ExposedEvents</code></a></span> {<span class=
"idlMaplike" id="idl-def-exposedevents-maplike" data-idl=""
data-title="iterable" data-dfn-for="exposedevents">
  maplike&lt;<a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, <a data-link-for=""
href="#dom-exposedevent" class="internalDFN" data-link-type=
"dfn"><code>ExposedEvent</code></a>&gt;;</span>
};</span><span class="idlCallback" id="idl-def-propertyreadhandler"
data-idl="" data-title="PropertyReadHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertyreadhandler" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyReadHandler</code></a></span> =<span class=
"idlCallbackType"> <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> ();</span><span class="idlCallback"
id="idl-def-propertywritehandler" data-idl="" data-title=
"PropertyWriteHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-propertywritehandler" class=
"internalDFN" data-link-type=
"dfn"><code>PropertyWriteHandler</code></a></span> =<span class=
"idlCallbackType"> <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span><span class="idlCallback"
id="idl-def-actionhandler" data-idl="" data-title="ActionHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-actionhandler" class=
"internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> =<span class=
"idlCallbackType"> <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">parameters</span></span>);</span></pre>
    </div>
    <p>The <dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id=
    "dom-exposedthing-properties" data-idl="attribute" data-title=
    "properties" data-type="PropertyMap" data-lt=
    "exposedthing.properties|properties"><code>properties</code></dfn>
    attribute represents a dictionary of <a href=
    "#dom-thingproperty" class="internalDFN" data-link-type=
    "dfn"><code>ThingProperty</code></a> items in which the
    <code>read()</code> and <code>write()</code> methods define
    local methods that access the physical representations of the
    <a href="#dfn-properties" class="internalDFN" data-link-type=
    "dfn">Properties</a>.</p>
    <p>The <dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id=
    "dom-exposedthing-actions" data-idl="attribute" data-title=
    "actions" data-type="ActionMap" data-lt=
    "exposedthing.actions|actions"><code>actions</code></dfn>
    attribute represents a dictionary of <a href="#dom-thingaction"
    class="internalDFN" data-link-type=
    "dfn"><code>ThingAction</code></a> items in which the
    <code>invoke()</code> method represents a local method to
    invoke the <a href="#dfn-actions" class="internalDFN"
    data-link-type="dfn">Action</a>.</p>
    <p>The <dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id=
    "dom-exposedthing-events" data-idl="attribute" data-title=
    "events" data-type="ExposedEvents" data-lt=
    "exposedthing.events|events"><code>events</code></dfn>
    attribute represents a dictionary of <a href=
    "#dom-exposedevent" class="internalDFN" data-link-type=
    "dfn"><code>ExposedEvent</code></a> items that add the
    <code>emit()</code> method to the <a href="#dom-thingevent"
    class="internalDFN" data-link-type=
    "dfn"><code>ThingEvent</code></a> definition. The
    <dfn data-dfn-for="" data-dfn-type="dfn" id="dom-exposedevents"
    data-idl="interface" data-title=
    "ExposedEvents"><code>ExposedEvents</code></dfn> interface
    represents a maplike dictionary where all values are <a href=
    "#dom-exposedevent" class="internalDFN" data-link-type=
    "dfn"><code>ExposedEvent</code></a> objects.</p>
    <section id="the-expose-method">
      <h3 id="x5-1-the-expose-method"><span class=
      "secno">5.1</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-expose" data-idl=
      "operation" data-title="expose()" data-type="Promise"
      data-lt="exposedthing.expose()|exposedthing.expose|expose()|expose">
      <code>expose()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-expose-method"></a></h3>
      <p>Start serving external requests for the <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a>, so that <a href="#dfn-wot-interactions"
      class="internalDFN" data-link-type="dfn">WoT Interactions</a>
      using <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Properties</a>, <a href="#dfn-actions"
      class="internalDFN" data-link-type="dfn">Action</a>s and
      <a href="#dfn-events" class="internalDFN" data-link-type=
      "dfn">Event</a>s will be possible.</p>
      <p>The <code>expose()</code> method <em class="rfc2119"
      title="MUST">MUST</em> run the following steps:</p>
      <ol>
        <li>Return a <code>Promise</code> <var>promise</var> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If invoking <code>expose()</code> is not allowed for
        the current scripting context for security reasons, reject
        <var>promise</var> with <code>SecurityError</code> and
        terminate these steps.</li>
        <li>Make a request to the underlying platform to attach
        protocol handlers and start serving external requests for
        <a href="#dfn-wot-interactions" class="internalDFN"
        data-link-type="dfn">WoT Interactions</a> (read, write and
        observe <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Properties</a>, invoke <a href=
        "#dfn-actions" class="internalDFN" data-link-type=
        "dfn">Action</a>s and manage <a href="#dfn-events" class=
        "internalDFN" data-link-type="dfn">Event</a>
        subscriptions), based on the <a href=
        "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>.
        </li>
        <li>If there was an error during the request, reject <var>
          promise</var> with an <code>Error</code> object
          <var>error</var> with <code>error.message</code> set to
          the error code seen by the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
        </li>
        <li>Otherwise resolve <var>promise</var> with <var>td</var>
        and terminate these steps.</li>
      </ol>
    </section>
    <section id="the-destroy-method">
      <h3 id="x5-2-the-destroy-method"><span class=
      "secno">5.2</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-destroy" data-idl=
      "operation" data-title="destroy()" data-type="Promise"
      data-lt=
      "exposedthing.destroy()|exposedthing.destroy|destroy()|destroy">
      <code>destroy()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-destroy-method"></a></h3>
      <p>Stop serving external requests for the <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> and destroy the object. Note that eventual
      unregistering should be done before invoking this method.</p>
      <p>The <code>destroy()</code> method <em class="rfc2119"
      title="MUST">MUST</em> run the following steps:</p>
      <ol>
        <li>Return a <code>Promise</code> <var>promise</var> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If invoking <code>destroy()</code> is not allowed for
        the current scripting context for security reasons, reject
        <var>promise</var> with <code>SecurityError</code> and
        terminate these steps.</li>
        <li>Make a request to the underlying platform to stop
        serving external requests for <a href=
        "#dfn-wot-interactions" class="internalDFN"
          data-link-type="dfn">WoT Interactions</a>, based on the
          <a href="#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a>.
        </li>
        <li>If there was an error during the request, reject <var>
          promise</var> with an <code>Error</code> object
          <var>error</var> with <code>error.message</code> set to
          the error code seen by the <a href=
          "#dfn-protocol-bindings" class="internalDFN"
          data-link-type="dfn">Protocol Bindings</a> and terminate
          these steps.
        </li>
        <li>Otherwise resolve <var>promise</var> with <var>td</var>
        and terminate these steps.</li>
      </ol>
    </section>
    <section id="the-addproperty-method">
      <h3 id="x5-3-the-addproperty-method"><span class=
      "secno">5.3</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-addproperty"
      data-idl="operation" data-title="addProperty()" data-type=
      "ExposedThing" data-lt=
      "exposedthing.addproperty()|exposedthing.addproperty|addproperty()|addproperty">
      <code>addProperty()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-addproperty-method"></a></h3>
      <p>Adds a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> with name defined by the
      <var>name</var> argument, the data schema provided by the
      <var>property</var> argument of type <a href=
      "#dom-propertyfragment" class="internalDFN" data-link-type=
      "dfn"><code>PropertyFragment</code></a>, and optionally an
      initial value provided in the argument <var>initValue</var>
      whose type should match the one defined in the
      <code>type</code> property according to the <a href=
      "#dfn-value-matching-algorithm" class="internalDFN"
      data-link-type="dfn">value-matching algorithm</a>. If
      <var>initValue</var> is not provided, it <em class="rfc2119"
      title="SHOULD">SHOULD</em> be initialized as
      <code>undefined</code>. Implementations <em class="rfc2119"
      title="SHOULD">SHOULD</em> update the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>. Throws on error. Returns a
      reference to the same object for supporting chaining.</p>
    </section>
    <section id="the-removeproperty-method">
      <h3 id="x5-4-the-removeproperty-method"><span class=
      "secno">5.4</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-removeproperty"
      data-idl="operation" data-title="removeProperty()" data-type=
      "ExposedThing" data-lt=
      "exposedthing.removeproperty()|exposedthing.removeproperty|removeproperty()|removeproperty">
      <code>removeProperty()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-removeproperty-method"></a></h3>
      <p>Removes the <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> specified by the
      <code>name</code> argument and updates the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>. Throws on error. Returns a
      reference to the same object for supporting chaining.</p>
    </section>
    <section id="the-addaction-method">
      <h3 id="x5-5-the-addaction-method"><span class=
      "secno">5.5</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-addaction" data-idl=
      "operation" data-title="addAction()" data-type="ExposedThing"
      data-lt=
      "exposedthing.addaction()|exposedthing.addaction|addaction()|addaction">
      <code>addAction()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-addaction-method"></a></h3>
      <p>Adds to the <code>actions</code> property of a <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> object an <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> with name
      defined by the <var>name</var> argument, defines input and
      output data format by the <var>init</var> argument of type
      <a href="#dom-actionfragment" class="internalDFN"
      data-link-type="dfn"><code>ActionFragment</code></a>, and
      adds the function provided in the <var>action</var> argument
      as a handler, then updates the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>. Throws on error. Returns a
      reference to the same object for supporting chaining.</p>
      <p>The provided <var>action</var> callback function will
      implement invoking an <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> and <em class=
      "rfc2119" title="SHOULD">SHOULD</em> be called by
      implementations when a request for invoking the <a href=
      "#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> is received from the underlying platform.
      The callback will receive a <code>parameters</code>
      dictionary argument according to the definition in the
      <var>init.input</var> argument and will return a value of
      type defined by the <var>init.output</var> argument according
      to the <a href="#dfn-value-matching-algorithm" class=
      "internalDFN" data-link-type="dfn">value-matching
      algorithm</a>.</p>
      <p>There <em class="rfc2119" title="SHOULD">SHOULD</em> be
      exactly one handler for any given <a href="#dfn-actions"
      class="internalDFN" data-link-type="dfn">Action</a>. If no
      handler is initialized for any given <a href="#dfn-actions"
      class="internalDFN" data-link-type="dfn">Action</a>,
      implementations <em class="rfc2119" title=
      "SHOULD">SHOULD</em> throw a <code>TypeError</code>.</p>
    </section>
    <section id="the-removeaction-method">
      <h3 id="x5-6-the-removeaction-method"><span class=
      "secno">5.6</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-removeaction"
      data-idl="operation" data-title="removeAction()" data-type=
      "ExposedThing" data-lt=
      "exposedthing.removeaction()|exposedthing.removeaction|removeaction()|removeaction">
      <code>removeAction()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-removeaction-method"></a></h3>
      <p>Removes the <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn">Action</a> specified by the
      <code>name</code> argument and updates the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>. Throws on error. Returns a
      reference to the same object for supporting chaining.</p>
    </section>
    <section id="the-addevent-method">
      <h3 id="x5-7-the-addevent-method"><span class=
      "secno">5.7</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-addevent" data-idl=
      "operation" data-title="addEvent()" data-type="ExposedThing"
      data-lt=
      "exposedthing.addevent()|exposedthing.addevent|addevent()|addevent">
      <code>addEvent()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-addevent-method"></a></h3>
      <p>Adds an event with name defined by the <var>name</var>
      argument and qualifiers and initialization value provided by
      the <var>event</var> argument of type <a href=
      "#dom-eventfragment" class="internalDFN" data-link-type=
      "dfn"><code>EventFragment</code></a>to the <a href=
      "#dfn-things" class="internalDFN" data-link-type=
      "dfn">Thing</a> object and updates the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a>. Throws on error. Returns a
      reference to the same object for supporting chaining.</p>
    </section>
    <section id="the-removeevent-method">
      <h3 id="x5-8-the-removeevent-method"><span class=
      "secno">5.8</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-removeevent"
      data-idl="operation" data-title="removeEvent()" data-type=
      "ExposedThing" data-lt=
      "exposedthing.removeevent()|exposedthing.removeevent|removeevent()|removeevent">
      <code>removeEvent()</code></dfn> method<a class="self-link"
      aria-label="§" href="#the-removeevent-method"></a></h3>
      <p>Removes the event specified by the <code>name</code>
      argument and updates the <a href="#dfn-thing-descriptions"
      class="internalDFN" data-link-type="dfn">Thing
      Description</a>. Returns a reference to the same object for
      supporting chaining.</p>
    </section>
    <section data-dfn-for="PropertyReadHandler" id=
    "the-propertyreadhandler-callback">
      <h3 id="x5-9-the-propertyreadhandler-callback"><span class=
      "secno">5.9</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-propertyreadhandler" data-idl="callback"
      data-title=
      "PropertyReadHandler"><code>PropertyReadHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-propertyreadhandler-callback"></a></h3>
      <p>A function that is called when an external request for
      reading a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> is received. It should
      return a Promise and resolves it with the value of the
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> matching the <code>name</code> argument to
      the <code>setPropertyReadHandler</code> function, or rejects
      with an error if the property is not found or the value
      cannot be retrieved.</p>
    </section>
    <section data-dfn-for="PropertyWriteHandler" id=
    "the-propertywritehandler-callback">
      <h3 id="x5-10-the-propertywritehandler-callback"><span class=
      "secno">5.10</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-propertywritehandler" data-idl="callback"
      data-title=
      "PropertyWriteHandler"><code>PropertyWriteHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-propertywritehandler-callback"></a></h3>
      <p>A function that is called when an external request for
      writing a <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> is received. It is given
      the requested new <code>value</code> as argument and should
      return a Promise which is resolved when the value of the
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> that matches the <code>name</code>
      argument has been updated with <code>value</code>, or rejects
      with an error if the property is not found or the value
      cannot be updated.</p>
      <div class="ednote" id="issue-container-generatedID-4">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-1" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">Note that this function is invoked by
        implementations before the property is updated and it
        actually defines what to do when a write request is
        received. The code in this callback function can invoke the
        <code>read()</code> method to find out the old value of the
        property, if needed. Therefore the old value is not
        provided to this function.</p>
      </div>
    </section>
    <section data-dfn-for="ActionHandler" id=
    "the-actionhandler-callback">
      <h3 id="x5-11-the-actionhandler-callback"><span class=
      "secno">5.11</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-actionhandler" data-idl="callback" data-title=
      "ActionHandler"><code>ActionHandler</code></dfn>
      callback<a class="self-link" aria-label="§" href=
      "#the-actionhandler-callback"></a></h3>
      <p>A function called with a <code>parameters</code>
      dictionary argument assembled by the <a href=
      "#dfn-wot-runtime" class="internalDFN" data-link-type=
      "dfn">WoT runtime</a> based on the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a> and the external client request.
      It returns a Promise that rejects with an error or resolves
      if the action is successful or ongoing (may also resolve with
      a control object such as an <a href="#dom-observable" class=
      "internalDFN" data-link-type=
      "dfn"><code>Observable</code></a> for actions that need
      progress notifications or that can be canceled).</p>
    </section>
    <section id="the-setpropertyreadhandler-method">
      <h3 id="x5-12-the-setpropertyreadhandler-method"><span class=
      "secno">5.12</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id=
      "dom-exposedthing-setpropertyreadhandler" data-idl=
      "operation" data-title="setPropertyReadHandler()" data-type=
      "ExposedThing" data-lt=
      "exposedthing.setpropertyreadhandler()|exposedthing.setpropertyreadhandler|setpropertyreadhandler()|setpropertyreadhandler">
      <code>setPropertyReadHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setpropertyreadhandler-method"></a></h3>
      <p>Takes <code>name</code> as string argument and
      <code>readHandler</code> as argument of type <a href=
      "#dom-propertyreadhandler" class="internalDFN"
      data-link-type="dfn"><code>PropertyReadHandler</code></a>.
      Sets the handler function for reading the specified <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> matched by <code>name</code>. Throws on
      error. Returns a reference to the same object for supporting
      chaining.</p>
      <p>The <code>readHandler</code> callback function will
      implement reading a <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> and
      <em class="rfc2119" title="SHOULD">SHOULD</em> be called by
      implementations when a request for reading a <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> is received from the underlying
      platform.</p>
      <p>There <em class="rfc2119" title="SHOULD">SHOULD</em> be at
      most one handler for any given <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a> and
      newly added handlers replace the old handlers. If no handler
      is initialized for any given <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a>,
      implementations <em class="rfc2119" title=
      "SHOULD">SHOULD</em> implement a default property read
      handler.</p>
      <p>When an external request for reading <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> <var>propertyName</var> is received, the
      runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
      execute the following steps:</p>
      <ol>
        <li>Return a <code>Promise</code> <a href="#dfn-promise"
        class="internalDFN" data-link-type="dfn">promise</a> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> with
        <var>propertyName</var> does not exist, reject <a href=
        "#dfn-promise" class="internalDFN" data-link-type=
        "dfn">promise</a> with a <code>ReferenceError</code> and
        terminate these steps.
        </li>
        <li>Otherwise, if no read handler has been defined for
        <var>propertyName</var>, resolve <var>promise</var> with
        the value of the <a href="#dfn-properties" class=
        "internalDFN" data-link-type="dfn">Property</a> named <var>
          propertyName</var> provided by the runtime implementation
          and terminate these steps.
        </li>
        <li>Otherwise, invoke the read handler associated with
        <var>propertyName</var>. If it rejects, then reject
        <var>promise</var> with the same error, and resolve
          <a href="#dfn-promise" class="internalDFN"
          data-link-type="dfn">promise</a> with the same value.
        </li>
      </ol>
    </section>
    <section id="the-setpropertywritehandler-method">
      <h3 id="x5-13-the-setpropertywritehandler-method">
      <span class="secno">5.13</span> The <dfn data-dfn-for=
      "exposedthing" data-dfn-type="dfn" id=
      "dom-exposedthing-setpropertywritehandler" data-idl=
      "operation" data-title="setPropertyWriteHandler()" data-type=
      "ExposedThing" data-lt=
      "exposedthing.setpropertywritehandler()|exposedthing.setpropertywritehandler|setpropertywritehandler()|setpropertywritehandler">
      <code>setPropertyWriteHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setpropertywritehandler-method"></a></h3>
      <p>Takes <code>name</code> as string argument and
      <code>writeHandler</code> as argument of type <a href=
      "#dom-propertywritehandler" class="internalDFN"
      data-link-type="dfn"><code>PropertyWriteHandler</code></a>.
      Sets the handler function for writing the specified <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> matched by <code>name</code>. Throws on
      error. Returns a reference to the same object for supporting
      chaining.</p>
      <p>There <em class="rfc2119" title="SHOULD">SHOULD</em> be at
      most one write handler for any given <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> and newly added handlers replace the old
      handlers. If no write handler is initialized for any given
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a>, implementations <em class="rfc2119"
      title="SHOULD">SHOULD</em> implement default property update
      and notifying observers on change.</p>
      <p>When an external request for writing a <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> <var>propertyName</var> with a new value
      <var>value</var> is received, the runtime <em class="rfc2119"
      title="SHOULD">SHOULD</em> execute the following steps:</p>
      <ol>
        <li>Return a <code>Promise</code> <a href="#dfn-promise"
        class="internalDFN" data-link-type="dfn">promise</a> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If a <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> with
        <var>propertyName</var> does not exist, reject <a href=
        "#dfn-promise" class="internalDFN" data-link-type=
        "dfn">promise</a> with a <code>ReferenceError</code> and
        terminate these steps.
        </li>
        <li>Otherwise, if no write handler has been defined for
        <var>propertyName</var>, the runtime implementation
        <em class="rfc2119" title="SHOULD">SHOULD</em> update the
        <a href="#dfn-properties" class="internalDFN"
        data-link-type="dfn">Property</a> value with
        <var>value</var>, resolve <var>promise</var> and terminate
        these steps.
        </li>
        <li>Otherwise, invoke the write handler associated with
        <var>propertyName</var> providing <var>value</var> as
        argument. If it rejects, then reject <var>promise</var>
        with the same error, and resolve <a href="#dfn-promise"
        class="internalDFN" data-link-type="dfn">promise</a> with
        the same value.
        </li>
      </ol>
    </section>
    <section id="the-setactionhandler-method">
      <h3 id="x5-14-the-setactionhandler-method"><span class=
      "secno">5.14</span> The <dfn data-dfn-for="exposedthing"
      data-dfn-type="dfn" id="dom-exposedthing-setactionhandler"
      data-idl="operation" data-title="setActionHandler()"
      data-type="ExposedThing" data-lt=
      "exposedthing.setactionhandler()|exposedthing.setactionhandler|setactionhandler()|setactionhandler">
      <code>setActionHandler()</code></dfn> method<a class=
      "self-link" aria-label="§" href=
      "#the-setactionhandler-method"></a></h3>
      <p>Takes <code>name</code> as string argument and
      <code>action</code> as argument of type <a href=
      "#dom-actionhandler" class="internalDFN" data-link-type=
      "dfn"><code>ActionHandler</code></a>. Sets the handler
      function for the specified <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> matched by
      <code>name</code>. Throws on error. Returns a reference to
      the same object for supporting chaining.</p>
      <p>The <code>action</code> callback function will implement
      an <a href="#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> and <em class="rfc2119" title=
      "SHOULD">SHOULD</em> be called by implementations when a
      request for invoking the <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> is received
      from the underlying platform.</p>
      <p>There <em class="rfc2119" title="SHOULD">SHOULD</em> be at
      most one handler for any given <a href="#dfn-actions" class=
      "internalDFN" data-link-type="dfn">Action</a> and newly added
      handlers replace the old handlers.</p>
      <p>When an external request for invoking the <a href=
      "#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> identified by <var>name</var> is received,
      the runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
      execute the following steps:</p>
      <ol>
        <li>Return a <code>Promise</code> <a href="#dfn-promise"
        class="internalDFN" data-link-type="dfn">promise</a> and
        execute the next steps <a href="#dfn-in-parallel" class=
        "internalDFN" data-link-type="dfn">in parallel</a>.
        </li>
        <li>If an <a href="#dfn-actions" class="internalDFN"
        data-link-type="dfn">Action</a> identified by
        <var>name</var> does not exist, reject <a href=
        "#dfn-promise" class="internalDFN" data-link-type=
        "dfn">promise</a> with a <code>ReferenceError</code> and
        terminate these steps.
        </li>
        <li>Otherwise, if no action handler has been defined for
        <var>name</var>, reject <a href="#dfn-promise" class=
        "internalDFN" data-link-type="dfn">promise</a> with a
        <code>ReferenceError</code> and terminate these steps.
        </li>
        <li>Otherwise, invoke the <a href="#dfn-actions" class=
        "internalDFN" data-link-type="dfn">Action</a> handler
        associated with <var>name</var>. If it rejects with
        <var>error</var>, then reject <var>promise</var> with the
        same <var>error</var>, otherwise if it resolves with <var>
          value</var>, then resolve <a href="#dfn-promise" class=
          "internalDFN" data-link-type="dfn">promise</a> with the
          same <var>value</var>.
        </li>
      </ol>
    </section>
    <section id="examples-1">
      <h3 id="x5-15-examples"><span class="secno">5.15</span>
      Examples<a class="self-link" aria-label="§" href=
      "#examples-1"></a></h3>
      <p>Below some <code><a href="#dom-exposedthing" class=
      "internalDFN" data-link-type=
      "dfn"><code>ExposedThing</code></a></code> interface examples
      are given.</p>
      <div class="example" id=
      "ex-5-create-a-new-exposed-thing-with-a-simple-property">
        <div class="marker">
          <a class="self-link" href=
          "#ex-5-create-a-new-exposed-thing-with-a-simple-property">
          Example 5</a><span class="example-title">: Create a new
          exposed Thing with a simple property</span>
        </div>
        <pre class="highlight hljs javascript" aria-busy="false">
        <span class="hljs-keyword">try</span> {
  <span class=
"hljs-keyword">var</span> temperatureValueDefinition = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
    <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">-50</span>,
    <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">10000</span>
  };
  <span class=
"hljs-keyword">var</span> temperaturePropertyDefinition = temperatureValueDefinition;
  <span class="hljs-comment">// add the 'forms' property</span>
  temperaturePropertyDefinition.forms = [ ... ];
  <span class="hljs-keyword">var</span> thing = WoT.produce({
    <span class="hljs-attr">name</span>: <span class=
"hljs-string">"tempSensor"</span>,
    <span class="hljs-attr">properties</span>: {
      <span class=
"hljs-attr">temperature</span>: temperaturePropertyDefinition
    },
    <span class="hljs-attr">actions</span>: {
      <span class="hljs-attr">reset</span>: {
        <span class="hljs-attr">description</span>: <span class=
"hljs-string">"Reset the temperature sensor"</span>,
        <span class="hljs-attr">input</span>: {
          <span class=
"hljs-attr">temperature</span>: temperatureValueDefinition
        },
        <span class="hljs-attr">output</span>: <span class=
"hljs-literal">null</span>,
        <span class="hljs-attr">forms</span>: []
      },
    },
    <span class="hljs-attr">events</span>: {
      <span class=
"hljs-attr">onchange</span>: temperatureValueDefinition
    },
    <span class="hljs-attr">links</span>: []
  });
  <span class="hljs-keyword">await</span> thing.expose();
  <span class="hljs-keyword">await</span> wot.register(<span class=
"hljs-string">"https://mydirectory.org"</span>, thing);
  <span class="hljs-comment">// define Thing business logic</span>
  setInterval( <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">let</span> mock = <span class=
"hljs-built_in">Math</span>.random()*<span class=
"hljs-number">100</span>;
    <span class="hljs-keyword">let</span> old = <span class=
"hljs-keyword">await</span> thing[<span class=
"hljs-string">"temperature"</span>].read();
    <span class="hljs-keyword">if</span> (old &lt; mock) {
      <span class="hljs-keyword">await</span> thing[<span class=
"hljs-string">"temperature"</span>].write(mock);
      thing.emitEvent(<span class=
"hljs-string">"onchange"</span>, mock);
    }
  }, <span class="hljs-number">1000</span>);
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</pre>
      </div>
      <div class="example" id=
      "ex-6-create-a-new-exposed-thing-with-object-property">
        <div class="marker">
          <a class="self-link" href=
          "#ex-6-create-a-new-exposed-thing-with-object-property">Example
          6</a><span class="example-title">: Create a new exposed
          Thing with object property</span>
        </div>
        <pre class="highlight hljs javascript" aria-busy="false">
        <span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">var</span> statusValueDefinition = {
    <span class="hljs-attr">type</span>: <span class=
"hljs-string">"object"</span>,
    <span class="hljs-attr">properties</span>: {
      <span class="hljs-attr">brightness</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
        <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">0.0</span>,
        <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">100.0</span>,
        <span class="hljs-attr">required</span>: <span class=
"hljs-literal">true</span>
      },
      <span class="hljs-attr">rgb</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"array"</span>,
        <span class="hljs-string">"minItems"</span>: <span class=
"hljs-number">3</span>,
        <span class="hljs-string">"maxItems"</span>: <span class=
"hljs-number">3</span>,
        <span class="hljs-attr">items</span> : {
            <span class="hljs-string">"type"</span> : <span class=
"hljs-string">"number"</span>,
            <span class=
"hljs-string">"minimum"</span>: <span class="hljs-number">0</span>,
            <span class=
"hljs-string">"maximum"</span>: <span class="hljs-number">255</span>
        }
      }
  };
  <span class=
"hljs-keyword">var</span> statusPropertyDefinition = statusValueDefinition;
  <span class="hljs-comment">// add the 'forms' property</span>
  statusPropertyDefinition[<span class=
"hljs-string">"forms"</span>] = [];
  <span class="hljs-keyword">var</span> thing = WoT.produce({
    <span class="hljs-attr">name</span>: <span class=
"hljs-string">"mySensor"</span>,
    <span class="hljs-attr">properties</span>: {
      <span class="hljs-attr">brightness</span>: {
        <span class="hljs-attr">type</span>: <span class=
"hljs-string">"number"</span>,
        <span class="hljs-attr">minimum</span>: <span class=
"hljs-number">0.0</span>,
        <span class="hljs-attr">maximum</span>: <span class=
"hljs-number">100.0</span>,
        <span class="hljs-attr">required</span>: <span class=
"hljs-literal">true</span>,
      },
      <span class=
"hljs-attr">status</span>: statusPropertyDefinition
    },
    <span class="hljs-attr">actions</span>: {
      <span class="hljs-attr">status</span>: {
        <span class="hljs-attr">description</span>: <span class=
"hljs-string">"Get status object"</span>,
        <span class="hljs-attr">input</span>: <span class=
"hljs-literal">null</span>,
        <span class="hljs-attr">output</span>: {
          <span class=
"hljs-attr">status</span> : statusValueDefinition;
        },
        <span class="hljs-attr">forms</span>: []
      },
    },
    <span class="hljs-attr">events</span>: {
      <span class=
"hljs-attr">onstatuschange</span>: statusValueDefinition;
    },
    <span class="hljs-attr">links</span>: []
  });
  thing.expose().then(<span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
      thing.register();
  });
} <span class="hljs-keyword">catch</span> (err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</pre>
      </div>
      <div class="example" id=
      "ex-7-create-a-new-exposed-thing-from-a-thing-description">
        <div class="marker">
          <a class="self-link" href=
          "#ex-7-create-a-new-exposed-thing-from-a-thing-description">
          Example 7</a><span class="example-title">: Create a new
          exposed Thing from a Thing Description</span>
        </div>
        <pre class="highlight hljs javascript" aria-busy="false">
        <span class=
        "hljs-keyword">let</span> thingDescription = <span class=
        "hljs-string">'{ \
  "name": "mySensor", \
  "@context": [ "http://www.w3.org/ns/td",\
     "https://w3c.github.io/wot/w3c-wot-common-context.jsonld" ],\
  "@type": [ "Thing", "Sensor" ], \
  "geo:location": "testspace", \
  "properties": { \
    "prop1": { \
      "type": "number",\
      "@type": [ "Property", "Temperature" ], \
      "saref:TemperatureUnit": "degree_Celsius" \
  } } }'</span>;
<span class="hljs-keyword">try</span> {
  <span class=
"hljs-comment">// note that produce() fails if thingDescription contains error</span>
  <span class=
"hljs-keyword">let</span> thing = WoT.produce(thingDescription);
  <span class=
"hljs-comment">// Interactions were added from TD</span>
  <span class=
"hljs-comment">// WoT adds generic handler for reading any property</span>
  <span class=
"hljs-comment">// define a specific handler for one property</span>
  <span class="hljs-keyword">let</span> name = <span class=
"hljs-string">"examplePropertyName"</span>;
  thing.setPropertyReadHandler(name, () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Handling read request for "</span> + name);
    <span class="hljs-keyword">return</span> <span class=
"hljs-keyword">new</span> <span class=
"hljs-built_in">Promise</span>(<span class=
"hljs-function">(<span class=
"hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class=
"hljs-keyword">let</span> examplePropertyValue = <span class=
"hljs-number">5</span>;
        resolve(examplePropertyValue);
      },
      e =&gt; {
        <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error"</span>);
      });
  });
  thing.expose();
} <span class="hljs-keyword">catch</span>(err) {
   <span class="hljs-built_in">console</span>.log(<span class=
"hljs-string">"Error creating ExposedThing: "</span> + err);
}</pre>
      </div>
      <div class="example" id=
      "ex-8-create-a-new-exposed-thing-from-a-td-uri">
        <div class="marker">
          <a class="self-link" href=
          "#ex-8-create-a-new-exposed-thing-from-a-td-uri">Example
          8</a><span class="example-title">: Create a new exposed
          Thing from a TD URI</span>
        </div>
        <pre class="highlight hljs javascript" aria-busy="false">
        <span class=
        "hljs-comment">// fetch an external TD, e.g., to set up a proxy for that Thing</span>
WoT.fetch(<span class=
"hljs-string">"http://myservice.org/mySensor/description"</span>).then(<span class="hljs-function"><span class="hljs-params">td</span> =&gt;</span> {
  <span class=
"hljs-comment">// WoT.produce() ignores instance-specific metadata (security, form)</span>
  <span class="hljs-keyword">let</span> thing = WoT.produce(td);
  <span class=
"hljs-comment">// Interactions were added from TD</span>
  <span class="hljs-comment">// add server functionality</span>
  <span class="hljs-comment">// ...</span>
});</pre>
      </div>
    </section>
  </section>
  <section data-dfn-for="TD-structures" id=
  "data-types-and-structures">
    <!--OddPage-->
    <h2 id="x6-data-types-and-structures"><span class=
    "secno">6.</span> Data types and structures<a class="self-link"
    aria-label="§" href="#data-types-and-structures"></a></h2>
    <p>The [<cite><a class="bibref" href=
    "#bib-wot-td">WOT-TD</a></cite>] specification defines the
    <a href=
    "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-vocabulary-definition">
    WoT information model</a>, i.e. the data types and data
    structures used in <a href="#dfn-wot-interactions" class=
    "internalDFN" data-link-type="dfn">WoT Interactions</a>. In
    this API these definitions translate to dictionary objects that
    are extended with methods by the interfaces defined in this
    specification.</p>
    <p>In order to avoid duplication of definitions, references to
    these data types and structures is defined in this section, but
    for their full description please refer to the <a href="">Thing
    Description specification</a>.</p>
    <section data-dfn-for="ValueTypes" id=
    "the-dataschema-dictionary-and-its-subclasses">
      <h3 id="x6-1-the-dataschema-dictionary-and-its-subclasses">
      <span class="secno">6.1</span> The <dfn data-dfn-for=""
      data-dfn-type="dfn" id="dom-dataschema" data-idl="typedef"
      data-title="DataSchema"><code>DataSchema</code></dfn>
      dictionary and its subclasses<a class="self-link" aria-label=
      "§" href=
      "#the-dataschema-dictionary-and-its-subclasses"></a></h3>
      <p>Value types basically represent types that may be used in
      <a href="#dfn-json" class="internalDFN" data-link-type=
      "dfn">JSON</a> object definitions and are used in <a href=
      "#dom-thingfragment" class="internalDFN" data-link-type=
      "dfn"><code>ThingFragment</code></a> to define <a href=
      "#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Properties</a>, <a href="#dfn-events" class=
      "internalDFN" data-link-type="dfn">Event</a>s and <a href=
      "#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> parameters. Value types are represented as
      dictionary objects whose properties and possible sub-classes
      are defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-data-schema-vocabulary-definition">
      DataSchema</a> section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>].</p>
      <p>One property of all <a href="#dom-dataschema" class=
      "internalDFN" data-link-type=
      "dfn"><code>DataSchema</code></a> dictionary is the
      <code>type</code> property whose value is from a set of
      enumerated strings defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#dataschema">DataSchema</a>
      section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>] and is referred as
      <dfn data-dfn-type="dfn" id="dfn-datatype">DataType</dfn> in
      this specification.</p>
      <p>Based on <code>type</code>, the following sub-classes of
      <a href="#dom-dataschema" class="internalDFN" data-link-type=
      "dfn"><code>DataSchema</code></a> are defined in
      [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>]: <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#booleanschema"><dfn data-dfn-type="dfn"
      id="dfn-booleanschema">BooleanSchema</dfn></a>, <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#numberschema"><dfn data-dfn-type="dfn"
      id="dfn-numberschema">NumberSchema</dfn></a>, <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#integerschema"><dfn data-dfn-type="dfn"
      id="dfn-integerschema">IntegerSchema</dfn></a>, <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#stringschema"><dfn data-dfn-type="dfn"
      id="dfn-stringschema">StringSchema</dfn></a>, <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#objectschema"><dfn data-dfn-type="dfn"
      id="dfn-objectschema">ObjectSchema</dfn></a>, <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#arrayschema"><dfn data-dfn-type="dfn"
      id="dfn-arrayschema">ArraySchema</dfn></a>.</p>
    </section>
    <section data-dfn-for="SecurityScheme" id=
    "the-securityscheme-dictionary-and-its-subclasses">
      <h3 id=
      "x6-2-the-securityscheme-dictionary-and-its-subclasses">
      <span class="secno">6.2</span> The <dfn data-dfn-for=""
      data-dfn-type="dfn" id="dom-securityscheme" data-idl=
      "typedef" data-title=
      "SecurityScheme"><code>SecurityScheme</code></dfn> dictionary
      and its subclasses<a class="self-link" aria-label="§" href=
      "#the-securityscheme-dictionary-and-its-subclasses"></a></h3>
      <p>Security metadata is represented as dictionary objects
      whose properties and sub-classes are defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#sec-security-vocabulary-definition">
      SecurityScheme</a> section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>].</p>
      <p>One property of the <a href="#dom-securityscheme" class=
      "internalDFN" data-link-type=
      "dfn"><code>SecurityScheme</code></a> dictionary is the
      <code>scheme</code> property whose value is from a set of
      enumerated strings defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#securityscheme">
      SecurityScheme</a> section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>]. Based on <code>type</code>,
      multiple subclasses of <a href="#dom-securityscheme" class=
      "internalDFN" data-link-type=
      "dfn"><code>SecurityScheme</code></a> are defined.</p>
    </section>
    <section data-dfn-for="Link" id="the-link-dictionary">
      <h3 id="x6-3-the-link-dictionary"><span class=
      "secno">6.3</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-link" data-idl="typedef" data-title=
      "Link"><code>Link</code></dfn> dictionary<a class="self-link"
      aria-label="§" href="#the-link-dictionary"></a></h3>
      <p>Represents a <a href=
      "https://tools.ietf.org/html/rfc8288">Web Link</a> with
      properties defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#link">Link</a>
      section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>].</p>
    </section>
    <section data-dfn-for="Form" id="the-form-dictionary">
      <h3 id="x6-4-the-form-dictionary"><span class=
      "secno">6.4</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-form" data-idl="typedef" data-title=
      "Form"><code>Form</code></dfn> dictionary<a class="self-link"
      aria-label="§" href="#the-form-dictionary"></a></h3>
      <p>Represents metadata describing service details, with
      properties defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#form">Form</a>
      section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>].</p>
    </section>
    <section data-dfn-for="InteractionFragment" id=
    "the-interactionfragment-dictionary">
      <h3 id="x6-5-the-interactionfragment-dictionary"><span class=
      "secno">6.5</span> The <code><dfn data-dfn-type="dfn" id=
      "dfn-interactionfragment">InteractionFragment</dfn></code>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-interactionfragment-dictionary"></a></h3>
      <p>Represents the common properties of <a href=
      "#dfn-wot-interactions" class="internalDFN" data-link-type=
      "dfn">WoT Interactions</a>, one of <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a>,
      <a href="#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> or <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn">Event</a>, as defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#interactionpattern">
      InteractionPattern</a> section of [<cite><a class="bibref"
      href="#bib-wot-td">WOT-TD</a></cite>]. Its subclasses are
      referred as <a href="#dom-propertyfragment" class=
      "internalDFN" data-link-type=
      "dfn"><code>PropertyFragment</code></a>, <a href=
      "#dom-actionfragment" class="internalDFN" data-link-type=
      "dfn"><code>ActionFragment</code></a> and <a href=
      "#dom-eventfragment" class="internalDFN" data-link-type=
      "dfn"><code>EventFragment</code></a>.</p>
    </section>
    <section data-dfn-for="PropertyFragment" id=
    "the-propertyfragment-dictionary">
      <h3 id="x6-6-the-propertyfragment-dictionary"><span class=
      "secno">6.6</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-propertyfragment" data-idl="typedef"
      data-title="PropertyFragment"><code>PropertyFragment</code></dfn>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-propertyfragment-dictionary"></a></h3>
      <p>Represents the <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> interaction
      data that initializes a <a href="#dom-thingproperty" class=
      "internalDFN" data-link-type=
      "dfn"><code>ThingProperty</code></a> object. Its properties
      are defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#property">Property</a>
      and <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#interactionpattern">
      InteractionPattern</a> sections of [<cite><a class="bibref"
      href="#bib-wot-td">WOT-TD</a></cite>].</p>
    </section>
    <section data-dfn-for="ActionFragment" id=
    "the-actionfragment-dictionary">
      <h3 id="x6-7-the-actionfragment-dictionary"><span class=
      "secno">6.7</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-actionfragment" data-idl="typedef" data-title=
      "ActionFragment"><code>ActionFragment</code></dfn>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-actionfragment-dictionary"></a></h3>
      <p>Represents the <a href="#dfn-actions" class="internalDFN"
      data-link-type="dfn">Action</a> interaction data that
      initializes a <a href="#dom-thingaction" class="internalDFN"
      data-link-type="dfn"><code>ThingAction</code></a> object. Its
      properties are defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#action">Action</a>
      and <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#interactionpattern">
      InteractionPattern</a> sections of [<cite><a class="bibref"
      href="#bib-wot-td">WOT-TD</a></cite>].</p>
    </section>
    <section data-dfn-for="EventFragment" id=
    "the-eventfragment-dictionary">
      <h3 id="x6-8-the-eventfragment-dictionary"><span class=
      "secno">6.8</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-eventfragment" data-idl="typedef" data-title=
      "EventFragment"><code>EventFragment</code></dfn>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-eventfragment-dictionary"></a></h3>
      <p>Represents the <a href="#dfn-events" class="internalDFN"
      data-link-type="dfn">Event</a> interaction data that
      initializes a <a href="#dom-thingevent" class="internalDFN"
      data-link-type="dfn"><code>ThingEvent</code></a> object. Its
      properties are defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#event">Event</a>
      section of [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>].</p>
    </section>
    <section data-dfn-for="ThingFragment" id=
    "the-thingfragment-dictionary">
      <h3 id="x6-9-the-thingfragment-dictionary"><span class=
      "secno">6.9</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-thingfragment" data-idl="typedef" data-title=
      "ThingFragment"><code>ThingFragment</code></dfn>
      dictionary<a class="self-link" aria-label="§" href=
      "#the-thingfragment-dictionary"></a></h3>
      <p>The <a href="#dom-thingfragment" class="internalDFN"
      data-link-type="dfn"><code>ThingFragment</code></a>
      dictionary is defined as <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/#thing"><b>Thing</b></a>
      in [<cite><a class="bibref" href=
      "#bib-wot-td">WOT-TD</a></cite>]. It is a dictionary that
      contains properties representing semantic metadata and
      interactions (<a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Properties</a>, <a href="#dfn-actions"
      class="internalDFN" data-link-type="dfn">Action</a>s and
      <a href="#dfn-events" class="internalDFN" data-link-type=
      "dfn">Event</a>s). It is used for initializing an internal
      representation of a <a href="#dfn-thing-descriptions" class=
      "internalDFN" data-link-type="dfn">Thing Description</a> and
      its properties may be used in <a href="#dom-thingfilter"
      class="internalDFN" data-link-type=
      "dfn"><code>ThingFilter</code></a>.</p>
    </section>
    <section data-dfn-for="ThingDescription" id=
    "the-thingdescription-type">
      <h3 id="x6-10-the-thingdescription-type"><span class=
      "secno">6.10</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-thingdescription" data-idl="typedef"
      data-title="ThingDescription"><code>ThingDescription</code></dfn>
      type<a class="self-link" aria-label="§" href=
      "#the-thingdescription-type"></a></h3>
      <p>Serialized representation of the <a href=
      "#dfn-thing-descriptions" class="internalDFN" data-link-type=
      "dfn">Thing Description</a> (a <a href="#dfn-json-ld" class=
      "internalDFN" data-link-type="dfn">JSON-LD</a> document).</p>
      <div class="note" id="issue-container-generatedID-5">
        <div role="heading" class="note-title marker" id="h-note-2"
        aria-level="4">
          <span>Note</span>
        </div>
        <p class="">In this version of the API, <a href=
        "#dfn-thing-descriptions" class="internalDFN"
        data-link-type="dfn">Thing Description</a>s are represented
        as an opaque <code>USVString</code> that can be transmitted
        between devices.</p>
      </div>
    </section>
  </section>
  <section id="interfaces-for-wot-interactions">
    <!--OddPage-->
    <h2 id="x7-interfaces-for-wot-interactions"><span class=
    "secno">7.</span> Interfaces for <a href=
    "#dfn-wot-interactions" class="internalDFN" data-link-type=
    "dfn">WoT Interactions</a><a class="self-link" aria-label="§"
    href="#interfaces-for-wot-interactions"></a></h2>
    <p>The data types and structures imported from [<cite><a class=
    "bibref" href="#bib-wot-td">WOT-TD</a></cite>] are extended by
    this specification in order to provide the interfaces for
    <a href="#dfn-wot-interactions" class="internalDFN"
    data-link-type="dfn">WoT Interactions</a>.</p>
    <p>Every <a href="#dfn-things" class="internalDFN"
    data-link-type="dfn">Thing</a> describes its metadata as
    defined in <a href="#dom-thingfragment" class="internalDFN"
    data-link-type="dfn"><code>ThingFragment</code></a>, and basic
    interactions defined as <a href="#dfn-properties" class=
    "internalDFN" data-link-type="dfn">Properties</a>, <a href=
    "#dfn-actions" class="internalDFN" data-link-type=
    "dfn">Action</a>s and <a href="#dfn-events" class="internalDFN"
    data-link-type="dfn">Event</a>s. The following interfaces are
    used for representing these interactions.</p>
    <section data-dfn-for="Interaction" id=
    "the-interaction-interface">
      <h3 id="x7-1-the-interaction-interface"><span class=
      "secno">7.1</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-interaction" data-idl="interface" data-title=
      "Interaction"><code>Interaction</code></dfn>
      interface<a class="self-link" aria-label="§" href=
      "#the-interaction-interface"></a></h3>
      <p>The <a href="#dom-interaction" class="internalDFN"
      data-link-type="dfn"><code>Interaction</code></a> interface
      is an abstract class to represent <a href="#dfn-things"
      class="internalDFN" data-link-type="dfn">Thing</a>
      interactions: <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Properties</a>, <a href="#dfn-actions"
      class="internalDFN" data-link-type="dfn">Actions</a> and
      <a href="#dfn-events" class="internalDFN" data-link-type=
      "dfn">Events</a>.</p>
      <p>The <a href="#dfn-interactionfragment" class="internalDFN"
      data-link-type="dfn"><code>InteractionFragment</code></a>
      dictionary holds the common properties of <a href=
      "#dom-propertyfragment" class="internalDFN" data-link-type=
      "dfn"><code>PropertyFragment</code></a>, <a href=
      "#dom-actionfragment" class="internalDFN" data-link-type=
      "dfn"><code>ActionFragment</code></a> and <a href=
      "#dom-eventfragment" class="internalDFN" data-link-type=
      "dfn"><code>EventFragment</code></a> dictionaries used for
      initializing <a href="#dom-thingproperty" class="internalDFN"
      data-link-type="dfn"><code>ThingProperty</code></a>, <a href=
      "#dom-thingaction" class="internalDFN" data-link-type=
      "dfn"><code>ThingAction</code></a> and <a href=
      "#dom-thingevent" class="internalDFN" data-link-type=
      "dfn"><code>ThingEvent</code></a> objects in a <a href=
      "#dom-thingfragment" class="internalDFN" data-link-type=
      "dfn"><code>ThingFragment</code></a> dictionary used for
      creating an <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="dfn"><code>ExposedThing</code></a>
      object.</p>
      <div>
        <pre class="def idl"><span class="idlInterface" id=
        "idl-def-interaction" data-idl="" data-title=
        "Interaction">interface <span class=
        "idlInterfaceID"><a data-no-default="" data-link-for=""
        data-lt="" href="#dom-interaction" class="internalDFN"
        data-link-type=
        "dfn"><code>Interaction</code></a></span> {<span class=
        "idlAttribute" id="idl-def-interaction-forms" data-idl=""
        data-title="forms" data-dfn-for="interaction">
  readonly attribute<span class="idlAttrType"> (<a data-link-for=""
href="#dom-form" class="internalDFN" data-link-type=
"dfn"><code>Form</code></a> or <a href=
"https://heycam.github.io/webidl/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-for=""
href="#dom-form" class="internalDFN" data-link-type=
"dfn"><code>Form</code></a>&gt;)</span> <span class=
"idlAttrName"><a data-no-default="" data-link-for="interaction"
data-lt="interaction.forms|forms" href="#dom-interaction-forms"
class="internalDFN" data-link-type=
"dfn"><code>forms</code></a></span>;</span>
};</span><span class="idlIncludes">
<a href="#dom-interaction" class="internalDFN" data-link-type=
"dfn"><code>Interaction</code></a> includes <a href=
"#dfn-interactionfragment" class="internalDFN" data-link-type=
"dfn"><code>InteractionFragment</code></a>;</span></pre>
      </div>
      <p>The <dfn data-dfn-for="interaction" data-dfn-type="dfn"
      id="dom-interaction-forms" data-idl="attribute" data-title=
      "forms" data-type="Form|FrozenArray" data-lt=
      "interaction.forms|forms"><code>forms</code></dfn> read-only
      property represents the protocol bindings initialization data
      and is initialized by the <a href="#dfn-wot-runtime" class=
      "internalDFN" data-link-type="dfn">WoT Runtime</a>.</p>
    </section>
    <section data-dfn-for="ThingProperty" id=
    "the-thingproperty-interface">
      <h3 id="x7-2-the-thingproperty-interface"><span class=
      "secno">7.2</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-thingproperty" data-idl="interface" data-title=
      "ThingProperty"><code>ThingProperty</code></dfn>
      interface<a class="self-link" aria-label="§" href=
      "#the-thingproperty-interface"></a></h3>
      <p>The <a href="#dom-thingproperty" class="internalDFN"
      data-link-type="dfn"><code>ThingProperty</code></a> interface
      is used in <a href="#dom-consumedthing" class="internalDFN"
      data-link-type="dfn"><code>ConsumedThing</code></a> and
      <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="dfn"><code>ExposedThing</code></a> objects to
      represent <a href="#dfn-things" class="internalDFN"
      data-link-type="dfn">Thing</a> <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a>
      interactions.</p>
      <p>The <a href="#dom-propertyfragment" class="internalDFN"
      data-link-type="dfn"><code>PropertyFragment</code></a>
      dictionary is used for initializing <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a> objects
      in a <a href="#dom-thingfragment" class="internalDFN"
      data-link-type="dfn"><code>ThingFragment</code></a>
      dictionary used for creating an <a href="#dom-exposedthing"
      class="internalDFN" data-link-type=
      "dfn"><code>ExposedThing</code></a> object. It <em class=
      "rfc2119" title="MUST">MUST</em> implement one of the
      <a href="#dom-dataschema" class="internalDFN" data-link-type=
      "dfn"><code>DataSchema</code></a> dictionaries.</p>
      <div>
        <pre class="def idl"><span class="idlInterface" id=
        "idl-def-thingproperty" data-idl="" data-title=
        "ThingProperty">interface <span class=
        "idlInterfaceID"><a data-no-default="" data-link-for=""
        data-lt="" href="#dom-thingproperty" class="internalDFN"
        data-link-type=
        "dfn"><code>ThingProperty</code></a></span> : <span class=
        "idlSuperclass"><a href="#dom-interaction" class=
        "internalDFN" data-link-type=
        "dfn"><code>Interaction</code></a></span> {<span class=
        "idlMethod" id="idl-def-thingproperty--name" data-idl=""
        data-title="" data-dfn-for="thingproperty"><span class=
        "idlSectionComment">
  // getter for PropertyFragment properties
  </span>getter<span class="idlMethType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span><span class="idlMethod"
id="idl-def-thingproperty-read" data-idl="" data-title="read"
data-dfn-for="thingproperty"><span class="idlMethType"><span class=
"idlSectionComment">
  // get and set interface for the Property
  </span><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="thingproperty" data-lt=
"thingproperty.read()|thingproperty.read|read()|read" href=
"#dom-thingproperty-read" class="internalDFN" data-link-type=
"dfn"><code>read</code></a></span>();</span><span class="idlMethod"
id="idl-def-thingproperty-write-value" data-idl="" data-title=
"write" data-dfn-for="thingproperty"><span class="idlMethType">
  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="thingproperty" data-lt=
"thingproperty.write()|thingproperty.write|write()|write" href=
"#dom-thingproperty-write" class="internalDFN" data-link-type=
"dfn"><code>write</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span>
};</span><span class="idlIncludes">
<a href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a> includes <a href=
"#dom-propertyfragment" class="internalDFN" data-link-type=
"dfn"><code>PropertyFragment</code></a>;</span><span class=
"idlIncludes">
<a href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a> includes <a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn"><code>Observable</code></a>;</span></pre>
      </div>
      <p>The <a href="#dom-thingproperty" class="internalDFN"
      data-link-type="dfn"><code>ThingProperty</code></a> interface
      contains all the properties defined on <a href=
      "#dom-propertyfragment" class="internalDFN" data-link-type=
      "dfn"><code>PropertyFragment</code></a> as read-only
      properties.</p>
      <p>The <dfn data-dfn-type="dfn" id="dfn-type">type</dfn>
      read-only property represents the type definition for the
      <a href="#dfn-properties" class="internalDFN" data-link-type=
      "dfn">Property</a> as a <a href="#dom-dataschema" class=
      "internalDFN" data-link-type=
      "dfn"><code>DataSchema</code></a> dictionary object.</p>
      <p>The <dfn data-dfn-type="dfn" id=
      "dfn-writable">writable</dfn> read-only property tells
      whether the <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> value can be updated. If it
      is <code>false</code>, then the <code>set(value)</code>
      method <em class="rfc2119" title="SHOULD">SHOULD</em> always
      reject.</p>
      <p>The <strong><em>observable</em></strong> read-only
      property tells whether the <a href="#dfn-properties" class=
      "internalDFN" data-link-type="dfn">Property</a> supports
      subscribing to value change notifications. If it is
      <code>false</code>, then the <code>subscribe()</code> method
      <em class="rfc2119" title="SHOULD">SHOULD</em> always
      fail.</p>
      <p>The <strong><em>constant</em></strong> read-only property
      - defined in <a href="#dom-dataschema" class="internalDFN"
      data-link-type="dfn"><code>DataSchema</code></a> - tells
      whether the <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> value is a constant. If
      <code>true</code>, the <code>set()</code> and
      <code>subscribe()</code> methods <em class="rfc2119" title=
      "SHOULD">SHOULD</em> always fail.</p>
      <p>The <strong><em>required</em></strong> read-only property
      - defined in <a href="#dom-dataschema" class="internalDFN"
      data-link-type="dfn"><code>DataSchema</code></a> - tells
      whether the <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a> should be always present on
      the <a href="#dom-exposedthing" class="internalDFN"
      data-link-type="dfn"><code>ExposedThing</code></a>
      object.</p>
      <p>The <dfn data-dfn-for="thingproperty" data-dfn-type="dfn"
      id="dom-thingproperty-read" data-idl="operation" data-title=
      "read()" data-type="Promise" data-lt=
      "thingproperty.read()|thingproperty.read|read()|read"><code>read()</code></dfn>
      method will fetch the value of the <a href="#dfn-properties"
      class="internalDFN" data-link-type="dfn">Property</a>.
      Returns a <a href="#dfn-promise" class="internalDFN"
      data-link-type="dfn">Promise</a> that resolves with the
      value, or rejects with an error.</p>
      <p>The <dfn data-dfn-for="thingproperty" data-dfn-type="dfn"
      id="dom-thingproperty-write" data-idl="operation" data-title=
      "write()" data-type="Promise" data-lt=
      "thingproperty.write()|thingproperty.write|write()|write"><code>
      write()</code></dfn> method will attempt to set the value of
      the <a href="#dfn-properties" class="internalDFN"
      data-link-type="dfn">Property</a>specified in the
      <code>value</code> argument whose type <em class="rfc2119"
      title="SHOULD">SHOULD</em> match the one specified by the
      <code>type</code> property. Returns a <a href="#dfn-promise"
      class="internalDFN" data-link-type="dfn">Promise</a> that
      resolves on success, or rejects on an error.</p>
    </section>
    <section data-dfn-for="ThingAction" id=
    "the-thingaction-interface">
      <h3 id="x7-3-the-thingaction-interface"><span class=
      "secno">7.3</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-thingaction" data-idl="interface" data-title=
      "ThingAction"><code>ThingAction</code></dfn>
      interface<a class="self-link" aria-label="§" href=
      "#the-thingaction-interface"></a></h3>
      <div>
        <pre class="def idl"><span class="idlInterface" id=
        "idl-def-thingaction" data-idl="" data-title=
        "ThingAction">interface <span class=
        "idlInterfaceID"><a data-no-default="" data-link-for=""
        data-lt="" href="#dom-thingaction" class="internalDFN"
        data-link-type=
        "dfn"><code>ThingAction</code></a></span> : <span class=
        "idlSuperclass"><a href="#dom-interaction" class=
        "internalDFN" data-link-type=
        "dfn"><code>Interaction</code></a></span> {<span class=
        "idlMethod" id="idl-def-thingaction-invoke-inputvalue"
        data-idl="" data-title="invoke" data-dfn-for=
        "thingaction"><span class="idlMethType">
  <a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="thingaction" data-lt=
"thingaction.invoke()|thingaction.invoke|invoke()|invoke" href=
"#dom-thingaction-invoke" class="internalDFN" data-link-type=
"dfn"><code>invoke</code></a></span>(<span class=
"idlParam">optional<span class="idlParamType"> <a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">inputValue</span></span>);</span>
};</span><span class="idlIncludes">
<a href="#dom-thingaction" class="internalDFN" data-link-type=
"dfn"><code>ThingAction</code></a> includes <a href=
"#dom-actionfragment" class="internalDFN" data-link-type=
"dfn"><code>ActionFragment</code></a>;</span></pre>
      </div>
      <p>The <dfn data-dfn-for="thingaction" data-dfn-type="dfn"
      id="dom-thingaction-invoke" data-idl="operation" data-title=
      "invoke()" data-type="Promise" data-lt=
      "thingaction.invoke()|thingaction.invoke|invoke()|invoke"><code>
      invoke()</code></dfn> method when invoked, starts the
      <a href="#dfn-actions" class="internalDFN" data-link-type=
      "dfn">Action</a> interaction with the input value provided by
      the <var>inputValue</var> argument. If <var>inputValue</var>
      is <code>null</code>, the action does not take any arguments
      and rejects if any arguments are provided. If the value is
      <code>undefined</code>, the action will ignore any arguments
      provided. Otherwise the type of <var>inputValue</var>
      <em class="rfc2119" title="SHOULD">SHOULD</em> match the
      <a href="#dom-dataschema" class="internalDFN" data-link-type=
      "dfn"><code>DataSchema</code></a> definition in the
      <code>input</code> property. Returns a <a href="#dfn-promise"
      class="internalDFN" data-link-type="dfn">Promise</a> that
      will reject with an error or will resolve with a value of
      type defined by the <code>output</code> property.</p>
    </section>
    <section data-dfn-for="ThingEvent" id=
    "the-thingevent-interface">
      <h3 id="x7-4-the-thingevent-interface"><span class=
      "secno">7.4</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-thingevent" data-idl="interface" data-title=
      "ThingEvent"><code>ThingEvent</code></dfn> interface<a class=
      "self-link" aria-label="§" href=
      "#the-thingevent-interface"></a></h3>
      <div>
        <pre class="def idl"><span class="idlInterface" id=
        "idl-def-thingevent" data-idl="" data-title=
        "ThingEvent">interface <span class=
        "idlInterfaceID"><a data-no-default="" data-link-for=""
        data-lt="" href="#dom-thingevent" class="internalDFN"
        data-link-type=
        "dfn"><code>ThingEvent</code></a></span> : <span class=
        "idlSuperclass"><a href="#dom-interaction" class=
        "internalDFN" data-link-type=
        "dfn"><code>Interaction</code></a></span> {
};</span><span class="idlIncludes">
<a href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a> includes <a href=
"#dom-eventfragment" class="internalDFN" data-link-type=
"dfn"><code>EventFragment</code></a>;</span><span class=
"idlIncludes">
<a href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a> includes <a href=
"#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a>;</span></pre>
      </div>
      <p>Since <a href="#dom-thingevent" class="internalDFN"
      data-link-type="dfn"><code>ThingEvent</code></a> implements
      <a href="#dom-observable" class="internalDFN" data-link-type=
      "dfn"><code>Observable</code></a> through the <a href=
      "#dom-thingproperty" class="internalDFN" data-link-type=
      "dfn"><code>ThingProperty</code></a> interface, event
      subscription is done by invoking the <code>subscribe()</code>
      method on the event object that returns a cancelable <a href=
      "#dom-subscription" class="internalDFN" data-link-type=
      "dfn"><code>Subscription</code></a>.</p>
    </section>
    <section data-dfn-for="ExposedEvent" id=
    "the-exposedevent-interface">
      <h3 id="x7-5-the-exposedevent-interface"><span class=
      "secno">7.5</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-exposedevent" data-idl="interface" data-title=
      "ExposedEvent"><code>ExposedEvent</code></dfn>
      interface<a class="self-link" aria-label="§" href=
      "#the-exposedevent-interface"></a></h3>
      <div>
        <pre class="def idl"><span class="idlInterface" id=
        "idl-def-exposedevent" data-idl="" data-title=
        "ExposedEvent">interface <span class=
        "idlInterfaceID"><a data-no-default="" data-link-for=""
        data-lt="" href="#dom-exposedevent" class="internalDFN"
        data-link-type=
        "dfn"><code>ExposedEvent</code></a></span> : <span class=
        "idlSuperclass"><a href="#dom-thingevent" class=
        "internalDFN" data-link-type=
        "dfn"><code>ThingEvent</code></a></span> {<span class=
        "idlMethod" id="idl-def-exposedevent-emit-payload" data-idl=
        "" data-title="emit" data-dfn-for=
        "exposedevent"><span class="idlMethType">
  void</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedevent" data-lt=
"exposedevent.emit()|exposedevent.emit|emit()|emit" href=
"#dom-exposedevent-emit" class="internalDFN" data-link-type=
"dfn"><code>emit</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">payload</span></span>);</span>
};</span></pre>
      </div>
      <section id="the-emit-method">
        <h4 id="x7-5-1-the-emit-method"><span class=
        "secno">7.5.1</span> The <dfn data-dfn-for="exposedevent"
        data-dfn-type="dfn" id="dom-exposedevent-emit" data-idl=
        "operation" data-title="emit()" data-type="void" data-lt=
        "exposedevent.emit()|exposedevent.emit|emit()|emit"><code>emit()</code></dfn>
        method<a class="self-link" aria-label="§" href=
        "#the-emit-method"></a></h4>
        <p>Emits an event that carries data specified by the
        <code>payload</code> argument.</p>
      </section>
    </section>
    <section id="the-value-matching-algorithm">
      <h3 id="x7-6-the-value-matching-algorithm"><span class=
      "secno">7.6</span> The <dfn data-dfn-type="dfn" id=
      "dfn-value-matching-algorithm">value-matching
      algorithm</dfn><a class="self-link" aria-label="§" href=
      "#the-value-matching-algorithm"></a></h3>
      <p>The value-matching algorithm is applied to a
      <var>value</var> input in relation to a <var>valueType</var>
      property of type <a href="#dom-dataschema" class=
      "internalDFN" data-link-type=
      "dfn"><code>DataSchema</code></a>, for instance the
      <code>value</code> and <code>type</code> properties of a
      <a href="#dom-propertyfragment" class="internalDFN"
      data-link-type="dfn"><code>PropertyFragment</code></a>
      object, or the <var>inputValue</var> parameter to the
      <code>invoke()</code> method of a <a href="#dom-thingaction"
      class="internalDFN" data-link-type=
      "dfn"><code>ThingAction</code></a> object in relation to the
      same object. It executes the following steps:</p>
      <ol>
        <li>If <var>valueType.type</var> is not defined, or does
        not fully match a string enumerated in <a href=
        "#dfn-datatype" class="internalDFN" data-link-type=
        "dfn">DataType</a>, return <code>false</code>.
        </li>
        <li>Otherwise, if <var>valueType.type</var> is
        <code>"null"</code>: if <var>value</var> is
        <code>null</code>, return <code>true</code>, otherwise
        return <code>false</code>.</li>
        <li>Otherwise, if <var>valueType.type</var> is
        <code>"boolean"</code>: if <var>value</var> is either
        <code>true</code> or <code>false</code>, then return
        <code>true</code>, otherwise return
        <code>false</code>.</li>
        <li>Otherwise, if <var>valueType.type</var> is
        <code>"integer"</code>: if <var>value</var> is not an
        integer type defined by the underlying platform (such as
        <code>long</code> or <code>long long</code>), then return
        <code>false</code>, otherwise execute the following
        sub-steps:
          <ol>
            <li>If <var>valueType.minimum</var> is defined and
            <var>value</var> is not greater or equal than that
            value, return <var>false</var>.</li>
            <li>If <var>valueType.maximum</var> is defined and
            <var>value</var> is not less or equal than that value,
            return <var>false</var>.</li>
            <li>Return <code>true</code>.</li>
          </ol>
        </li>
        <li>Otherwise, if <var>valueType.type</var> is
        <code>"number"</code>, if <var>value</var> is not an
        integer or floating point type defined by the underlying
        platform (such as <code>long</code> or <code>long
        long</code> or <code>double</code>), then return
        <code>false</code>, otherwise otherwise execute the
        following sub-steps:
          <ol>
            <li>If <var>valueType.minimum</var> is defined and
            <var>value</var> is not greater or equal than that
            value, return <var>false</var>.</li>
            <li>If <var>valueType.maximum</var> is defined and
            <var>value</var> is not less or equal than that value,
            return <var>false</var>.</li>
            <li>Return <code>true</code>.</li>
          </ol>
        </li>
        <li>Otherwise, if <var>valueType.type</var> is
        <code>"string"</code>: if <var>value</var> is not a string
        type defined by the underlying platform, then return <code>
          false</code>, otherwise return <code>true</code>. In this
          case the algorithm expects a third parameter
          <var>valueType.enum</var> and runs the following
          sub-steps:
          <ul>
            <li>If <var>valueType.enum</var> is an array of
            strings, then if <var>value</var> fully matches one of
            the strings defined in the array, return
            <var>true</var>.</li>
            <li>Otherwise, return <var>false</var>.</li>
          </ul>
        </li>
        <li>Otherwise, if <var>valueType.type</var> is
        <code>"array"</code>, execute the following sub-steps:
          <ol>
            <li>If <var>value</var> is not an array, return
            <code>false</code>.</li>
            <li>If <var>valueType.minItems</var> is defined, and
            <var>value</var> does not contain at least
            <var>valueType.minItems</var> elements, return
            <var>false</var>.</li>
            <li>If <var>valueType.maxItems</var> is defined, and
            <var>value</var> contains more than
            <var>valueType.maxItems</var> elements, return
            <var>false</var>.</li>
            <li>Otherwise, if <var>valueType.items</var> is
            <code>undefined</code>, return <code>false</code>.</li>
            <li>Otherwise, if <var>valueType.items</var> is
            <code>null</code>, return <code>true</code> (i.e. any
            type is accepted as array element, including
            heterogenous arrays).</li>
            <li>Otherwise, for each element of the array
            <var>value</var> run the <a href=
            "#dfn-value-matching-algorithm" class="internalDFN"
            data-link-type="dfn">value-matching algorithm</a>
            against the <var>valueType.items</var> object. If any
            of these runs returns <code>false</code>, then return
            <code>false</code>.
            </li>
            <li>Otherwise, return <code>true</code>.</li>
          </ol>
        </li>
        <li>Otherwise, if <var>type</var> is <code>"object"</code>,
        execute the following sub-steps:
          <ol>
            <li>If <var>value</var> is not an <code>Object</code>,
            return <code>false</code>.</li>
            <li>If <var>valueType.properties</var> is not defined,
            return <code>false</code>.</li>
            <li>If <var>valueType.properties</var> is
            <code>null</code>, return <code>true</code> (i.e.
            accept any object value).</li>
            <li>For each string in the
            <var>valueType.required</var> array, if it does not
            match a property name in the
            <var>value.properties</var> object or in the
            <var>value</var> object, then return
            <code>false</code>.</li>
            <li>For each property with name <var>propName</var> and
            value <var>propDataSchema</var> found in
            <var>valueType.properties</var>, run the following
            sub-steps:
              <ol>
                <li>If the result of applying the <a href=
                "#dfn-value-matching-algorithm" class="internalDFN"
                  data-link-type="dfn">value-matching algorithm</a>
                  on the value <var>value[propName]</var> and
                  <var>propDataSchema</var> is <var>false</var>,
                  then return <var>false</var>.
                </li>
              </ol>
            </li>
            <li>Return <code>true</code>.</li>
          </ol>
        </li>
      </ol>
    </section>
  </section>
  <section data-dfn-for="Observable" class="informative" id=
  "observables">
    <!--OddPage-->
    <h2 id="x8-observables"><span class="secno">8.</span>
    Observables<a class="self-link" aria-label="§" href=
    "#observables"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p><dfn data-dfn-type="dfn" id=
    "dfn-observables">Observables</dfn> are <a href=
    "https://github.com/tc39/proposal-observable">proposed</a> to
    be included in ECMAScript and are used for handling pushed data
    associated with various possible sources, for instance events,
    timers, streams, etc. A minimal required implementation is
    described here.</p>
    <div class="ednote" id="issue-container-generatedID-6">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-2" aria-level="3">
        <span>Editor's note</span>
      </div>
      <p class="">This section is informal and contains rather
      laconic information for implementations on what to support
      for interoperability.</p>
    </div>
    <div>
      <pre class="def idl"><span class="idlInterface" id=
      "idl-def-observable" data-idl="" data-title=
      "Observable">interface <span class=
      "idlInterfaceID"><a data-no-default="" data-link-for=""
      data-lt="" href="#dom-observable" class="internalDFN"
      data-link-type=
      "dfn"><code>Observable</code></a></span> {<span class=
      "idlMethod" id=
      "idl-def-observable-subscribe-handler-errorhandler-oncomplete"
      data-idl="" data-title="subscribe" data-dfn-for=
      "observable"><span class="idlMethType">
  <a data-link-for="" href="#dom-subscription" class="internalDFN"
data-link-type=
"dfn"><code>Subscription</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="observable"
data-lt="subscribe|subscribe()" href="#dom-observable-subscribe"
class="internalDFN" data-link-type=
"dfn"><code>subscribe</code></a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://html.spec.whatwg.org/multipage/#eventhandler">EventHandler</a></span> <span class="idlParamName">handler</span></span>,<span class="idlParam">
                         optional<span class=
"idlParamType"> <a data-link-for="" href="#dom-errorhandler" class=
"internalDFN" data-link-type=
"dfn"><code>ErrorHandler</code></a></span> <span class=
"idlParamName">errorHandler</span></span>,<span class="idlParam">
                         optional<span class=
"idlParamType"> <a data-link-for="" href="#dom-oncomplete" class=
"internalDFN" data-link-type=
"dfn"><code>OnComplete</code></a></span> <span class=
"idlParamName">onComplete</span></span>);</span>
};</span><span class="idlInterface" id="idl-def-subscription"
data-idl="" data-title="Subscription">
interface <span class="idlInterfaceID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-subscription" class=
"internalDFN" data-link-type=
"dfn"><code>Subscription</code></a></span> {<span class="idlMethod"
id="idl-def-subscription-unsubscribe" data-idl="" data-title=
"unsubscribe" data-dfn-for="subscription"><span class=
"idlMethType">
  void</span> <span class="idlMethName"><a data-no-default=""
data-link-for="subscription" data-lt="unsubscribe|unsubscribe()"
href="#dom-subscription-unsubscribe" class="internalDFN"
data-link-type=
"dfn"><code>unsubscribe</code></a></span>();</span><span class=
"idlAttribute" id="idl-def-subscription-closed" data-idl=""
data-title="closed" data-dfn-for="subscription">
  readonly attribute<span class="idlAttrType"> <a href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="subscription" data-lt="subscription.closed|closed"
href="#dom-subscription-closed" class="internalDFN" data-link-type=
"dfn"><code>closed</code></a></span>;</span>
};</span><span class="idlCallback" id="idl-def-eventhandler"
data-idl="" data-title="EventHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-eventhandler" class=
"internalDFN" data-link-type=
"dfn"><code>EventHandler</code></a></span> =<span class=
"idlCallbackType"> void</span> (<span class="idlParam"><span class=
"idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span><span class="idlCallback"
id="idl-def-errorhandler" data-idl="" data-title="ErrorHandler">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-errorhandler" class=
"internalDFN" data-link-type=
"dfn"><code>ErrorHandler</code></a></span> =<span class=
"idlCallbackType"> void</span> (<span class="idlParam"><span class=
"idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-Error">Error</a></span> <span class="idlParamName">error</span></span>);</span><span class="idlCallback"
id="idl-def-oncomplete" data-idl="" data-title="OnComplete">
callback <span class="idlCallbackID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-oncomplete" class=
"internalDFN" data-link-type=
"dfn"><code>OnComplete</code></a></span> =<span class=
"idlCallbackType"> void</span> ();</span></pre>
    </div>
    <p>The following callbacks can be provided when subscribing to
    an <a href="#dom-observable" class="internalDFN"
    data-link-type="dfn"><code>Observable</code></a>:</p>
    <ul>
      <li>The <dfn data-dfn-for="" data-dfn-type="dfn" id=
      "dom-eventhandler" data-idl="callback" data-title=
      "EventHandler"><code>EventHandler</code></dfn> callback takes
      the next sample for the data in the <code>value</code>
      argument.</li>
      <li>The <dfn data-dfn-for="" data-dfn-type="dfn" id=
      "dom-errorhandler" data-idl="callback" data-title=
      "ErrorHandler"><code>ErrorHandler</code></dfn> callback takes
      an error in the <code>value</code> argument. It is called
      when an error occurred in producing the data the client should
      know about.</li>
      <li>The <dfn data-dfn-for="" data-dfn-type="dfn" id=
      "dom-oncomplete" data-idl="callback" data-title=
      "OnComplete"><code>OnComplete</code></dfn> callback is called
      when the data source has finished sending values.</li>
    </ul>
    <section data-dfn-for="Subscription" id=
    "the-subscription-interface">
      <h3 id="x8-1-the-subscription-interface"><span class=
      "secno">8.1</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-subscription" data-idl="interface" data-title=
      "Subscription"><code>Subscription</code></dfn>
      interface<a class="self-link" aria-label="§" href=
      "#the-subscription-interface"></a></h3>
      <p>Contains the <dfn data-dfn-for="subscription"
      data-dfn-type="dfn" id="dom-subscription-closed" data-idl=
      "attribute" data-title="closed" data-type="boolean" data-lt=
      "subscription.closed|closed"><code>closed</code></dfn>
      property of type <code>boolean</code> that tells if the
      subscription is closed or active.</p>
      <p>Also, contains the <dfn data-dfn-for="subscription"
      data-dfn-type="dfn" id="dom-subscription-unsubscribe"
      data-idl="operation" data-title="unsubscribe" data-type=
      "void" data-lt=
      "unsubscribe|unsubscribe()"><code>unsubscribe</code></dfn>()
      method that cancels the subscription, i.e. makes a request to
      the underlying platform to stop receiving data from the
      source, and sets the <code>closed</code> property to
      <code>false</code>.</p>
    </section>
    <section data-dfn-for="Observable" id=
    "the-observable-interface">
      <h3 id="x8-2-the-observable-interface"><span class=
      "secno">8.2</span> The <dfn data-dfn-for="" data-dfn-type=
      "dfn" id="dom-observable" data-idl="interface" data-title=
      "Observable"><code>Observable</code></dfn> interface<a class=
      "self-link" aria-label="§" href=
      "#the-observable-interface"></a></h3>
      <p>The <a href="#dom-observable" class="internalDFN"
      data-link-type="dfn"><code>Observable</code></a> interface
      enabled subscribing to pushed data notifications by the
      <dfn data-dfn-for="observable" data-dfn-type="dfn" id=
      "dom-observable-subscribe" data-idl="operation" data-title=
      "subscribe" data-type="Subscription" data-lt=
      "subscribe|subscribe()"><code>subscribe</code></dfn>()
      method:</p>
      <ul>
        <li>Initialize the data handler callback with the first
        function argument.</li>
        <li>If the next argument is provided and is a function,
        initialize the error handling callback with that function,
        or throw on error.</li>
        <li>If the third argument is provided and is a function,
        initialize the completion handler with that function, or
        throw on error.</li>
        <li>After callback initializations, the implementation
        should request the underlying platform to provide data,
        error and completion notifications for the supported data
        source.</li>
      </ul>
    </section>
  </section>
  <section>
    <!--OddPage-->
    <h2 id="security"><span class="secno">9.</span> Security and
    Privacy<a class="self-link" aria-label="§" href=
    "#security"></a></h2>
    <p>In general the security measures taken to protect a WoT
    system will depend on the threats and attackers that system may
    face and the value of the assets needs to protect. A detailed
    discussion of security and privacy considerations for the Web
    of Things, including a threat model that can be adapted to
    various circumstances, is presented in the informative document
    [<cite><a class="bibref" href=
    "#bib-wot-security-considerations">WOT-SECURITY-CONSIDERATIONS</a></cite>].
    This section includes only normative recommendations relevant
    to the WoT Thing Description.</p>
    <p><span class="rfc2119-assertion" id=
    "td-sec-best-practices">When designing new devices and services
    for use with the WoT, we have documented a set of best
    practices in [<cite><a class="bibref" href=
    "#bib-wot-security-best-practices">WOT-SECURITY-BEST-PRACTICES</a></cite>]
    that <em class="rfc2119" title="SHOULD">SHOULD</em> be
    followed.</span> This best-practices document may be updated as
    security measures evolve. Following these practices does not
    guarantee security, but it at least will help to avoid common
    known vulnerabilities and pitfalls.</p>
    <p>Below are specific recommendations related to WoT runtime
    implementations:</p>
    <ul>
      <li>In basic WoT setups, all scripts running inside the WoT
      runtime are considered trusted, and therefore there is no
      strong need to perform strict isolation between each running
      script instance. However, depending on device capabilities
      and deployment use case scenario risk level it might be
      desirable to do so.
        <ul>
          <li>For example, if one script handles sensitive
          privacy-related data and well-audited, it might be
          desirable to separate it from the rest of the script
          instances to minimize the risk of data exposure in case
          some other script inside WoT gets compromised during the
          runtime. <span class="rfc2119-assertion" id=
          "scripting-sec-isolation-scripts">Therefore the WoT
          runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
          perform isolation of script instances and their data in
          cases when scripts handle privacy-related or other
          critical security data.</span></li>
          <li>Another example is mutual co-existence of different
          tenants on a single WoT device. In this case each WoT
          runtime instance will be hosting a different tenant, and
          isolation between them is required. <span class=
          "rfc2119-assertion" id=
          "scripting-sec-isolation-runtimes">Therefore the WoT
          runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
          perform isolation of WoT runtime instances and their data
          if a WoT device has more than one tenant.</span></li>
        </ul>Such isolation can be performed within the WoT Runtime
        using platform security mechanisms available on the device.
        For more information see Section "WoT Servient
        Single-Tenant" and "WoT Servient Multi-Tenant" of
        [<cite><a class="bibref" href=
        "#bib-wot-security-considerations">WOT-SECURITY-CONSIDERATIONS</a></cite>].
      </li>
      <li>WoT scripts are using WoT Scripting API to implement the
      functionality and logic for WoT Things. In addition to
      providing the isolation between script and runtime instances,
      the WoT runtime needs to protect the underlying physical
      device from potentially misbehaving WoT scripts. <span class=
      "rfc2119-assertion" id="scripting-sec-native">Therefore the
      WoT Runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
      avoid directly exposing the native device interfaces to the
      script developers.</span> Instead a WoT Runtime should
      provide a hardware abstraction layer for accessing the native
      device interfaces. Additionally, in order to reduce the
      damage to a physical WoT device in cases a WoT script gets
      compromised, it is important to minimize the number of
      interfaces that are exposed or accessible to a particular WoT
      script based on its functionality. <span class=
      "rfc2119-assertion" id=
      "scripting-sec-interface-min">Therefore the WoT Runtime
      <em class="rfc2119" title="SHOULD">SHOULD</em> only expose a
      minimal set of interfaces to a WoT script based on its
      intended functionality.</span></li>
      <li>If the WoT runtime supports post-manufacturing
      provisioning or update of WoT scripts, WoT runtime or any
      related data (including security credentials), it can be a
      major attack vector. An attacker can try to modify any above
      described part during the update or provisioning process or
      simply provision attacker's code and data directly.
      <span class="rfc2119-assertion" id=
      "scripting-sec-update">Therefore, if WoT Runtime supports
      post-manufacturing provisioning or update of WoT scripts, WoT
      runtime or any related data, such operations <em class=
      "rfc2119" title="SHOULD">SHOULD</em> be done in a secure
      fashion.</span> A set of recommendations for secure update
      and post-manufacturing provisioning can be found in
      [<cite><a class="bibref" href=
      "#bib-wot-security-best-practices">WOT-SECURITY-BEST-PRACTICES</a></cite>].</li>
      <li>Typically the WoT runtime needs to store the security
      credentials that are provisioned to a WoT device to operate
      in WoT network. The confidentiality or integrity of these
      credentials should not be compromised. <span class=
      "rfc2119-assertion" id="scripting-sec-creds1">Therefore the
      WoT runtime <em class="rfc2119" title="SHOULD">SHOULD</em>
      securely store the provisioned security credentials,
      guaranteeing their integrity and confidentiality.</span>
      <span class="rfc2119-assertion" id="scripting-sec-creds2">In
      case there are more than one tenant on a single WoT-enabled
      device, a WoT Runtime <em class="rfc2119" title=
      "SHOULD">SHOULD</em> guarantee isolation of each tenant
      provisioned security credentials.</span> Additionally, in
      order to minimize a risk that provisioned security
      credentials get compromised, the WoT runtime should not have
      any way for WoT scripts to query these credentials.
      <span class="rfc2119-assertion" id=
      "scripting-sec-creds3">Therefore, the WoT Runtime <em class=
      "rfc2119" title="SHOULD NOT">SHOULD NOT</em> expose any API
      for WoT scripts to query the provisioned security
      credentials.</span></li>
    </ul>
    <p>Some additional specific recommendations relevant for WoT
    script developers:</p>
    <ul>
      <li>A typical way to compromise any process is to send it a
      corrupted input via one of the exposed interfaces.
      <span class="rfc2119-assertion" id=
      "scripting-sec-inputs">Therefore developers <em class=
      "rfc2119" title="SHOULD">SHOULD</em> perform validation on
      all WoT script inputs, including <a href=
      "https://en.wikipedia.org/wiki/Fuzzing">fuzzing</a>.</span>
      There are many tool and techniques in existence to do such
      validation. More details can be found in [<cite><a class=
      "bibref" href=
      "#bib-wot-security-testing">WOT-SECURITY-TESTING</a></cite>].</li>
      <li>As any software, complex scripts with a lot of
      functionality presents a higher risk of development mistakes.
      Such scripts are also hard to verify and test appropriately.
      <span class="rfc2119-assertion" id=
      "scripting-sec-complexity">Therefore developers SHOUD
      minimize the functionality and complexity of WoT
      scripts.</span></li>
      <li>If a WoT script performs a heavy functional processing on
      received requests before the request is authenticated, it
      presents a great risk for Denial-Of-Service (DOS) attacks.
      <span class="rfc2119-assertion" id=
      "scripting-sec-dos">Therefore WoT scripts <em class="rfc2119"
      title="SHOULD">SHOULD</em> avoid heavy functional processing
      without prior successful authentication of requestor.</span>
      The set of recommended authentication mechanisms can be found
      in [<cite><a class="bibref" href=
      "#bib-wot-security-best-practices">WOT-SECURITY-BEST-PRACTICES</a></cite>].</li>
      <li>WoT developers should remember that a content of a TD can
      change, including its identified, id, which is not an
      immutable identifier. <span class="rfc2119-assertion" id=
      "scripting-sec-id">Therefore WoT scripts <em class="rfc2119"
      title="SHOULD">SHOULD</em> use the provided WoT script API to
      subscribe for notifications on TD changes.</span></li>
    </ul>
  </section>
  <section id="terminology-and-conventions">
    <!--OddPage-->
    <h2 id="x10-terminology-and-conventions"><span class=
    "secno">10.</span> Terminology and conventions<a class=
    "self-link" aria-label="§" href=
    "#terminology-and-conventions"></a></h2>
    <p>The generic WoT terminology is defined in [<cite><a class=
    "bibref" href=
    "#bib-wot-architecture">WOT-ARCHITECTURE</a></cite>]:
    <dfn data-lt="things|thing" data-dfn-type="dfn" id=
    "dfn-things">Thing</dfn>, <dfn data-lt=
    "thing descriptions|thing description" data-dfn-type="dfn" id=
    "dfn-thing-descriptions">Thing Description</dfn> (in short
    <dfn data-dfn-type="dfn" id="dfn-td">TD</dfn>),
    <dfn data-dfn-type="dfn" id="dfn-web-of-things">Web of
    Things</dfn> (in short <b><i>WoT</i></b>), <dfn data-dfn-type=
    "dfn" id="dfn-wot-interface">WoT Interface</dfn>,
    <dfn data-dfn-type="dfn" id="dfn-protocol-bindings">Protocol
    Bindings</dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-wot-runtime">WoT Runtime</dfn>, <dfn data-lt=
    "consume|consume a td|consuming a td|consuming a thing description"
    data-dfn-type="dfn" id="dfn-consume">Consuming a Thing
    Description</dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-thing-directory">Thing Directory</dfn>,
    <dfn data-dfn-type="dfn" id="dfn-wot-interactions">WoT
    Interactions</dfn>, <dfn data-lt="properties|property"
    data-dfn-type="dfn" id="dfn-properties">Property</dfn>,
    <dfn data-lt="actions|action" data-dfn-type="dfn" id=
    "dfn-actions">Action</dfn>, <dfn data-lt=
    "events|wot-event|event" data-dfn-type="dfn" id=
    "dfn-events">Event</dfn> etc.</p>
    <p><dfn data-dfn-type="dfn" id="dfn-json-ld">JSON-LD</dfn> is
    defined in [<cite><a class="bibref" href=
    "#bib-json-ld">JSON-LD</a></cite>] as a JSON document that is
    augmented with support for Linked Data.</p>
    <p>The terms <a href=
    "http://www.w3.org/TR/url-1/"><dfn data-dfn-type="dfn" id=
    "dfn-url">URL</dfn></a> and <a href=
    "https://url.spec.whatwg.org/#concept-url-path"><dfn data-dfn-type="dfn"
    id="dfn-url-path">URL path</dfn></a> are defined in
    [<cite><a class="bibref" href="#bib-url">URL</a></cite>].</p>
    <p>The following terms are defined in [<cite><a class="bibref"
    href="#bib-html52">HTML52</a></cite>] and are used in the context
    of browser implementations: <a href=
    "https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">
    <dfn data-dfn-type="dfn" id="dfn-browsing-context">browsing
    context</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#top-level-browsing-context"><dfn data-dfn-type="dfn"
    id="dfn-top-level-browsing-context">top-level browsing
    context</dfn></a>, <a href=
    "https://html.spec.whatwg.org/multipage/webappapis.html#global-object">
    <dfn data-dfn-type="dfn" id="dfn-global-object">global
    object</dfn></a>, <a href=
    "http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">
    <dfn data-dfn-type="dfn" id=
    "dfn-incumbent-settings-object">incumbent settings
    object</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#document"><dfn data-dfn-type=
    "dfn" id="dfn-document">Document</dfn></a>, <a href=
    "http://www.w3.org/TR/2011/WD-html5-20110113/urls.html#document-base-url">
    <dfn data-dfn-type="dfn" id="dfn-document-base-url">document
    base URL</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#window"><dfn data-dfn-type="dfn"
    id="dfn-window">Window</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#windowproxy"><dfn data-dfn-type=
    "dfn" id="dfn-windowproxy">WindowProxy</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#origin"><dfn data-dfn-type="dfn"
    id="dfn-origin">origin</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#ascii-serialisation-of-an-origin">
    <dfn data-dfn-type="dfn" id="dfn-ascii-serialized-origin">ASCII
    serialized origin</dfn></a>, executing algorithms <a href=
    "https://html.spec.whatwg.org/#in-parallel"><dfn data-dfn-type=
    "dfn" id="dfn-in-parallel">in parallel</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#queue-a-task"><dfn data-dfn-type="dfn"
    id="dfn-queue-a-task">queue a task</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#task-source"><dfn data-dfn-type=
    "dfn" id="dfn-task-source">task source</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#the-iframe-element"><dfn data-dfn-type="dfn"
    id="dfn-iframe">iframe</dfn></a>, <a href=
    "https://html.spec.whatwg.org/#valid-mime-type"><dfn data-dfn-type="dfn"
    id="dfn-valid-mime-type">valid MIME type</dfn></a>.</p>
    <p>A <a href="#dfn-browsing-context" class="internalDFN"
    data-link-type="dfn">browsing context</a> refers to the
    environment in which <a href="#dfn-document" class=
    "internalDFN" data-link-type="dfn">Document</a> objects are
    presented to the user. A given <a href="#dfn-browsing-context"
    class="internalDFN" data-link-type="dfn">browsing context</a>
    has a single <code><a href="#dfn-windowproxy" class=
    "internalDFN" data-link-type="dfn">WindowProxy</a></code>
    object, but it can have many <code><a href="#dfn-document"
    class="internalDFN" data-link-type="dfn">Document</a></code>
    objects, with their associated <code><a href="#dfn-window"
    class="internalDFN" data-link-type="dfn">Window</a></code>
    objects. The <a href="#dfn-script-execution-context" class=
    "internalDFN" data-link-type="dfn">script execution context</a>
    associated with the <i>browsing context</i> identifies the
    entity which invokes this API, which can be a <i>web app</i>, a
    <i>web page</i>, or an <a href="#dfn-iframe" class=
    "internalDFN" data-link-type="dfn">iframe</a>.</p>
    <p>The term <a href=
    "https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">
    <dfn data-dfn-type="dfn" id="dfn-secure-context">secure
    context</dfn></a> is defined in [<cite><a class="bibref" href=
    "#bib-webappsec">WEBAPPSEC</a></cite>].</p>
    <p><a href=
    "https://tc39.github.io/ecma262/#sec-error-objects"><dfn data-dfn-type="dfn"
    id="dfn-error">Error</dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-evalerror">EvalError</dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-rangeerror">RangeError</dfn>, <dfn data-dfn-type="dfn" id=
    "dfn-referenceerror">ReferenceError</dfn>, <dfn data-dfn-type=
    "dfn" id="dfn-syntaxerror">SyntaxError</dfn>,
    <dfn data-dfn-type="dfn" id="dfn-typeerror">TypeError</dfn>,
    <dfn data-dfn-type="dfn" id="dfn-urierror">URIError</dfn></a> ,
    <a href=
    "https://tc39.github.io/ecma262/#sec-execution-contexts"><dfn data-dfn-type="dfn"
    id="dfn-script-execution-context">script execution
    context</dfn></a>, <a href=
    "http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects">
    <dfn data-dfn-type="dfn" id="dfn-promise">Promise</dfn></a>,
    <a href=
    "http://www.ecma-international.org/ecma-262/6.0/#sec-json-object">
    <dfn data-dfn-type="dfn" id="dfn-json">JSON</dfn></a>, <a href=
    "http://www.ecma-international.org/ecma-262/6.0/#sec-json.stringify">
    <dfn data-dfn-type="dfn" id=
    "dfn-json-stringify">JSON.stringify</dfn></a> and <a href=
    "http://www.ecma-international.org/ecma-262/6.0/#sec-json.parse">
    <dfn data-dfn-type="dfn" id=
    "dfn-json-parse">JSON.parse</dfn></a> are defined in
    [<cite><a class="bibref" href=
    "#bib-ecmascript">ECMASCRIPT</a></cite>].</p>
    <p><a href=
    "http://heycam.github.io/webidl/#idl-DOMString"><dfn data-dfn-type="dfn"
    id="dfn-domstring">DOMString</dfn></a>, <a href=
    "https://heycam.github.io/webidl/#idl-USVString"><dfn data-dfn-type="dfn"
    id="dfn-usvstring">USVString</dfn></a>, <a href=
    "http://heycam.github.io/webidl/#idl-ArrayBuffer"><dfn data-dfn-type="dfn"
    id="dfn-arraybuffer">ArrayBuffer</dfn></a>, <a href=
    "http://heycam.github.io/webidl/#common-BufferSource"><dfn data-dfn-type="dfn"
    id="dfn-buffersource">BufferSource</dfn></a> and <a href=
    "http://heycam.github.io/webidl/#idl-any"><dfn data-dfn-type=
    "dfn" id="dfn-any-0">any</dfn></a> are defined in
    [<cite><a class="bibref" href=
    "#bib-webidl">WEBIDL</a></cite>].</p>
    <p>The algorithms <a href=
    "http://www.w3.org/TR/encoding/#utf-8-encode"><dfn data-dfn-type="dfn"
    id="dfn-utf-8-encode">utf-8 encode</dfn></a>, and <a href=
    "http://www.w3.org/TR/encoding/#utf-8-decode"><dfn data-dfn-type="dfn"
    id="dfn-utf-8-decode">utf-8 decode</dfn></a> are defined in
    [<cite><a class="bibref" href=
    "#bib-encoding">ENCODING</a></cite>].</p>
    <p><dfn data-dfn-type="dfn" id="dfn-iana-media-type">IANA media
    type</dfn>s (formerly known as MIME types) are defined in
    <a href="http://tools.ietf.org/html/rfc2046">RFC2046</a>.</p>
    <p>The terms <dfn data-dfn-type="dfn" id=
    "dfn-hyperlink-reference">hyperlink reference</dfn> and
    <dfn data-dfn-type="dfn" id="dfn-relation-type">relation
    type</dfn> are defined in [<cite><a class="bibref" href=
    "#bib-html52">HTML52</a></cite>] and <a href=
    "https://tools.ietf.org/html/rfc8288">RFC8288</a>.</p>
  </section>
  <section id="conformance">
    <!--OddPage-->
    <h2 id="x11-conformance"><span class="secno">11.</span>
    Conformance<a class="self-link" aria-label="§" href=
    "#conformance"></a></h2>
    <p>As well as sections marked as non-normative, all authoring
    guidelines, diagrams, examples, and notes in this specification
    are non-normative. Everything else in this specification is
    normative.</p>
    <p id="respecRFC2119">The key words <em class=
    "rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class=
    "rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em>
    are to be interpreted as described in [<cite><a class="bibref"
    href="#bib-rfc2119">RFC2119</a></cite>].</p>
    <p>This document defines conformance criteria that apply to a
    single product: the <dfn data-dfn-type="dfn" id=
    "dfn-ua">UA</dfn> (user agent) that implements the interfaces
    it contains.</p>
    <p>This specification can be used for implementing the WoT
    Scripting API in multiple programming languages. The interface
    definitions are specified in [<cite><a class="bibref" href=
    "#bib-webidl">WEBIDL</a></cite>].</p>
    <p>The user agent (UA) may be implemented in the browser, or in
    a separate runtime environment, such as <a href=
    "https://nodejs.org/en/">Node.js</a> or small embedded
    runtimes.</p>
    <p>Implementations that use ECMAScript executed in a browser to
    implement the APIs defined in this document <em class="rfc2119"
    title="MUST">MUST</em> implement them in a manner consistent
    with the ECMAScript Bindings defined in the Web IDL
    specification [<cite><a class="bibref" href=
    "#bib-webidl">WEBIDL</a></cite>].</p>
    <p>Implementations that use TypeScript or ECMAScript in a
    runtime to implement the APIs defined in this document
    <em class="rfc2119" title="MUST">MUST</em> implement them in a
    manner consistent with the TypeScript Bindings defined in the
    TypeScript specification [<cite><a class="bibref" href=
    "#bib-typescript">TYPESCRIPT</a></cite>].</p>
    <p>This document serves a general description of the WoT
    Scripting API. Language and runtime specific issues are
    discussed in separate extensions of this document.</p>
  </section>
  <section class="appendix" id="Changes">
    <!--OddPage-->
    <h2 id="a-changes"><span class="secno">A.</span>
    Changes<a class="self-link" aria-label="§" href=
    "#Changes"></a></h2>
    <p>The following is a list of major changes to the document.
    For a complete list of changes, see the <a href=
    "https://github.com/w3c/wot-scripting-api/commits/master">github
    change log</a>. You can also view the <a href=
    "https://github.com/w3c/wot-scripting-api/issues?page=1&amp;state=closed">
    recently closed issues</a>.</p>
    <ul>
      <li>Make the Scripting API refer to (rather then locally
      re-define) the data structures defined in the <a href=
      "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/">Thing
      Description specification</a>.
      </li>
    </ul>
  </section>
  <section>
    <!--OddPage-->
    <h2 class="appendix" id="openissues"><span class=
    "secno">B.</span> Open issues<a class="self-link" aria-label=
    "§" href="#openissues"></a></h2>
    <p>The following problems are being discussed and need most
    attention:</p>
    <ul>
      <li>Security related metadata
      (https://github.com/w3c/wot-scripting-api/issues/91).</li>
      <li>Providing Protocol Binding for <a href=
      "#dom-exposedthing" class="internalDFN" data-link-type="dfn">
        <code>ExposedThing</code></a>
        (https://github.com/w3c/wot-scripting-api/issues/45).
      </li>
      <li>Script management and runtime related issues
      (https://github.com/w3c/wot-scripting-api/issues/)</li>
    </ul>
  </section>
  <section id="acknowledgements">
    <!--OddPage-->
    <h2 id="c-acknowledgements"><span class="secno">C.</span>
    Acknowledgments<a class="self-link" aria-label="§" href=
    "#acknowledgements"></a></h2>
    <p>Special thanks to former editor Johannes Hund (until August
    2017, when at Siemens AG) for developing this specification.
    Also, the editors would like to thank Dave Raggett, Matthias
    Kovatsch, Michael Koster and Michael McCool for their comments
    and guidance.</p>
  </section>
  <section id="references" class="appendix">
    <!--OddPage-->
    <h2 id="d-references"><span class="secno">D.</span>
    References<a class="self-link" aria-label="§" href=
    "#references"></a></h2>
    <section id="normative-references">
      <h3 id="d-1-normative-references"><span class=
      "secno">D.1</span> Normative references<a class="self-link"
      aria-label="§" href="#normative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-ecmascript">[ECMASCRIPT]</dt>
        <dd>
          <a href=
          "https://tc39.github.io/ecma262/"><cite>ECMAScript
          Language Specification</cite></a>. Ecma International.
          URL: <a href=
          "https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
        </dd>
        <dt id="bib-encoding">[ENCODING]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/encoding/"><cite>Encoding</cite></a>.
          Anne van Kesteren; Joshua Bell; Addison Phillips. W3C. 15
          December 2016. W3C Candidate Recommendation. URL:
          <a href="https://www.w3.org/TR/encoding/">https://www.w3.org/TR/encoding/</a>
        </dd>
        <dt id="bib-HTML52">[HTML52]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/html52/"><cite>HTML 5.2</cite></a>.
          Steve Faulkner;
          Arron Eicholz;
          Travis Leithead;
          Alex Danilo;
          Sangwhan Moon;
          Erika Doyle Navara;
          Theresa O'Connor;
          Robin Berjon.
          W3C. 14 December 2017. W3C Recommendation. URL:
          <a href="https://www.w3.org/TR/html52/">https://www.w3.org/TR/html52/</a>
        </dd>
        <dt id="bib-json-ld">[JSON-LD]</dt>
        <dd>
          <a href="https://www.w3.org/TR/json-ld/"><cite>JSON-LD
          1.0</cite></a>. Manu Sporny; Gregg Kellogg; Markus
          Lanthaler. W3C. 16 January 2014. W3C Recommendation. URL:
          <a href=
          "https://www.w3.org/TR/json-ld/">https://www.w3.org/TR/json-ld/</a>
        </dd>
        <dt id="bib-rfc2119">[RFC2119]</dt>
        <dd>
          <a href="https://tools.ietf.org/html/rfc2119"><cite>Key
          words for use in RFCs to Indicate Requirement
          Levels</cite></a>. S. Bradner. IETF. March 1997. Best
          Current Practice. URL: <a href=
          "https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
        </dd>
        <dt id="bib-typescript">[TYPESCRIPT]</dt>
        <dd>
          <a href=
          "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
          <cite>TypeScript Language Specification</cite></a>.
          Microsoft. 1 October 2012. URL: <a href=
          "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
          https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md</a>
        </dd>
        <dt id="bib-url">[URL]</dt>
        <dd>
          <a href="https://url.spec.whatwg.org/"><cite>URL
          Standard</cite></a>. Anne van Kesteren. WHATWG. Living
          Standard. URL: <a href=
          "https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        </dd>
        <dt id="bib-webappsec">[WEBAPPSEC]</dt>
        <dd>
          <a href=
          "https://w3c.github.io/webappsec/specs/powerfulfeatures"><cite>
          Secure Contexts</cite></a>. W3C. 17 July 2015. URL:
          <a href=
          "https://w3c.github.io/webappsec/specs/powerfulfeatures">https://w3c.github.io/webappsec/specs/powerfulfeatures</a>
        </dd>
        <dt id="bib-webidl">[WEBIDL]</dt>
        <dd>
          <a href="https://heycam.github.io/webidl/"><cite>Web
          IDL</cite></a>. Cameron McCormack; Boris Zbarsky; Tobie
          Langel. W3C. 15 December 2016. W3C Editor's Draft. URL:
          <a href=
          "https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
        </dd>
        <dt id="bib-wot-architecture">[WOT-ARCHITECTURE]</dt>
        <dd>
          <a href=
          "https://w3c.github.io/wot-architecture/"><cite>Web of
          Things Architecture</cite></a>. W3C. 20 August 2017. URL:
          <a href=
          "https://w3c.github.io/wot-architecture/">https://w3c.github.io/wot-architecture/</a>
        </dd>
        <dt id="bib-wot-security-best-practices">
        [WOT-SECURITY-BEST-PRACTICES]</dt>
        <dd>
          <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md">
          <cite>Web of Things Security and Privacy Best Practices
          (WIP)</cite></a>. W3C. WIP. URL: <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md">
          https://github.com/w3c/wot-security/blob/master/wot-security-best-practices.md</a>
        </dd>
        <dt id="bib-wot-security-considerations">
        [WOT-SECURITY-CONSIDERATIONS]</dt>
        <dd>
          <a href="https://w3c.github.io/wot-security/"><cite>Web
          of Things Security and Privacy Considerations</cite></a>.
          W3C. 28 August 2017. URL: <a href=
          "https://w3c.github.io/wot-security/">https://w3c.github.io/wot-security/</a>
        </dd>
        <dt id="bib-wot-security-testing">
        [WOT-SECURITY-TESTING]</dt>
        <dd>
          <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md">
          <cite>Web of Things Security Testing and
          Validation</cite></a>. W3C. WIP. URL: <a href=
          "https://github.com/w3c/wot-security/blob/master/wot-security-testing.md">
          https://github.com/w3c/wot-security/blob/master/wot-security-testing.md</a>
        </dd>
        <dt id="bib-wot-td">[WOT-TD]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/"><cite>WoT
          Thing Description</cite></a> . W3C. 21 October 2018. URL:
          <a href=
             "https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/">https://www.w3.org/TR/2018/WD-wot-thing-description-20181021/</a>
        </dd>
      </dl>
    </section>
    <section id="informative-references">
      <h3 id="d-2-informative-references"><span class=
      "secno">D.2</span> Informative references<a class="self-link"
      aria-label="§" href="#informative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-html">[HTML]</dt>
        <dd>
          <a href=
          "https://html.spec.whatwg.org/multipage/"><cite>HTML
          Standard</cite></a>. Anne van Kesteren; Domenic Denicola;
          Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG.
          Living Standard. URL: <a href=
          "https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        </dd>
      </dl>
    </section>
  </section>
  <p role="navigation" id="back-to-top"><a href=
  "#toc"><abbr title="Back to Top">↑</abbr></a></p>
  <script src="https://www.w3.org/scripts/TR/2016/fixup.js">
  </script>
</body>
</html>
